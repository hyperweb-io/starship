// Jest Snapshot v1, https://goo.gl/fbAQLP

exports[`Manifest Comparison Tests Individual Config Comparisons should generate manifests for agoric that match the snapshot 1`] = `
"ðŸ”„ MODIFIED_RESOURCES:

--- StatefulSet/agoric-3-genesis ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,18 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/id": "agoric-3",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "agoric-3-genesis",[39m
[31m+       "app.kubernetes.io/part-of": "agoric-3",[39m
[31m+       "app.kubernetes.io/role": "genesis",[39m
[31m+       "app.kubernetes.io/type": "agoric-3-statefulset",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-name": "agoric",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "agoric-3-genesis",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +21,7 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "agoric",[39m
[31m+         "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m          "app.kubernetes.io/name": "agoric-3-genesis",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -23,11 +35,12 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "agoric",[39m
[31m+           "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m            "app.kubernetes.io/name": "agoric-3-genesis",[22m
[2m            "app.kubernetes.io/rawname": "agoric-3",[22m
[31m+           "app.kubernetes.io/role": "genesis",[39m
[2m            "app.kubernetes.io/type": "agoric-3",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[33m@@ -91,11 +104,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -184,12 +197,12 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[32m-                 "memory": "200M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "128M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[32m-                 "memory": "200M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "128M",[39m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[33m@@ -211,7 +224,12 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "START_ARGS=\\"\\"[39m
[31m+               "#!/bin/bash[39m
[31m+ set -euo pipefail[39m
[31m+[39m
[31m+ START_ARGS=\\"\\"[39m
[31m+[39m
[31m+[39m
[2m  $CHAIN_BIN start $START_ARGS",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -307,6 +325,7 @@[39m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m

[2m  echo \\"Running setup config script...\\"[22m
[31m+[39m
[2m  bash -e /scripts/update-config.sh",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -348,7 +367,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "TIME_IOTA_MS",[22m
[33m@@ -415,9 +434,7 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "# Install faucet binary from the image[39m
[32m- cp /bin/faucet /faucet/faucet[39m
[32m- chmod +x /faucet/faucet",[39m
[31m+               "cp /bin/faucet /faucet/faucet && chmod +x /faucet/faucet",[39m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/faucet:20250325-2207109",[22m
[2m              "imagePullPolicy": "IfNotPresent",[22m

--- ConfigMap/setup-scripts-agoric-3 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -608,6 +608,17 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts-agoric-3",[39m
[31m+       "app.kubernetes.io/part-of": "agoric-3",[39m
[31m+       "app.kubernetes.io/role": "setup-scripts",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-id": "agoric-3",[39m
[31m+       "starship.io/chain-name": "agoric",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts-agoric-3",[22m
[2m    },[22m
[2m  }[22m

--- ConfigMap/keys ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -98,6 +98,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "configmap",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "keys",[39m
[31m+       "app.kubernetes.io/part-of": "global",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "keys",[22m
[2m    },[22m
[2m  }[22m

--- ConfigMap/setup-scripts ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -208,6 +208,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "configmap",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts",[39m
[31m+       "app.kubernetes.io/part-of": "global",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts",[22m
[2m    },[22m
[2m  }[22m

--- StatefulSet/cosmoshub-4-genesis ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,18 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/id": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "cosmoshub-4-genesis",[39m
[31m+       "app.kubernetes.io/part-of": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/role": "genesis",[39m
[31m+       "app.kubernetes.io/type": "cosmoshub-4-statefulset",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-name": "cosmoshub",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "cosmoshub-4-genesis",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +21,7 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "cosmoshub",[39m
[31m+         "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m          "app.kubernetes.io/name": "cosmoshub-4-genesis",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -23,11 +35,12 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "cosmoshub",[39m
[31m+           "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m            "app.kubernetes.io/name": "cosmoshub-4-genesis",[22m
[2m            "app.kubernetes.io/rawname": "cosmoshub-4",[22m
[31m+           "app.kubernetes.io/role": "genesis",[39m
[2m            "app.kubernetes.io/type": "cosmoshub-4",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[33m@@ -91,11 +104,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -184,12 +197,12 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[32m-                 "memory": "200M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "128M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[32m-                 "memory": "200M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "128M",[39m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[33m@@ -211,7 +224,12 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "START_ARGS=\\"\\"[39m
[31m+               "#!/bin/bash[39m
[31m+ set -euo pipefail[39m
[31m+[39m
[31m+ START_ARGS=\\"\\"[39m
[31m+[39m
[31m+[39m
[2m  $CHAIN_BIN start $START_ARGS",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -274,11 +292,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -307,6 +325,7 @@[39m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m

[2m  echo \\"Running setup config script...\\"[22m
[31m+[39m
[2m  bash -e /scripts/update-config.sh",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -348,7 +367,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "TIME_IOTA_MS",[22m
[33m@@ -388,11 +407,11 @@[39m
[2m              "name": "init-config",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -415,20 +434,18 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "# Install faucet binary from the image[39m
[32m- cp /bin/faucet /faucet/faucet[39m
[32m- chmod +x /faucet/faucet",[39m
[31m+               "cp /bin/faucet /faucet/faucet && chmod +x /faucet/faucet",[39m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/faucet:20250325-2207109",[22m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "init-faucet",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -553,11 +570,11 @@[39m
[2m              "name": "init-genesis",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m

--- ConfigMap/setup-scripts-cosmoshub-4 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -608,6 +608,17 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts-cosmoshub-4",[39m
[31m+       "app.kubernetes.io/part-of": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/role": "setup-scripts",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-id": "cosmoshub-4",[39m
[31m+       "starship.io/chain-name": "cosmoshub",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts-cosmoshub-4",[22m
[2m    },[22m
[2m  }[22m

--- ConfigMap/registry-agoric-3 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -7,7 +7,14 @@[39m
[2m    \\"assets\\": [[22m
[2m      {[22m
[2m        \\"base\\": \\"ubld\\",[22m
[32m-       \\"coingecko_id\\": \\"agoric\\",[39m
[31m+       \\"description\\": \\"The native token of Agoric\\",[39m
[31m+       \\"name\\": \\"Agoric\\",[39m
[31m+       \\"display\\": \\"bld\\",[39m
[31m+       \\"symbol\\": \\"BLD\\",[39m
[31m+       \\"logo_URIs\\": {[39m
[31m+         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/agoric/images/bld.png\\",[39m
[31m+         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/agoric/images/bld.svg\\"[39m
[31m+       },[39m
[2m        \\"denom_units\\": [[22m
[2m          {[22m
[2m            \\"denom\\": \\"ubld\\",[22m
[33m@@ -18,21 +25,21 @@[39m
[2m            \\"exponent\\": 6[22m
[2m          }[22m
[2m        ],[22m
[32m-       \\"description\\": \\"The native token of Agoric\\",[39m
[32m-       \\"display\\": \\"bld\\",[39m
[31m+       \\"coingecko_id\\": \\"agoric\\",[39m
[2m        \\"keywords\\": [[22m
[2m          \\"agoric\\"[22m
[32m-       ],[39m
[32m-       \\"logo_URIs\\": {[39m
[32m-         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/agoric/images/bld.png\\",[39m
[32m-         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/agoric/images/bld.svg\\"[39m
[32m-       },[39m
[32m-       \\"name\\": \\"Agoric\\",[39m
[32m-       \\"symbol\\": \\"BLD\\"[39m
[31m+       ][39m
[2m      },[22m
[2m      {[22m
[2m        \\"base\\": \\"uist\\",[22m
[32m-       \\"coingecko_id\\": \\"inter-stable-token\\",[39m
[31m+       \\"description\\": \\"IST is the stable token used by the Agoric chain for execution fees and commerce.\\",[39m
[31m+       \\"name\\": \\"Inter Stable Token\\",[39m
[31m+       \\"display\\": \\"ist\\",[39m
[31m+       \\"symbol\\": \\"IST\\",[39m
[31m+       \\"logo_URIs\\": {[39m
[31m+         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/agoric/images/ist.png\\",[39m
[31m+         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/agoric/images/ist.svg\\"[39m
[31m+       },[39m
[2m        \\"denom_units\\": [[22m
[2m          {[22m
[2m            \\"denom\\": \\"uist\\",[22m
[33m@@ -43,17 +50,10 @@[39m
[2m            \\"exponent\\": 6[22m
[2m          }[22m
[2m        ],[22m
[32m-       \\"description\\": \\"IST is the stable token used by the Agoric chain for execution fees and commerce.\\",[39m
[32m-       \\"display\\": \\"ist\\",[39m
[31m+       \\"coingecko_id\\": \\"inter-stable-token\\",[39m
[2m        \\"keywords\\": [[22m
[2m          \\"inter-stable-token\\"[22m
[32m-       ],[39m
[32m-       \\"logo_URIs\\": {[39m
[32m-         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/agoric/images/ist.png\\",[39m
[32m-         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/agoric/images/ist.svg\\"[39m
[32m-       },[39m
[32m-       \\"name\\": \\"Inter Stable Token\\",[39m
[32m-       \\"symbol\\": \\"IST\\"[39m
[31m+       ][39m
[2m      }[22m
[2m    ][22m
[2m  }",[22m
[33m@@ -110,6 +110,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "registry",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "registry-agoric-3",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "registry-agoric-3",[22m
[2m    },[22m
[2m  }[22m

--- ConfigMap/registry-cosmoshub-4 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -7,7 +7,14 @@[39m
[2m    \\"assets\\": [[22m
[2m      {[22m
[2m        \\"base\\": \\"uatom\\",[22m
[32m-       \\"coingecko_id\\": \\"atom\\",[39m
[31m+       \\"description\\": \\"The native staking and governance token of the Cosmos Hub.\\",[39m
[31m+       \\"name\\": \\"Cosmos Hub Atom\\",[39m
[31m+       \\"display\\": \\"atom\\",[39m
[31m+       \\"symbol\\": \\"ATOM\\",[39m
[31m+       \\"logo_URIs\\": {[39m
[31m+         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/cosmoshub/images/atom.png\\",[39m
[31m+         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/cosmoshub/images/atom.svg\\"[39m
[31m+       },[39m
[2m        \\"denom_units\\": [[22m
[2m          {[22m
[2m            \\"denom\\": \\"uatom\\",[22m
[33m@@ -18,14 +25,7 @@[39m
[2m            \\"exponent\\": 6[22m
[2m          }[22m
[2m        ],[22m
[32m-       \\"description\\": \\"The native staking and governance token of the Cosmos Hub.\\",[39m
[32m-       \\"display\\": \\"atom\\",[39m
[32m-       \\"logo_URIs\\": {[39m
[32m-         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/cosmoshub/images/atom.png\\",[39m
[32m-         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/cosmoshub/images/atom.svg\\"[39m
[32m-       },[39m
[32m-       \\"name\\": \\"Cosmos Hub Atom\\",[39m
[32m-       \\"symbol\\": \\"ATOM\\"[39m
[31m+       \\"coingecko_id\\": \\"atom\\"[39m
[2m      }[22m
[2m    ][22m
[2m  }",[22m
[33m@@ -82,6 +82,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "registry",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "registry-cosmoshub-4",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "registry-cosmoshub-4",[22m
[2m    },[22m
[2m  }[22m

--- Deployment/registry ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,14 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "Deployment",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "registry",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "registry",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "registry",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +17,6 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "registry",[39m
[2m          "app.kubernetes.io/name": "registry",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -22,19 +29,17 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "registry",[39m
[31m+           "app.kubernetes.io/component": "registry",[39m
[31m+           "app.kubernetes.io/managed-by": "starship",[39m
[2m            "app.kubernetes.io/name": "registry",[22m
[32m-           "app.kubernetes.io/rawname": "registry",[39m
[32m-           "app.kubernetes.io/type": "registry",[39m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/part-of": "starship",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+           "starship.io/name": "starship-e2e-tests",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[2m          "containers": Array [[22m
[2m            Object {[22m
[32m-             "command": Array [[39m
[32m-               "registry",[39m
[32m-             ],[39m
[2m              "env": Array [[22m
[2m                Object {[22m
[2m                  "name": "NAMESPACE",[22m
[33m@@ -74,21 +79,20 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "REGISTRY_CHAIN_REGISTRY",[22m
[32m-                 "value": "/configs",[39m
[31m+                 "value": "/chains",[39m
[2m                },[22m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/registry:20250205-544757d",[22m
[32m-             "imagePullPolicy": "IfNotPresent",[39m
[2m              "livenessProbe": Object {[22m
[32m-               "initialDelaySeconds": 20,[39m
[32m-               "periodSeconds": 10,[39m
[31m+               "initialDelaySeconds": 15,[39m
[31m+               "periodSeconds": 20,[39m
[2m                "tcpSocket": Object {[22m
[2m                  "port": 8080,[22m
[2m                },[22m
[2m              },[22m
[2m              "name": "registry",[22m
[2m              "readinessProbe": Object {[22m
[32m-               "initialDelaySeconds": 20,[39m
[31m+               "initialDelaySeconds": 5,[39m
[2m                "periodSeconds": 10,[22m
[2m                "tcpSocket": Object {[22m
[2m                  "port": 8080,[22m
[33m@@ -96,22 +100,22 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[2m                Object {[22m
[32m-                 "mountPath": "/configs/agoric-3",[39m
[32m-                 "name": "registry-configs-agoric-3",[39m
[31m+                 "mountPath": "/chains/agoric-3",[39m
[31m+                 "name": "registry-agoric-3",[39m
[2m                },[22m
[2m                Object {[22m
[32m-                 "mountPath": "/configs/cosmoshub-4",[39m
[32m-                 "name": "registry-configs-cosmoshub-4",[39m
[31m+                 "mountPath": "/chains/cosmoshub-4",[39m
[31m+                 "name": "registry-cosmoshub-4",[39m
[2m                },[22m
[2m              ],[22m
[2m            },[22m
[33m@@ -126,6 +130,7 @@[39m
[2m    echo \\"Checking: http://agoric-3-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id\\"[22m
[2m    sleep 10;[22m
[2m  done[22m
[31m+[39m
[2m  while [ $(curl -sw '%{http_code}' http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id -o /dev/null) -ne 200 ]; do[22m
[2m    echo \\"Genesis validator does not seem to be ready for: cosmoshub-4. Waiting for it to start...\\"[22m
[2m    echo \\"Checking: http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id\\"[22m
[33m@@ -148,16 +153,16 @@[39m
[2m                  },[22m
[2m                },[22m
[2m              ],[22m
[32m-             "image": "curlimages/curl",[39m
[31m+             "image": "curlimages/curl:latest",[39m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "wait-for-chains",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -168,13 +173,13 @@[39m
[2m              "configMap": Object {[22m
[2m                "name": "registry-agoric-3",[22m
[2m              },[22m
[32m-             "name": "registry-configs-agoric-3",[39m
[31m+             "name": "registry-agoric-3",[39m
[2m            },[22m
[2m            Object {[22m
[2m              "configMap": Object {[22m
[2m                "name": "registry-cosmoshub-4",[22m
[2m              },[22m
[32m-             "name": "registry-configs-cosmoshub-4",[39m
[31m+             "name": "registry-cosmoshub-4",[39m
[2m            },[22m
[2m          ],[22m
[2m        },[22m

--- ConfigMap/hermes-agoric-cosmos ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -3,92 +3,45 @@[39m
[2m    "data": Object {[22m
[2m      "config-cli.toml": "# The global section has parameters that apply globally to the relayer operation.[22m
[2m  [global][22m
[32m- # Specify the verbosity for the relayer logging output. Default: 'info'[39m
[32m- # Valid options are 'error', 'warn', 'info', 'debug', 'trace'.[39m
[32m- log_level = 'info'[39m
[32m- # Specify the mode to be used by the relayer. [Required][39m
[31m+ log_level = \\"info\\"[39m
[31m+[39m
[2m  [mode][22m
[32m- # Specify the client mode.[39m
[2m  [mode.clients][22m
[32m- # Whether or not to enable the client workers. [Required][39m
[2m  enabled = true[22m
[32m- # Whether or not to enable periodic refresh of clients. [Default: true][39m
[32m- # This feature only applies to clients that underlie an open channel.[39m
[32m- # For Tendermint clients, the frequency at which Hermes refreshes them is 2/3 of their[39m
[32m- # trusting period (e.g., refresh every ~9 days if the trusting period is 14 days).[39m
[32m- # Note: Even if this is disabled, clients will be refreshed automatically if[39m
[32m- #      there is activity on a connection or channel they are involved with.[39m
[2m  refresh = true[22m
[32m- # Whether or not to enable misbehaviour detection for clients. [Default: false][39m
[2m  misbehaviour = true[22m
[32m- # Specify the connections mode.[39m
[31m+[39m
[2m  [mode.connections][22m
[32m- # Whether or not to enable the connection workers for handshake completion. [Required][39m
[2m  enabled = true[22m
[32m- # Specify the channels mode.[39m
[31m+[39m
[2m  [mode.channels][22m
[32m- # Whether or not to enable the channel workers for handshake completion. [Required][39m
[2m  enabled = true[22m
[32m- # Specify the packets mode.[39m
[31m+[39m
[2m  [mode.packets][22m
[32m- # Whether or not to enable the packet workers. [Required][39m
[2m  enabled = true[22m
[32m- # Parametrize the periodic packet clearing feature.[39m
[32m- # Interval (in number of blocks) at which pending packets[39m
[32m- # should be periodically cleared. A value of '0' will disable[39m
[32m- # periodic packet clearing. [Default: 100][39m
[2m  clear_interval = 100[22m
[32m- # Whether or not to clear packets on start. [Default: false][39m
[2m  clear_on_start = true[22m
[32m- # Toggle the transaction confirmation mechanism.[39m
[32m- # The tx confirmation mechanism periodically queries the \`/tx_search\` RPC[39m
[32m- # endpoint to check that previously-submitted transactions[39m
[32m- # (to any chain in this config file) have been successfully delivered.[39m
[32m- # If they have not been, and \`clear_interval = 0\`, then those packets are[39m
[32m- # queued up for re-submission.[39m
[32m- # Experimental feature. Affects telemetry if set to false.[39m
[32m- # [Default: true][39m
[2m  tx_confirmation = true[22m
[32m- # Auto register the counterparty payee on a destination chain to[39m
[32m- # the relayer's address on the source chain. This can be used[39m
[32m- # for simple configuration of the relayer to receive fees for[39m
[32m- # relaying RecvPacket on fee-enabled channels.[39m
[32m- # For more complex configuration, turn this off and use the CLI[39m
[32m- # to manually register the payee addresses.[39m
[32m- # [Default: false][39m
[32m- auto_register_counterparty_payee = false[39m
[32m- # The REST section defines parameters for Hermes' built-in RESTful API.[39m
[32m- # https://hermes.informal.systems/rest.html[39m
[31m+[39m
[2m  [rest][22m
[32m- # Whether or not to enable the REST service. Default: false[39m
[2m  enabled = true[22m
[32m- # Specify the IPv4/6 host over which the built-in HTTP server will serve the RESTful[39m
[32m- # API requests. Default: 127.0.0.1[39m
[32m- host =  '0.0.0.0'[39m
[32m- # Specify the port over which the built-in HTTP server will serve the restful API[39m
[32m- # requests. Default: 3000[39m
[31m+ host = \\"0.0.0.0\\"[39m
[2m  port = 3000[22m
[32m- # The telemetry section defines parameters for Hermes' built-in telemetry capabilities.[39m
[32m- # https://hermes.informal.systems/telemetry.html[39m
[31m+[39m
[2m  [telemetry][22m
[32m- # Whether or not to enable the telemetry service. Default: false[39m
[2m  enabled = true[22m
[32m- # Specify the IPv4/6 host over which the built-in HTTP server will serve the metrics[39m
[32m- # gathered by the telemetry service. Default: 127.0.0.1[39m
[32m- host = '0.0.0.0'[39m
[32m- # Specify the port over which the built-in HTTP server will serve the metrics gathered[39m
[32m- # by the telemetry service. Default: 3001[39m
[31m+ host = \\"0.0.0.0\\"[39m
[2m  port = 3001[22m
[32m-[39m


[2m  [[chains]][22m
[2m  id = \\"agoric-3\\"[22m
[31m+ type = \\"CosmosSdk\\"[39m
[2m  key_name = \\"agoric-3-cli\\"[22m
[32m- rpc_addr = \\"http://agoric-3-genesis.default.svc.cluster.local:26657\\"[39m
[32m- grpc_addr = \\"http://agoric-3-genesis.default.svc.cluster.local:9090\\"[39m
[32m- event_source = { mode = 'push', url = \\"ws://agoric-3-genesis.default.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[32m- # Experimental: Whether or not the full node is trusted.[39m
[31m+[39m
[31m+ rpc_addr = \\"http://agoric-3-genesis.$NAMESPACE.svc.cluster.local:26657\\"[39m
[31m+ grpc_addr = \\"http://agoric-3-genesis.$NAMESPACE.svc.cluster.local:9090\\"[39m
[31m+ event_source = { mode = 'push', url = \\"ws://agoric-3-genesis.$NAMESPACE.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[2m  trusted_node = false[22m
[2m  account_prefix = \\"agoric\\"[22m
[2m  default_gas = 500000000[22m
[33m@@ -103,17 +56,16 @@[39m
[2m  trusting_period = \\"75s\\"[22m
[2m  trust_threshold = { numerator = \\"2\\", denominator = \\"3\\" }[22m
[2m  address_type = { derivation = 'cosmos' }[22m
[32m- gas_price = { price = 0.25, denom = \\"ubld\\" }[39m
[32m-[39m
[32m-[39m
[31m+ gas_price = { price = 1.25, denom = \\"ubld\\" }[39m

[2m  [[chains]][22m
[2m  id = \\"cosmoshub-4\\"[22m
[31m+ type = \\"CosmosSdk\\"[39m
[2m  key_name = \\"cosmoshub-4-cli\\"[22m
[32m- rpc_addr = \\"http://cosmoshub-4-genesis.default.svc.cluster.local:26657\\"[39m
[32m- grpc_addr = \\"http://cosmoshub-4-genesis.default.svc.cluster.local:9090\\"[39m
[32m- event_source = { mode = 'push', url = \\"ws://cosmoshub-4-genesis.default.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[32m- # Experimental: Whether or not the full node is trusted.[39m
[31m+[39m
[31m+ rpc_addr = \\"http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:26657\\"[39m
[31m+ grpc_addr = \\"http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:9090\\"[39m
[31m+ event_source = { mode = 'push', url = \\"ws://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[2m  trusted_node = false[22m
[2m  account_prefix = \\"cosmos\\"[22m
[2m  default_gas = 500000000[22m
[33m@@ -128,96 +80,48 @@[39m
[2m  trusting_period = \\"75s\\"[22m
[2m  trust_threshold = { numerator = \\"2\\", denominator = \\"3\\" }[22m
[2m  address_type = { derivation = 'cosmos' }[22m
[32m- gas_price = { price = 0.25, denom = \\"uatom\\" }",[39m
[31m+ gas_price = { price = 1.25, denom = \\"uatom\\" }",[39m
[2m      "config.toml": "# The global section has parameters that apply globally to the relayer operation.[22m
[2m  [global][22m
[32m- # Specify the verbosity for the relayer logging output. Default: 'info'[39m
[32m- # Valid options are 'error', 'warn', 'info', 'debug', 'trace'.[39m
[32m- log_level = 'info'[39m
[32m- # Specify the mode to be used by the relayer. [Required][39m
[31m+ log_level = \\"info\\"[39m
[31m+[39m
[2m  [mode][22m
[32m- # Specify the client mode.[39m
[2m  [mode.clients][22m
[32m- # Whether or not to enable the client workers. [Required][39m
[2m  enabled = true[22m
[32m- # Whether or not to enable periodic refresh of clients. [Default: true][39m
[32m- # This feature only applies to clients that underlie an open channel.[39m
[32m- # For Tendermint clients, the frequency at which Hermes refreshes them is 2/3 of their[39m
[32m- # trusting period (e.g., refresh every ~9 days if the trusting period is 14 days).[39m
[32m- # Note: Even if this is disabled, clients will be refreshed automatically if[39m
[32m- #      there is activity on a connection or channel they are involved with.[39m
[2m  refresh = true[22m
[32m- # Whether or not to enable misbehaviour detection for clients. [Default: false][39m
[2m  misbehaviour = true[22m
[32m- # Specify the connections mode.[39m
[31m+[39m
[2m  [mode.connections][22m
[32m- # Whether or not to enable the connection workers for handshake completion. [Required][39m
[2m  enabled = true[22m
[32m- # Specify the channels mode.[39m
[31m+[39m
[2m  [mode.channels][22m
[32m- # Whether or not to enable the channel workers for handshake completion. [Required][39m
[2m  enabled = true[22m
[32m- # Specify the packets mode.[39m
[31m+[39m
[2m  [mode.packets][22m
[32m- # Whether or not to enable the packet workers. [Required][39m
[2m  enabled = true[22m
[32m- # Parametrize the periodic packet clearing feature.[39m
[32m- # Interval (in number of blocks) at which pending packets[39m
[32m- # should be periodically cleared. A value of '0' will disable[39m
[32m- # periodic packet clearing. [Default: 100][39m
[2m  clear_interval = 100[22m
[32m- # Whether or not to clear packets on start. [Default: false][39m
[2m  clear_on_start = true[22m
[32m- # Toggle the transaction confirmation mechanism.[39m
[32m- # The tx confirmation mechanism periodically queries the \`/tx_search\` RPC[39m
[32m- # endpoint to check that previously-submitted transactions[39m
[32m- # (to any chain in this config file) have been successfully delivered.[39m
[32m- # If they have not been, and \`clear_interval = 0\`, then those packets are[39m
[32m- # queued up for re-submission.[39m
[32m- # Experimental feature. Affects telemetry if set to false.[39m
[32m- # [Default: true][39m
[2m  tx_confirmation = true[22m
[32m- # Auto register the counterparty payee on a destination chain to[39m
[32m- # the relayer's address on the source chain. This can be used[39m
[32m- # for simple configuration of the relayer to receive fees for[39m
[32m- # relaying RecvPacket on fee-enabled channels.[39m
[32m- # For more complex configuration, turn this off and use the CLI[39m
[32m- # to manually register the payee addresses.[39m
[32m- # [Default: false][39m
[32m- auto_register_counterparty_payee = false[39m
[32m- # The REST section defines parameters for Hermes' built-in RESTful API.[39m
[32m- # https://hermes.informal.systems/rest.html[39m
[31m+[39m
[2m  [rest][22m
[32m- # Whether or not to enable the REST service. Default: false[39m
[2m  enabled = true[22m
[32m- # Specify the IPv4/6 host over which the built-in HTTP server will serve the RESTful[39m
[32m- # API requests. Default: 127.0.0.1[39m
[32m- host =  '0.0.0.0'[39m
[32m- # Specify the port over which the built-in HTTP server will serve the restful API[39m
[32m- # requests. Default: 3000[39m
[31m+ host = \\"0.0.0.0\\"[39m
[2m  port = 3000[22m
[32m- # The telemetry section defines parameters for Hermes' built-in telemetry capabilities.[39m
[32m- # https://hermes.informal.systems/telemetry.html[39m
[31m+[39m
[2m  [telemetry][22m
[32m- # Whether or not to enable the telemetry service. Default: false[39m
[2m  enabled = true[22m
[32m- # Specify the IPv4/6 host over which the built-in HTTP server will serve the metrics[39m
[32m- # gathered by the telemetry service. Default: 127.0.0.1[39m
[32m- host = '0.0.0.0'[39m
[32m- # Specify the port over which the built-in HTTP server will serve the metrics gathered[39m
[32m- # by the telemetry service. Default: 3001[39m
[31m+ host = \\"0.0.0.0\\"[39m
[2m  port = 3001[22m
[32m-[39m


[2m  [[chains]][22m
[2m  id = \\"agoric-3\\"[22m
[2m  type = \\"CosmosSdk\\"[22m
[2m  key_name = \\"agoric-3\\"[22m
[32m- rpc_addr = \\"http://agoric-3-genesis.default.svc.cluster.local:26657\\"[39m
[32m- grpc_addr = \\"http://agoric-3-genesis.default.svc.cluster.local:9090\\"[39m
[32m- event_source = { mode = 'push', url = \\"ws://agoric-3-genesis.default.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[32m- # Experimental: Whether or not the full node is trusted.[39m
[31m+[39m
[31m+ rpc_addr = \\"http://agoric-3-genesis.$NAMESPACE.svc.cluster.local:26657\\"[39m
[31m+ grpc_addr = \\"http://agoric-3-genesis.$NAMESPACE.svc.cluster.local:9090\\"[39m
[31m+ event_source = { mode = 'push', url = \\"ws://agoric-3-genesis.$NAMESPACE.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[2m  trusted_node = false[22m
[2m  account_prefix = \\"agoric\\"[22m
[2m  default_gas = 500000000[22m
[33m@@ -233,17 +137,15 @@[39m
[2m  trust_threshold = { numerator = \\"2\\", denominator = \\"3\\" }[22m
[2m  address_type = { derivation = 'cosmos' }[22m
[2m  gas_price = { price = 1.25, denom = \\"ubld\\" }[22m
[32m-[39m
[32m-[39m

[2m  [[chains]][22m
[2m  id = \\"cosmoshub-4\\"[22m
[2m  type = \\"CosmosSdk\\"[22m
[2m  key_name = \\"cosmoshub-4\\"[22m
[32m- rpc_addr = \\"http://cosmoshub-4-genesis.default.svc.cluster.local:26657\\"[39m
[32m- grpc_addr = \\"http://cosmoshub-4-genesis.default.svc.cluster.local:9090\\"[39m
[32m- event_source = { mode = 'push', url = \\"ws://cosmoshub-4-genesis.default.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[32m- # Experimental: Whether or not the full node is trusted.[39m
[31m+[39m
[31m+ rpc_addr = \\"http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:26657\\"[39m
[31m+ grpc_addr = \\"http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:9090\\"[39m
[31m+ event_source = { mode = 'push', url = \\"ws://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[2m  trusted_node = false[22m
[2m  account_prefix = \\"cosmos\\"[22m
[2m  default_gas = 500000000[22m
[33m@@ -262,6 +164,15 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "relayer",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "hermes-agoric-cosmos",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/role": "hermes",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "hermes-agoric-cosmos",[22m
[2m    },[22m
[2m  }[22m

--- StatefulSet/hermes-agoric-cosmos ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,15 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "relayer",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "hermes-agoric-cosmos",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/role": "hermes",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "hermes-agoric-cosmos",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -29,16 +38,18 @@[39m
[2m            "app.kubernetes.io/name": "hermes-agoric-cosmos",[22m
[2m            "app.kubernetes.io/rawname": "agoric-cosmos",[22m
[2m            "app.kubernetes.io/type": "hermes",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[2m          "containers": Array [[22m
[2m            Object {[22m
[31m+             "args": Array [[39m
[31m+               "/exposer/exposer",[39m
[31m+             ],[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "/exposer/exposer",[39m
[2m              ],[22m
[2m              "env": Array [[22m
[2m                Object {[22m
[33m@@ -55,11 +66,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -83,14 +94,24 @@[39m
[2m              ],[22m
[2m            },[22m
[2m            Object {[22m
[31m+             "args": Array [[39m
[31m+               "RLY_INDEX=\${HOSTNAME##*-}[39m
[31m+ echo \\"Relayer Index: $RLY_INDEX\\"[39m
[31m+ hermes start",[39m
[31m+             ],[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "RLY_INDEX=\${HOSTNAME##*-}[39m
[32m- echo \\"Relayer Index: $RLY_INDEX\\"[39m
[32m- hermes start",[39m
[2m              ],[22m
[2m              "env": Array [[22m
[31m+               Object {[39m
[31m+                 "name": "NAMESPACE",[39m
[31m+                 "valueFrom": Object {[39m
[31m+                   "fieldRef": Object {[39m
[31m+                     "fieldPath": "metadata.namespace",[39m
[31m+                   },[39m
[31m+                 },[39m
[31m+               },[39m
[2m                Object {[22m
[2m                  "name": "RELAYER_DIR",[22m
[2m                  "value": "/root/.hermes",[22m
[33m@@ -101,12 +122,12 @@[39m
[2m              "name": "relayer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[2m              },[22m
[2m              "securityContext": Object {[22m
[33m@@ -127,24 +148,26 @@[39m
[2m          ],[22m
[2m          "initContainers": Array [[22m
[2m            Object {[22m
[31m+             "args": Array [[39m
[31m+               "# Install exposer binary from the image[39m
[31m+ cp /bin/exposer /exposer/exposer[39m
[31m+ chmod +x /exposer/exposer",[39m
[31m+             ],[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "# Install exposer binary from the image[39m
[32m- cp /bin/exposer /exposer/exposer[39m
[32m- chmod +x /exposer/exposer",[39m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/exposer:20250205-544757d",[22m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "init-exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "100M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "100M",[39m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[33m@@ -155,9 +178,7 @@[39m
[2m              ],[22m
[2m            },[22m
[2m            Object {[22m
[32m-             "command": Array [[39m
[32m-               "bash",[39m
[32m-               "-c",[39m
[31m+             "args": Array [[39m
[2m                "set -ux[22m

[2m  RLY_INDEX=\${HOSTNAME##*-}[22m
[33m@@ -166,18 +187,16 @@[39m
[2m  mkdir -p $RELAYER_DIR[22m
[2m  cp /configs/config.toml $RELAYER_DIR/config.toml[22m
[2m  cp /configs/config-cli.toml $RELAYER_DIR/config-cli.toml[22m
[32m- cat $RELAYER_DIR/config.toml[39m
[31m+[39m
[31m+ # Replace namespace placeholder with actual namespace environment variable[39m
[31m+ sed -i \\"s|\\\\$NAMESPACE|$NAMESPACE|g\\" $RELAYER_DIR/config.toml[39m
[31m+ sed -i \\"s|\\\\$NAMESPACE|$NAMESPACE|g\\" $RELAYER_DIR/config-cli.toml[39m

[32m- MNEMONIC=$(jq -r \\".relayers[$RELAYER_INDEX].mnemonic\\" $KEYS_CONFIG)[39m
[31m+ MNEMONIC=$(jq -r \\".relayers[$RLY_INDEX].mnemonic\\" $KEYS_CONFIG)[39m
[2m  echo $MNEMONIC > $RELAYER_DIR/mnemonic.txt[22m
[32m- MNEMONIC_CLI=$(jq -r \\".relayers_cli[$RELAYER_INDEX].mnemonic\\" $KEYS_CONFIG)[39m
[31m+ MNEMONIC_CLI=$(jq -r \\".relayers_cli[$RLY_INDEX].mnemonic\\" $KEYS_CONFIG)[39m
[2m  echo $MNEMONIC_CLI > $RELAYER_DIR/mnemonic-cli.txt[22m

[32m- echo \\"Debug output for agoric-cosmos...\\"[39m
[32m- cat << EOF[39m
[32m-               map[string]interface {}[39m
[32m-               {\\"chains\\":[\\"agoric-3\\",\\"cosmoshub-4\\"],\\"channels\\":[{\\"a-chain\\":\\"agoric-3\\",\\"a-port\\":\\"transfer\\",\\"b-chain\\":\\"cosmoshub-4\\",\\"b-port\\":\\"transfer\\",\\"new-connection\\":true}],\\"config\\":{\\"event_source\\":{\\"mode\\":\\"push\\"},\\"global\\":{\\"log_level\\":\\"info\\"},\\"mode\\":{\\"channels\\":{\\"enabled\\":true},\\"clients\\":{\\"enabled\\":true,\\"misbehaviour\\":true,\\"refresh\\":true},\\"connections\\":{\\"enabled\\":true},\\"packets\\":{\\"clear_interval\\":100,\\"clear_on_start\\":true,\\"enabled\\":true,\\"tx_confirmation\\":true}},\\"rest\\":{\\"enabled\\":true,\\"host\\":\\"0.0.0.0\\",\\"port\\":3000},\\"telemetry\\":{\\"enabled\\":true,\\"host\\":\\"0.0.0.0\\",\\"port\\":3001}},\\"fullname\\":\\"hermes-agoric-cosmos\\",\\"ics\\":{\\"enabled\\":false},\\"image\\":\\"ghcr.io/cosmology-tech/starship/hermes:1.10.0\\",\\"name\\":\\"agoric-cosmos\\",\\"replicas\\":1,\\"type\\":\\"hermes\\"}[39m
[32m- EOF[39m

[2m  echo \\"Creating key for agoric-3...\\"[22m
[2m  hermes keys add \\\\[22m
[33m@@ -240,12 +259,17 @@[39m
[2m    $DENOM \\\\[22m
[2m    http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:8000/credit \\\\[22m
[2m    \\"true\\" || true[22m
[31m+[39m
[2m  hermes create channel \\\\[22m
[2m    --new-client-connection --yes \\\\[22m
[2m    --b-chain cosmoshub-4 \\\\[22m
[2m    --a-chain agoric-3 \\\\[22m
[2m    --a-port transfer \\\\[22m
[2m    --b-port transfer",[22m
[31m+             ],[39m
[31m+             "command": Array [[39m
[31m+               "bash",[39m
[31m+               "-c",[39m
[2m              ],[22m
[2m              "env": Array [[22m
[2m                Object {[22m
[33m@@ -266,7 +290,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "RELAYER_INDEX",[22m
[32m-                 "value": "0",[39m
[31m+                 "value": "\${HOSTNAME##*-}",[39m
[2m                },[22m
[2m              ],[22m
[2m              "image": "ghcr.io/cosmology-tech/starship/hermes:1.10.0",[22m
[33m@@ -274,12 +298,12 @@[39m
[2m              "name": "init-relayer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[33m@@ -310,6 +334,7 @@[39m
[2m    echo \\"Checking: http://agoric-3-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id\\"[22m
[2m    sleep 10;[22m
[2m  done[22m
[31m+[39m
[2m  while [ $(curl -sw '%{http_code}' http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id -o /dev/null) -ne 200 ]; do[22m
[2m    echo \\"Genesis validator does not seem to be ready for: cosmoshub-4. Waiting for it to start...\\"[22m
[2m    echo \\"Checking: http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id\\"[22m
[33m@@ -332,16 +357,16 @@[39m
[2m                  },[22m
[2m                },[22m
[2m              ],[22m
[32m-             "image": "curlimages/curl",[39m
[31m+             "image": "curlimages/curl:latest",[39m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "wait-for-chains",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m"
`;

exports[`Manifest Comparison Tests Individual Config Comparisons should generate manifests for build-chain that match the snapshot 1`] = `
"ðŸ”„ MODIFIED_RESOURCES:

--- ConfigMap/keys ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -98,6 +98,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "configmap",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "keys",[39m
[31m+       "app.kubernetes.io/part-of": "global",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "keys",[22m
[2m    },[22m
[2m  }[22m

--- ConfigMap/setup-scripts ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -208,6 +208,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "configmap",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts",[39m
[31m+       "app.kubernetes.io/part-of": "global",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts",[22m
[2m    },[22m
[2m  }[22m

--- StatefulSet/cosmoshub-4-genesis ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,18 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/id": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "cosmoshub-4-genesis",[39m
[31m+       "app.kubernetes.io/part-of": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/role": "genesis",[39m
[31m+       "app.kubernetes.io/type": "cosmoshub-4-statefulset",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-name": "cosmoshub",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "cosmoshub-4-genesis",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +21,7 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "cosmoshub",[39m
[31m+         "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m          "app.kubernetes.io/name": "cosmoshub-4-genesis",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -23,11 +35,12 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "cosmoshub",[39m
[31m+           "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m            "app.kubernetes.io/name": "cosmoshub-4-genesis",[22m
[2m            "app.kubernetes.io/rawname": "cosmoshub-4",[22m
[31m+           "app.kubernetes.io/role": "genesis",[39m
[2m            "app.kubernetes.io/type": "cosmoshub-4",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[33m@@ -91,11 +104,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -184,12 +197,12 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[32m-                 "memory": "200M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "128M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[32m-                 "memory": "200M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "128M",[39m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[33m@@ -211,7 +224,12 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "START_ARGS=\\"\\"[39m
[31m+               "#!/bin/bash[39m
[31m+ set -euo pipefail[39m
[31m+[39m
[31m+ START_ARGS=\\"\\"[39m
[31m+[39m
[31m+[39m
[2m  $CHAIN_BIN start $START_ARGS",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -274,11 +292,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -307,6 +325,7 @@[39m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m

[2m  echo \\"Running setup config script...\\"[22m
[31m+[39m
[2m  bash -e /scripts/update-config.sh",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -348,7 +367,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "TIME_IOTA_MS",[22m
[33m@@ -388,11 +407,11 @@[39m
[2m              "name": "init-config",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -415,20 +434,18 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "# Install faucet binary from the image[39m
[32m- cp /bin/faucet /faucet/faucet[39m
[32m- chmod +x /faucet/faucet",[39m
[31m+               "cp /bin/faucet /faucet/faucet && chmod +x /faucet/faucet",[39m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/faucet:20250325-2207109",[22m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "init-faucet",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -553,11 +570,11 @@[39m
[2m              "name": "init-genesis",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m

--- ConfigMap/setup-scripts-cosmoshub-4 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -608,6 +608,17 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts-cosmoshub-4",[39m
[31m+       "app.kubernetes.io/part-of": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/role": "setup-scripts",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-id": "cosmoshub-4",[39m
[31m+       "starship.io/chain-name": "cosmoshub",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts-cosmoshub-4",[22m
[2m    },[22m
[2m  }[22m

--- Service/cosmoshub-4-validator ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -23,6 +23,12 @@[39m
[2m          "targetPort": 8081,[22m
[2m        },[22m
[2m        Object {[22m
[31m+         "name": "faucet",[39m
[31m+         "port": 8000,[39m
[31m+         "protocol": "TCP",[39m
[31m+         "targetPort": 8000,[39m
[31m+       },[39m
[31m+       Object {[39m
[2m          "name": "grpc",[22m
[2m          "port": 9090,[22m
[2m          "protocol": "TCP",[22m

--- StatefulSet/cosmoshub-4-validator ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,18 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/id": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "cosmoshub-4-validator",[39m
[31m+       "app.kubernetes.io/part-of": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/role": "validator",[39m
[31m+       "app.kubernetes.io/type": "cosmoshub-4-statefulset",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-name": "cosmoshub",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "cosmoshub-4-validator",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -10,7 +22,7 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "cosmoshub",[39m
[31m+         "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m          "app.kubernetes.io/name": "cosmoshub-4-validator",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -24,10 +36,11 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "cosmoshub",[39m
[31m+           "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m            "app.kubernetes.io/name": "cosmoshub-4-validator",[22m
[31m+           "app.kubernetes.io/role": "validator",[39m
[2m            "app.kubernetes.io/type": "cosmoshub-4",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[33m@@ -119,11 +132,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -145,7 +158,9 @@[39m
[2m                "set -eux[22m
[2m  START_ARGS=\\"\\"[22m

[31m+[39m
[2m  # Starting the chain[22m
[31m+[39m
[2m  $CHAIN_BIN start $START_ARGS",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -255,11 +270,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -286,6 +301,7 @@[39m
[2m                "-c",[22m
[2m                "VAL_INDEX=\${HOSTNAME##*-}[22m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m
[31m+[39m

[2m  echo \\"Running setup config script...\\"[22m
[2m  bash -e /scripts/update-config.sh[22m
[33m@@ -351,7 +367,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "NAMESPACE",[22m
[33m@@ -399,11 +415,11 @@[39m
[2m              "name": "init-config",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -428,6 +444,7 @@[39m
[2m                "-c",[22m
[2m                "VAL_INDEX=\${HOSTNAME##*-}[22m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m
[31m+[39m

[2m  if [ -f $CHAIN_DIR/config/genesis.json ]; then[22m
[2m    echo \\"Genesis file exists, exiting early\\"[22m
[33m@@ -500,7 +517,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "NAMESPACE",[22m
[33m@@ -548,11 +565,11 @@[39m
[2m              "name": "init-validator",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -597,16 +614,16 @@[39m
[2m                  },[22m
[2m                },[22m
[2m              ],[22m
[32m-             "image": "curlimages/curl",[39m
[31m+             "image": "curlimages/curl:latest",[39m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "wait-for-chains",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -618,6 +635,10 @@[39m
[2m                "name": "keys",[22m
[2m              },[22m
[2m              "name": "addresses",[22m
[31m+           },[39m
[31m+           Object {[39m
[31m+             "emptyDir": Object {},[39m
[31m+             "name": "faucet",[39m
[2m            },[22m
[2m            Object {[22m
[2m              "emptyDir": Object {},[22m

--- StatefulSet/core-1-genesis ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,18 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/id": "core-1",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "core-1-genesis",[39m
[31m+       "app.kubernetes.io/part-of": "core-1",[39m
[31m+       "app.kubernetes.io/role": "genesis",[39m
[31m+       "app.kubernetes.io/type": "core-1-statefulset",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-name": "persistencecore",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "core-1-genesis",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +21,7 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "persistencecore",[39m
[31m+         "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m          "app.kubernetes.io/name": "core-1-genesis",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -23,11 +35,12 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "persistencecore",[39m
[31m+           "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m            "app.kubernetes.io/name": "core-1-genesis",[22m
[2m            "app.kubernetes.io/rawname": "core-1",[22m
[31m+           "app.kubernetes.io/role": "genesis",[39m
[2m            "app.kubernetes.io/type": "core-1",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[33m@@ -91,11 +104,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -184,12 +197,12 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[32m-                 "memory": "200M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "128M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[32m-                 "memory": "200M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "128M",[39m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[33m@@ -211,7 +224,12 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "START_ARGS=\\"\\"[39m
[31m+               "#!/bin/bash[39m
[31m+ set -euo pipefail[39m
[31m+[39m
[31m+ START_ARGS=\\"\\"[39m
[31m+[39m
[31m+[39m
[2m  /usr/bin/cosmovisor start $START_ARGS",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -240,10 +258,18 @@[39m
[2m                  "value": "/root/.persistenceCore",[22m
[2m                },[22m
[2m                Object {[22m
[31m+                 "name": "DAEMON_HOME",[39m
[31m+                 "value": "/root/.persistenceCore",[39m
[31m+               },[39m
[31m+               Object {[39m
[2m                  "name": "DAEMON_NAME",[22m
[2m                  "value": "persistenceCore",[22m
[2m                },[22m
[2m                Object {[22m
[31m+                 "name": "DAEMON_NAME",[39m
[31m+                 "value": "persistenceCore",[39m
[31m+               },[39m
[31m+               Object {[39m
[2m                  "name": "DENOM",[22m
[2m                  "value": "uxprt",[22m
[2m                },[22m
[33m@@ -274,11 +300,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 2,[39m
[31m+                 "cpu": "2",[39m
[2m                  "memory": "2Gi",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 2,[39m
[31m+                 "cpu": "2",[39m
[2m                  "memory": "2Gi",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -360,11 +386,11 @@[39m
[2m              "name": "init-build-images",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 2,[39m
[31m+                 "cpu": "2",[39m
[2m                  "memory": "2Gi",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 2,[39m
[31m+                 "cpu": "2",[39m
[2m                  "memory": "2Gi",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -389,9 +415,11 @@[39m
[2m                "-c",[22m
[2m                "VAL_INDEX=\${HOSTNAME##*-}[22m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m
[31m+[39m
[2m  cp $CHAIN_DIR/cosmovisor/genesis/bin/$CHAIN_BIN /usr/bin[22m

[2m  echo \\"Running setup config script...\\"[22m
[31m+[39m
[2m  bash -e /scripts/update-config.sh",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -433,7 +461,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "TIME_IOTA_MS",[22m
[33m@@ -473,11 +501,11 @@[39m
[2m              "name": "init-config",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 2,[39m
[31m+                 "cpu": "2",[39m
[2m                  "memory": "2Gi",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 2,[39m
[31m+                 "cpu": "2",[39m
[2m                  "memory": "2Gi",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -500,20 +528,18 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "# Install faucet binary from the image[39m
[32m- cp /bin/faucet /faucet/faucet[39m
[32m- chmod +x /faucet/faucet",[39m
[31m+               "cp /bin/faucet /faucet/faucet && chmod +x /faucet/faucet",[39m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/faucet:20250325-2207109",[22m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "init-faucet",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 2,[39m
[31m+                 "cpu": "2",[39m
[2m                  "memory": "2Gi",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 2,[39m
[31m+                 "cpu": "2",[39m
[2m                  "memory": "2Gi",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -530,6 +556,7 @@[39m
[2m                "-c",[22m
[2m                "VAL_INDEX=\${HOSTNAME##*-}[22m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m
[31m+[39m
[2m  cp $CHAIN_DIR/cosmovisor/genesis/bin/$CHAIN_BIN /usr/bin[22m

[2m  if [ -f $CHAIN_DIR/config/genesis.json ]; then[22m
[33m@@ -639,11 +666,11 @@[39m
[2m              "name": "init-genesis",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 2,[39m
[31m+                 "cpu": "2",[39m
[2m                  "memory": "2Gi",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 2,[39m
[31m+                 "cpu": "2",[39m
[2m                  "memory": "2Gi",[22m
[2m                },[22m
[2m              },[22m

--- ConfigMap/setup-scripts-core-1 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -608,6 +608,17 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts-core-1",[39m
[31m+       "app.kubernetes.io/part-of": "core-1",[39m
[31m+       "app.kubernetes.io/role": "setup-scripts",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-id": "core-1",[39m
[31m+       "starship.io/chain-name": "persistencecore",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts-core-1",[22m
[2m    },[22m
[2m  }[22m

--- Service/core-1-validator ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -23,6 +23,12 @@[39m
[2m          "targetPort": 8081,[22m
[2m        },[22m
[2m        Object {[22m
[31m+         "name": "faucet",[39m
[31m+         "port": 8000,[39m
[31m+         "protocol": "TCP",[39m
[31m+         "targetPort": 8000,[39m
[31m+       },[39m
[31m+       Object {[39m
[2m          "name": "grpc",[22m
[2m          "port": 9090,[22m
[2m          "protocol": "TCP",[22m

--- StatefulSet/core-1-validator ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,18 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/id": "core-1",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "core-1-validator",[39m
[31m+       "app.kubernetes.io/part-of": "core-1",[39m
[31m+       "app.kubernetes.io/role": "validator",[39m
[31m+       "app.kubernetes.io/type": "core-1-statefulset",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-name": "persistencecore",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "core-1-validator",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -10,7 +22,7 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "persistencecore",[39m
[31m+         "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m          "app.kubernetes.io/name": "core-1-validator",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -24,10 +36,11 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "persistencecore",[39m
[31m+           "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m            "app.kubernetes.io/name": "core-1-validator",[22m
[31m+           "app.kubernetes.io/role": "validator",[39m
[2m            "app.kubernetes.io/type": "core-1",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[33m@@ -119,11 +132,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -144,8 +157,10 @@[39m
[2m                "-c",[22m
[2m                "set -eux[22m
[2m  START_ARGS=\\"\\"[22m
[31m+[39m

[2m  # Starting the chain[22m
[31m+[39m
[2m  cp $CHAIN_DIR/cosmovisor/genesis/bin/$CHAIN_BIN /usr/bin[22m
[2m  /usr/bin/cosmovisor start $START_ARGS",[22m
[2m              ],[22m
[33m@@ -256,11 +271,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 2,[39m
[31m+                 "cpu": "2",[39m
[2m                  "memory": "2Gi",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 2,[39m
[31m+                 "cpu": "2",[39m
[2m                  "memory": "2Gi",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -342,11 +357,11 @@[39m
[2m              "name": "init-build-images",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 2,[39m
[31m+                 "cpu": "2",[39m
[2m                  "memory": "2Gi",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 2,[39m
[31m+                 "cpu": "2",[39m
[2m                  "memory": "2Gi",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -437,7 +452,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "NAMESPACE",[22m
[33m@@ -485,11 +500,11 @@[39m
[2m              "name": "init-config",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 2,[39m
[31m+                 "cpu": "2",[39m
[2m                  "memory": "2Gi",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 2,[39m
[31m+                 "cpu": "2",[39m
[2m                  "memory": "2Gi",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -587,7 +602,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "NAMESPACE",[22m
[33m@@ -635,11 +650,11 @@[39m
[2m              "name": "init-validator",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 2,[39m
[31m+                 "cpu": "2",[39m
[2m                  "memory": "2Gi",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 2,[39m
[31m+                 "cpu": "2",[39m
[2m                  "memory": "2Gi",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -684,16 +699,16 @@[39m
[2m                  },[22m
[2m                },[22m
[2m              ],[22m
[32m-             "image": "curlimages/curl",[39m
[31m+             "image": "curlimages/curl:latest",[39m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "wait-for-chains",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -705,6 +720,10 @@[39m
[2m                "name": "keys",[22m
[2m              },[22m
[2m              "name": "addresses",[22m
[31m+           },[39m
[31m+           Object {[39m
[31m+             "emptyDir": Object {},[39m
[31m+             "name": "faucet",[39m
[2m            },[22m
[2m            Object {[22m
[2m              "emptyDir": Object {},[22m

--- ConfigMap/registry-core-1 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -78,6 +78,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "registry",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "registry-core-1",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "registry-core-1",[22m
[2m    },[22m
[2m  }[22m

--- ConfigMap/registry-cosmoshub-4 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -7,7 +7,14 @@[39m
[2m    \\"assets\\": [[22m
[2m      {[22m
[2m        \\"base\\": \\"uatom\\",[22m
[32m-       \\"coingecko_id\\": \\"atom\\",[39m
[31m+       \\"description\\": \\"The native staking and governance token of the Cosmos Hub.\\",[39m
[31m+       \\"name\\": \\"Cosmos Hub Atom\\",[39m
[31m+       \\"display\\": \\"atom\\",[39m
[31m+       \\"symbol\\": \\"ATOM\\",[39m
[31m+       \\"logo_URIs\\": {[39m
[31m+         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/cosmoshub/images/atom.png\\",[39m
[31m+         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/cosmoshub/images/atom.svg\\"[39m
[31m+       },[39m
[2m        \\"denom_units\\": [[22m
[2m          {[22m
[2m            \\"denom\\": \\"uatom\\",[22m
[33m@@ -18,14 +25,7 @@[39m
[2m            \\"exponent\\": 6[22m
[2m          }[22m
[2m        ],[22m
[32m-       \\"description\\": \\"The native staking and governance token of the Cosmos Hub.\\",[39m
[32m-       \\"display\\": \\"atom\\",[39m
[32m-       \\"logo_URIs\\": {[39m
[32m-         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/cosmoshub/images/atom.png\\",[39m
[32m-         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/cosmoshub/images/atom.svg\\"[39m
[32m-       },[39m
[32m-       \\"name\\": \\"Cosmos Hub Atom\\",[39m
[32m-       \\"symbol\\": \\"ATOM\\"[39m
[31m+       \\"coingecko_id\\": \\"atom\\"[39m
[2m      }[22m
[2m    ][22m
[2m  }",[22m
[33m@@ -82,6 +82,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "registry",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "registry-cosmoshub-4",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "registry-cosmoshub-4",[22m
[2m    },[22m
[2m  }[22m

--- Deployment/registry ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,14 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "Deployment",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "registry",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "registry",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "registry",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +17,6 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "registry",[39m
[2m          "app.kubernetes.io/name": "registry",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -22,19 +29,17 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "registry",[39m
[31m+           "app.kubernetes.io/component": "registry",[39m
[31m+           "app.kubernetes.io/managed-by": "starship",[39m
[2m            "app.kubernetes.io/name": "registry",[22m
[32m-           "app.kubernetes.io/rawname": "registry",[39m
[32m-           "app.kubernetes.io/type": "registry",[39m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/part-of": "starship",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+           "starship.io/name": "starship-e2e-tests",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[2m          "containers": Array [[22m
[2m            Object {[22m
[32m-             "command": Array [[39m
[32m-               "registry",[39m
[32m-             ],[39m
[2m              "env": Array [[22m
[2m                Object {[22m
[2m                  "name": "NAMESPACE",[22m
[33m@@ -74,21 +79,20 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "REGISTRY_CHAIN_REGISTRY",[22m
[32m-                 "value": "/configs",[39m
[31m+                 "value": "/chains",[39m
[2m                },[22m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/registry:20250205-544757d",[22m
[32m-             "imagePullPolicy": "IfNotPresent",[39m
[2m              "livenessProbe": Object {[22m
[32m-               "initialDelaySeconds": 20,[39m
[32m-               "periodSeconds": 10,[39m
[31m+               "initialDelaySeconds": 15,[39m
[31m+               "periodSeconds": 20,[39m
[2m                "tcpSocket": Object {[22m
[2m                  "port": 8080,[22m
[2m                },[22m
[2m              },[22m
[2m              "name": "registry",[22m
[2m              "readinessProbe": Object {[22m
[32m-               "initialDelaySeconds": 20,[39m
[31m+               "initialDelaySeconds": 5,[39m
[2m                "periodSeconds": 10,[22m
[2m                "tcpSocket": Object {[22m
[2m                  "port": 8080,[22m
[33m@@ -96,22 +100,22 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[2m                Object {[22m
[32m-                 "mountPath": "/configs/core-1",[39m
[32m-                 "name": "registry-configs-core-1",[39m
[31m+                 "mountPath": "/chains/core-1",[39m
[31m+                 "name": "registry-core-1",[39m
[2m                },[22m
[2m                Object {[22m
[32m-                 "mountPath": "/configs/cosmoshub-4",[39m
[32m-                 "name": "registry-configs-cosmoshub-4",[39m
[31m+                 "mountPath": "/chains/cosmoshub-4",[39m
[31m+                 "name": "registry-cosmoshub-4",[39m
[2m                },[22m
[2m              ],[22m
[2m            },[22m
[33m@@ -126,6 +130,7 @@[39m
[2m    echo \\"Checking: http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id\\"[22m
[2m    sleep 10;[22m
[2m  done[22m
[31m+[39m
[2m  while [ $(curl -sw '%{http_code}' http://core-1-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id -o /dev/null) -ne 200 ]; do[22m
[2m    echo \\"Genesis validator does not seem to be ready for: core-1. Waiting for it to start...\\"[22m
[2m    echo \\"Checking: http://core-1-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id\\"[22m
[33m@@ -148,16 +153,16 @@[39m
[2m                  },[22m
[2m                },[22m
[2m              ],[22m
[32m-             "image": "curlimages/curl",[39m
[31m+             "image": "curlimages/curl:latest",[39m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "wait-for-chains",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -168,13 +173,13 @@[39m
[2m              "configMap": Object {[22m
[2m                "name": "registry-core-1",[22m
[2m              },[22m
[32m-             "name": "registry-configs-core-1",[39m
[31m+             "name": "registry-core-1",[39m
[2m            },[22m
[2m            Object {[22m
[2m              "configMap": Object {[22m
[2m                "name": "registry-cosmoshub-4",[22m
[2m              },[22m
[32m-             "name": "registry-configs-cosmoshub-4",[39m
[31m+             "name": "registry-cosmoshub-4",[39m
[2m            },[22m
[2m          ],[22m
[2m        },[22m

--- ConfigMap/hermes-persistence-cosmos ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -3,92 +3,45 @@[39m
[2m    "data": Object {[22m
[2m      "config-cli.toml": "# The global section has parameters that apply globally to the relayer operation.[22m
[2m  [global][22m
[32m- # Specify the verbosity for the relayer logging output. Default: 'info'[39m
[32m- # Valid options are 'error', 'warn', 'info', 'debug', 'trace'.[39m
[32m- log_level = 'info'[39m
[32m- # Specify the mode to be used by the relayer. [Required][39m
[31m+ log_level = \\"info\\"[39m
[31m+[39m
[2m  [mode][22m
[32m- # Specify the client mode.[39m
[2m  [mode.clients][22m
[32m- # Whether or not to enable the client workers. [Required][39m
[2m  enabled = true[22m
[32m- # Whether or not to enable periodic refresh of clients. [Default: true][39m
[32m- # This feature only applies to clients that underlie an open channel.[39m
[32m- # For Tendermint clients, the frequency at which Hermes refreshes them is 2/3 of their[39m
[32m- # trusting period (e.g., refresh every ~9 days if the trusting period is 14 days).[39m
[32m- # Note: Even if this is disabled, clients will be refreshed automatically if[39m
[32m- #      there is activity on a connection or channel they are involved with.[39m
[2m  refresh = true[22m
[32m- # Whether or not to enable misbehaviour detection for clients. [Default: false][39m
[2m  misbehaviour = true[22m
[32m- # Specify the connections mode.[39m
[31m+[39m
[2m  [mode.connections][22m
[32m- # Whether or not to enable the connection workers for handshake completion. [Required][39m
[2m  enabled = true[22m
[32m- # Specify the channels mode.[39m
[31m+[39m
[2m  [mode.channels][22m
[32m- # Whether or not to enable the channel workers for handshake completion. [Required][39m
[2m  enabled = true[22m
[32m- # Specify the packets mode.[39m
[31m+[39m
[2m  [mode.packets][22m
[32m- # Whether or not to enable the packet workers. [Required][39m
[2m  enabled = true[22m
[32m- # Parametrize the periodic packet clearing feature.[39m
[32m- # Interval (in number of blocks) at which pending packets[39m
[32m- # should be periodically cleared. A value of '0' will disable[39m
[32m- # periodic packet clearing. [Default: 100][39m
[2m  clear_interval = 100[22m
[32m- # Whether or not to clear packets on start. [Default: false][39m
[2m  clear_on_start = true[22m
[32m- # Toggle the transaction confirmation mechanism.[39m
[32m- # The tx confirmation mechanism periodically queries the \`/tx_search\` RPC[39m
[32m- # endpoint to check that previously-submitted transactions[39m
[32m- # (to any chain in this config file) have been successfully delivered.[39m
[32m- # If they have not been, and \`clear_interval = 0\`, then those packets are[39m
[32m- # queued up for re-submission.[39m
[32m- # Experimental feature. Affects telemetry if set to false.[39m
[32m- # [Default: true][39m
[2m  tx_confirmation = true[22m
[32m- # Auto register the counterparty payee on a destination chain to[39m
[32m- # the relayer's address on the source chain. This can be used[39m
[32m- # for simple configuration of the relayer to receive fees for[39m
[32m- # relaying RecvPacket on fee-enabled channels.[39m
[32m- # For more complex configuration, turn this off and use the CLI[39m
[32m- # to manually register the payee addresses.[39m
[32m- # [Default: false][39m
[32m- auto_register_counterparty_payee = false[39m
[32m- # The REST section defines parameters for Hermes' built-in RESTful API.[39m
[32m- # https://hermes.informal.systems/rest.html[39m
[31m+[39m
[2m  [rest][22m
[32m- # Whether or not to enable the REST service. Default: false[39m
[2m  enabled = true[22m
[32m- # Specify the IPv4/6 host over which the built-in HTTP server will serve the RESTful[39m
[32m- # API requests. Default: 127.0.0.1[39m
[32m- host =  '0.0.0.0'[39m
[32m- # Specify the port over which the built-in HTTP server will serve the restful API[39m
[32m- # requests. Default: 3000[39m
[31m+ host = \\"0.0.0.0\\"[39m
[2m  port = 3000[22m
[32m- # The telemetry section defines parameters for Hermes' built-in telemetry capabilities.[39m
[32m- # https://hermes.informal.systems/telemetry.html[39m
[31m+[39m
[2m  [telemetry][22m
[32m- # Whether or not to enable the telemetry service. Default: false[39m
[2m  enabled = true[22m
[32m- # Specify the IPv4/6 host over which the built-in HTTP server will serve the metrics[39m
[32m- # gathered by the telemetry service. Default: 127.0.0.1[39m
[32m- host = '0.0.0.0'[39m
[32m- # Specify the port over which the built-in HTTP server will serve the metrics gathered[39m
[32m- # by the telemetry service. Default: 3001[39m
[31m+ host = \\"0.0.0.0\\"[39m
[2m  port = 3001[22m
[32m-[39m


[2m  [[chains]][22m
[2m  id = \\"core-1\\"[22m
[31m+ type = \\"CosmosSdk\\"[39m
[2m  key_name = \\"core-1-cli\\"[22m
[32m- rpc_addr = \\"http://core-1-genesis.default.svc.cluster.local:26657\\"[39m
[32m- grpc_addr = \\"http://core-1-genesis.default.svc.cluster.local:9090\\"[39m
[32m- event_source = { mode = 'push', url = \\"ws://core-1-genesis.default.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[32m- # Experimental: Whether or not the full node is trusted.[39m
[31m+[39m
[31m+ rpc_addr = \\"http://core-1-genesis.$NAMESPACE.svc.cluster.local:26657\\"[39m
[31m+ grpc_addr = \\"http://core-1-genesis.$NAMESPACE.svc.cluster.local:9090\\"[39m
[31m+ event_source = { mode = 'push', url = \\"ws://core-1-genesis.$NAMESPACE.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[2m  trusted_node = false[22m
[2m  account_prefix = \\"persistence\\"[22m
[2m  default_gas = 500000000[22m
[33m@@ -103,17 +56,16 @@[39m
[2m  trusting_period = \\"75s\\"[22m
[2m  trust_threshold = { numerator = \\"2\\", denominator = \\"3\\" }[22m
[2m  address_type = { derivation = 'cosmos' }[22m
[32m- gas_price = { price = 0.25, denom = \\"uxprt\\" }[39m
[32m-[39m
[32m-[39m
[31m+ gas_price = { price = 1.25, denom = \\"uxprt\\" }[39m

[2m  [[chains]][22m
[2m  id = \\"cosmoshub-4\\"[22m
[31m+ type = \\"CosmosSdk\\"[39m
[2m  key_name = \\"cosmoshub-4-cli\\"[22m
[32m- rpc_addr = \\"http://cosmoshub-4-genesis.default.svc.cluster.local:26657\\"[39m
[32m- grpc_addr = \\"http://cosmoshub-4-genesis.default.svc.cluster.local:9090\\"[39m
[32m- event_source = { mode = 'push', url = \\"ws://cosmoshub-4-genesis.default.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[32m- # Experimental: Whether or not the full node is trusted.[39m
[31m+[39m
[31m+ rpc_addr = \\"http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:26657\\"[39m
[31m+ grpc_addr = \\"http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:9090\\"[39m
[31m+ event_source = { mode = 'push', url = \\"ws://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[2m  trusted_node = false[22m
[2m  account_prefix = \\"cosmos\\"[22m
[2m  default_gas = 500000000[22m
[33m@@ -128,96 +80,48 @@[39m
[2m  trusting_period = \\"75s\\"[22m
[2m  trust_threshold = { numerator = \\"2\\", denominator = \\"3\\" }[22m
[2m  address_type = { derivation = 'cosmos' }[22m
[32m- gas_price = { price = 0.25, denom = \\"uatom\\" }",[39m
[31m+ gas_price = { price = 1.25, denom = \\"uatom\\" }",[39m
[2m      "config.toml": "# The global section has parameters that apply globally to the relayer operation.[22m
[2m  [global][22m
[32m- # Specify the verbosity for the relayer logging output. Default: 'info'[39m
[32m- # Valid options are 'error', 'warn', 'info', 'debug', 'trace'.[39m
[32m- log_level = 'info'[39m
[32m- # Specify the mode to be used by the relayer. [Required][39m
[31m+ log_level = \\"info\\"[39m
[31m+[39m
[2m  [mode][22m
[32m- # Specify the client mode.[39m
[2m  [mode.clients][22m
[32m- # Whether or not to enable the client workers. [Required][39m
[2m  enabled = true[22m
[32m- # Whether or not to enable periodic refresh of clients. [Default: true][39m
[32m- # This feature only applies to clients that underlie an open channel.[39m
[32m- # For Tendermint clients, the frequency at which Hermes refreshes them is 2/3 of their[39m
[32m- # trusting period (e.g., refresh every ~9 days if the trusting period is 14 days).[39m
[32m- # Note: Even if this is disabled, clients will be refreshed automatically if[39m
[32m- #      there is activity on a connection or channel they are involved with.[39m
[2m  refresh = true[22m
[32m- # Whether or not to enable misbehaviour detection for clients. [Default: false][39m
[2m  misbehaviour = true[22m
[32m- # Specify the connections mode.[39m
[31m+[39m
[2m  [mode.connections][22m
[32m- # Whether or not to enable the connection workers for handshake completion. [Required][39m
[2m  enabled = true[22m
[32m- # Specify the channels mode.[39m
[31m+[39m
[2m  [mode.channels][22m
[32m- # Whether or not to enable the channel workers for handshake completion. [Required][39m
[2m  enabled = true[22m
[32m- # Specify the packets mode.[39m
[31m+[39m
[2m  [mode.packets][22m
[32m- # Whether or not to enable the packet workers. [Required][39m
[2m  enabled = true[22m
[32m- # Parametrize the periodic packet clearing feature.[39m
[32m- # Interval (in number of blocks) at which pending packets[39m
[32m- # should be periodically cleared. A value of '0' will disable[39m
[32m- # periodic packet clearing. [Default: 100][39m
[2m  clear_interval = 100[22m
[32m- # Whether or not to clear packets on start. [Default: false][39m
[2m  clear_on_start = true[22m
[32m- # Toggle the transaction confirmation mechanism.[39m
[32m- # The tx confirmation mechanism periodically queries the \`/tx_search\` RPC[39m
[32m- # endpoint to check that previously-submitted transactions[39m
[32m- # (to any chain in this config file) have been successfully delivered.[39m
[32m- # If they have not been, and \`clear_interval = 0\`, then those packets are[39m
[32m- # queued up for re-submission.[39m
[32m- # Experimental feature. Affects telemetry if set to false.[39m
[32m- # [Default: true][39m
[2m  tx_confirmation = true[22m
[32m- # Auto register the counterparty payee on a destination chain to[39m
[32m- # the relayer's address on the source chain. This can be used[39m
[32m- # for simple configuration of the relayer to receive fees for[39m
[32m- # relaying RecvPacket on fee-enabled channels.[39m
[32m- # For more complex configuration, turn this off and use the CLI[39m
[32m- # to manually register the payee addresses.[39m
[32m- # [Default: false][39m
[32m- auto_register_counterparty_payee = false[39m
[32m- # The REST section defines parameters for Hermes' built-in RESTful API.[39m
[32m- # https://hermes.informal.systems/rest.html[39m
[31m+[39m
[2m  [rest][22m
[32m- # Whether or not to enable the REST service. Default: false[39m
[2m  enabled = true[22m
[32m- # Specify the IPv4/6 host over which the built-in HTTP server will serve the RESTful[39m
[32m- # API requests. Default: 127.0.0.1[39m
[32m- host =  '0.0.0.0'[39m
[32m- # Specify the port over which the built-in HTTP server will serve the restful API[39m
[32m- # requests. Default: 3000[39m
[31m+ host = \\"0.0.0.0\\"[39m
[2m  port = 3000[22m
[32m- # The telemetry section defines parameters for Hermes' built-in telemetry capabilities.[39m
[32m- # https://hermes.informal.systems/telemetry.html[39m
[31m+[39m
[2m  [telemetry][22m
[32m- # Whether or not to enable the telemetry service. Default: false[39m
[2m  enabled = true[22m
[32m- # Specify the IPv4/6 host over which the built-in HTTP server will serve the metrics[39m
[32m- # gathered by the telemetry service. Default: 127.0.0.1[39m
[32m- host = '0.0.0.0'[39m
[32m- # Specify the port over which the built-in HTTP server will serve the metrics gathered[39m
[32m- # by the telemetry service. Default: 3001[39m
[31m+ host = \\"0.0.0.0\\"[39m
[2m  port = 3001[22m
[32m-[39m


[2m  [[chains]][22m
[2m  id = \\"core-1\\"[22m
[2m  type = \\"CosmosSdk\\"[22m
[2m  key_name = \\"core-1\\"[22m
[32m- rpc_addr = \\"http://core-1-genesis.default.svc.cluster.local:26657\\"[39m
[32m- grpc_addr = \\"http://core-1-genesis.default.svc.cluster.local:9090\\"[39m
[32m- event_source = { mode = 'push', url = \\"ws://core-1-genesis.default.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[32m- # Experimental: Whether or not the full node is trusted.[39m
[31m+[39m
[31m+ rpc_addr = \\"http://core-1-genesis.$NAMESPACE.svc.cluster.local:26657\\"[39m
[31m+ grpc_addr = \\"http://core-1-genesis.$NAMESPACE.svc.cluster.local:9090\\"[39m
[31m+ event_source = { mode = 'push', url = \\"ws://core-1-genesis.$NAMESPACE.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[2m  trusted_node = false[22m
[2m  account_prefix = \\"persistence\\"[22m
[2m  default_gas = 500000000[22m
[33m@@ -233,17 +137,15 @@[39m
[2m  trust_threshold = { numerator = \\"2\\", denominator = \\"3\\" }[22m
[2m  address_type = { derivation = 'cosmos' }[22m
[2m  gas_price = { price = 1.25, denom = \\"uxprt\\" }[22m
[32m-[39m
[32m-[39m

[2m  [[chains]][22m
[2m  id = \\"cosmoshub-4\\"[22m
[2m  type = \\"CosmosSdk\\"[22m
[2m  key_name = \\"cosmoshub-4\\"[22m
[32m- rpc_addr = \\"http://cosmoshub-4-genesis.default.svc.cluster.local:26657\\"[39m
[32m- grpc_addr = \\"http://cosmoshub-4-genesis.default.svc.cluster.local:9090\\"[39m
[32m- event_source = { mode = 'push', url = \\"ws://cosmoshub-4-genesis.default.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[32m- # Experimental: Whether or not the full node is trusted.[39m
[31m+[39m
[31m+ rpc_addr = \\"http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:26657\\"[39m
[31m+ grpc_addr = \\"http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:9090\\"[39m
[31m+ event_source = { mode = 'push', url = \\"ws://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[2m  trusted_node = false[22m
[2m  account_prefix = \\"cosmos\\"[22m
[2m  default_gas = 500000000[22m
[33m@@ -262,6 +164,15 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "relayer",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "hermes-persistence-cosmos",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/role": "hermes",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "hermes-persistence-cosmos",[22m
[2m    },[22m
[2m  }[22m

--- StatefulSet/hermes-persistence-cosmos ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,15 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "relayer",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "hermes-persistence-cosmos",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/role": "hermes",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "hermes-persistence-cosmos",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -29,16 +38,18 @@[39m
[2m            "app.kubernetes.io/name": "hermes-persistence-cosmos",[22m
[2m            "app.kubernetes.io/rawname": "persistence-cosmos",[22m
[2m            "app.kubernetes.io/type": "hermes",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[2m          "containers": Array [[22m
[2m            Object {[22m
[31m+             "args": Array [[39m
[31m+               "/exposer/exposer",[39m
[31m+             ],[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "/exposer/exposer",[39m
[2m              ],[22m
[2m              "env": Array [[22m
[2m                Object {[22m
[33m@@ -55,11 +66,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -83,14 +94,24 @@[39m
[2m              ],[22m
[2m            },[22m
[2m            Object {[22m
[31m+             "args": Array [[39m
[31m+               "RLY_INDEX=\${HOSTNAME##*-}[39m
[31m+ echo \\"Relayer Index: $RLY_INDEX\\"[39m
[31m+ hermes start",[39m
[31m+             ],[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "RLY_INDEX=\${HOSTNAME##*-}[39m
[32m- echo \\"Relayer Index: $RLY_INDEX\\"[39m
[32m- hermes start",[39m
[2m              ],[22m
[2m              "env": Array [[22m
[31m+               Object {[39m
[31m+                 "name": "NAMESPACE",[39m
[31m+                 "valueFrom": Object {[39m
[31m+                   "fieldRef": Object {[39m
[31m+                     "fieldPath": "metadata.namespace",[39m
[31m+                   },[39m
[31m+                 },[39m
[31m+               },[39m
[2m                Object {[22m
[2m                  "name": "RELAYER_DIR",[22m
[2m                  "value": "/root/.hermes",[22m
[33m@@ -101,12 +122,12 @@[39m
[2m              "name": "relayer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[2m              },[22m
[2m              "securityContext": Object {[22m
[33m@@ -127,24 +148,26 @@[39m
[2m          ],[22m
[2m          "initContainers": Array [[22m
[2m            Object {[22m
[31m+             "args": Array [[39m
[31m+               "# Install exposer binary from the image[39m
[31m+ cp /bin/exposer /exposer/exposer[39m
[31m+ chmod +x /exposer/exposer",[39m
[31m+             ],[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "# Install exposer binary from the image[39m
[32m- cp /bin/exposer /exposer/exposer[39m
[32m- chmod +x /exposer/exposer",[39m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/exposer:20250205-544757d",[22m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "init-exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "100M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "100M",[39m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[33m@@ -155,9 +178,7 @@[39m
[2m              ],[22m
[2m            },[22m
[2m            Object {[22m
[32m-             "command": Array [[39m
[32m-               "bash",[39m
[32m-               "-c",[39m
[31m+             "args": Array [[39m
[2m                "set -ux[22m

[2m  RLY_INDEX=\${HOSTNAME##*-}[22m
[33m@@ -166,18 +187,16 @@[39m
[2m  mkdir -p $RELAYER_DIR[22m
[2m  cp /configs/config.toml $RELAYER_DIR/config.toml[22m
[2m  cp /configs/config-cli.toml $RELAYER_DIR/config-cli.toml[22m
[32m- cat $RELAYER_DIR/config.toml[39m
[31m+[39m
[31m+ # Replace namespace placeholder with actual namespace environment variable[39m
[31m+ sed -i \\"s|\\\\$NAMESPACE|$NAMESPACE|g\\" $RELAYER_DIR/config.toml[39m
[31m+ sed -i \\"s|\\\\$NAMESPACE|$NAMESPACE|g\\" $RELAYER_DIR/config-cli.toml[39m

[32m- MNEMONIC=$(jq -r \\".relayers[$RELAYER_INDEX].mnemonic\\" $KEYS_CONFIG)[39m
[31m+ MNEMONIC=$(jq -r \\".relayers[$RLY_INDEX].mnemonic\\" $KEYS_CONFIG)[39m
[2m  echo $MNEMONIC > $RELAYER_DIR/mnemonic.txt[22m
[32m- MNEMONIC_CLI=$(jq -r \\".relayers_cli[$RELAYER_INDEX].mnemonic\\" $KEYS_CONFIG)[39m
[31m+ MNEMONIC_CLI=$(jq -r \\".relayers_cli[$RLY_INDEX].mnemonic\\" $KEYS_CONFIG)[39m
[2m  echo $MNEMONIC_CLI > $RELAYER_DIR/mnemonic-cli.txt[22m

[32m- echo \\"Debug output for persistence-cosmos...\\"[39m
[32m- cat << EOF[39m
[32m-               map[string]interface {}[39m
[32m-               {\\"chains\\":[\\"core-1\\",\\"cosmoshub-4\\"],\\"channels\\":[{\\"a-chain\\":\\"core-1\\",\\"a-port\\":\\"transfer\\",\\"b-chain\\":\\"cosmoshub-4\\",\\"b-port\\":\\"transfer\\",\\"new-connection\\":true}],\\"config\\":{\\"event_source\\":{\\"mode\\":\\"push\\"},\\"global\\":{\\"log_level\\":\\"info\\"},\\"mode\\":{\\"channels\\":{\\"enabled\\":true},\\"clients\\":{\\"enabled\\":true,\\"misbehaviour\\":true,\\"refresh\\":true},\\"connections\\":{\\"enabled\\":true},\\"packets\\":{\\"clear_interval\\":100,\\"clear_on_start\\":true,\\"enabled\\":true,\\"tx_confirmation\\":true}},\\"rest\\":{\\"enabled\\":true,\\"host\\":\\"0.0.0.0\\",\\"port\\":3000},\\"telemetry\\":{\\"enabled\\":true,\\"host\\":\\"0.0.0.0\\",\\"port\\":3001}},\\"fullname\\":\\"hermes-persistence-cosmos\\",\\"ics\\":{\\"enabled\\":false},\\"image\\":\\"ghcr.io/cosmology-tech/starship/hermes:1.10.0\\",\\"name\\":\\"persistence-cosmos\\",\\"replicas\\":1,\\"type\\":\\"hermes\\"}[39m
[32m- EOF[39m

[2m  echo \\"Creating key for core-1...\\"[22m
[2m  hermes keys add \\\\[22m
[33m@@ -240,12 +259,17 @@[39m
[2m    $DENOM \\\\[22m
[2m    http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:8000/credit \\\\[22m
[2m    \\"true\\" || true[22m
[31m+[39m
[2m  hermes create channel \\\\[22m
[2m    --new-client-connection --yes \\\\[22m
[2m    --b-chain cosmoshub-4 \\\\[22m
[2m    --a-chain core-1 \\\\[22m
[2m    --a-port transfer \\\\[22m
[2m    --b-port transfer",[22m
[31m+             ],[39m
[31m+             "command": Array [[39m
[31m+               "bash",[39m
[31m+               "-c",[39m
[2m              ],[22m
[2m              "env": Array [[22m
[2m                Object {[22m
[33m@@ -266,7 +290,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "RELAYER_INDEX",[22m
[32m-                 "value": "0",[39m
[31m+                 "value": "\${HOSTNAME##*-}",[39m
[2m                },[22m
[2m              ],[22m
[2m              "image": "ghcr.io/cosmology-tech/starship/hermes:1.10.0",[22m
[33m@@ -274,12 +298,12 @@[39m
[2m              "name": "init-relayer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[33m@@ -310,6 +334,7 @@[39m
[2m    echo \\"Checking: http://core-1-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id\\"[22m
[2m    sleep 10;[22m
[2m  done[22m
[31m+[39m
[2m  while [ $(curl -sw '%{http_code}' http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id -o /dev/null) -ne 200 ]; do[22m
[2m    echo \\"Genesis validator does not seem to be ready for: cosmoshub-4. Waiting for it to start...\\"[22m
[2m    echo \\"Checking: http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id\\"[22m
[33m@@ -332,16 +357,16 @@[39m
[2m                  },[22m
[2m                },[22m
[2m              ],[22m
[32m-             "image": "curlimages/curl",[39m
[31m+             "image": "curlimages/curl:latest",[39m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "wait-for-chains",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m"
`;

exports[`Manifest Comparison Tests Individual Config Comparisons should generate manifests for eth that match the snapshot 1`] = `
"ðŸ”„ MODIFIED_RESOURCES:

--- ConfigMap/config-ethereum ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -61,7 +61,7 @@[39m
[2m        \\"balance\\": \\"0x3635c9adc5dea00000\\"[22m
[2m      },[22m
[2m      \\"0x4242424242424242424242424242424242424242\\": {[22m
[32m-       \\"code\\": \\"0x60806040526004361061003f5760003560e01c806301ffc9a71461004457806322895118146100b6578063621fd130146101e3578063c5f2892f14610273575b600080fd5b34801561005057600080fd5b5061009c6004803603602081101561006757600080fd5b8101908080357bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916906020019092919050505061029e565b604051808215151515815260200191505060405180910390f35b6101e1600480360360808110156100cc57600080fd5b81019080803590602001906401000000008111156100e957600080fd5b8201836020820111156100fb57600080fd5b8035906020019184600183028401116401000000008311171561011d57600080fd5b90919293919293908035906020019064010000000081111561013e57600080fd5b82018360208201111561015057600080fd5b8035906020019184600183028401116401000000008311171561017257600080fd5b90919293919293908035906020019064010000000081111561019357600080fd5b8201836020820111156101a557600080fd5b803590602001918460018302840111640100000000831117156101c757600080fd5b909192939192939080359060200190929190505050610370565b005b3480156101ef57600080fd5b506101f8610fd0565b6040518080602001828103825283818151815260200191508051906020019080838360005b8381101561023857808201518184015260208101905061021d565b50505050905090810190601f1680156102655780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b34801561027f57600080fd5b50610288610fe2565b6040518082815260200191505060405180910390f35b60007f01ffc9a7000000000000000000000000000000000000000000000000000000007bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916827bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916148061036957507f85640907000000000000000000000000000000000000000000000000000000007bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916827bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916145b9050919050565b603087879050146103cc576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260268152602001806116ec6026913960400191505060405180910390fd5b60208585905014610428576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260368152602001806116836036913960400191505060405180910390fd5b60608383905014610484576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252602981526020018061175f6029913960400191505060405180910390fd5b670de0b6b3a76400003410156104e5576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260268152602001806117396026913960400191505060405180910390fd5b6000633b9aca0034816104f457fe5b061461054b576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260338152602001806116b96033913960400191505060405180910390fd5b6000633b9aca00348161055a57fe5b04905067ffffffffffffffff80168111156105c0576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260278152602001806117126027913960400191505060405180910390fd5b60606105cb82611314565b90507f649bbc62d0e31342afea4e5cd82d4049e7e1ee912fc0889aa790803be39038c589898989858a8a610600602054611314565b60405180806020018060200180602001806020018060200186810386528e8e82818152602001925080828437600081840152601f19601f82011690508083019250505086810385528c8c82818152602001925080828437600081840152601f19601f82011690508083019250505086810384528a818151815260200191508051906020019080838360005b838110156106a657808201518184015260208101905061068b565b50505050905090810190601f1680156106d35780820380516001836020036101000a031916815260200191505b508681038352898982818152602001925080828437600081840152601f19601f820116905080830192505050868103825287818151815260200191508051906020019080838360005b8381101561073757808201518184015260208101905061071c565b50505050905090810190601f1680156107645780820380516001836020036101000a031916815260200191505b509d505050505050505050505050505060405180910390a1600060028a8a600060801b6040516020018084848082843780830192505050826fffffffffffffffffffffffffffffffff19166fffffffffffffffffffffffffffffffff1916815260100193505050506040516020818303038152906040526040518082805190602001908083835b6020831061080e57805182526020820191506020810190506020830392506107eb565b6001836020036101000a038019825116818451168082178552505050505050905001915050602060405180830381855afa158015610850573d6000803e3d6000fd5b5050506040513d602081101561086557600080fd5b8101908080519060200190929190505050905060006002808888600090604092610891939291906115da565b6040516020018083838082843780830192505050925050506040516020818303038152906040526040518082805190602001908083835b602083106108eb57805182526020820191506020810190506020830392506108c8565b6001836020036101000a038019825116818451168082178552505050505050905001915050602060405180830381855afa15801561092d573d6000803e3d6000fd5b5050506040513d602081101561094257600080fd5b8101908080519060200190929190505050600289896040908092610968939291906115da565b6000801b604051602001808484808284378083019250505082815260200193505050506040516020818303038152906040526040518082805190602001908083835b602083106109cd57805182526020820191506020810190506020830392506109aa565b6001836020036101000a038019825116818451168082178552505050505050905001915050602060405180830381855afa158015610a0f573d6000803e3d6000fd5b5050506040513d6020811015610a2457600080fd5b810190808051906020019092919050505060405160200180838152602001828152602001925050506040516020818303038152906040526040518082805190602001908083835b60208310610a8e5780518252602082019150602081019050602083039250610a6b565b6001836020036101000a038019825116818451168082178552505050505050905001915050602060405180830381855afa158015610ad0573d6000803e3d6000fd5b5050506040513d6020811015610ae557600080fd5b810190808051906020019092919050505090506000600280848c8c604051602001808481526020018383808284378083019250505093505050506040516020818303038152906040526040518082805190602001908083835b60208310610b615780518252602082019150602081019050602083039250610b3e565b6001836020036101000a038019825116818451168082178552505050505050905001915050602060405180830381855afa158015610ba3573d6000803e3d6000fd5b5050506040513d6020811015610bb857600080fd5b8101908080519060200190929190505050600286600060401b866040516020018084805190602001908083835b60208310610c085780518252602082019150602081019050602083039250610be5565b6001836020036101000a0380198251168184511680821785525050505050509050018367ffffffffffffffff191667ffffffffffffffff1916815260180182815260200193505050506040516020818303038152906040526040518082805190602001908083835b60208310610c935780518252602082019150602081019050602083039250610c70565b6001836020036101000a038019825116818451168082178552505050505050905001915050602060405180830381855afa158015610cd5573d6000803e3d6000fd5b5050506040513d6020811015610cea57600080fd5b810190808051906020019092919050505060405160200180838152602001828152602001925050506040516020818303038152906040526040518082805190602001908083835b60208310610d545780518252602082019150602081019050602083039250610d31565b6001836020036101000a038019825116818451168082178552505050505050905001915050602060405180830381855afa158015610d96573d6000803e3d6000fd5b5050506040513d6020811015610dab57600080fd5b81019080805190602001909291905050509050858114610e16576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252605481526020018061162f6054913960600191505060405180910390fd5b6001602060020a0360205410610e77576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252602181526020018061160e6021913960400191505060405180910390fd5b60016020600082825401925050819055506000602054905060008090505b6020811015610fb75760018083161415610ec8578260008260208110610eb757fe5b018190555050505050505050610fc7565b600260008260208110610ed757fe5b01548460405160200180838152602001828152602001925050506040516020818303038152906040526040518082805190602001908083835b60208310610f335780518252602082019150602081019050602083039250610f10565b6001836020036101000a038019825116818451168082178552505050505050905001915050602060405180830381855afa158015610f75573d6000803e3d6000fd5b5050506040513d6020811015610f8a57600080fd5b8101908080519060200190929190505050925060028281610fa757fe5b0491508080600101915050610e95565b506000610fc057fe5b5050505050505b50505050505050565b6060610fdd602054611314565b905090565b6000806000602054905060008090505b60208110156111d057600180831614156110e05760026000826020811061101557fe5b01548460405160200180838152602001828152602001925050506040516020818303038152906040526040518082805190602001908083835b60208310611071578051825260208201915060208101905060208303925061104e565b6001836020036101000a038019825116818451168082178552505050505050905001915050602060405180830381855afa1580156110b3573d6000803e3d6000fd5b5050506040513d60208110156110c857600080fd5b810190808051906020019092919050505092506111b6565b600283602183602081106110f057fe5b015460405160200180838152602001828152602001925050506040516020818303038152906040526040518082805190602001908083835b6020831061114b5780518252602082019150602081019050602083039250611128565b6001836020036101000a038019825116818451168082178552505050505050905001915050602060405180830381855afa15801561118d573d6000803e3d6000fd5b5050506040513d60208110156111a257600080fd5b810190808051906020019092919050505092505b600282816111c057fe5b0491508080600101915050610ff2565b506002826111df602054611314565b600060401b6040516020018084815260200183805190602001908083835b6020831061122057805182526020820191506020810190506020830392506111fd565b6001836020036101000a0380198251168184511680821785525050505050509050018267ffffffffffffffff191667ffffffffffffffff1916815260180193505050506040516020818303038152906040526040518082805190602001908083835b602083106112a55780518252602082019150602081019050602083039250611282565b6001836020036101000a038019825116818451168082178552505050505050905001915050602060405180830381855afa1580156112e7573d6000803e3d6000fd5b5050506040513d60208110156112fc57600080fd5b81019080805190602001909291905050509250505090565b6060600867ffffffffffffffff8111801561132e57600080fd5b506040519080825280601f01601f1916602001820160405280156113615781602001600182028036833780820191505090505b50905060008260c01b90508060076008811061137957fe5b1a60f81b8260008151811061138a57fe5b60200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916908160001a905350806006600881106113c657fe5b1a60f81b826001815181106113d757fe5b60200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916908160001a9053508060056008811061141357fe5b1a60f81b8260028151811061142457fe5b60200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916908160001a9053508060046008811061146057fe5b1a60f81b8260038151811061147157fe5b60200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916908160001a905350806003600881106114ad57fe5b1a60f81b826004815181106114be57fe5b60200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916908160001a905350806002600881106114fa57fe5b1a60f81b8260058151811061150b57fe5b60200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916908160001a9053508060016008811061154757fe5b1a60f81b8260068151811061155857fe5b60200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916908160001a9053508060006008811061159457fe5b1a60f81b826007815181106115a557fe5b60200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916908160001a90535050919050565b600080858511156115ea57600080fd5b838611156115f757600080fd5b600185028301915084860390509450949250505056fe4465706f736974436f6e74726163743a206d65726b6c6520747265652066756c6c4465706f736974436f6e74726163743a207265636f6e7374727563746564204465706f7369744461746120646f6573206e6f74206d6174636820737570706c696564206465706f7369745f646174615f726f6f744465706f736974436f6e74726163743a20696e76616c6964207769746864726177616c5f63726564656e7469616c73206c656e6774684465706f736974436f6e74726163743a206465706f7369742076616c7565206e6f74206d756c7469706c65206f6620677765694465706f736974436f6e74726163743a20696e76616c6964207075626b6579206c656e6774684465706f736974436f6e74726163743a206465706f7369742076616c756520746f6f20686967684465706f736974436f6e74726163743a206465706f7369742076616c756520746f6f206c6f774465706f736974436f6e74726163743a20696e76616c6964207369676e6174757265206c656e677468a2646970667358221220230afd4b6e3551329e50f1239e08fa3ab7907b77403c4f237d9adf679e8e43cf64736f6c634300060b0033\\",[39m
[31m+       \\"code\\": \\"0x60806040526004361061003f5760003560e01c806301ffc9a71461004457806322895118146100b6578063621fd130146101e3578063c5f2892f14610273575b600080fd5b34801561005057600080fd5b5061009c6004803603602081101561006757600080fd5b8101908080357bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916906020019092919050505061029e565b604051808215151515815260200191505060405180910390f35b6101e1600480360360808110156100cc57600080fd5b81019080803590602001906401000000008111156100e957600080fd5b8201836020820111156100fb57600080fd5b8035906020019184600183028401116401000000008311171561011d57600080fd5b90919293919293908035906020019064010000000081111561013e57600080fd5b82018360208201111561015057600080fd5b8035906020019184600183028401116401000000008311171561017257600080fd5b90919293919293908035906020019064010000000081111561019357600080fd5b8201836020820111156101a557600080fd5b803590602001918460018302840111640100000000831117156101c757600080fd5b909192939192939080359060200190929190505050610370565b005b3480156101ef57600080fd5b506101f8610fd0565b6040518080602001828103825283818151815260200191508051906020019080838360005b8381101561023857808201518184015260208101905061021d565b50505050905090810190601f1680156102655780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b34801561027f57600080fd5b50610288610fe2565b6040518082815260200191505060405180910390f35b60007f01ffc9a7000000000000000000000000000000000000000000000000000000007bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916827bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916148061036957507f85640907000000000000000000000000000000000000000000000000000000007bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916827bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916145b9050919050565b603087879050146103cc576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260268152602001806116ec6026913960400191505060405180910390fd5b60208585905014610428576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260368152602001806116836036913960400191505060405180910390fd5b60608383905014610484576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252602981526020018061175f6029913960400191505060405180910390fd5b670de0b6b3a76400003410156104e5576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260268152602001806117396026913960400191505060405180910390fd5b6000633b9aca0034816104f457fe5b061461054b576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260338152602001806116b96033913960400191505060405180910390fd5b6000633b9aca00348161055a57fe5b04905067ffffffffffffffff80168111156105c0576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260278152602001806117126027913960400191505060405180910390fd5b60606105cb82611314565b90507f649bbc62d0e31342afea4e5cd82d4049e7e1ee912fc0889aa790803be39038c589898989858a8a610600602054611314565b60405180806020018060200180602001806020018060200186810386528e8e82818152602001925080828437600081840152601f19601f82011690508083019250505086810385528c8c82818152602001925080828437600081840152601f19601f82011690508083019250505086810384528a818151815260200191508051906020019080838360005b838110156106a657808201518184015260208101905061068b565b50505050905090810190601f1680156106d35780820380516001836020036101000a031916815260200191505b508681038352898982818152602001925080828437600081840152601f19601f820116905080830192505050868103825287818151815260200191508051906020019080838360005b8381101561073757808201518184015260208101905061071c565b50505050905090810190601f1680156107645780820380516001836020036101000a031916815260200191505b509d505050505050505050505050505060405180910390a1600060028a8a600060801b6040516020018084848082843780830192505050826fffffffffffffffffffffffffffffffff19166fffffffffffffffffffffffffffffffff1916815260100193505050506040516020818303038152906040526040518082805190602001908083835b6020831061080e57805182526020820191506020810190506020830392506107eb565b6001836020036101000a038019825116818451168082178552505050505050905001915050602060405180830381855afa158015610850573d6000803e3d6000fd5b5050506040513d602081101561086557600080fd5b8101908080519060200190929190505050905060006002808888600090604092610891939291906115da565b6040516020018083838082843780830192505050925050506040516020818303038152906040526040518082805190602001908083835b602083106108eb57805182526020820191506020810190506020830392506108c8565b6001836020036101000a038019825116818451168082178552505050505050905001915050602060405180830381855afa15801561092d573d6000803e3d6000fd5b5050506040513d602081101561094257600080fd5b8101908080519060200190929190505050600289896040908092610968939291906115da565b6000801b604051602001808484808284378083019250505082815260200193505050506040516020818303038152906040526040518082805190602001908083835b602083106109cd57805182526020820191506020810190506020830392506109aa565b6001836020036101000a038019825116818451168082178552505050505050905001915050602060405180830381855afa158015610a0f573d6000803e3d6000fd5b5050506040513d6020811015610a2457600080fd5b810190808051906020019092919050505060405160200180838152602001828152602001925050506040516020818303038152906040526040518082805190602001908083835b60208310610a8e5780518252602082019150602081019050602083039250610a6b565b6001836020036101000a038019825116818451168082178552505050505050905001915050602060405180830381855afa158015610ad0573d6000803e3d6000fd5b5050506040513d6020811015610ae557600080fd5b810190808051906020019092919050505090506000600280848c8c604051602001808481526020018383808284378083019250505093505050506040516020818303038152906040526040518082805190602001908083835b60208310610b615780518252602082019150602081019050602083039250610b3e565b6001836020036101000a038019825116818451168082178552505050505050905001915050602060405180830381855afa158015610ba3573d6000803e3d6000fd5b5050506040513d6020811015610bb857600080fd5b8101908080519060200190929190505050600286600060401b866040516020018084805190602001908083835b60208310610c085780518252602082019150602081019050602083039250610be5565b6001836020036101000a0380198251168184511680821785525050505050509050018367ffffffffffffffff191667ffffffffffffffff1916815260180182815260200193505050506040516020818303038152906040526040518082805190602001908083835b60208310610c935780518252602082019150602081019050602083039250610c70565b6001836020036101000a038019825116818451168082178552505050505050905001915050602060405180830381855afa158015610cd5573d6000803e3d6000fd5b5050506040513d6020811015610cea57600080fd5b810190808051906020019092919050505060405160200180838152602001828152602001925050506040516020818303038152906040526040518082805190602001908083835b60208310610d545780518252602082019150602081019050602083039250610d31565b6001836020036101000a038019825116818451168082178552505050505050905001915050602060405180830381855afa158015610d96573d6000803e3d6000fd5b5050506040513d6020811015610dab57600080fd5b81019080805190602001909291905050509050858114610e16576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252605481526020018061162f6054913960600191505060405180910390fd5b6001602060020a0360205410610e77576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252602181526020018061160e6021913960400191505060405180910390fd5b60016020600082825401925050819055506000602054905060008090505b6020811015610fb75760018083161415610ec8578260008260208110610eb757fe5b018190555050505050505050610fc7565b600260008260208110610ed757fe5b01548460405160200180838152602001828152602001925050506040516020818303038152906040526040518082805190602001908083835b60208310610f335780518252602082019150602081019050602083039250610f10565b6001836020036101000a038019825116818451168082178552505050505050905001915050602060405180830381855afa158015610f75573d6000803e3d6000fd5b5050506040513d6020811015610f8a57600080fd5b8101908080519060200190929190505050925060028281610fa757fe5b0491508080600101915050610e95565b506000610fc057fe5b5050505050505b50505050505050565b6060610fdd602054611314565b905090565b6000806000602054905060008090505b60208110156111d057600180831614156110e05760026000826020811061101557fe5b01548460405160200180838152602001828152602001925050506040516020818303038152906040526040518082805190602001908083835b60208310611071578051825260208201915060208101905060208303925061104e565b6001836020036101000a038019825116818451168082178552505050505050905001915050602060405180830381855afa1580156110b3573d6000803e3d6000fd5b5050506040513d60208110156110c857600080fd5b810190808051906020019092919050505092506111b6565b600283602183602081106110f057fe5b015460405160200180838152602001828152602001925050506040516020818303038152906040526040518082805190602001908083835b6020831061114b5780518252602082019150602081019050602083039250611128565b6001836020036101000a038019825116818451168082178552505050505050905001915050602060405180830381855afa15801561118d573d6000803e3d6000fd5b5050506040513d60208110156111a257600080fd5b810190808051906020019092919050505092505b600282816111c057fe5b0491508080600101915050610ff2565b506002826111df602054611314565b600060401b6040516020018084815260200183805190602001908083835b6020831061122057805182526020820191506020810190506020830392506111fd565b6001836020036101000a0380198251168184511680821785525050505050509050018267ffffffffffffffff191667ffffffffffffffff1916815260180193505050506040516020818303038152906040526040518082805190602001908083835b602083106112a55780518252602082019150602081019050602083039250611282565b6001836020036101000a038019825116818451168082178552505050505050905001915050602060405180830381855afa1580156112e7573d6000803e3d6000fd5b5050506040513d60208110156112fc57600080fd5b81019080805190602001909291905050509250505090565b6060600867ffffffffffffffff8111801561132e57600080fd5b506040519080825280601f01601f1916602001820160405280156113615781602001600182028036833780820191505090505b50905060008260c01b90508060076008811061137957fe5b1a60f81b8260008151811061138a57fe5b60200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916908160001a905350806006600881106113c657fe5b1a60f81b826001815181106113d757fe5b60200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916908160001a9053508060056008811061141357fe5b1a60f81b8260028151811061142457fe5b60200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916908160001a9053508060046008811061146057fe5b1a60f81b8260038151811061147157fe5b60200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916908160001a905350806003600881106114ad57fe5b1a60f81b826004815181106114be57fe5b60200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916908160001a905350806002600881106114fa57fe5b1a60f81b8260058151811061150b57fe5b60200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916908160001a9053508060016008811061154757fe5b1a60f81b8260068151811061155857fe5b60200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916908160001a9053508060006008811061159457fe5b1a60f81b8260078151811061159857fe5b60200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916908160001a90535050919050565b600080858511156115ea57600080fd5b838611156115f757600080fd5b600185028301915084860390509450949250505056fe4465706f736974436f6e74726163743a206d65726b6c6520747265652066756c6c4465706f736974436f6e74726163743a207265636f6e7374727563746564204465706f7369744461746120646f6573206e6f74206d6174636820737570706c696564206465706f7369745f646174615f726f6f744465706f736974436f6e74726163743a20696e76616c6964207769746864726177616c5f63726564656e7469616c73206c656e6774684465706f736974436f6e74726163743a206465706f7369742076616c7565206e6f74206d756c7469706c65206f6620677765694465706f736974436f6e74726163743a20696e76616c6964207075626b6579206c656e6774684465706f736974436f6e74726163743a206465706f7369742076616c756520746f6f20686967684465706f736974436f6e74726163743a206465706f7369742076616c756520746f6f206c6f774465706f736974436f6e74726163743a20696e76616c6964207369676e6174757265206c656e677468a2646970667358221220230afd4b6e3551329e50f1239e08fa3ab7907b77403c4f237d9adf679e8e43cf64736f6c634300060b0033\\",[39m
[2m        \\"balance\\": \\"0x0\\"[22m
[2m      }[22m
[2m    },[22m
[33m@@ -76,6 +76,17 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "ethereum-1337",[39m
[31m+       "app.kubernetes.io/part-of": "1337",[39m
[31m+       "app.kubernetes.io/role": "config",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-id": "1337",[39m
[31m+       "starship.io/chain-name": "ethereum",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "config-ethereum",[22m
[2m    },[22m
[2m  }[22m

--- StatefulSet/ethereum-1337 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -6,10 +6,9 @@[39m
[2m        "app": "ethereum-1337",[22m
[2m      },[22m
[2m      "name": "ethereum-1337",[22m
[32m-     "namespace": "default",[39m
[2m    },[22m
[2m    "spec": Object {[22m
[32m-     "replicas": null,[39m
[31m+     "replicas": 1,[39m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[2m          "app.kubernetes.io/instance": "ethereum-1337",[22m
[33m@@ -30,15 +29,12 @@[39m
[2m            "app.kubernetes.io/name": "ethereum-1337",[22m
[2m            "app.kubernetes.io/rawname": "1337",[22m
[2m            "app.kubernetes.io/type": "ethereum-1337",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[2m          "containers": Array [[22m
[2m            Object {[22m
[32m-             "command": Array [[39m
[32m-               "bash",[39m
[32m-               "-c",[39m
[31m+             "args": Array [[39m
[2m                "echo \\"Waiting 30 seconds for execution client to be ready...\\"[22m
[2m  sleep 30[22m

[33m@@ -60,6 +56,10 @@[39m
[2m    --minimum-peers-per-subnet=0 \\\\[22m
[2m    --force-clear-db",[22m
[2m              ],[22m
[31m+             "command": Array [[39m
[31m+               "bash",[39m
[31m+               "-c",[39m
[31m+             ],[39m
[2m              "env": Array [[22m
[2m                Object {[22m
[2m                  "name": "NAMESPACE",[22m
[33m@@ -83,11 +83,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -103,9 +103,7 @@[39m
[2m              ],[22m
[2m            },[22m
[2m            Object {[22m
[32m-             "command": Array [[39m
[32m-               "bash",[39m
[32m-               "-c",[39m
[31m+             "args": Array [[39m
[2m                "echo \\"Setting UDP buffer size\\"[22m
[2m  sysctl -w net.core.rmem_max=16777216[22m
[2m  sysctl -w net.core.wmem_max=16777216[22m
[33m@@ -136,6 +134,10 @@[39m
[2m    --nat=none \\\\[22m
[2m    --log.vmodule=engine=6",[22m
[2m              ],[22m
[31m+             "command": Array [[39m
[31m+               "bash",[39m
[31m+               "-c",[39m
[31m+             ],[39m
[2m              "env": Array [[22m
[2m                Object {[22m
[2m                  "name": "HTTP_PORT",[22m
[33m@@ -166,11 +168,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -186,9 +188,7 @@[39m
[2m              ],[22m
[2m            },[22m
[2m            Object {[22m
[32m-             "command": Array [[39m
[32m-               "bash",[39m
[32m-               "-c",[39m
[31m+             "args": Array [[39m
[2m                "echo \\"Waiting 15 seconds for execution client to be ready...\\"[22m
[2m  sleep 20[22m
[2m  mkdir -p /ethereum/consensus/validator[22m
[33m@@ -206,6 +206,10 @@[39m
[2m    --monitoring-port=8081 \\\\[22m
[2m    --suggested-fee-recipient=0x0C46c2cAFE097b4f7e1BB868B89e5697eE65f934",[22m
[2m              ],[22m
[31m+             "command": Array [[39m
[31m+               "bash",[39m
[31m+               "-c",[39m
[31m+             ],[39m
[2m              "env": Array [[22m
[2m                Object {[22m
[2m                  "name": "NAMESPACE",[22m
[33m@@ -229,11 +233,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -251,9 +255,7 @@[39m
[2m          ],[22m
[2m          "initContainers": Array [[22m
[2m            Object {[22m
[32m-             "command": Array [[39m
[32m-               "bash",[39m
[32m-               "-c",[39m
[31m+             "args": Array [[39m
[2m                "mkdir -p /ethereum/consensus /ethereum/execution[22m
[2m  cp /config/genesis.json /ethereum/execution/genesis.json[22m
[2m  cp /config/config.yaml /ethereum/consensus/config.yaml[22m
[33m@@ -270,17 +272,21 @@[39m

[2m  echo \\"Copy secrets over\\"[22m
[2m  cp /config/jwt.hex /etc/secrets/jwt.hex",[22m
[31m+             ],[39m
[31m+             "command": Array [[39m
[31m+               "bash",[39m
[31m+               "-c",[39m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/prysm/cmd/prysmctl:v5.2.0",[22m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "init-genesis-beacon",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -300,22 +306,24 @@[39m
[2m              ],[22m
[2m            },[22m
[2m            Object {[22m
[31m+             "args": Array [[39m
[31m+               "echo \\"Initializing genesis geth\\"[39m
[31m+ geth --datadir /ethereum/execution init /ethereum/execution/genesis.json",[39m
[31m+             ],[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "echo \\"Initializing genesis geth\\"[39m
[32m- geth --datadir /ethereum/execution init /ethereum/execution/genesis.json",[39m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/ethereum/client-go:v1.14.12",[22m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "init-genesis-execution",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m"
`;

exports[`Manifest Comparison Tests Individual Config Comparisons should generate manifests for eth-lite that match the snapshot 1`] = `
"ðŸ”„ MODIFIED_RESOURCES:

--- ConfigMap/config-ethereum ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -64,7 +64,7 @@[39m
[2m        \\"balance\\": \\"0x3635c9adc5dea00000\\"[22m
[2m      },[22m
[2m      \\"0x4242424242424242424242424242424242424242\\": {[22m
[32m-       \\"code\\": \\"0x60806040526004361061003f5760003560e01c806301ffc9a71461004457806322895118146100b6578063621fd130146101e3578063c5f2892f14610273575b600080fd5b34801561005057600080fd5b5061009c6004803603602081101561006757600080fd5b8101908080357bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916906020019092919050505061029e565b604051808215151515815260200191505060405180910390f35b6101e1600480360360808110156100cc57600080fd5b81019080803590602001906401000000008111156100e957600080fd5b8201836020820111156100fb57600080fd5b8035906020019184600183028401116401000000008311171561011d57600080fd5b90919293919293908035906020019064010000000081111561013e57600080fd5b82018360208201111561015057600080fd5b8035906020019184600183028401116401000000008311171561017257600080fd5b90919293919293908035906020019064010000000081111561019357600080fd5b8201836020820111156101a557600080fd5b803590602001918460018302840111640100000000831117156101c757600080fd5b909192939192939080359060200190929190505050610370565b005b3480156101ef57600080fd5b506101f8610fd0565b6040518080602001828103825283818151815260200191508051906020019080838360005b8381101561023857808201518184015260208101905061021d565b50505050905090810190601f1680156102655780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b34801561027f57600080fd5b50610288610fe2565b6040518082815260200191505060405180910390f35b60007f01ffc9a7000000000000000000000000000000000000000000000000000000007bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916827bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916148061036957507f85640907000000000000000000000000000000000000000000000000000000007bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916827bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916145b9050919050565b603087879050146103cc576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260268152602001806116ec6026913960400191505060405180910390fd5b60208585905014610428576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260368152602001806116836036913960400191505060405180910390fd5b60608383905014610484576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252602981526020018061175f6029913960400191505060405180910390fd5b670de0b6b3a76400003410156104e5576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260268152602001806117396026913960400191505060405180910390fd5b6000633b9aca0034816104f457fe5b061461054b576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260338152602001806116b96033913960400191505060405180910390fd5b6000633b9aca00348161055a57fe5b04905067ffffffffffffffff80168111156105c0576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260278152602001806117126027913960400191505060405180910390fd5b60606105cb82611314565b90507f649bbc62d0e31342afea4e5cd82d4049e7e1ee912fc0889aa790803be39038c589898989858a8a610600602054611314565b60405180806020018060200180602001806020018060200186810386528e8e82818152602001925080828437600081840152601f19601f82011690508083019250505086810385528c8c82818152602001925080828437600081840152601f19601f82011690508083019250505086810384528a818151815260200191508051906020019080838360005b838110156106a657808201518184015260208101905061068b565b50505050905090810190601f1680156106d35780820380516001836020036101000a031916815260200191505b508681038352898982818152602001925080828437600081840152601f19601f820116905080830192505050868103825287818151815260200191508051906020019080838360005b8381101561073757808201518184015260208101905061071c565b50505050905090810190601f1680156107645780820380516001836020036101000a031916815260200191505b509d505050505050505050505050505060405180910390a1600060028a8a600060801b6040516020018084848082843780830192505050826fffffffffffffffffffffffffffffffff19166fffffffffffffffffffffffffffffffff1916815260100193505050506040516020818303038152906040526040518082805190602001908083835b6020831061080e57805182526020820191506020810190506020830392506107eb565b6001836020036101000a038019825116818451168082178552505050505050905001915050602060405180830381855afa158015610850573d6000803e3d6000fd5b5050506040513d602081101561086557600080fd5b8101908080519060200190929190505050905060006002808888600090604092610891939291906115da565b6040516020018083838082843780830192505050925050506040516020818303038152906040526040518082805190602001908083835b602083106108eb57805182526020820191506020810190506020830392506108c8565b6001836020036101000a038019825116818451168082178552505050505050905001915050602060405180830381855afa15801561092d573d6000803e3d6000fd5b5050506040513d602081101561094257600080fd5b8101908080519060200190929190505050600289896040908092610968939291906115da565b6000801b604051602001808484808284378083019250505082815260200193505050506040516020818303038152906040526040518082805190602001908083835b602083106109cd57805182526020820191506020810190506020830392506109aa565b6001836020036101000a038019825116818451168082178552505050505050905001915050602060405180830381855afa158015610a0f573d6000803e3d6000fd5b5050506040513d6020811015610a2457600080fd5b810190808051906020019092919050505060405160200180838152602001828152602001925050506040516020818303038152906040526040518082805190602001908083835b60208310610a8e5780518252602082019150602081019050602083039250610a6b565b6001836020036101000a038019825116818451168082178552505050505050905001915050602060405180830381855afa158015610ad0573d6000803e3d6000fd5b5050506040513d6020811015610ae557600080fd5b810190808051906020019092919050505090506000600280848c8c604051602001808481526020018383808284378083019250505093505050506040516020818303038152906040526040518082805190602001908083835b60208310610b615780518252602082019150602081019050602083039250610b3e565b6001836020036101000a038019825116818451168082178552505050505050905001915050602060405180830381855afa158015610ba3573d6000803e3d6000fd5b5050506040513d6020811015610bb857600080fd5b8101908080519060200190929190505050600286600060401b866040516020018084805190602001908083835b60208310610c085780518252602082019150602081019050602083039250610be5565b6001836020036101000a0380198251168184511680821785525050505050509050018367ffffffffffffffff191667ffffffffffffffff1916815260180182815260200193505050506040516020818303038152906040526040518082805190602001908083835b60208310610c935780518252602082019150602081019050602083039250610c70565b6001836020036101000a038019825116818451168082178552505050505050905001915050602060405180830381855afa158015610cd5573d6000803e3d6000fd5b5050506040513d6020811015610cea57600080fd5b810190808051906020019092919050505060405160200180838152602001828152602001925050506040516020818303038152906040526040518082805190602001908083835b60208310610d545780518252602082019150602081019050602083039250610d31565b6001836020036101000a038019825116818451168082178552505050505050905001915050602060405180830381855afa158015610d96573d6000803e3d6000fd5b5050506040513d6020811015610dab57600080fd5b81019080805190602001909291905050509050858114610e16576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252605481526020018061162f6054913960600191505060405180910390fd5b6001602060020a0360205410610e77576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252602181526020018061160e6021913960400191505060405180910390fd5b60016020600082825401925050819055506000602054905060008090505b6020811015610fb75760018083161415610ec8578260008260208110610eb757fe5b018190555050505050505050610fc7565b600260008260208110610ed757fe5b01548460405160200180838152602001828152602001925050506040516020818303038152906040526040518082805190602001908083835b60208310610f335780518252602082019150602081019050602083039250610f10565b6001836020036101000a038019825116818451168082178552505050505050905001915050602060405180830381855afa158015610f75573d6000803e3d6000fd5b5050506040513d6020811015610f8a57600080fd5b8101908080519060200190929190505050925060028281610fa757fe5b0491508080600101915050610e95565b506000610fc057fe5b5050505050505b50505050505050565b6060610fdd602054611314565b905090565b6000806000602054905060008090505b60208110156111d057600180831614156110e05760026000826020811061101557fe5b01548460405160200180838152602001828152602001925050506040516020818303038152906040526040518082805190602001908083835b60208310611071578051825260208201915060208101905060208303925061104e565b6001836020036101000a038019825116818451168082178552505050505050905001915050602060405180830381855afa1580156110b3573d6000803e3d6000fd5b5050506040513d60208110156110c857600080fd5b810190808051906020019092919050505092506111b6565b600283602183602081106110f057fe5b015460405160200180838152602001828152602001925050506040516020818303038152906040526040518082805190602001908083835b6020831061114b5780518252602082019150602081019050602083039250611128565b6001836020036101000a038019825116818451168082178552505050505050905001915050602060405180830381855afa15801561118d573d6000803e3d6000fd5b5050506040513d60208110156111a257600080fd5b810190808051906020019092919050505092505b600282816111c057fe5b0491508080600101915050610ff2565b506002826111df602054611314565b600060401b6040516020018084815260200183805190602001908083835b6020831061122057805182526020820191506020810190506020830392506111fd565b6001836020036101000a0380198251168184511680821785525050505050509050018267ffffffffffffffff191667ffffffffffffffff1916815260180193505050506040516020818303038152906040526040518082805190602001908083835b602083106112a55780518252602082019150602081019050602083039250611282565b6001836020036101000a038019825116818451168082178552505050505050905001915050602060405180830381855afa1580156112e7573d6000803e3d6000fd5b5050506040513d60208110156112fc57600080fd5b81019080805190602001909291905050509250505090565b6060600867ffffffffffffffff8111801561132e57600080fd5b506040519080825280601f01601f1916602001820160405280156113615781602001600182028036833780820191505090505b50905060008260c01b90508060076008811061137957fe5b1a60f81b8260008151811061138a57fe5b60200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916908160001a905350806006600881106113c657fe5b1a60f81b826001815181106113d757fe5b60200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916908160001a9053508060056008811061141357fe5b1a60f81b8260028151811061142457fe5b60200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916908160001a9053508060046008811061146057fe5b1a60f81b8260038151811061147157fe5b60200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916908160001a905350806003600881106114ad57fe5b1a60f81b826004815181106114be57fe5b60200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916908160001a905350806002600881106114fa57fe5b1a60f81b8260058151811061150b57fe5b60200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916908160001a9053508060016008811061154757fe5b1a60f81b8260068151811061155857fe5b60200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916908160001a9053508060006008811061159457fe5b1a60f81b826007815181106115a557fe5b60200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916908160001a90535050919050565b600080858511156115ea57600080fd5b838611156115f757600080fd5b600185028301915084860390509450949250505056fe4465706f736974436f6e74726163743a206d65726b6c6520747265652066756c6c4465706f736974436f6e74726163743a207265636f6e7374727563746564204465706f7369744461746120646f6573206e6f74206d6174636820737570706c696564206465706f7369745f646174615f726f6f744465706f736974436f6e74726163743a20696e76616c6964207769746864726177616c5f63726564656e7469616c73206c656e6774684465706f736974436f6e74726163743a206465706f7369742076616c7565206e6f74206d756c7469706c65206f6620677765694465706f736974436f6e74726163743a20696e76616c6964207075626b6579206c656e6774684465706f736974436f6e74726163743a206465706f7369742076616c756520746f6f20686967684465706f736974436f6e74726163743a206465706f7369742076616c756520746f6f206c6f774465706f736974436f6e74726163743a20696e76616c6964207369676e6174757265206c656e677468a2646970667358221220230afd4b6e3551329e50f1239e08fa3ab7907b77403c4f237d9adf679e8e43cf64736f6c634300060b0033\\",[39m
[31m+       \\"code\\": \\"0x60806040526004361061003f5760003560e01c806301ffc9a71461004457806322895118146100b6578063621fd130146101e3578063c5f2892f14610273575b600080fd5b34801561005057600080fd5b5061009c6004803603602081101561006757600080fd5b8101908080357bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916906020019092919050505061029e565b604051808215151515815260200191505060405180910390f35b6101e1600480360360808110156100cc57600080fd5b81019080803590602001906401000000008111156100e957600080fd5b8201836020820111156100fb57600080fd5b8035906020019184600183028401116401000000008311171561011d57600080fd5b90919293919293908035906020019064010000000081111561013e57600080fd5b82018360208201111561015057600080fd5b8035906020019184600183028401116401000000008311171561017257600080fd5b90919293919293908035906020019064010000000081111561019357600080fd5b8201836020820111156101a557600080fd5b803590602001918460018302840111640100000000831117156101c757600080fd5b909192939192939080359060200190929190505050610370565b005b3480156101ef57600080fd5b506101f8610fd0565b6040518080602001828103825283818151815260200191508051906020019080838360005b8381101561023857808201518184015260208101905061021d565b50505050905090810190601f1680156102655780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b34801561027f57600080fd5b50610288610fe2565b6040518082815260200191505060405180910390f35b60007f01ffc9a7000000000000000000000000000000000000000000000000000000007bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916827bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916148061036957507f85640907000000000000000000000000000000000000000000000000000000007bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916827bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916145b9050919050565b603087879050146103cc576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260268152602001806116ec6026913960400191505060405180910390fd5b60208585905014610428576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260368152602001806116836036913960400191505060405180910390fd5b60608383905014610484576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252602981526020018061175f6029913960400191505060405180910390fd5b670de0b6b3a76400003410156104e5576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260268152602001806117396026913960400191505060405180910390fd5b6000633b9aca0034816104f457fe5b061461054b576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260338152602001806116b96033913960400191505060405180910390fd5b6000633b9aca00348161055a57fe5b04905067ffffffffffffffff80168111156105c0576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260278152602001806117126027913960400191505060405180910390fd5b60606105cb82611314565b90507f649bbc62d0e31342afea4e5cd82d4049e7e1ee912fc0889aa790803be39038c589898989858a8a610600602054611314565b60405180806020018060200180602001806020018060200186810386528e8e82818152602001925080828437600081840152601f19601f82011690508083019250505086810385528c8c82818152602001925080828437600081840152601f19601f82011690508083019250505086810384528a818151815260200191508051906020019080838360005b838110156106a657808201518184015260208101905061068b565b50505050905090810190601f1680156106d35780820380516001836020036101000a031916815260200191505b508681038352898982818152602001925080828437600081840152601f19601f820116905080830192505050868103825287818151815260200191508051906020019080838360005b8381101561073757808201518184015260208101905061071c565b50505050905090810190601f1680156107645780820380516001836020036101000a031916815260200191505b509d505050505050505050505050505060405180910390a1600060028a8a600060801b6040516020018084848082843780830192505050826fffffffffffffffffffffffffffffffff19166fffffffffffffffffffffffffffffffff1916815260100193505050506040516020818303038152906040526040518082805190602001908083835b6020831061080e57805182526020820191506020810190506020830392506107eb565b6001836020036101000a038019825116818451168082178552505050505050905001915050602060405180830381855afa158015610850573d6000803e3d6000fd5b5050506040513d602081101561086557600080fd5b8101908080519060200190929190505050905060006002808888600090604092610891939291906115da565b6040516020018083838082843780830192505050925050506040516020818303038152906040526040518082805190602001908083835b602083106108eb57805182526020820191506020810190506020830392506108c8565b6001836020036101000a038019825116818451168082178552505050505050905001915050602060405180830381855afa15801561092d573d6000803e3d6000fd5b5050506040513d602081101561094257600080fd5b8101908080519060200190929190505050600289896040908092610968939291906115da565b6000801b604051602001808484808284378083019250505082815260200193505050506040516020818303038152906040526040518082805190602001908083835b602083106109cd57805182526020820191506020810190506020830392506109aa565b6001836020036101000a038019825116818451168082178552505050505050905001915050602060405180830381855afa158015610a0f573d6000803e3d6000fd5b5050506040513d6020811015610a2457600080fd5b810190808051906020019092919050505060405160200180838152602001828152602001925050506040516020818303038152906040526040518082805190602001908083835b60208310610a8e5780518252602082019150602081019050602083039250610a6b565b6001836020036101000a038019825116818451168082178552505050505050905001915050602060405180830381855afa158015610ad0573d6000803e3d6000fd5b5050506040513d6020811015610ae557600080fd5b810190808051906020019092919050505090506000600280848c8c604051602001808481526020018383808284378083019250505093505050506040516020818303038152906040526040518082805190602001908083835b60208310610b615780518252602082019150602081019050602083039250610b3e565b6001836020036101000a038019825116818451168082178552505050505050905001915050602060405180830381855afa158015610ba3573d6000803e3d6000fd5b5050506040513d6020811015610bb857600080fd5b8101908080519060200190929190505050600286600060401b866040516020018084805190602001908083835b60208310610c085780518252602082019150602081019050602083039250610be5565b6001836020036101000a0380198251168184511680821785525050505050509050018367ffffffffffffffff191667ffffffffffffffff1916815260180182815260200193505050506040516020818303038152906040526040518082805190602001908083835b60208310610c935780518252602082019150602081019050602083039250610c70565b6001836020036101000a038019825116818451168082178552505050505050905001915050602060405180830381855afa158015610cd5573d6000803e3d6000fd5b5050506040513d6020811015610cea57600080fd5b810190808051906020019092919050505060405160200180838152602001828152602001925050506040516020818303038152906040526040518082805190602001908083835b60208310610d545780518252602082019150602081019050602083039250610d31565b6001836020036101000a038019825116818451168082178552505050505050905001915050602060405180830381855afa158015610d96573d6000803e3d6000fd5b5050506040513d6020811015610dab57600080fd5b81019080805190602001909291905050509050858114610e16576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252605481526020018061162f6054913960600191505060405180910390fd5b6001602060020a0360205410610e77576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252602181526020018061160e6021913960400191505060405180910390fd5b60016020600082825401925050819055506000602054905060008090505b6020811015610fb75760018083161415610ec8578260008260208110610eb757fe5b018190555050505050505050610fc7565b600260008260208110610ed757fe5b01548460405160200180838152602001828152602001925050506040516020818303038152906040526040518082805190602001908083835b60208310610f335780518252602082019150602081019050602083039250610f10565b6001836020036101000a038019825116818451168082178552505050505050905001915050602060405180830381855afa158015610f75573d6000803e3d6000fd5b5050506040513d6020811015610f8a57600080fd5b8101908080519060200190929190505050925060028281610fa757fe5b0491508080600101915050610e95565b506000610fc057fe5b5050505050505b50505050505050565b6060610fdd602054611314565b905090565b6000806000602054905060008090505b60208110156111d057600180831614156110e05760026000826020811061101557fe5b01548460405160200180838152602001828152602001925050506040516020818303038152906040526040518082805190602001908083835b60208310611071578051825260208201915060208101905060208303925061104e565b6001836020036101000a038019825116818451168082178552505050505050905001915050602060405180830381855afa1580156110b3573d6000803e3d6000fd5b5050506040513d60208110156110c857600080fd5b810190808051906020019092919050505092506111b6565b600283602183602081106110f057fe5b015460405160200180838152602001828152602001925050506040516020818303038152906040526040518082805190602001908083835b6020831061114b5780518252602082019150602081019050602083039250611128565b6001836020036101000a038019825116818451168082178552505050505050905001915050602060405180830381855afa15801561118d573d6000803e3d6000fd5b5050506040513d60208110156111a257600080fd5b810190808051906020019092919050505092505b600282816111c057fe5b0491508080600101915050610ff2565b506002826111df602054611314565b600060401b6040516020018084815260200183805190602001908083835b6020831061122057805182526020820191506020810190506020830392506111fd565b6001836020036101000a0380198251168184511680821785525050505050509050018267ffffffffffffffff191667ffffffffffffffff1916815260180193505050506040516020818303038152906040526040518082805190602001908083835b602083106112a55780518252602082019150602081019050602083039250611282565b6001836020036101000a038019825116818451168082178552505050505050905001915050602060405180830381855afa1580156112e7573d6000803e3d6000fd5b5050506040513d60208110156112fc57600080fd5b81019080805190602001909291905050509250505090565b6060600867ffffffffffffffff8111801561132e57600080fd5b506040519080825280601f01601f1916602001820160405280156113615781602001600182028036833780820191505090505b50905060008260c01b90508060076008811061137957fe5b1a60f81b8260008151811061138a57fe5b60200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916908160001a905350806006600881106113c657fe5b1a60f81b826001815181106113d757fe5b60200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916908160001a9053508060056008811061141357fe5b1a60f81b8260028151811061142457fe5b60200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916908160001a9053508060046008811061146057fe5b1a60f81b8260038151811061147157fe5b60200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916908160001a905350806003600881106114ad57fe5b1a60f81b826004815181106114be57fe5b60200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916908160001a905350806002600881106114fa57fe5b1a60f81b8260058151811061150b57fe5b60200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916908160001a9053508060016008811061154757fe5b1a60f81b8260068151811061155857fe5b60200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916908160001a9053508060006008811061159457fe5b1a60f81b8260078151811061159857fe5b60200101907effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916908160001a90535050919050565b600080858511156115ea57600080fd5b838611156115f757600080fd5b600185028301915084860390509450949250505056fe4465706f736974436f6e74726163743a206d65726b6c6520747265652066756c6c4465706f736974436f6e74726163743a207265636f6e7374727563746564204465706f7369744461746120646f6573206e6f74206d6174636820737570706c696564206465706f7369745f646174615f726f6f744465706f736974436f6e74726163743a20696e76616c6964207769746864726177616c5f63726564656e7469616c73206c656e6774684465706f736974436f6e74726163743a206465706f7369742076616c7565206e6f74206d756c7469706c65206f6620677765694465706f736974436f6e74726163743a20696e76616c6964207075626b6579206c656e6774684465706f736974436f6e74726163743a206465706f7369742076616c756520746f6f20686967684465706f736974436f6e74726163743a206465706f7369742076616c756520746f6f206c6f774465706f736974436f6e74726163743a20696e76616c6964207369676e6174757265206c656e677468a2646970667358221220230afd4b6e3551329e50f1239e08fa3ab7907b77403c4f237d9adf679e8e43cf64736f6c634300060b0033\\",[39m
[2m        \\"balance\\": \\"0x0\\"[22m
[2m      }[22m
[2m    },[22m
[33m@@ -79,6 +79,17 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "ethereum-1337",[39m
[31m+       "app.kubernetes.io/part-of": "1337",[39m
[31m+       "app.kubernetes.io/role": "config",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-id": "1337",[39m
[31m+       "starship.io/chain-name": "ethereum",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "config-ethereum",[22m
[2m    },[22m
[2m  }[22m

--- StatefulSet/ethereum-1337 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -6,10 +6,9 @@[39m
[2m        "app": "ethereum-1337",[22m
[2m      },[22m
[2m      "name": "ethereum-1337",[22m
[32m-     "namespace": "default",[39m
[2m    },[22m
[2m    "spec": Object {[22m
[32m-     "replicas": null,[39m
[31m+     "replicas": 1,[39m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[2m          "app.kubernetes.io/instance": "ethereum-1337",[22m
[33m@@ -30,15 +29,12 @@[39m
[2m            "app.kubernetes.io/name": "ethereum-1337",[22m
[2m            "app.kubernetes.io/rawname": "1337",[22m
[2m            "app.kubernetes.io/type": "ethereum-1337",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[2m          "containers": Array [[22m
[2m            Object {[22m
[32m-             "command": Array [[39m
[32m-               "bash",[39m
[32m-               "-c",[39m
[31m+             "args": Array [[39m
[2m                "echo \\"Waiting 30 seconds for execution client to be ready...\\"[22m
[2m  sleep 30[22m

[33m@@ -60,6 +56,10 @@[39m
[2m    --minimum-peers-per-subnet=0 \\\\[22m
[2m    --force-clear-db",[22m
[2m              ],[22m
[31m+             "command": Array [[39m
[31m+               "bash",[39m
[31m+               "-c",[39m
[31m+             ],[39m
[2m              "env": Array [[22m
[2m                Object {[22m
[2m                  "name": "NAMESPACE",[22m
[33m@@ -103,9 +103,7 @@[39m
[2m              ],[22m
[2m            },[22m
[2m            Object {[22m
[32m-             "command": Array [[39m
[32m-               "bash",[39m
[32m-               "-c",[39m
[31m+             "args": Array [[39m
[2m                "echo \\"Setting UDP buffer size\\"[22m
[2m  sysctl -w net.core.rmem_max=16777216[22m
[2m  sysctl -w net.core.wmem_max=16777216[22m
[33m@@ -135,6 +133,10 @@[39m
[2m    --maxpeers=50 \\\\[22m
[2m    --nat=none \\\\[22m
[2m    --log.vmodule=engine=6",[22m
[31m+             ],[39m
[31m+             "command": Array [[39m
[31m+               "bash",[39m
[31m+               "-c",[39m
[2m              ],[22m
[2m              "env": Array [[22m
[2m                Object {[22m
[33m@@ -186,9 +188,7 @@[39m
[2m              ],[22m
[2m            },[22m
[2m            Object {[22m
[32m-             "command": Array [[39m
[32m-               "bash",[39m
[32m-               "-c",[39m
[31m+             "args": Array [[39m
[2m                "echo \\"Waiting 15 seconds for execution client to be ready...\\"[22m
[2m  sleep 20[22m
[2m  mkdir -p /ethereum/consensus/validator[22m
[33m@@ -205,6 +205,10 @@[39m
[2m    --monitoring-host=0.0.0.0 \\\\[22m
[2m    --monitoring-port=8081 \\\\[22m
[2m    --suggested-fee-recipient=0x0C46c2cAFE097b4f7e1BB868B89e5697eE65f934",[22m
[31m+             ],[39m
[31m+             "command": Array [[39m
[31m+               "bash",[39m
[31m+               "-c",[39m
[2m              ],[22m
[2m              "env": Array [[22m
[2m                Object {[22m
[33m@@ -251,9 +255,7 @@[39m
[2m          ],[22m
[2m          "initContainers": Array [[22m
[2m            Object {[22m
[32m-             "command": Array [[39m
[32m-               "bash",[39m
[32m-               "-c",[39m
[31m+             "args": Array [[39m
[2m                "mkdir -p /ethereum/consensus /ethereum/execution[22m
[2m  cp /config/genesis.json /ethereum/execution/genesis.json[22m
[2m  cp /config/config.yaml /ethereum/consensus/config.yaml[22m
[33m@@ -270,6 +272,10 @@[39m

[2m  echo \\"Copy secrets over\\"[22m
[2m  cp /config/jwt.hex /etc/secrets/jwt.hex",[22m
[31m+             ],[39m
[31m+             "command": Array [[39m
[31m+               "bash",[39m
[31m+               "-c",[39m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/prysm/cmd/prysmctl:v5.2.0",[22m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[33m@@ -300,11 +306,13 @@[39m
[2m              ],[22m
[2m            },[22m
[2m            Object {[22m
[31m+             "args": Array [[39m
[31m+               "echo \\"Initializing genesis geth\\"[39m
[31m+ geth --datadir /ethereum/execution init /ethereum/execution/genesis.json",[39m
[31m+             ],[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "echo \\"Initializing genesis geth\\"[39m
[32m- geth --datadir /ethereum/execution init /ethereum/execution/genesis.json",[39m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/ethereum/client-go:v1.14.12",[22m
[2m              "imagePullPolicy": "IfNotPresent",[22m"
`;

exports[`Manifest Comparison Tests Individual Config Comparisons should generate manifests for evmos that match the snapshot 1`] = `
"ðŸ”„ MODIFIED_RESOURCES:

--- ConfigMap/keys ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -98,6 +98,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "configmap",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "keys",[39m
[31m+       "app.kubernetes.io/part-of": "global",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "keys",[22m
[2m    },[22m
[2m  }[22m

--- ConfigMap/setup-scripts ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -208,6 +208,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "configmap",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts",[39m
[31m+       "app.kubernetes.io/part-of": "global",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts",[22m
[2m    },[22m
[2m  }[22m

--- StatefulSet/cosmoshub-4-genesis ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,18 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/id": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "cosmoshub-4-genesis",[39m
[31m+       "app.kubernetes.io/part-of": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/role": "genesis",[39m
[31m+       "app.kubernetes.io/type": "cosmoshub-4-statefulset",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-name": "cosmoshub",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "cosmoshub-4-genesis",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +21,7 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "cosmoshub",[39m
[31m+         "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m          "app.kubernetes.io/name": "cosmoshub-4-genesis",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -23,11 +35,12 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "cosmoshub",[39m
[31m+           "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m            "app.kubernetes.io/name": "cosmoshub-4-genesis",[22m
[2m            "app.kubernetes.io/rawname": "cosmoshub-4",[22m
[31m+           "app.kubernetes.io/role": "genesis",[39m
[2m            "app.kubernetes.io/type": "cosmoshub-4",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[33m@@ -91,11 +104,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -184,12 +197,12 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[32m-                 "memory": "200M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "128M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[32m-                 "memory": "200M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "128M",[39m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[33m@@ -211,7 +224,12 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "START_ARGS=\\"\\"[39m
[31m+               "#!/bin/bash[39m
[31m+ set -euo pipefail[39m
[31m+[39m
[31m+ START_ARGS=\\"\\"[39m
[31m+[39m
[31m+[39m
[2m  $CHAIN_BIN start $START_ARGS",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -274,11 +292,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -307,6 +325,7 @@[39m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m

[2m  echo \\"Running setup config script...\\"[22m
[31m+[39m
[2m  bash -e /scripts/update-config.sh",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -348,7 +367,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "TIME_IOTA_MS",[22m
[33m@@ -388,11 +407,11 @@[39m
[2m              "name": "init-config",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -415,20 +434,18 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "# Install faucet binary from the image[39m
[32m- cp /bin/faucet /faucet/faucet[39m
[32m- chmod +x /faucet/faucet",[39m
[31m+               "cp /bin/faucet /faucet/faucet && chmod +x /faucet/faucet",[39m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/faucet:20250325-2207109",[22m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "init-faucet",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -553,11 +570,11 @@[39m
[2m              "name": "init-genesis",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m

--- ConfigMap/setup-scripts-cosmoshub-4 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -608,6 +608,17 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts-cosmoshub-4",[39m
[31m+       "app.kubernetes.io/part-of": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/role": "setup-scripts",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-id": "cosmoshub-4",[39m
[31m+       "starship.io/chain-name": "cosmoshub",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts-cosmoshub-4",[22m
[2m    },[22m
[2m  }[22m

--- StatefulSet/evmos-9000-1-genesis ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,18 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/id": "evmos_9000-1",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "evmos_9000-1-genesis",[39m
[31m+       "app.kubernetes.io/part-of": "evmos_9000-1",[39m
[31m+       "app.kubernetes.io/role": "genesis",[39m
[31m+       "app.kubernetes.io/type": "evmos_9000-1-statefulset",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-name": "evmos",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "evmos-9000-1-genesis",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +21,7 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "evmos",[39m
[31m+         "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m          "app.kubernetes.io/name": "evmos_9000-1-genesis",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -23,11 +35,12 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "evmos",[39m
[31m+           "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m            "app.kubernetes.io/name": "evmos_9000-1-genesis",[22m
[2m            "app.kubernetes.io/rawname": "evmos_9000-1",[22m
[31m+           "app.kubernetes.io/role": "genesis",[39m
[2m            "app.kubernetes.io/type": "evmos_9000-1",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[33m@@ -91,11 +104,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -184,12 +197,12 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[32m-                 "memory": "200M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "128M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[32m-                 "memory": "200M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "128M",[39m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[33m@@ -211,7 +224,12 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "START_ARGS=\\"\\"[39m
[31m+               "#!/bin/bash[39m
[31m+ set -euo pipefail[39m
[31m+[39m
[31m+ START_ARGS=\\"\\"[39m
[31m+[39m
[31m+[39m
[2m  $CHAIN_BIN start $START_ARGS",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -274,11 +292,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -307,6 +325,7 @@[39m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m

[2m  echo \\"Running setup config script...\\"[22m
[31m+[39m
[2m  bash -e /scripts/update-config.sh",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -348,7 +367,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "TIME_IOTA_MS",[22m
[33m@@ -388,11 +407,11 @@[39m
[2m              "name": "init-config",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -415,20 +434,18 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "# Install faucet binary from the image[39m
[32m- cp /bin/faucet /faucet/faucet[39m
[32m- chmod +x /faucet/faucet",[39m
[31m+               "cp /bin/faucet /faucet/faucet && chmod +x /faucet/faucet",[39m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/faucet:20250325-2207109",[22m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "init-faucet",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -553,11 +570,11 @@[39m
[2m              "name": "init-genesis",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m

--- ConfigMap/setup-scripts-evmos-9000-1 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -608,6 +608,17 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts-evmos-9000-1",[39m
[31m+       "app.kubernetes.io/part-of": "evmos_9000-1",[39m
[31m+       "app.kubernetes.io/role": "setup-scripts",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-id": "evmos_9000-1",[39m
[31m+       "starship.io/chain-name": "evmos",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts-evmos-9000-1",[22m
[2m    },[22m
[2m  }[22m

--- Service/evmos-9000-1-validator ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -23,6 +23,12 @@[39m
[2m          "targetPort": 8081,[22m
[2m        },[22m
[2m        Object {[22m
[31m+         "name": "faucet",[39m
[31m+         "port": 8000,[39m
[31m+         "protocol": "TCP",[39m
[31m+         "targetPort": 8000,[39m
[31m+       },[39m
[31m+       Object {[39m
[2m          "name": "grpc",[22m
[2m          "port": 9090,[22m
[2m          "protocol": "TCP",[22m

--- StatefulSet/evmos-9000-1-validator ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,18 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/id": "evmos_9000-1",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "evmos_9000-1-validator",[39m
[31m+       "app.kubernetes.io/part-of": "evmos_9000-1",[39m
[31m+       "app.kubernetes.io/role": "validator",[39m
[31m+       "app.kubernetes.io/type": "evmos_9000-1-statefulset",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-name": "evmos",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "evmos-9000-1-validator",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -10,7 +22,7 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "evmos",[39m
[31m+         "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m          "app.kubernetes.io/name": "evmos_9000-1-validator",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -24,10 +36,11 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "evmos",[39m
[31m+           "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m            "app.kubernetes.io/name": "evmos_9000-1-validator",[22m
[31m+           "app.kubernetes.io/role": "validator",[39m
[2m            "app.kubernetes.io/type": "evmos_9000-1",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[33m@@ -119,11 +132,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -145,7 +158,9 @@[39m
[2m                "set -eux[22m
[2m  START_ARGS=\\"\\"[22m

[31m+[39m
[2m  # Starting the chain[22m
[31m+[39m
[2m  $CHAIN_BIN start $START_ARGS",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -255,11 +270,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -286,6 +301,7 @@[39m
[2m                "-c",[22m
[2m                "VAL_INDEX=\${HOSTNAME##*-}[22m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m
[31m+[39m

[2m  echo \\"Running setup config script...\\"[22m
[2m  bash -e /scripts/update-config.sh[22m
[33m@@ -351,7 +367,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "NAMESPACE",[22m
[33m@@ -399,11 +415,11 @@[39m
[2m              "name": "init-config",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -428,6 +444,7 @@[39m
[2m                "-c",[22m
[2m                "VAL_INDEX=\${HOSTNAME##*-}[22m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m
[31m+[39m

[2m  if [ -f $CHAIN_DIR/config/genesis.json ]; then[22m
[2m    echo \\"Genesis file exists, exiting early\\"[22m
[33m@@ -500,7 +517,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "NAMESPACE",[22m
[33m@@ -548,11 +565,11 @@[39m
[2m              "name": "init-validator",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -597,16 +614,16 @@[39m
[2m                  },[22m
[2m                },[22m
[2m              ],[22m
[32m-             "image": "curlimages/curl",[39m
[31m+             "image": "curlimages/curl:latest",[39m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "wait-for-chains",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -618,6 +635,10 @@[39m
[2m                "name": "keys",[22m
[2m              },[22m
[2m              "name": "addresses",[22m
[31m+           },[39m
[31m+           Object {[39m
[31m+             "emptyDir": Object {},[39m
[31m+             "name": "faucet",[39m
[2m            },[22m
[2m            Object {[22m
[2m              "emptyDir": Object {},[22m

--- ConfigMap/registry-cosmoshub-4 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -7,7 +7,14 @@[39m
[2m    \\"assets\\": [[22m
[2m      {[22m
[2m        \\"base\\": \\"uatom\\",[22m
[32m-       \\"coingecko_id\\": \\"atom\\",[39m
[31m+       \\"description\\": \\"The native staking and governance token of the Cosmos Hub.\\",[39m
[31m+       \\"name\\": \\"Cosmos Hub Atom\\",[39m
[31m+       \\"display\\": \\"atom\\",[39m
[31m+       \\"symbol\\": \\"ATOM\\",[39m
[31m+       \\"logo_URIs\\": {[39m
[31m+         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/cosmoshub/images/atom.png\\",[39m
[31m+         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/cosmoshub/images/atom.svg\\"[39m
[31m+       },[39m
[2m        \\"denom_units\\": [[22m
[2m          {[22m
[2m            \\"denom\\": \\"uatom\\",[22m
[33m@@ -18,14 +25,7 @@[39m
[2m            \\"exponent\\": 6[22m
[2m          }[22m
[2m        ],[22m
[32m-       \\"description\\": \\"The native staking and governance token of the Cosmos Hub.\\",[39m
[32m-       \\"display\\": \\"atom\\",[39m
[32m-       \\"logo_URIs\\": {[39m
[32m-         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/cosmoshub/images/atom.png\\",[39m
[32m-         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/cosmoshub/images/atom.svg\\"[39m
[32m-       },[39m
[32m-       \\"name\\": \\"Cosmos Hub Atom\\",[39m
[32m-       \\"symbol\\": \\"ATOM\\"[39m
[31m+       \\"coingecko_id\\": \\"atom\\"[39m
[2m      }[22m
[2m    ][22m
[2m  }",[22m
[33m@@ -82,6 +82,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "registry",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "registry-cosmoshub-4",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "registry-cosmoshub-4",[22m
[2m    },[22m
[2m  }[22m

--- Deployment/registry ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,14 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "Deployment",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "registry",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "registry",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "registry",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +17,6 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "registry",[39m
[2m          "app.kubernetes.io/name": "registry",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -22,19 +29,17 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "registry",[39m
[31m+           "app.kubernetes.io/component": "registry",[39m
[31m+           "app.kubernetes.io/managed-by": "starship",[39m
[2m            "app.kubernetes.io/name": "registry",[22m
[32m-           "app.kubernetes.io/rawname": "registry",[39m
[32m-           "app.kubernetes.io/type": "registry",[39m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/part-of": "starship",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+           "starship.io/name": "starship-e2e-tests",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[2m          "containers": Array [[22m
[2m            Object {[22m
[32m-             "command": Array [[39m
[32m-               "registry",[39m
[32m-             ],[39m
[2m              "env": Array [[22m
[2m                Object {[22m
[2m                  "name": "NAMESPACE",[22m
[33m@@ -74,21 +79,20 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "REGISTRY_CHAIN_REGISTRY",[22m
[32m-                 "value": "/configs",[39m
[31m+                 "value": "/chains",[39m
[2m                },[22m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/registry:20250205-544757d",[22m
[32m-             "imagePullPolicy": "IfNotPresent",[39m
[2m              "livenessProbe": Object {[22m
[32m-               "initialDelaySeconds": 20,[39m
[32m-               "periodSeconds": 10,[39m
[31m+               "initialDelaySeconds": 15,[39m
[31m+               "periodSeconds": 20,[39m
[2m                "tcpSocket": Object {[22m
[2m                  "port": 8080,[22m
[2m                },[22m
[2m              },[22m
[2m              "name": "registry",[22m
[2m              "readinessProbe": Object {[22m
[32m-               "initialDelaySeconds": 20,[39m
[31m+               "initialDelaySeconds": 5,[39m
[2m                "periodSeconds": 10,[22m
[2m                "tcpSocket": Object {[22m
[2m                  "port": 8080,[22m
[33m@@ -96,22 +100,22 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[2m                Object {[22m
[32m-                 "mountPath": "/configs/cosmoshub-4",[39m
[32m-                 "name": "registry-configs-cosmoshub-4",[39m
[31m+                 "mountPath": "/chains/cosmoshub-4",[39m
[31m+                 "name": "registry-cosmoshub-4",[39m
[2m                },[22m
[2m                Object {[22m
[32m-                 "mountPath": "/configs/evmos_9000-1",[39m
[32m-                 "name": "registry-configs-evmos-9000-1",[39m
[31m+                 "mountPath": "/chains/evmos_9000-1",[39m
[31m+                 "name": "registry-evmos-9000-1",[39m
[2m                },[22m
[2m              ],[22m
[2m            },[22m
[33m@@ -126,6 +130,7 @@[39m
[2m    echo \\"Checking: http://evmos-9000-1-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id\\"[22m
[2m    sleep 10;[22m
[2m  done[22m
[31m+[39m
[2m  while [ $(curl -sw '%{http_code}' http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id -o /dev/null) -ne 200 ]; do[22m
[2m    echo \\"Genesis validator does not seem to be ready for: cosmoshub-4. Waiting for it to start...\\"[22m
[2m    echo \\"Checking: http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id\\"[22m
[33m@@ -148,16 +153,16 @@[39m
[2m                  },[22m
[2m                },[22m
[2m              ],[22m
[32m-             "image": "curlimages/curl",[39m
[31m+             "image": "curlimages/curl:latest",[39m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "wait-for-chains",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -168,13 +173,13 @@[39m
[2m              "configMap": Object {[22m
[2m                "name": "registry-cosmoshub-4",[22m
[2m              },[22m
[32m-             "name": "registry-configs-cosmoshub-4",[39m
[31m+             "name": "registry-cosmoshub-4",[39m
[2m            },[22m
[2m            Object {[22m
[2m              "configMap": Object {[22m
[2m                "name": "registry-evmos-9000-1",[22m
[2m              },[22m
[32m-             "name": "registry-configs-evmos-9000-1",[39m
[31m+             "name": "registry-evmos-9000-1",[39m
[2m            },[22m
[2m          ],[22m
[2m        },[22m

--- ConfigMap/registry-evmos-9000-1 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -7,7 +7,7 @@[39m
[2m    \\"assets\\": [[22m
[2m      {[22m
[2m        \\"base\\": \\"aevmos\\",[22m
[32m-       \\"coingecko_id\\": \\"evmos\\",[39m
[31m+       \\"description\\": \\"The native EVM, governance and staking token of the Evmos Hub\\",[39m
[2m        \\"denom_units\\": [[22m
[2m          {[22m
[2m            \\"denom\\": \\"aevmos\\",[22m
[33m@@ -18,14 +18,14 @@[39m
[2m            \\"exponent\\": 18[22m
[2m          }[22m
[2m        ],[22m
[32m-       \\"description\\": \\"The native EVM, governance and staking token of the Evmos Hub\\",[39m
[31m+       \\"name\\": \\"Evmos\\",[39m
[2m        \\"display\\": \\"evmos\\",[22m
[31m+       \\"symbol\\": \\"EVMOS\\",[39m
[2m        \\"logo_URIs\\": {[22m
[32m-         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/evmos/images/evmos.png\\",[39m
[32m-         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/evmos/images/evmos.svg\\"[39m
[31m+         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/evmos/images/evmos.svg\\",[39m
[31m+         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/evmos/images/evmos.png\\"[39m
[2m        },[22m
[32m-       \\"name\\": \\"Evmos\\",[39m
[32m-       \\"symbol\\": \\"EVMOS\\"[39m
[31m+       \\"coingecko_id\\": \\"evmos\\"[39m
[2m      }[22m
[2m    ][22m
[2m  }",[22m
[33m@@ -82,6 +82,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "registry",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "registry-evmos-9000-1",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "registry-evmos-9000-1",[22m
[2m    },[22m
[2m  }[22m

--- ConfigMap/hermes-evmos-cosmos ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -3,92 +3,45 @@[39m
[2m    "data": Object {[22m
[2m      "config-cli.toml": "# The global section has parameters that apply globally to the relayer operation.[22m
[2m  [global][22m
[32m- # Specify the verbosity for the relayer logging output. Default: 'info'[39m
[32m- # Valid options are 'error', 'warn', 'info', 'debug', 'trace'.[39m
[32m- log_level = 'info'[39m
[32m- # Specify the mode to be used by the relayer. [Required][39m
[31m+ log_level = \\"info\\"[39m
[31m+[39m
[2m  [mode][22m
[32m- # Specify the client mode.[39m
[2m  [mode.clients][22m
[32m- # Whether or not to enable the client workers. [Required][39m
[2m  enabled = true[22m
[32m- # Whether or not to enable periodic refresh of clients. [Default: true][39m
[32m- # This feature only applies to clients that underlie an open channel.[39m
[32m- # For Tendermint clients, the frequency at which Hermes refreshes them is 2/3 of their[39m
[32m- # trusting period (e.g., refresh every ~9 days if the trusting period is 14 days).[39m
[32m- # Note: Even if this is disabled, clients will be refreshed automatically if[39m
[32m- #      there is activity on a connection or channel they are involved with.[39m
[2m  refresh = true[22m
[32m- # Whether or not to enable misbehaviour detection for clients. [Default: false][39m
[2m  misbehaviour = true[22m
[32m- # Specify the connections mode.[39m
[31m+[39m
[2m  [mode.connections][22m
[32m- # Whether or not to enable the connection workers for handshake completion. [Required][39m
[2m  enabled = true[22m
[32m- # Specify the channels mode.[39m
[31m+[39m
[2m  [mode.channels][22m
[32m- # Whether or not to enable the channel workers for handshake completion. [Required][39m
[2m  enabled = true[22m
[32m- # Specify the packets mode.[39m
[31m+[39m
[2m  [mode.packets][22m
[32m- # Whether or not to enable the packet workers. [Required][39m
[2m  enabled = true[22m
[32m- # Parametrize the periodic packet clearing feature.[39m
[32m- # Interval (in number of blocks) at which pending packets[39m
[32m- # should be periodically cleared. A value of '0' will disable[39m
[32m- # periodic packet clearing. [Default: 100][39m
[2m  clear_interval = 100[22m
[32m- # Whether or not to clear packets on start. [Default: false][39m
[2m  clear_on_start = true[22m
[32m- # Toggle the transaction confirmation mechanism.[39m
[32m- # The tx confirmation mechanism periodically queries the \`/tx_search\` RPC[39m
[32m- # endpoint to check that previously-submitted transactions[39m
[32m- # (to any chain in this config file) have been successfully delivered.[39m
[32m- # If they have not been, and \`clear_interval = 0\`, then those packets are[39m
[32m- # queued up for re-submission.[39m
[32m- # Experimental feature. Affects telemetry if set to false.[39m
[32m- # [Default: true][39m
[2m  tx_confirmation = true[22m
[32m- # Auto register the counterparty payee on a destination chain to[39m
[32m- # the relayer's address on the source chain. This can be used[39m
[32m- # for simple configuration of the relayer to receive fees for[39m
[32m- # relaying RecvPacket on fee-enabled channels.[39m
[32m- # For more complex configuration, turn this off and use the CLI[39m
[32m- # to manually register the payee addresses.[39m
[32m- # [Default: false][39m
[32m- auto_register_counterparty_payee = false[39m
[32m- # The REST section defines parameters for Hermes' built-in RESTful API.[39m
[32m- # https://hermes.informal.systems/rest.html[39m
[31m+[39m
[2m  [rest][22m
[32m- # Whether or not to enable the REST service. Default: false[39m
[2m  enabled = true[22m
[32m- # Specify the IPv4/6 host over which the built-in HTTP server will serve the RESTful[39m
[32m- # API requests. Default: 127.0.0.1[39m
[32m- host =  '0.0.0.0'[39m
[32m- # Specify the port over which the built-in HTTP server will serve the restful API[39m
[32m- # requests. Default: 3000[39m
[31m+ host = \\"0.0.0.0\\"[39m
[2m  port = 3000[22m
[32m- # The telemetry section defines parameters for Hermes' built-in telemetry capabilities.[39m
[32m- # https://hermes.informal.systems/telemetry.html[39m
[31m+[39m
[2m  [telemetry][22m
[32m- # Whether or not to enable the telemetry service. Default: false[39m
[2m  enabled = true[22m
[32m- # Specify the IPv4/6 host over which the built-in HTTP server will serve the metrics[39m
[32m- # gathered by the telemetry service. Default: 127.0.0.1[39m
[32m- host = '0.0.0.0'[39m
[32m- # Specify the port over which the built-in HTTP server will serve the metrics gathered[39m
[32m- # by the telemetry service. Default: 3001[39m
[31m+ host = \\"0.0.0.0\\"[39m
[2m  port = 3001[22m
[32m-[39m


[2m  [[chains]][22m
[2m  id = \\"evmos_9000-1\\"[22m
[31m+ type = \\"CosmosSdk\\"[39m
[2m  key_name = \\"evmos_9000-1-cli\\"[22m
[32m- rpc_addr = \\"http://evmos-9000-1-genesis.default.svc.cluster.local:26657\\"[39m
[32m- grpc_addr = \\"http://evmos-9000-1-genesis.default.svc.cluster.local:9090\\"[39m
[32m- event_source = { mode = 'push', url = \\"ws://evmos-9000-1-genesis.default.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[32m- # Experimental: Whether or not the full node is trusted.[39m
[31m+[39m
[31m+ rpc_addr = \\"http://evmos-9000-1-genesis.$NAMESPACE.svc.cluster.local:26657\\"[39m
[31m+ grpc_addr = \\"http://evmos-9000-1-genesis.$NAMESPACE.svc.cluster.local:9090\\"[39m
[31m+ event_source = { mode = 'push', url = \\"ws://evmos-9000-1-genesis.$NAMESPACE.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[2m  trusted_node = false[22m
[2m  account_prefix = \\"evmos\\"[22m
[2m  default_gas = 500000000[22m
[33m@@ -105,15 +58,14 @@[39m
[2m  address_type = { derivation = 'ethermint', proto_type = { pk_type = '/ethermint.crypto.v1.ethsecp256k1.PubKey' } }[22m
[2m  gas_price = { price = 2500000, denom = \\"aevmos\\" }[22m

[32m-[39m
[32m-[39m
[2m  [[chains]][22m
[2m  id = \\"cosmoshub-4\\"[22m
[31m+ type = \\"CosmosSdk\\"[39m
[2m  key_name = \\"cosmoshub-4-cli\\"[22m
[32m- rpc_addr = \\"http://cosmoshub-4-genesis.default.svc.cluster.local:26657\\"[39m
[32m- grpc_addr = \\"http://cosmoshub-4-genesis.default.svc.cluster.local:9090\\"[39m
[32m- event_source = { mode = 'push', url = \\"ws://cosmoshub-4-genesis.default.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[32m- # Experimental: Whether or not the full node is trusted.[39m
[31m+[39m
[31m+ rpc_addr = \\"http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:26657\\"[39m
[31m+ grpc_addr = \\"http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:9090\\"[39m
[31m+ event_source = { mode = 'push', url = \\"ws://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[2m  trusted_node = false[22m
[2m  account_prefix = \\"cosmos\\"[22m
[2m  default_gas = 500000000[22m
[33m@@ -128,96 +80,48 @@[39m
[2m  trusting_period = \\"75s\\"[22m
[2m  trust_threshold = { numerator = \\"2\\", denominator = \\"3\\" }[22m
[2m  address_type = { derivation = 'cosmos' }[22m
[32m- gas_price = { price = 0.25, denom = \\"uatom\\" }",[39m
[31m+ gas_price = { price = 1.25, denom = \\"uatom\\" }",[39m
[2m      "config.toml": "# The global section has parameters that apply globally to the relayer operation.[22m
[2m  [global][22m
[32m- # Specify the verbosity for the relayer logging output. Default: 'info'[39m
[32m- # Valid options are 'error', 'warn', 'info', 'debug', 'trace'.[39m
[32m- log_level = 'info'[39m
[32m- # Specify the mode to be used by the relayer. [Required][39m
[31m+ log_level = \\"info\\"[39m
[31m+[39m
[2m  [mode][22m
[32m- # Specify the client mode.[39m
[2m  [mode.clients][22m
[32m- # Whether or not to enable the client workers. [Required][39m
[2m  enabled = true[22m
[32m- # Whether or not to enable periodic refresh of clients. [Default: true][39m
[32m- # This feature only applies to clients that underlie an open channel.[39m
[32m- # For Tendermint clients, the frequency at which Hermes refreshes them is 2/3 of their[39m
[32m- # trusting period (e.g., refresh every ~9 days if the trusting period is 14 days).[39m
[32m- # Note: Even if this is disabled, clients will be refreshed automatically if[39m
[32m- #      there is activity on a connection or channel they are involved with.[39m
[2m  refresh = true[22m
[32m- # Whether or not to enable misbehaviour detection for clients. [Default: false][39m
[2m  misbehaviour = true[22m
[32m- # Specify the connections mode.[39m
[31m+[39m
[2m  [mode.connections][22m
[32m- # Whether or not to enable the connection workers for handshake completion. [Required][39m
[2m  enabled = true[22m
[32m- # Specify the channels mode.[39m
[31m+[39m
[2m  [mode.channels][22m
[32m- # Whether or not to enable the channel workers for handshake completion. [Required][39m
[2m  enabled = true[22m
[32m- # Specify the packets mode.[39m
[31m+[39m
[2m  [mode.packets][22m
[32m- # Whether or not to enable the packet workers. [Required][39m
[2m  enabled = true[22m
[32m- # Parametrize the periodic packet clearing feature.[39m
[32m- # Interval (in number of blocks) at which pending packets[39m
[32m- # should be periodically cleared. A value of '0' will disable[39m
[32m- # periodic packet clearing. [Default: 100][39m
[2m  clear_interval = 100[22m
[32m- # Whether or not to clear packets on start. [Default: false][39m
[2m  clear_on_start = true[22m
[32m- # Toggle the transaction confirmation mechanism.[39m
[32m- # The tx confirmation mechanism periodically queries the \`/tx_search\` RPC[39m
[32m- # endpoint to check that previously-submitted transactions[39m
[32m- # (to any chain in this config file) have been successfully delivered.[39m
[32m- # If they have not been, and \`clear_interval = 0\`, then those packets are[39m
[32m- # queued up for re-submission.[39m
[32m- # Experimental feature. Affects telemetry if set to false.[39m
[32m- # [Default: true][39m
[2m  tx_confirmation = true[22m
[32m- # Auto register the counterparty payee on a destination chain to[39m
[32m- # the relayer's address on the source chain. This can be used[39m
[32m- # for simple configuration of the relayer to receive fees for[39m
[32m- # relaying RecvPacket on fee-enabled channels.[39m
[32m- # For more complex configuration, turn this off and use the CLI[39m
[32m- # to manually register the payee addresses.[39m
[32m- # [Default: false][39m
[32m- auto_register_counterparty_payee = false[39m
[32m- # The REST section defines parameters for Hermes' built-in RESTful API.[39m
[32m- # https://hermes.informal.systems/rest.html[39m
[31m+[39m
[2m  [rest][22m
[32m- # Whether or not to enable the REST service. Default: false[39m
[2m  enabled = true[22m
[32m- # Specify the IPv4/6 host over which the built-in HTTP server will serve the RESTful[39m
[32m- # API requests. Default: 127.0.0.1[39m
[32m- host =  '0.0.0.0'[39m
[32m- # Specify the port over which the built-in HTTP server will serve the restful API[39m
[32m- # requests. Default: 3000[39m
[31m+ host = \\"0.0.0.0\\"[39m
[2m  port = 3000[22m
[32m- # The telemetry section defines parameters for Hermes' built-in telemetry capabilities.[39m
[32m- # https://hermes.informal.systems/telemetry.html[39m
[31m+[39m
[2m  [telemetry][22m
[32m- # Whether or not to enable the telemetry service. Default: false[39m
[2m  enabled = true[22m
[32m- # Specify the IPv4/6 host over which the built-in HTTP server will serve the metrics[39m
[32m- # gathered by the telemetry service. Default: 127.0.0.1[39m
[32m- host = '0.0.0.0'[39m
[32m- # Specify the port over which the built-in HTTP server will serve the metrics gathered[39m
[32m- # by the telemetry service. Default: 3001[39m
[31m+ host = \\"0.0.0.0\\"[39m
[2m  port = 3001[22m
[32m-[39m


[2m  [[chains]][22m
[2m  id = \\"evmos_9000-1\\"[22m
[2m  type = \\"CosmosSdk\\"[22m
[2m  key_name = \\"evmos_9000-1\\"[22m
[32m- rpc_addr = \\"http://evmos-9000-1-genesis.default.svc.cluster.local:26657\\"[39m
[32m- grpc_addr = \\"http://evmos-9000-1-genesis.default.svc.cluster.local:9090\\"[39m
[32m- event_source = { mode = 'push', url = \\"ws://evmos-9000-1-genesis.default.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[32m- # Experimental: Whether or not the full node is trusted.[39m
[31m+[39m
[31m+ rpc_addr = \\"http://evmos-9000-1-genesis.$NAMESPACE.svc.cluster.local:26657\\"[39m
[31m+ grpc_addr = \\"http://evmos-9000-1-genesis.$NAMESPACE.svc.cluster.local:9090\\"[39m
[31m+ event_source = { mode = 'push', url = \\"ws://evmos-9000-1-genesis.$NAMESPACE.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[2m  trusted_node = false[22m
[2m  account_prefix = \\"evmos\\"[22m
[2m  default_gas = 500000000[22m
[33m@@ -234,16 +138,14 @@[39m
[2m  address_type = { derivation = 'ethermint', proto_type = { pk_type = '/ethermint.crypto.v1.ethsecp256k1.PubKey' } }[22m
[2m  gas_price = { price = 2500000, denom = \\"aevmos\\" }[22m

[32m-[39m
[32m-[39m
[2m  [[chains]][22m
[2m  id = \\"cosmoshub-4\\"[22m
[2m  type = \\"CosmosSdk\\"[22m
[2m  key_name = \\"cosmoshub-4\\"[22m
[32m- rpc_addr = \\"http://cosmoshub-4-genesis.default.svc.cluster.local:26657\\"[39m
[32m- grpc_addr = \\"http://cosmoshub-4-genesis.default.svc.cluster.local:9090\\"[39m
[32m- event_source = { mode = 'push', url = \\"ws://cosmoshub-4-genesis.default.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[32m- # Experimental: Whether or not the full node is trusted.[39m
[31m+[39m
[31m+ rpc_addr = \\"http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:26657\\"[39m
[31m+ grpc_addr = \\"http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:9090\\"[39m
[31m+ event_source = { mode = 'push', url = \\"ws://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[2m  trusted_node = false[22m
[2m  account_prefix = \\"cosmos\\"[22m
[2m  default_gas = 500000000[22m
[33m@@ -262,6 +164,15 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "relayer",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "hermes-evmos-cosmos",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/role": "hermes",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "hermes-evmos-cosmos",[22m
[2m    },[22m
[2m  }[22m

--- StatefulSet/hermes-evmos-cosmos ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,15 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "relayer",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "hermes-evmos-cosmos",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/role": "hermes",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "hermes-evmos-cosmos",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -29,16 +38,18 @@[39m
[2m            "app.kubernetes.io/name": "hermes-evmos-cosmos",[22m
[2m            "app.kubernetes.io/rawname": "evmos-cosmos",[22m
[2m            "app.kubernetes.io/type": "hermes",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[2m          "containers": Array [[22m
[2m            Object {[22m
[31m+             "args": Array [[39m
[31m+               "/exposer/exposer",[39m
[31m+             ],[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "/exposer/exposer",[39m
[2m              ],[22m
[2m              "env": Array [[22m
[2m                Object {[22m
[33m@@ -55,11 +66,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -83,14 +94,24 @@[39m
[2m              ],[22m
[2m            },[22m
[2m            Object {[22m
[31m+             "args": Array [[39m
[31m+               "RLY_INDEX=\${HOSTNAME##*-}[39m
[31m+ echo \\"Relayer Index: $RLY_INDEX\\"[39m
[31m+ hermes start",[39m
[31m+             ],[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "RLY_INDEX=\${HOSTNAME##*-}[39m
[32m- echo \\"Relayer Index: $RLY_INDEX\\"[39m
[32m- hermes start",[39m
[2m              ],[22m
[2m              "env": Array [[22m
[31m+               Object {[39m
[31m+                 "name": "NAMESPACE",[39m
[31m+                 "valueFrom": Object {[39m
[31m+                   "fieldRef": Object {[39m
[31m+                     "fieldPath": "metadata.namespace",[39m
[31m+                   },[39m
[31m+                 },[39m
[31m+               },[39m
[2m                Object {[22m
[2m                  "name": "RELAYER_DIR",[22m
[2m                  "value": "/root/.hermes",[22m
[33m@@ -101,12 +122,12 @@[39m
[2m              "name": "relayer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[2m              },[22m
[2m              "securityContext": Object {[22m
[33m@@ -127,24 +148,26 @@[39m
[2m          ],[22m
[2m          "initContainers": Array [[22m
[2m            Object {[22m
[31m+             "args": Array [[39m
[31m+               "# Install exposer binary from the image[39m
[31m+ cp /bin/exposer /exposer/exposer[39m
[31m+ chmod +x /exposer/exposer",[39m
[31m+             ],[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "# Install exposer binary from the image[39m
[32m- cp /bin/exposer /exposer/exposer[39m
[32m- chmod +x /exposer/exposer",[39m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/exposer:20250205-544757d",[22m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "init-exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "100M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "100M",[39m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[33m@@ -155,9 +178,7 @@[39m
[2m              ],[22m
[2m            },[22m
[2m            Object {[22m
[32m-             "command": Array [[39m
[32m-               "bash",[39m
[32m-               "-c",[39m
[31m+             "args": Array [[39m
[2m                "set -ux[22m

[2m  RLY_INDEX=\${HOSTNAME##*-}[22m
[33m@@ -166,18 +187,16 @@[39m
[2m  mkdir -p $RELAYER_DIR[22m
[2m  cp /configs/config.toml $RELAYER_DIR/config.toml[22m
[2m  cp /configs/config-cli.toml $RELAYER_DIR/config-cli.toml[22m
[32m- cat $RELAYER_DIR/config.toml[39m
[31m+[39m
[31m+ # Replace namespace placeholder with actual namespace environment variable[39m
[31m+ sed -i \\"s|\\\\$NAMESPACE|$NAMESPACE|g\\" $RELAYER_DIR/config.toml[39m
[31m+ sed -i \\"s|\\\\$NAMESPACE|$NAMESPACE|g\\" $RELAYER_DIR/config-cli.toml[39m

[32m- MNEMONIC=$(jq -r \\".relayers[$RELAYER_INDEX].mnemonic\\" $KEYS_CONFIG)[39m
[31m+ MNEMONIC=$(jq -r \\".relayers[$RLY_INDEX].mnemonic\\" $KEYS_CONFIG)[39m
[2m  echo $MNEMONIC > $RELAYER_DIR/mnemonic.txt[22m
[32m- MNEMONIC_CLI=$(jq -r \\".relayers_cli[$RELAYER_INDEX].mnemonic\\" $KEYS_CONFIG)[39m
[31m+ MNEMONIC_CLI=$(jq -r \\".relayers_cli[$RLY_INDEX].mnemonic\\" $KEYS_CONFIG)[39m
[2m  echo $MNEMONIC_CLI > $RELAYER_DIR/mnemonic-cli.txt[22m

[32m- echo \\"Debug output for evmos-cosmos...\\"[39m
[32m- cat << EOF[39m
[32m-               map[string]interface {}[39m
[32m-               {\\"chains\\":[\\"evmos_9000-1\\",\\"cosmoshub-4\\"],\\"channels\\":[{\\"a-chain\\":\\"evmos_9000-1\\",\\"a-port\\":\\"transfer\\",\\"b-chain\\":\\"cosmoshub-4\\",\\"b-port\\":\\"transfer\\",\\"new-connection\\":true}],\\"config\\":{\\"event_source\\":{\\"mode\\":\\"push\\"},\\"global\\":{\\"log_level\\":\\"info\\"},\\"mode\\":{\\"channels\\":{\\"enabled\\":true},\\"clients\\":{\\"enabled\\":true,\\"misbehaviour\\":true,\\"refresh\\":true},\\"connections\\":{\\"enabled\\":true},\\"packets\\":{\\"clear_interval\\":100,\\"clear_on_start\\":true,\\"enabled\\":true,\\"tx_confirmation\\":true}},\\"rest\\":{\\"enabled\\":true,\\"host\\":\\"0.0.0.0\\",\\"port\\":3000},\\"telemetry\\":{\\"enabled\\":true,\\"host\\":\\"0.0.0.0\\",\\"port\\":3001}},\\"fullname\\":\\"hermes-evmos-cosmos\\",\\"ics\\":{\\"enabled\\":false},\\"image\\":\\"ghcr.io/cosmology-tech/starship/hermes:1.10.0\\",\\"name\\":\\"evmos-cosmos\\",\\"replicas\\":1,\\"type\\":\\"hermes\\"}[39m
[32m- EOF[39m

[2m  echo \\"Creating key for evmos_9000-1...\\"[22m
[2m  hermes keys add \\\\[22m
[33m@@ -240,12 +259,17 @@[39m
[2m    $DENOM \\\\[22m
[2m    http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:8000/credit \\\\[22m
[2m    \\"true\\" || true[22m
[31m+[39m
[2m  hermes create channel \\\\[22m
[2m    --new-client-connection --yes \\\\[22m
[2m    --b-chain cosmoshub-4 \\\\[22m
[2m    --a-chain evmos_9000-1 \\\\[22m
[2m    --a-port transfer \\\\[22m
[2m    --b-port transfer",[22m
[31m+             ],[39m
[31m+             "command": Array [[39m
[31m+               "bash",[39m
[31m+               "-c",[39m
[2m              ],[22m
[2m              "env": Array [[22m
[2m                Object {[22m
[33m@@ -266,7 +290,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "RELAYER_INDEX",[22m
[32m-                 "value": "0",[39m
[31m+                 "value": "\${HOSTNAME##*-}",[39m
[2m                },[22m
[2m              ],[22m
[2m              "image": "ghcr.io/cosmology-tech/starship/hermes:1.10.0",[22m
[33m@@ -274,12 +298,12 @@[39m
[2m              "name": "init-relayer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[33m@@ -310,6 +334,7 @@[39m
[2m    echo \\"Checking: http://evmos-9000-1-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id\\"[22m
[2m    sleep 10;[22m
[2m  done[22m
[31m+[39m
[2m  while [ $(curl -sw '%{http_code}' http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id -o /dev/null) -ne 200 ]; do[22m
[2m    echo \\"Genesis validator does not seem to be ready for: cosmoshub-4. Waiting for it to start...\\"[22m
[2m    echo \\"Checking: http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id\\"[22m
[33m@@ -332,16 +357,16 @@[39m
[2m                  },[22m
[2m                },[22m
[2m              ],[22m
[32m-             "image": "curlimages/curl",[39m
[31m+             "image": "curlimages/curl:latest",[39m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "wait-for-chains",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m"
`;

exports[`Manifest Comparison Tests Individual Config Comparisons should generate manifests for hyperweb that match the snapshot 1`] = `
"ðŸ”„ MODIFIED_RESOURCES:

--- ConfigMap/keys ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -98,6 +98,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "configmap",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "keys",[39m
[31m+       "app.kubernetes.io/part-of": "global",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "keys",[22m
[2m    },[22m
[2m  }[22m

--- ConfigMap/setup-scripts ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -208,6 +208,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "configmap",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts",[39m
[31m+       "app.kubernetes.io/part-of": "global",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts",[22m
[2m    },[22m
[2m  }[22m

--- Deployment/playground ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,14 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "Deployment",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "frontend",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "playground",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "playground",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -23,56 +31,25 @@[39m
[2m          },[22m
[2m          "labels": Object {[22m
[2m            "app.kubernetes.io/instance": "playground",[22m
[31m+           "app.kubernetes.io/managed-by": "starship",[39m
[2m            "app.kubernetes.io/name": "playground",[22m
[32m-           "app.kubernetes.io/rawname": "playground",[39m
[2m            "app.kubernetes.io/type": "custom",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+           "starship.io/name": "starship-e2e-tests",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[2m          "containers": Array [[22m
[32m-           Object {[39m
[32m-             "env": Array [[39m
[32m-               Object {[39m
[32m-                 "name": "CHAIN_FAUCET_URL",[39m
[32m-                 "value": "http://localhost:8000",[39m
[32m-               },[39m
[2m            Object {[22m
[32m-                 "name": "CHAIN_RPC_URL",[39m
[32m-                 "value": "http://localhost:26657",[39m
[32m-               },[39m
[32m-               Object {[39m
[32m-                 "name": "NAMESPACE",[39m
[32m-                 "valueFrom": Object {[39m
[32m-                   "fieldRef": Object {[39m
[32m-                     "fieldPath": "metadata.namespace",[39m
[32m-                   },[39m
[32m-                 },[39m
[32m-               },[39m
[32m-               Object {[39m
[32m-                 "name": "REGISTRY_REST_URL",[39m
[32m-                 "value": "http://localhost:8081",[39m
[32m-               },[39m
[32m-               Object {[39m
[32m-                 "name": "S3_BUCKET_URL",[39m
[32m-                 "value": "https://hyperweb-playground.s3.amazonaws.com/create-hyperweb-app",[39m
[32m-               },[39m
[32m-               Object {[39m
[32m-                 "name": "S3_TARBALL_NAME",[39m
[32m-                 "value": "latest.tar.gz",[39m
[31m+             "env": Object {[39m
[31m+               "CHAIN_FAUCET_URL": "http://localhost:8000",[39m
[31m+               "CHAIN_RPC_URL": "http://localhost:26657",[39m
[31m+               "REGISTRY_REST_URL": "http://localhost:8081",[39m
[31m+               "S3_BUCKET_URL": "https://hyperweb-playground.s3.amazonaws.com/create-hyperweb-app",[39m
[31m+               "S3_TARBALL_NAME": "latest.tar.gz",[39m
[2m              },[22m
[32m-             ],[39m
[2m              "image": "ghcr.io/hyperweb-io/hyperweb-playground:latest",[22m
[2m              "imagePullPolicy": "Always",[22m
[32m-             "livenessProbe": Object {[39m
[32m-               "failureThreshold": 3,[39m
[32m-               "initialDelaySeconds": 20,[39m
[32m-               "periodSeconds": 10,[39m
[32m-               "tcpSocket": Object {[39m
[32m-                 "port": "http",[39m
[32m-               },[39m
[32m-               "timeoutSeconds": 5,[39m
[32m-             },[39m
[2m              "name": "playground",[22m
[2m              "ports": Array [[22m
[2m                Object {[22m
[33m@@ -81,16 +58,16 @@[39m
[2m                  "protocol": "TCP",[22m
[2m                },[22m
[2m              ],[22m
[32m-             "readinessProbe": Object {[39m
[32m-               "failureThreshold": 3,[39m
[32m-               "initialDelaySeconds": 20,[39m
[32m-               "periodSeconds": 10,[39m
[32m-               "tcpSocket": Object {[39m
[32m-                 "port": "http",[39m
[31m+             "resources": Object {[39m
[31m+               "limits": Object {[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[32m-               "timeoutSeconds": 5,[39m
[31m+               "requests": Object {[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[32m-             "resources": null,[39m
[31m+             },[39m
[2m            },[22m
[2m          ],[22m
[2m        },[22m

--- StatefulSet/test-hyperweb-1-genesis ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,18 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/id": "test-hyperweb-1",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "test-hyperweb-1-genesis",[39m
[31m+       "app.kubernetes.io/part-of": "test-hyperweb-1",[39m
[31m+       "app.kubernetes.io/role": "genesis",[39m
[31m+       "app.kubernetes.io/type": "test-hyperweb-1-statefulset",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-name": "hyperweb",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "test-hyperweb-1-genesis",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +21,7 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "hyperweb",[39m
[31m+         "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m          "app.kubernetes.io/name": "test-hyperweb-1-genesis",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -23,11 +35,12 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "hyperweb",[39m
[31m+           "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m            "app.kubernetes.io/name": "test-hyperweb-1-genesis",[22m
[2m            "app.kubernetes.io/rawname": "test-hyperweb-1",[22m
[31m+           "app.kubernetes.io/role": "genesis",[39m
[2m            "app.kubernetes.io/type": "test-hyperweb-1",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[33m@@ -91,11 +104,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -184,12 +197,12 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[32m-                 "memory": "200M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "128M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[32m-                 "memory": "200M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "128M",[39m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[33m@@ -211,7 +224,12 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "START_ARGS=\\"\\"[39m
[31m+               "#!/bin/bash[39m
[31m+ set -euo pipefail[39m
[31m+[39m
[31m+ START_ARGS=\\"\\"[39m
[31m+[39m
[31m+[39m
[2m  $CHAIN_BIN start $START_ARGS",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -274,11 +292,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -307,6 +325,7 @@[39m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m

[2m  echo \\"Running setup config script...\\"[22m
[31m+[39m
[2m  bash -e /scripts/update-config.sh",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -348,7 +367,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "TIME_IOTA_MS",[22m
[33m@@ -388,11 +407,11 @@[39m
[2m              "name": "init-config",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -415,20 +434,18 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "# Install faucet binary from the image[39m
[32m- cp /bin/faucet /faucet/faucet[39m
[32m- chmod +x /faucet/faucet",[39m
[31m+               "cp /bin/faucet /faucet/faucet && chmod +x /faucet/faucet",[39m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/faucet:20250325-2207109",[22m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "init-faucet",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -553,11 +570,11 @@[39m
[2m              "name": "init-genesis",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m

--- ConfigMap/setup-scripts-test-hyperweb-1 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -608,6 +608,17 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts-test-hyperweb-1",[39m
[31m+       "app.kubernetes.io/part-of": "test-hyperweb-1",[39m
[31m+       "app.kubernetes.io/role": "setup-scripts",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-id": "test-hyperweb-1",[39m
[31m+       "starship.io/chain-name": "hyperweb",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts-test-hyperweb-1",[22m
[2m    },[22m
[2m  }[22m

--- Service/test-hyperweb-1-validator ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -23,6 +23,12 @@[39m
[2m          "targetPort": 8081,[22m
[2m        },[22m
[2m        Object {[22m
[31m+         "name": "faucet",[39m
[31m+         "port": 8000,[39m
[31m+         "protocol": "TCP",[39m
[31m+         "targetPort": 8000,[39m
[31m+       },[39m
[31m+       Object {[39m
[2m          "name": "grpc",[22m
[2m          "port": 9090,[22m
[2m          "protocol": "TCP",[22m

--- StatefulSet/test-hyperweb-1-validator ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,18 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/id": "test-hyperweb-1",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "test-hyperweb-1-validator",[39m
[31m+       "app.kubernetes.io/part-of": "test-hyperweb-1",[39m
[31m+       "app.kubernetes.io/role": "validator",[39m
[31m+       "app.kubernetes.io/type": "test-hyperweb-1-statefulset",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-name": "hyperweb",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "test-hyperweb-1-validator",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -10,7 +22,7 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "hyperweb",[39m
[31m+         "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m          "app.kubernetes.io/name": "test-hyperweb-1-validator",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -24,10 +36,11 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "hyperweb",[39m
[31m+           "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m            "app.kubernetes.io/name": "test-hyperweb-1-validator",[22m
[31m+           "app.kubernetes.io/role": "validator",[39m
[2m            "app.kubernetes.io/type": "test-hyperweb-1",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[33m@@ -119,11 +132,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -145,7 +158,9 @@[39m
[2m                "set -eux[22m
[2m  START_ARGS=\\"\\"[22m

[31m+[39m
[2m  # Starting the chain[22m
[31m+[39m
[2m  $CHAIN_BIN start $START_ARGS",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -255,11 +270,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -286,6 +301,7 @@[39m
[2m                "-c",[22m
[2m                "VAL_INDEX=\${HOSTNAME##*-}[22m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m
[31m+[39m

[2m  echo \\"Running setup config script...\\"[22m
[2m  bash -e /scripts/update-config.sh[22m
[33m@@ -351,7 +367,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "NAMESPACE",[22m
[33m@@ -399,11 +415,11 @@[39m
[2m              "name": "init-config",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -428,6 +444,7 @@[39m
[2m                "-c",[22m
[2m                "VAL_INDEX=\${HOSTNAME##*-}[22m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m
[31m+[39m

[2m  if [ -f $CHAIN_DIR/config/genesis.json ]; then[22m
[2m    echo \\"Genesis file exists, exiting early\\"[22m
[33m@@ -500,7 +517,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "NAMESPACE",[22m
[33m@@ -548,11 +565,11 @@[39m
[2m              "name": "init-validator",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -597,16 +614,16 @@[39m
[2m                  },[22m
[2m                },[22m
[2m              ],[22m
[32m-             "image": "curlimages/curl",[39m
[31m+             "image": "curlimages/curl:latest",[39m
[2m              "imagePullPolicy": "Always",[22m
[2m              "name": "wait-for-chains",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -618,6 +635,10 @@[39m
[2m                "name": "keys",[22m
[2m              },[22m
[2m              "name": "addresses",[22m
[31m+           },[39m
[31m+           Object {[39m
[31m+             "emptyDir": Object {},[39m
[31m+             "name": "faucet",[39m
[2m            },[22m
[2m            Object {[22m
[2m              "emptyDir": Object {},[22m

--- Deployment/registry ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,14 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "Deployment",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "registry",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "registry",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "registry",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +17,6 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "registry",[39m
[2m          "app.kubernetes.io/name": "registry",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -22,19 +29,17 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "registry",[39m
[31m+           "app.kubernetes.io/component": "registry",[39m
[31m+           "app.kubernetes.io/managed-by": "starship",[39m
[2m            "app.kubernetes.io/name": "registry",[22m
[32m-           "app.kubernetes.io/rawname": "registry",[39m
[32m-           "app.kubernetes.io/type": "registry",[39m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/part-of": "starship",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+           "starship.io/name": "starship-e2e-tests",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[2m          "containers": Array [[22m
[2m            Object {[22m
[32m-             "command": Array [[39m
[32m-               "registry",[39m
[32m-             ],[39m
[2m              "env": Array [[22m
[2m                Object {[22m
[2m                  "name": "NAMESPACE",[22m
[33m@@ -74,21 +79,20 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "REGISTRY_CHAIN_REGISTRY",[22m
[32m-                 "value": "/configs",[39m
[31m+                 "value": "/chains",[39m
[2m                },[22m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/registry:20250205-544757d",[22m
[32m-             "imagePullPolicy": "Always",[39m
[2m              "livenessProbe": Object {[22m
[32m-               "initialDelaySeconds": 20,[39m
[32m-               "periodSeconds": 10,[39m
[31m+               "initialDelaySeconds": 15,[39m
[31m+               "periodSeconds": 20,[39m
[2m                "tcpSocket": Object {[22m
[2m                  "port": 8080,[22m
[2m                },[22m
[2m              },[22m
[2m              "name": "registry",[22m
[2m              "readinessProbe": Object {[22m
[32m-               "initialDelaySeconds": 20,[39m
[31m+               "initialDelaySeconds": 5,[39m
[2m                "periodSeconds": 10,[22m
[2m                "tcpSocket": Object {[22m
[2m                  "port": 8080,[22m
[33m@@ -96,18 +100,18 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[2m                Object {[22m
[32m-                 "mountPath": "/configs/test-hyperweb-1",[39m
[32m-                 "name": "registry-configs-test-hyperweb-1",[39m
[31m+                 "mountPath": "/chains/test-hyperweb-1",[39m
[31m+                 "name": "registry-test-hyperweb-1",[39m
[2m                },[22m
[2m              ],[22m
[2m            },[22m
[33m@@ -139,16 +143,16 @@[39m
[2m                  },[22m
[2m                },[22m
[2m              ],[22m
[32m-             "image": "curlimages/curl",[39m
[31m+             "image": "curlimages/curl:latest",[39m
[2m              "imagePullPolicy": "Always",[22m
[2m              "name": "wait-for-chains",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -159,7 +163,7 @@[39m
[2m              "configMap": Object {[22m
[2m                "name": "registry-test-hyperweb-1",[22m
[2m              },[22m
[32m-             "name": "registry-configs-test-hyperweb-1",[39m
[31m+             "name": "registry-test-hyperweb-1",[39m
[2m            },[22m
[2m          ],[22m
[2m        },[22m

--- ConfigMap/registry-test-hyperweb-1 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -7,7 +7,14 @@[39m
[2m    \\"assets\\": [[22m
[2m      {[22m
[2m        \\"base\\": \\"uhyper\\",[22m
[32m-       \\"coingecko_id\\": \\"hyper\\",[39m
[31m+       \\"description\\": \\"The meme coin for Hyperweb chain.\\",[39m
[31m+       \\"name\\": \\"Hyper\\",[39m
[31m+       \\"display\\": \\"hyper\\",[39m
[31m+       \\"symbol\\": \\"HYPR\\",[39m
[31m+       \\"logo_URIs\\": {[39m
[31m+         \\"png\\": \\"https://gist.githubusercontent.com/Anmol1696/bea1b3835dfb0fce3ab9ed993f5a0792/raw/7065493384a51c888752284be7c1afbf6135b50a/logo-png.png\\",[39m
[31m+         \\"svg\\": \\"https://gist.githubusercontent.com/Anmol1696/bea1b3835dfb0fce3ab9ed993f5a0792/raw/7065493384a51c888752284be7c1afbf6135b50a/logo-svg.svg\\"[39m
[31m+       },[39m
[2m        \\"denom_units\\": [[22m
[2m          {[22m
[2m            \\"denom\\": \\"uhyper\\",[22m
[33m@@ -18,17 +25,10 @@[39m
[2m            \\"exponent\\": 6[22m
[2m          }[22m
[2m        ],[22m
[32m-       \\"description\\": \\"The meme coin for Hyperweb chain.\\",[39m
[32m-       \\"display\\": \\"hyper\\",[39m
[31m+       \\"coingecko_id\\": \\"hyper\\",[39m
[2m        \\"keywords\\": [[22m
[2m          \\"hyper\\"[22m
[32m-       ],[39m
[32m-       \\"logo_URIs\\": {[39m
[32m-         \\"png\\": \\"https://gist.githubusercontent.com/Anmol1696/bea1b3835dfb0fce3ab9ed993f5a0792/raw/7065493384a51c888752284be7c1afbf6135b50a/logo-png.png\\",[39m
[32m-         \\"svg\\": \\"https://gist.githubusercontent.com/Anmol1696/bea1b3835dfb0fce3ab9ed993f5a0792/raw/7065493384a51c888752284be7c1afbf6135b50a/logo-svg.svg\\"[39m
[32m-       },[39m
[32m-       \\"name\\": \\"Hyper\\",[39m
[32m-       \\"symbol\\": \\"HYPR\\"[39m
[31m+       ][39m
[2m      }[22m
[2m    ][22m
[2m  }",[22m
[33m@@ -85,6 +85,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "registry",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "registry-test-hyperweb-1",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "registry-test-hyperweb-1",[22m
[2m    },[22m
[2m  }[22m"
`;

exports[`Manifest Comparison Tests Individual Config Comparisons should generate manifests for injective that match the snapshot 1`] = `
"ðŸ”„ MODIFIED_RESOURCES:

--- ConfigMap/keys ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -98,6 +98,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "configmap",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "keys",[39m
[31m+       "app.kubernetes.io/part-of": "global",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "keys",[22m
[2m    },[22m
[2m  }[22m

--- ConfigMap/setup-scripts ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -208,6 +208,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "configmap",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts",[39m
[31m+       "app.kubernetes.io/part-of": "global",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts",[22m
[2m    },[22m
[2m  }[22m

--- StatefulSet/cosmoshub-4-genesis ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,18 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/id": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "cosmoshub-4-genesis",[39m
[31m+       "app.kubernetes.io/part-of": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/role": "genesis",[39m
[31m+       "app.kubernetes.io/type": "cosmoshub-4-statefulset",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-name": "cosmoshub",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "cosmoshub-4-genesis",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +21,7 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "cosmoshub",[39m
[31m+         "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m          "app.kubernetes.io/name": "cosmoshub-4-genesis",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -23,11 +35,12 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "cosmoshub",[39m
[31m+           "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m            "app.kubernetes.io/name": "cosmoshub-4-genesis",[22m
[2m            "app.kubernetes.io/rawname": "cosmoshub-4",[22m
[31m+           "app.kubernetes.io/role": "genesis",[39m
[2m            "app.kubernetes.io/type": "cosmoshub-4",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[33m@@ -91,11 +104,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -184,12 +197,12 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[32m-                 "memory": "200M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "128M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[32m-                 "memory": "200M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "128M",[39m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[33m@@ -211,7 +224,12 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "START_ARGS=\\"\\"[39m
[31m+               "#!/bin/bash[39m
[31m+ set -euo pipefail[39m
[31m+[39m
[31m+ START_ARGS=\\"\\"[39m
[31m+[39m
[31m+[39m
[2m  $CHAIN_BIN start $START_ARGS",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -274,11 +292,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -307,6 +325,7 @@[39m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m

[2m  echo \\"Running setup config script...\\"[22m
[31m+[39m
[2m  bash -e /scripts/update-config.sh",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -348,7 +367,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "TIME_IOTA_MS",[22m
[33m@@ -388,11 +407,11 @@[39m
[2m              "name": "init-config",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -415,20 +434,18 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "# Install faucet binary from the image[39m
[32m- cp /bin/faucet /faucet/faucet[39m
[32m- chmod +x /faucet/faucet",[39m
[31m+               "cp /bin/faucet /faucet/faucet && chmod +x /faucet/faucet",[39m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/faucet:20250325-2207109",[22m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "init-faucet",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -553,11 +570,11 @@[39m
[2m              "name": "init-genesis",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m

--- ConfigMap/setup-scripts-cosmoshub-4 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -608,6 +608,17 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts-cosmoshub-4",[39m
[31m+       "app.kubernetes.io/part-of": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/role": "setup-scripts",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-id": "cosmoshub-4",[39m
[31m+       "starship.io/chain-name": "cosmoshub",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts-cosmoshub-4",[22m
[2m    },[22m
[2m  }[22m

--- StatefulSet/injective-1-genesis ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,18 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/id": "injective-1",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "injective-1-genesis",[39m
[31m+       "app.kubernetes.io/part-of": "injective-1",[39m
[31m+       "app.kubernetes.io/role": "genesis",[39m
[31m+       "app.kubernetes.io/type": "injective-1-statefulset",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-name": "injective",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "injective-1-genesis",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +21,7 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "injective",[39m
[31m+         "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m          "app.kubernetes.io/name": "injective-1-genesis",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -23,11 +35,12 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "injective",[39m
[31m+           "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m            "app.kubernetes.io/name": "injective-1-genesis",[22m
[2m            "app.kubernetes.io/rawname": "injective-1",[22m
[31m+           "app.kubernetes.io/role": "genesis",[39m
[2m            "app.kubernetes.io/type": "injective-1",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[33m@@ -91,11 +104,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -184,12 +197,12 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[32m-                 "memory": "200M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "128M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[32m-                 "memory": "200M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "128M",[39m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[33m@@ -211,7 +224,12 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "START_ARGS=\\"\\"[39m
[31m+               "#!/bin/bash[39m
[31m+ set -euo pipefail[39m
[31m+[39m
[31m+ START_ARGS=\\"\\"[39m
[31m+[39m
[31m+[39m
[2m  $CHAIN_BIN start $START_ARGS",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -274,11 +292,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -307,6 +325,7 @@[39m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m

[2m  echo \\"Running setup config script...\\"[22m
[31m+[39m
[2m  bash -e /scripts/update-config.sh",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -348,7 +367,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "TIME_IOTA_MS",[22m
[33m@@ -388,11 +407,11 @@[39m
[2m              "name": "init-config",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -415,20 +434,18 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "# Install faucet binary from the image[39m
[32m- cp /bin/faucet /faucet/faucet[39m
[32m- chmod +x /faucet/faucet",[39m
[31m+               "cp /bin/faucet /faucet/faucet && chmod +x /faucet/faucet",[39m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/faucet:20250325-2207109",[22m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "init-faucet",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -553,11 +570,11 @@[39m
[2m              "name": "init-genesis",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m

--- ConfigMap/setup-scripts-injective-1 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -87,122 +87,6 @@[39m

[2m  echo \\"$json\\" | jq -r .result[22m
[2m  exit 0",[22m
[32m-     "create-genesis.sh": "#!/bin/bash[39m
[32m-[39m
[32m- DENOM=\\"\${DENOM:=uosmo}\\"[39m
[32m- COINS=\\"\${COINS:=100000000000000000inj}\\"[39m
[32m- CHAIN_ID=\\"\${CHAIN_ID:=injective}\\"[39m
[32m- CHAIN_BIN=\\"\${CHAIN_BIN:=injectived}\\"[39m
[32m- CHAIN_DIR=\\"\${CHAIN_DIR:=$HOME/.injectived}\\"[39m
[32m- KEYS_CONFIG=\\"\${KEYS_CONFIG:=configs/keys.json}\\"[39m
[32m-[39m
[32m- FEEDADMIN=\\"inj1k2z3chspuk9wsufle69svmtmnlc07rvw9djya7\\"[39m
[32m-[39m
[32m- set -eu[39m
[32m-[39m
[32m- # check if the binary has genesis subcommand or not, if not, set CHAIN_GENESIS_CMD to empty[39m
[32m- CHAIN_GENESIS_CMD=$($CHAIN_BIN 2>&1 | grep -q \\"genesis-related subcommands\\" && echo \\"genesis\\" || echo \\"\\")[39m
[32m-[39m
[32m- jq -r \\".genesis[0].mnemonic\\" $KEYS_CONFIG | $CHAIN_BIN init $CHAIN_ID --chain-id $CHAIN_ID --recover[39m
[32m-[39m
[32m- WASM_KEY=\\"wasm\\"[39m
[32m- WASM_MNEMONIC=\\"juice dog over thing anger search film document sight fork enrich jungle vacuum grab more sunset winner diesel flock smooth route impulse cheap toward\\"[39m
[32m-[39m
[32m- VAL_KEY=\\"localkey\\"[39m
[32m- VAL_MNEMONIC=\\"gesture inject test cycle original hollow east ridge hen combine junk child bacon zero hope comfort vacuum milk pitch cage oppose unhappy lunar seat\\"[39m
[32m-[39m
[32m- USER1_KEY=\\"user1\\"[39m
[32m- USER1_MNEMONIC=\\"copper push brief egg scan entry inform record adjust fossil boss egg comic alien upon aspect dry avoid interest fury window hint race symptom\\"[39m
[32m-[39m
[32m- USER2_KEY=\\"user2\\"[39m
[32m- USER2_MNEMONIC=\\"maximum display century economy unlock van census kite error heart snow filter midnight usage egg venture cash kick motor survey drastic edge muffin visual\\"[39m
[32m-[39m
[32m- USER3_KEY=\\"user3\\"[39m
[32m- USER3_MNEMONIC=\\"keep liar demand upon shed essence tip undo eagle run people strong sense another salute double peasant egg royal hair report winner student diamond\\"[39m
[32m-[39m
[32m- USER4_KEY=\\"user4\\"[39m
[32m- USER4_MNEMONIC=\\"pony glide frown crisp unfold lawn cup loan trial govern usual matrix theory wash fresh address pioneer between meadow visa buffalo keep gallery swear\\"[39m
[32m-[39m
[32m- USER5_KEY=\\"ocrfeedadmin\\"[39m
[32m- USER5_MNEMONIC=\\"earn front swamp dune level clip shell aware apple spare faith upset flip local regret loud suspect view heavy raccoon satisfy cupboard harbor basic\\"[39m
[32m-[39m
[32m- USER6_KEY=\\"signer1\\"[39m
[32m- USER6_MNEMONIC=\\"output arrange offer advance egg point office silent diamond fame heart hotel rocket sheriff resemble couple race crouch kit laptop document grape drastic lumber\\"[39m
[32m-[39m
[32m- USER7_KEY=\\"signer2\\"[39m
[32m- USER7_MNEMONIC=\\"velvet gesture rule caution injury stick property decorate raccoon physical narrow tuition address drum shoot pyramid record sport include rich actress sadness crater seek\\"[39m
[32m-[39m
[32m- USER8_KEY=\\"signer3\\"[39m
[32m- USER8_MNEMONIC=\\"guitar parrot nuclear sun blue marble amazing extend solar device address better chalk shock street absent follow notice female picnic into trade brass couch\\"[39m
[32m-[39m
[32m- USER9_KEY=\\"signer4\\"[39m
[32m- USER9_MNEMONIC=\\"rotate fame stamp size inform hurdle match stick brain shrimp fancy clinic soccer fortune photo gloom wear punch shed diet celery blossom tide bulk\\"[39m
[32m-[39m
[32m- USER10_KEY=\\"signer5\\"[39m
[32m- USER10_MNEMONIC=\\"apart acid night more advance december weather expect pause taxi reunion eternal crater crew lady chaos visual dynamic friend match glow flash couple tumble\\"[39m
[32m-[39m
[32m- NEWLINE=$'\\\\n'[39m
[32m-[39m
[32m- # Import keys from mnemonics[39m
[32m- echo \\"$WASM_MNEMONIC\\" | $CHAIN_BIN keys add $WASM_KEY --recover --keyring-backend=\\"test\\"[39m
[32m- yes \\"$VAL_MNEMONIC\\" | $CHAIN_BIN keys add $VAL_KEY --recover --keyring-backend=\\"test\\"[39m
[32m- yes \\"$USER1_MNEMONIC\\" | $CHAIN_BIN keys add $USER1_KEY --recover --keyring-backend=\\"test\\"[39m
[32m- yes \\"$USER2_MNEMONIC\\" | $CHAIN_BIN keys add $USER2_KEY --recover --keyring-backend=\\"test\\"[39m
[32m- yes \\"$USER3_MNEMONIC\\" | $CHAIN_BIN keys add $USER3_KEY --recover --keyring-backend=\\"test\\"[39m
[32m- yes \\"$USER4_MNEMONIC\\" | $CHAIN_BIN keys add $USER4_KEY --recover --keyring-backend=\\"test\\"[39m
[32m- yes \\"$USER5_MNEMONIC\\" | $CHAIN_BIN keys add $USER5_KEY --recover --keyring-backend=\\"test\\"[39m
[32m- yes \\"$USER6_MNEMONIC\\" | $CHAIN_BIN keys add $USER6_KEY --recover --keyring-backend=\\"test\\"[39m
[32m- yes \\"$USER7_MNEMONIC\\" | $CHAIN_BIN keys add $USER7_KEY --recover --keyring-backend=\\"test\\"[39m
[32m- yes \\"$USER8_MNEMONIC\\" | $CHAIN_BIN keys add $USER8_KEY --recover --keyring-backend=\\"test\\"[39m
[32m- yes \\"$USER9_MNEMONIC\\" | $CHAIN_BIN keys add $USER9_KEY --recover --keyring-backend=\\"test\\"[39m
[32m- yes \\"$USER10_MNEMONIC\\" | $CHAIN_BIN keys add $USER10_KEY --recover --keyring-backend=\\"test\\"[39m
[32m-[39m
[32m- # Add genesis keys to the keyring and self delegate initial coins[39m
[32m- echo \\"Adding key....\\" $(jq -r \\".genesis[0].name\\" $KEYS_CONFIG)[39m
[32m- jq -r \\".genesis[0].mnemonic\\" $KEYS_CONFIG | $CHAIN_BIN keys add $(jq -r \\".genesis[0].name\\" $KEYS_CONFIG) --recover --keyring-backend=\\"test\\"[39m
[32m- $CHAIN_BIN $CHAIN_GENESIS_CMD add-genesis-account --chain-id $CHAIN_ID $($CHAIN_BIN keys show -a $(jq -r .genesis[0].name $KEYS_CONFIG) --keyring-backend=\\"test\\") 1000000000000000000000000inj,1000000000000000000000000atom,100000000000000000000000000peggy0xdAC17F958D2ee523a2206206994597C13D831ec7,100000000000000000000000000peggy0x2260FAC5E5542a773Aa44fBCfeDf7C193bc2C599 --keyring-backend=\\"test\\"[39m
[32m-[39m
[32m- # Add relayer keys to the keyring and self delegate initial coins[39m
[32m- echo \\"Adding key....\\" $(jq -r \\".relayers[0].name\\" $KEYS_CONFIG)[39m
[32m- jq -r \\".relayers[0].mnemonic\\" $KEYS_CONFIG | $CHAIN_BIN keys add $(jq -r \\".relayers[0].name\\" $KEYS_CONFIG) --recover --keyring-backend=\\"test\\"[39m
[32m- $CHAIN_BIN $CHAIN_GENESIS_CMD add-genesis-account --chain-id $CHAIN_ID $($CHAIN_BIN keys show -a $(jq -r .relayers[0].name $KEYS_CONFIG) --keyring-backend=\\"test\\") 1000000000000000000000000inj --keyring-backend=\\"test\\"[39m
[32m-[39m
[32m- # Add faucet keys to the keyring and self delegate initial coins[39m
[32m- echo \\"Adding key....\\" $(jq -r \\".faucet[0].name\\" $KEYS_CONFIG)[39m
[32m- jq -r \\".faucet[0].mnemonic\\" $KEYS_CONFIG | $CHAIN_BIN keys add $(jq -r \\".faucet[0].name\\" $KEYS_CONFIG) --recover --keyring-backend=\\"test\\"[39m
[32m- $CHAIN_BIN $CHAIN_GENESIS_CMD add-genesis-account --chain-id $CHAIN_ID $($CHAIN_BIN keys show -a $(jq -r .faucet[0].name $KEYS_CONFIG) --keyring-backend=\\"test\\") 1000000000000000000000000inj --keyring-backend=\\"test\\"[39m
[32m-[39m
[32m-[39m
[32m- # zero address account[39m
[32m- $CHAIN_BIN add-genesis-account --chain-id $CHAIN_ID inj1qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqe2hm49 1inj[39m
[32m-[39m
[32m- # Allocate genesis accounts (cosmos formatted addresses)[39m
[32m- $CHAIN_BIN add-genesis-account --chain-id $CHAIN_ID $($CHAIN_BIN keys show $WASM_KEY -a --keyring-backend=\\"test\\") 1000000000000000000000inj --keyring-backend=\\"test\\"[39m
[32m- $CHAIN_BIN add-genesis-account --chain-id $CHAIN_ID $($CHAIN_BIN keys show $VAL_KEY -a --keyring-backend=\\"test\\") 1000000000000000000000inj --keyring-backend=\\"test\\"[39m
[32m- $CHAIN_BIN add-genesis-account --chain-id $CHAIN_ID $($CHAIN_BIN keys show $USER1_KEY -a --keyring-backend=\\"test\\") 1000000000000000000000inj,1000000000000000000000atom,100000000000000000000000000peggy0xdAC17F958D2ee523a2206206994597C13D831ec7,100000000000000000000000000peggy0x2260FAC5E5542a773Aa44fBCfeDf7C193bc2C599 --keyring-backend=\\"test\\"[39m
[32m- $CHAIN_BIN add-genesis-account --chain-id $CHAIN_ID $($CHAIN_BIN keys show $USER2_KEY -a --keyring-backend=\\"test\\") 1000000000000000000000inj,100000000000000000000000000peggy0xdAC17F958D2ee523a2206206994597C13D831ec7,100000000000000000000000000peggy0x2260FAC5E5542a773Aa44fBCfeDf7C193bc2C599 --keyring-backend=\\"test\\"[39m
[32m- $CHAIN_BIN add-genesis-account --chain-id $CHAIN_ID $($CHAIN_BIN keys show $USER3_KEY -a --keyring-backend=\\"test\\") 1000000000000000000000inj --keyring-backend=\\"test\\"[39m
[32m- $CHAIN_BIN add-genesis-account --chain-id $CHAIN_ID $($CHAIN_BIN keys show $USER4_KEY -a --keyring-backend=\\"test\\") 1000000000000000000000inj --keyring-backend=\\"test\\"[39m
[32m- $CHAIN_BIN add-genesis-account --chain-id $CHAIN_ID $($CHAIN_BIN keys show $USER5_KEY -a --keyring-backend=\\"test\\") 100000000000000000000000000inj --keyring-backend=\\"test\\"[39m
[32m- $CHAIN_BIN add-genesis-account --chain-id $CHAIN_ID $($CHAIN_BIN keys show $USER6_KEY -a --keyring-backend=\\"test\\") 100000000000000000000000000inj --keyring-backend=\\"test\\"[39m
[32m- $CHAIN_BIN add-genesis-account --chain-id $CHAIN_ID $($CHAIN_BIN keys show $USER7_KEY -a --keyring-backend=\\"test\\") 100000000000000000000000000inj --keyring-backend=\\"test\\"[39m
[32m- $CHAIN_BIN add-genesis-account --chain-id $CHAIN_ID $($CHAIN_BIN keys show $USER8_KEY -a --keyring-backend=\\"test\\") 100000000000000000000000000inj --keyring-backend=\\"test\\"[39m
[32m- $CHAIN_BIN add-genesis-account --chain-id $CHAIN_ID $($CHAIN_BIN keys show $USER9_KEY -a --keyring-backend=\\"test\\") 100000000000000000000000000inj --keyring-backend=\\"test\\"[39m
[32m- $CHAIN_BIN add-genesis-account --chain-id $CHAIN_ID $($CHAIN_BIN keys show $USER10_KEY -a --keyring-backend=\\"test\\") 100000000000000000000000000inj --keyring-backend=\\"test\\"[39m
[32m-[39m
[32m- echo \\"Creating gentx...\\"[39m
[32m- $CHAIN_BIN $CHAIN_GENESIS_CMD gentx $(jq -r \\".genesis[0].name\\" $KEYS_CONFIG) 1000000000000000000000inj --keyring-backend=\\"test\\" --chain-id $CHAIN_ID[39m
[32m-[39m
[32m- echo \\"Output of gentx\\"[39m
[32m- cat $CHAIN_DIR/config/gentx/*.json | jq[39m
[32m-[39m
[32m- echo \\"Running collect-gentxs\\"[39m
[32m- $CHAIN_BIN $CHAIN_GENESIS_CMD collect-gentxs[39m
[32m-[39m
[32m- echo \\"Validate genesis\\"[39m
[32m- $CHAIN_BIN validate-genesis[39m
[32m-[39m
[32m- ls $CHAIN_DIR/config",[39m
[2m      "create-ics.sh": "#!/bin/bash[22m

[2m  set -euxo pipefail[22m
[33m@@ -345,7 +229,123 @@[39m
[2m  }[22m

[2m  main",[22m
[32m-     "create-validator.sh": "#!/bin/bash[39m
[31m+     "createGenesis.sh": "#!/bin/bash[39m
[31m+[39m
[31m+ DENOM=\\"\${DENOM:=uosmo}\\"[39m
[31m+ COINS=\\"\${COINS:=100000000000000000inj}\\"[39m
[31m+ CHAIN_ID=\\"\${CHAIN_ID:=injective}\\"[39m
[31m+ CHAIN_BIN=\\"\${CHAIN_BIN:=injectived}\\"[39m
[31m+ CHAIN_DIR=\\"\${CHAIN_DIR:=$HOME/.injectived}\\"[39m
[31m+ KEYS_CONFIG=\\"\${KEYS_CONFIG:=configs/keys.json}\\"[39m
[31m+[39m
[31m+ FEEDADMIN=\\"inj1k2z3chspuk9wsufle69svmtmnlc07rvw9djya7\\"[39m
[31m+[39m
[31m+ set -eu[39m
[31m+[39m
[31m+ # check if the binary has genesis subcommand or not, if not, set CHAIN_GENESIS_CMD to empty[39m
[31m+ CHAIN_GENESIS_CMD=$($CHAIN_BIN 2>&1 | grep -q \\"genesis-related subcommands\\" && echo \\"genesis\\" || echo \\"\\")[39m
[31m+[39m
[31m+ jq -r \\".genesis[0].mnemonic\\" $KEYS_CONFIG | $CHAIN_BIN init $CHAIN_ID --chain-id $CHAIN_ID --recover[39m
[31m+[39m
[31m+ WASM_KEY=\\"wasm\\"[39m
[31m+ WASM_MNEMONIC=\\"juice dog over thing anger search film document sight fork enrich jungle vacuum grab more sunset winner diesel flock smooth route impulse cheap toward\\"[39m
[31m+[39m
[31m+ VAL_KEY=\\"localkey\\"[39m
[31m+ VAL_MNEMONIC=\\"gesture inject test cycle original hollow east ridge hen combine junk child bacon zero hope comfort vacuum milk pitch cage oppose unhappy lunar seat\\"[39m
[31m+[39m
[31m+ USER1_KEY=\\"user1\\"[39m
[31m+ USER1_MNEMONIC=\\"copper push brief egg scan entry inform record adjust fossil boss egg comic alien upon aspect dry avoid interest fury window hint race symptom\\"[39m
[31m+[39m
[31m+ USER2_KEY=\\"user2\\"[39m
[31m+ USER2_MNEMONIC=\\"maximum display century economy unlock van census kite error heart snow filter midnight usage egg venture cash kick motor survey drastic edge muffin visual\\"[39m
[31m+[39m
[31m+ USER3_KEY=\\"user3\\"[39m
[31m+ USER3_MNEMONIC=\\"keep liar demand upon shed essence tip undo eagle run people strong sense another salute double peasant egg royal hair report winner student diamond\\"[39m
[31m+[39m
[31m+ USER4_KEY=\\"user4\\"[39m
[31m+ USER4_MNEMONIC=\\"pony glide frown crisp unfold lawn cup loan trial govern usual matrix theory wash fresh address pioneer between meadow visa buffalo keep gallery swear\\"[39m
[31m+[39m
[31m+ USER5_KEY=\\"ocrfeedadmin\\"[39m
[31m+ USER5_MNEMONIC=\\"earn front swamp dune level clip shell aware apple spare faith upset flip local regret loud suspect view heavy raccoon satisfy cupboard harbor basic\\"[39m
[31m+[39m
[31m+ USER6_KEY=\\"signer1\\"[39m
[31m+ USER6_MNEMONIC=\\"output arrange offer advance egg point office silent diamond fame heart hotel rocket sheriff resemble couple race crouch kit laptop document grape drastic lumber\\"[39m
[31m+[39m
[31m+ USER7_KEY=\\"signer2\\"[39m
[31m+ USER7_MNEMONIC=\\"velvet gesture rule caution injury stick property decorate raccoon physical narrow tuition address drum shoot pyramid record sport include rich actress sadness crater seek\\"[39m
[31m+[39m
[31m+ USER8_KEY=\\"signer3\\"[39m
[31m+ USER8_MNEMONIC=\\"guitar parrot nuclear sun blue marble amazing extend solar device address better chalk shock street absent follow notice female picnic into trade brass couch\\"[39m
[31m+[39m
[31m+ USER9_KEY=\\"signer4\\"[39m
[31m+ USER9_MNEMONIC=\\"rotate fame stamp size inform hurdle match stick brain shrimp fancy clinic soccer fortune photo gloom wear punch shed diet celery blossom tide bulk\\"[39m
[31m+[39m
[31m+ USER10_KEY=\\"signer5\\"[39m
[31m+ USER10_MNEMONIC=\\"apart acid night more advance december weather expect pause taxi reunion eternal crater crew lady chaos visual dynamic friend match glow flash couple tumble\\"[39m
[31m+[39m
[31m+ NEWLINE=$'\\\\n'[39m
[31m+[39m
[31m+ # Import keys from mnemonics[39m
[31m+ echo \\"$WASM_MNEMONIC\\" | $CHAIN_BIN keys add $WASM_KEY --recover --keyring-backend=\\"test\\"[39m
[31m+ yes \\"$VAL_MNEMONIC\\" | $CHAIN_BIN keys add $VAL_KEY --recover --keyring-backend=\\"test\\"[39m
[31m+ yes \\"$USER1_MNEMONIC\\" | $CHAIN_BIN keys add $USER1_KEY --recover --keyring-backend=\\"test\\"[39m
[31m+ yes \\"$USER2_MNEMONIC\\" | $CHAIN_BIN keys add $USER2_KEY --recover --keyring-backend=\\"test\\"[39m
[31m+ yes \\"$USER3_MNEMONIC\\" | $CHAIN_BIN keys add $USER3_KEY --recover --keyring-backend=\\"test\\"[39m
[31m+ yes \\"$USER4_MNEMONIC\\" | $CHAIN_BIN keys add $USER4_KEY --recover --keyring-backend=\\"test\\"[39m
[31m+ yes \\"$USER5_MNEMONIC\\" | $CHAIN_BIN keys add $USER5_KEY --recover --keyring-backend=\\"test\\"[39m
[31m+ yes \\"$USER6_MNEMONIC\\" | $CHAIN_BIN keys add $USER6_KEY --recover --keyring-backend=\\"test\\"[39m
[31m+ yes \\"$USER7_MNEMONIC\\" | $CHAIN_BIN keys add $USER7_KEY --recover --keyring-backend=\\"test\\"[39m
[31m+ yes \\"$USER8_MNEMONIC\\" | $CHAIN_BIN keys add $USER8_KEY --recover --keyring-backend=\\"test\\"[39m
[31m+ yes \\"$USER9_MNEMONIC\\" | $CHAIN_BIN keys add $USER9_KEY --recover --keyring-backend=\\"test\\"[39m
[31m+ yes \\"$USER10_MNEMONIC\\" | $CHAIN_BIN keys add $USER10_KEY --recover --keyring-backend=\\"test\\"[39m
[31m+[39m
[31m+ # Add genesis keys to the keyring and self delegate initial coins[39m
[31m+ echo \\"Adding key....\\" $(jq -r \\".genesis[0].name\\" $KEYS_CONFIG)[39m
[31m+ jq -r \\".genesis[0].mnemonic\\" $KEYS_CONFIG | $CHAIN_BIN keys add $(jq -r \\".genesis[0].name\\" $KEYS_CONFIG) --recover --keyring-backend=\\"test\\"[39m
[31m+ $CHAIN_BIN $CHAIN_GENESIS_CMD add-genesis-account --chain-id $CHAIN_ID $($CHAIN_BIN keys show -a $(jq -r .genesis[0].name $KEYS_CONFIG) --keyring-backend=\\"test\\") 1000000000000000000000000inj,1000000000000000000000000atom,100000000000000000000000000peggy0xdAC17F958D2ee523a2206206994597C13D831ec7,100000000000000000000000000peggy0x2260FAC5E5542a773Aa44fBCfeDf7C193bc2C599 --keyring-backend=\\"test\\"[39m
[31m+[39m
[31m+ # Add relayer keys to the keyring and self delegate initial coins[39m
[31m+ echo \\"Adding key....\\" $(jq -r \\".relayers[0].name\\" $KEYS_CONFIG)[39m
[31m+ jq -r \\".relayers[0].mnemonic\\" $KEYS_CONFIG | $CHAIN_BIN keys add $(jq -r \\".relayers[0].name\\" $KEYS_CONFIG) --recover --keyring-backend=\\"test\\"[39m
[31m+ $CHAIN_BIN $CHAIN_GENESIS_CMD add-genesis-account --chain-id $CHAIN_ID $($CHAIN_BIN keys show -a $(jq -r .relayers[0].name $KEYS_CONFIG) --keyring-backend=\\"test\\") 1000000000000000000000000inj --keyring-backend=\\"test\\"[39m
[31m+[39m
[31m+ # Add faucet keys to the keyring and self delegate initial coins[39m
[31m+ echo \\"Adding key....\\" $(jq -r \\".faucet[0].name\\" $KEYS_CONFIG)[39m
[31m+ jq -r \\".faucet[0].mnemonic\\" $KEYS_CONFIG | $CHAIN_BIN keys add $(jq -r \\".faucet[0].name\\" $KEYS_CONFIG) --recover --keyring-backend=\\"test\\"[39m
[31m+ $CHAIN_BIN $CHAIN_GENESIS_CMD add-genesis-account --chain-id $CHAIN_ID $($CHAIN_BIN keys show -a $(jq -r .faucet[0].name $KEYS_CONFIG) --keyring-backend=\\"test\\") 1000000000000000000000000inj --keyring-backend=\\"test\\"[39m
[31m+[39m
[31m+[39m
[31m+ # zero address account[39m
[31m+ $CHAIN_BIN add-genesis-account --chain-id $CHAIN_ID inj1qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqe2hm49 1inj[39m
[31m+[39m
[31m+ # Allocate genesis accounts (cosmos formatted addresses)[39m
[31m+ $CHAIN_BIN add-genesis-account --chain-id $CHAIN_ID $($CHAIN_BIN keys show $WASM_KEY -a --keyring-backend=\\"test\\") 1000000000000000000000inj --keyring-backend=\\"test\\"[39m
[31m+ $CHAIN_BIN add-genesis-account --chain-id $CHAIN_ID $($CHAIN_BIN keys show $VAL_KEY -a --keyring-backend=\\"test\\") 1000000000000000000000inj --keyring-backend=\\"test\\"[39m
[31m+ $CHAIN_BIN add-genesis-account --chain-id $CHAIN_ID $($CHAIN_BIN keys show $USER1_KEY -a --keyring-backend=\\"test\\") 1000000000000000000000inj,1000000000000000000000atom,100000000000000000000000000peggy0xdAC17F958D2ee523a2206206994597C13D831ec7,100000000000000000000000000peggy0x2260FAC5E5542a773Aa44fBCfeDf7C193bc2C599 --keyring-backend=\\"test\\"[39m
[31m+ $CHAIN_BIN add-genesis-account --chain-id $CHAIN_ID $($CHAIN_BIN keys show $USER2_KEY -a --keyring-backend=\\"test\\") 1000000000000000000000inj,100000000000000000000000000peggy0xdAC17F958D2ee523a2206206994597C13D831ec7,100000000000000000000000000peggy0x2260FAC5E5542a773Aa44fBCfeDf7C193bc2C599 --keyring-backend=\\"test\\"[39m
[31m+ $CHAIN_BIN add-genesis-account --chain-id $CHAIN_ID $($CHAIN_BIN keys show $USER3_KEY -a --keyring-backend=\\"test\\") 1000000000000000000000inj --keyring-backend=\\"test\\"[39m
[31m+ $CHAIN_BIN add-genesis-account --chain-id $CHAIN_ID $($CHAIN_BIN keys show $USER4_KEY -a --keyring-backend=\\"test\\") 1000000000000000000000inj --keyring-backend=\\"test\\"[39m
[31m+ $CHAIN_BIN add-genesis-account --chain-id $CHAIN_ID $($CHAIN_BIN keys show $USER5_KEY -a --keyring-backend=\\"test\\") 100000000000000000000000000inj --keyring-backend=\\"test\\"[39m
[31m+ $CHAIN_BIN add-genesis-account --chain-id $CHAIN_ID $($CHAIN_BIN keys show $USER6_KEY -a --keyring-backend=\\"test\\") 100000000000000000000000000inj --keyring-backend=\\"test\\"[39m
[31m+ $CHAIN_BIN add-genesis-account --chain-id $CHAIN_ID $($CHAIN_BIN keys show $USER7_KEY -a --keyring-backend=\\"test\\") 100000000000000000000000000inj --keyring-backend=\\"test\\"[39m
[31m+ $CHAIN_BIN add-genesis-account --chain-id $CHAIN_ID $($CHAIN_BIN keys show $USER8_KEY -a --keyring-backend=\\"test\\") 100000000000000000000000000inj --keyring-backend=\\"test\\"[39m
[31m+ $CHAIN_BIN add-genesis-account --chain-id $CHAIN_ID $($CHAIN_BIN keys show $USER9_KEY -a --keyring-backend=\\"test\\") 100000000000000000000000000inj --keyring-backend=\\"test\\"[39m
[31m+ $CHAIN_BIN add-genesis-account --chain-id $CHAIN_ID $($CHAIN_BIN keys show $USER10_KEY -a --keyring-backend=\\"test\\") 100000000000000000000000000inj --keyring-backend=\\"test\\"[39m
[31m+[39m
[31m+ echo \\"Creating gentx...\\"[39m
[31m+ $CHAIN_BIN $CHAIN_GENESIS_CMD gentx $(jq -r \\".genesis[0].name\\" $KEYS_CONFIG) 1000000000000000000000inj --keyring-backend=\\"test\\" --chain-id $CHAIN_ID[39m
[31m+[39m
[31m+ echo \\"Output of gentx\\"[39m
[31m+ cat $CHAIN_DIR/config/gentx/*.json | jq[39m
[31m+[39m
[31m+ echo \\"Running collect-gentxs\\"[39m
[31m+ $CHAIN_BIN $CHAIN_GENESIS_CMD collect-gentxs[39m
[31m+[39m
[31m+ echo \\"Validate genesis\\"[39m
[31m+ $CHAIN_BIN validate-genesis[39m
[31m+[39m
[31m+ ls $CHAIN_DIR/config",[39m
[31m+     "createValidator.sh": "#!/bin/bash[39m

[2m  DENOM=\\"\${DENOM:=inj}\\"[22m
[2m  CHAIN_BIN=\\"\${CHAIN_BIN:=injectived}\\"[22m
[33m@@ -514,7 +514,7 @@[39m
[2m  sed -i -e \\"s#timeout_precommit = \\\\\\".*\\\\\\"#timeout_precommit = \\\\\\"$TIMEOUT_PRECOMMIT\\\\\\"#g\\" $CHAIN_DIR/config/config.toml[22m
[2m  sed -i -e \\"s#timeout_precommit_delta = \\\\\\".*\\\\\\"#timeout_precommit_delta = \\\\\\"$TIMEOUT_PRECOMMIT_DELTA\\\\\\"#g\\" $CHAIN_DIR/config/config.toml[22m
[2m  sed -i -e \\"s#timeout_commit = \\\\\\".*\\\\\\"#timeout_commit = \\\\\\"$TIMEOUT_COMMIT\\\\\\"#g\\" $CHAIN_DIR/config/config.toml",[22m
[32m-     "update-genesis.sh": "#!/bin/bash[39m
[31m+     "updateGenesis.sh": "#!/bin/bash[39m

[2m  DENOM=\\"\${DENOM:=inj}\\"[22m
[2m  CHAIN_BIN=\\"\${CHAIN_BIN:=injectived}\\"[22m
[33m@@ -617,6 +617,17 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts-injective-1",[39m
[31m+       "app.kubernetes.io/part-of": "injective-1",[39m
[31m+       "app.kubernetes.io/role": "setup-scripts",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-id": "injective-1",[39m
[31m+       "starship.io/chain-name": "injective",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts-injective-1",[22m
[2m    },[22m
[2m  }[22m

--- Service/injective-1-validator ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -23,6 +23,12 @@[39m
[2m          "targetPort": 8081,[22m
[2m        },[22m
[2m        Object {[22m
[31m+         "name": "faucet",[39m
[31m+         "port": 8000,[39m
[31m+         "protocol": "TCP",[39m
[31m+         "targetPort": 8000,[39m
[31m+       },[39m
[31m+       Object {[39m
[2m          "name": "grpc",[22m
[2m          "port": 9090,[22m
[2m          "protocol": "TCP",[22m

--- StatefulSet/injective-1-validator ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,18 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/id": "injective-1",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "injective-1-validator",[39m
[31m+       "app.kubernetes.io/part-of": "injective-1",[39m
[31m+       "app.kubernetes.io/role": "validator",[39m
[31m+       "app.kubernetes.io/type": "injective-1-statefulset",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-name": "injective",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "injective-1-validator",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -10,7 +22,7 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "injective",[39m
[31m+         "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m          "app.kubernetes.io/name": "injective-1-validator",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -24,10 +36,11 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "injective",[39m
[31m+           "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m            "app.kubernetes.io/name": "injective-1-validator",[22m
[31m+           "app.kubernetes.io/role": "validator",[39m
[2m            "app.kubernetes.io/type": "injective-1",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[33m@@ -119,11 +132,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -145,7 +158,9 @@[39m
[2m                "set -eux[22m
[2m  START_ARGS=\\"\\"[22m

[31m+[39m
[2m  # Starting the chain[22m
[31m+[39m
[2m  $CHAIN_BIN start $START_ARGS",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -255,11 +270,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -286,6 +301,7 @@[39m
[2m                "-c",[22m
[2m                "VAL_INDEX=\${HOSTNAME##*-}[22m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m
[31m+[39m

[2m  echo \\"Running setup config script...\\"[22m
[2m  bash -e /scripts/update-config.sh[22m
[33m@@ -351,7 +367,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "NAMESPACE",[22m
[33m@@ -399,11 +415,11 @@[39m
[2m              "name": "init-config",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -428,6 +444,7 @@[39m
[2m                "-c",[22m
[2m                "VAL_INDEX=\${HOSTNAME##*-}[22m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m
[31m+[39m

[2m  if [ -f $CHAIN_DIR/config/genesis.json ]; then[22m
[2m    echo \\"Genesis file exists, exiting early\\"[22m
[33m@@ -500,7 +517,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "NAMESPACE",[22m
[33m@@ -548,11 +565,11 @@[39m
[2m              "name": "init-validator",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -597,16 +614,16 @@[39m
[2m                  },[22m
[2m                },[22m
[2m              ],[22m
[32m-             "image": "curlimages/curl",[39m
[31m+             "image": "curlimages/curl:latest",[39m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "wait-for-chains",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -618,6 +635,10 @@[39m
[2m                "name": "keys",[22m
[2m              },[22m
[2m              "name": "addresses",[22m
[31m+           },[39m
[31m+           Object {[39m
[31m+             "emptyDir": Object {},[39m
[31m+             "name": "faucet",[39m
[2m            },[22m
[2m            Object {[22m
[2m              "emptyDir": Object {},[22m

--- ConfigMap/registry-cosmoshub-4 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -7,7 +7,14 @@[39m
[2m    \\"assets\\": [[22m
[2m      {[22m
[2m        \\"base\\": \\"uatom\\",[22m
[32m-       \\"coingecko_id\\": \\"atom\\",[39m
[31m+       \\"description\\": \\"The native staking and governance token of the Cosmos Hub.\\",[39m
[31m+       \\"name\\": \\"Cosmos Hub Atom\\",[39m
[31m+       \\"display\\": \\"atom\\",[39m
[31m+       \\"symbol\\": \\"ATOM\\",[39m
[31m+       \\"logo_URIs\\": {[39m
[31m+         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/cosmoshub/images/atom.png\\",[39m
[31m+         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/cosmoshub/images/atom.svg\\"[39m
[31m+       },[39m
[2m        \\"denom_units\\": [[22m
[2m          {[22m
[2m            \\"denom\\": \\"uatom\\",[22m
[33m@@ -18,14 +25,7 @@[39m
[2m            \\"exponent\\": 6[22m
[2m          }[22m
[2m        ],[22m
[32m-       \\"description\\": \\"The native staking and governance token of the Cosmos Hub.\\",[39m
[32m-       \\"display\\": \\"atom\\",[39m
[32m-       \\"logo_URIs\\": {[39m
[32m-         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/cosmoshub/images/atom.png\\",[39m
[32m-         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/cosmoshub/images/atom.svg\\"[39m
[32m-       },[39m
[32m-       \\"name\\": \\"Cosmos Hub Atom\\",[39m
[32m-       \\"symbol\\": \\"ATOM\\"[39m
[31m+       \\"coingecko_id\\": \\"atom\\"[39m
[2m      }[22m
[2m    ][22m
[2m  }",[22m
[33m@@ -82,6 +82,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "registry",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "registry-cosmoshub-4",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "registry-cosmoshub-4",[22m
[2m    },[22m
[2m  }[22m

--- Deployment/registry ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,14 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "Deployment",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "registry",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "registry",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "registry",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +17,6 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "registry",[39m
[2m          "app.kubernetes.io/name": "registry",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -22,19 +29,17 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "registry",[39m
[31m+           "app.kubernetes.io/component": "registry",[39m
[31m+           "app.kubernetes.io/managed-by": "starship",[39m
[2m            "app.kubernetes.io/name": "registry",[22m
[32m-           "app.kubernetes.io/rawname": "registry",[39m
[32m-           "app.kubernetes.io/type": "registry",[39m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/part-of": "starship",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+           "starship.io/name": "starship-e2e-tests",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[2m          "containers": Array [[22m
[2m            Object {[22m
[32m-             "command": Array [[39m
[32m-               "registry",[39m
[32m-             ],[39m
[2m              "env": Array [[22m
[2m                Object {[22m
[2m                  "name": "NAMESPACE",[22m
[33m@@ -74,21 +79,20 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "REGISTRY_CHAIN_REGISTRY",[22m
[32m-                 "value": "/configs",[39m
[31m+                 "value": "/chains",[39m
[2m                },[22m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/registry:20250205-544757d",[22m
[32m-             "imagePullPolicy": "IfNotPresent",[39m
[2m              "livenessProbe": Object {[22m
[32m-               "initialDelaySeconds": 20,[39m
[32m-               "periodSeconds": 10,[39m
[31m+               "initialDelaySeconds": 15,[39m
[31m+               "periodSeconds": 20,[39m
[2m                "tcpSocket": Object {[22m
[2m                  "port": 8080,[22m
[2m                },[22m
[2m              },[22m
[2m              "name": "registry",[22m
[2m              "readinessProbe": Object {[22m
[32m-               "initialDelaySeconds": 20,[39m
[31m+               "initialDelaySeconds": 5,[39m
[2m                "periodSeconds": 10,[22m
[2m                "tcpSocket": Object {[22m
[2m                  "port": 8080,[22m
[33m@@ -96,22 +100,22 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[2m                Object {[22m
[32m-                 "mountPath": "/configs/cosmoshub-4",[39m
[32m-                 "name": "registry-configs-cosmoshub-4",[39m
[31m+                 "mountPath": "/chains/cosmoshub-4",[39m
[31m+                 "name": "registry-cosmoshub-4",[39m
[2m                },[22m
[2m                Object {[22m
[32m-                 "mountPath": "/configs/injective-1",[39m
[32m-                 "name": "registry-configs-injective-1",[39m
[31m+                 "mountPath": "/chains/injective-1",[39m
[31m+                 "name": "registry-injective-1",[39m
[2m                },[22m
[2m              ],[22m
[2m            },[22m
[33m@@ -126,6 +130,7 @@[39m
[2m    echo \\"Checking: http://injective-1-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id\\"[22m
[2m    sleep 10;[22m
[2m  done[22m
[31m+[39m
[2m  while [ $(curl -sw '%{http_code}' http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id -o /dev/null) -ne 200 ]; do[22m
[2m    echo \\"Genesis validator does not seem to be ready for: cosmoshub-4. Waiting for it to start...\\"[22m
[2m    echo \\"Checking: http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id\\"[22m
[33m@@ -148,16 +153,16 @@[39m
[2m                  },[22m
[2m                },[22m
[2m              ],[22m
[32m-             "image": "curlimages/curl",[39m
[31m+             "image": "curlimages/curl:latest",[39m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "wait-for-chains",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -168,13 +173,13 @@[39m
[2m              "configMap": Object {[22m
[2m                "name": "registry-cosmoshub-4",[22m
[2m              },[22m
[32m-             "name": "registry-configs-cosmoshub-4",[39m
[31m+             "name": "registry-cosmoshub-4",[39m
[2m            },[22m
[2m            Object {[22m
[2m              "configMap": Object {[22m
[2m                "name": "registry-injective-1",[22m
[2m              },[22m
[32m-             "name": "registry-configs-injective-1",[39m
[31m+             "name": "registry-injective-1",[39m
[2m            },[22m
[2m          ],[22m
[2m        },[22m

--- ConfigMap/registry-injective-1 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -7,7 +7,7 @@[39m
[2m    \\"assets\\": [[22m
[2m      {[22m
[2m        \\"base\\": \\"inj\\",[22m
[32m-       \\"coingecko_id\\": \\"injective-protocol\\",[39m
[31m+       \\"description\\": \\"The INJ token is the native governance token for the Injective chain.\\",[39m
[2m        \\"denom_units\\": [[22m
[2m          {[22m
[2m            \\"denom\\": \\"inj\\",[22m
[33m@@ -18,14 +18,14 @@[39m
[2m            \\"exponent\\": 18[22m
[2m          }[22m
[2m        ],[22m
[32m-       \\"description\\": \\"The INJ token is the native governance token for the Injective chain.\\",[39m
[31m+       \\"name\\": \\"Injective\\",[39m
[2m        \\"display\\": \\"INJ\\",[22m
[31m+       \\"symbol\\": \\"INJ\\",[39m
[2m        \\"logo_URIs\\": {[22m
[2m          \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/injective/images/inj.png\\",[22m
[2m          \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/injective/images/inj.svg\\"[22m
[2m        },[22m
[32m-       \\"name\\": \\"Injective\\",[39m
[32m-       \\"symbol\\": \\"INJ\\"[39m
[31m+       \\"coingecko_id\\": \\"injective-protocol\\"[39m
[2m      }[22m
[2m    ][22m
[2m  }",[22m
[33m@@ -82,6 +82,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "registry",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "registry-injective-1",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "registry-injective-1",[22m
[2m    },[22m
[2m  }[22m

--- ConfigMap/hermes-injective-cosmos ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -3,92 +3,45 @@[39m
[2m    "data": Object {[22m
[2m      "config-cli.toml": "# The global section has parameters that apply globally to the relayer operation.[22m
[2m  [global][22m
[32m- # Specify the verbosity for the relayer logging output. Default: 'info'[39m
[32m- # Valid options are 'error', 'warn', 'info', 'debug', 'trace'.[39m
[32m- log_level = 'info'[39m
[32m- # Specify the mode to be used by the relayer. [Required][39m
[31m+ log_level = \\"info\\"[39m
[31m+[39m
[2m  [mode][22m
[32m- # Specify the client mode.[39m
[2m  [mode.clients][22m
[32m- # Whether or not to enable the client workers. [Required][39m
[2m  enabled = true[22m
[32m- # Whether or not to enable periodic refresh of clients. [Default: true][39m
[32m- # This feature only applies to clients that underlie an open channel.[39m
[32m- # For Tendermint clients, the frequency at which Hermes refreshes them is 2/3 of their[39m
[32m- # trusting period (e.g., refresh every ~9 days if the trusting period is 14 days).[39m
[32m- # Note: Even if this is disabled, clients will be refreshed automatically if[39m
[32m- #      there is activity on a connection or channel they are involved with.[39m
[2m  refresh = true[22m
[32m- # Whether or not to enable misbehaviour detection for clients. [Default: false][39m
[2m  misbehaviour = true[22m
[32m- # Specify the connections mode.[39m
[31m+[39m
[2m  [mode.connections][22m
[32m- # Whether or not to enable the connection workers for handshake completion. [Required][39m
[2m  enabled = true[22m
[32m- # Specify the channels mode.[39m
[31m+[39m
[2m  [mode.channels][22m
[32m- # Whether or not to enable the channel workers for handshake completion. [Required][39m
[2m  enabled = true[22m
[32m- # Specify the packets mode.[39m
[31m+[39m
[2m  [mode.packets][22m
[32m- # Whether or not to enable the packet workers. [Required][39m
[2m  enabled = true[22m
[32m- # Parametrize the periodic packet clearing feature.[39m
[32m- # Interval (in number of blocks) at which pending packets[39m
[32m- # should be periodically cleared. A value of '0' will disable[39m
[32m- # periodic packet clearing. [Default: 100][39m
[2m  clear_interval = 100[22m
[32m- # Whether or not to clear packets on start. [Default: false][39m
[2m  clear_on_start = true[22m
[32m- # Toggle the transaction confirmation mechanism.[39m
[32m- # The tx confirmation mechanism periodically queries the \`/tx_search\` RPC[39m
[32m- # endpoint to check that previously-submitted transactions[39m
[32m- # (to any chain in this config file) have been successfully delivered.[39m
[32m- # If they have not been, and \`clear_interval = 0\`, then those packets are[39m
[32m- # queued up for re-submission.[39m
[32m- # Experimental feature. Affects telemetry if set to false.[39m
[32m- # [Default: true][39m
[2m  tx_confirmation = true[22m
[32m- # Auto register the counterparty payee on a destination chain to[39m
[32m- # the relayer's address on the source chain. This can be used[39m
[32m- # for simple configuration of the relayer to receive fees for[39m
[32m- # relaying RecvPacket on fee-enabled channels.[39m
[32m- # For more complex configuration, turn this off and use the CLI[39m
[32m- # to manually register the payee addresses.[39m
[32m- # [Default: false][39m
[32m- auto_register_counterparty_payee = false[39m
[32m- # The REST section defines parameters for Hermes' built-in RESTful API.[39m
[32m- # https://hermes.informal.systems/rest.html[39m
[31m+[39m
[2m  [rest][22m
[32m- # Whether or not to enable the REST service. Default: false[39m
[2m  enabled = true[22m
[32m- # Specify the IPv4/6 host over which the built-in HTTP server will serve the RESTful[39m
[32m- # API requests. Default: 127.0.0.1[39m
[32m- host =  '0.0.0.0'[39m
[32m- # Specify the port over which the built-in HTTP server will serve the restful API[39m
[32m- # requests. Default: 3000[39m
[31m+ host = \\"0.0.0.0\\"[39m
[2m  port = 3000[22m
[32m- # The telemetry section defines parameters for Hermes' built-in telemetry capabilities.[39m
[32m- # https://hermes.informal.systems/telemetry.html[39m
[31m+[39m
[2m  [telemetry][22m
[32m- # Whether or not to enable the telemetry service. Default: false[39m
[2m  enabled = true[22m
[32m- # Specify the IPv4/6 host over which the built-in HTTP server will serve the metrics[39m
[32m- # gathered by the telemetry service. Default: 127.0.0.1[39m
[32m- host = '0.0.0.0'[39m
[32m- # Specify the port over which the built-in HTTP server will serve the metrics gathered[39m
[32m- # by the telemetry service. Default: 3001[39m
[31m+ host = \\"0.0.0.0\\"[39m
[2m  port = 3001[22m
[32m-[39m


[2m  [[chains]][22m
[2m  id = \\"injective-1\\"[22m
[31m+ type = \\"CosmosSdk\\"[39m
[2m  key_name = \\"injective-1-cli\\"[22m
[32m- rpc_addr = \\"http://injective-1-genesis.default.svc.cluster.local:26657\\"[39m
[32m- grpc_addr = \\"http://injective-1-genesis.default.svc.cluster.local:9090\\"[39m
[32m- event_source = { mode = 'push', url = \\"ws://injective-1-genesis.default.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[32m- # Experimental: Whether or not the full node is trusted.[39m
[31m+[39m
[31m+ rpc_addr = \\"http://injective-1-genesis.$NAMESPACE.svc.cluster.local:26657\\"[39m
[31m+ grpc_addr = \\"http://injective-1-genesis.$NAMESPACE.svc.cluster.local:9090\\"[39m
[31m+ event_source = { mode = 'push', url = \\"ws://injective-1-genesis.$NAMESPACE.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[2m  trusted_node = false[22m
[2m  account_prefix = \\"inj\\"[22m
[2m  default_gas = 500000000[22m
[33m@@ -105,15 +58,14 @@[39m
[2m  address_type = { derivation = 'ethermint', proto_type = { pk_type = '/injective.crypto.v1beta1.ethsecp256k1.PubKey' } }[22m
[2m  gas_price = { price = 2500000, denom = \\"inj\\" }[22m

[32m-[39m
[32m-[39m
[2m  [[chains]][22m
[2m  id = \\"cosmoshub-4\\"[22m
[31m+ type = \\"CosmosSdk\\"[39m
[2m  key_name = \\"cosmoshub-4-cli\\"[22m
[32m- rpc_addr = \\"http://cosmoshub-4-genesis.default.svc.cluster.local:26657\\"[39m
[32m- grpc_addr = \\"http://cosmoshub-4-genesis.default.svc.cluster.local:9090\\"[39m
[32m- event_source = { mode = 'push', url = \\"ws://cosmoshub-4-genesis.default.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[32m- # Experimental: Whether or not the full node is trusted.[39m
[31m+[39m
[31m+ rpc_addr = \\"http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:26657\\"[39m
[31m+ grpc_addr = \\"http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:9090\\"[39m
[31m+ event_source = { mode = 'push', url = \\"ws://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[2m  trusted_node = false[22m
[2m  account_prefix = \\"cosmos\\"[22m
[2m  default_gas = 500000000[22m
[33m@@ -128,96 +80,48 @@[39m
[2m  trusting_period = \\"75s\\"[22m
[2m  trust_threshold = { numerator = \\"2\\", denominator = \\"3\\" }[22m
[2m  address_type = { derivation = 'cosmos' }[22m
[32m- gas_price = { price = 0.25, denom = \\"uatom\\" }",[39m
[31m+ gas_price = { price = 1.25, denom = \\"uatom\\" }",[39m
[2m      "config.toml": "# The global section has parameters that apply globally to the relayer operation.[22m
[2m  [global][22m
[32m- # Specify the verbosity for the relayer logging output. Default: 'info'[39m
[32m- # Valid options are 'error', 'warn', 'info', 'debug', 'trace'.[39m
[32m- log_level = 'info'[39m
[32m- # Specify the mode to be used by the relayer. [Required][39m
[31m+ log_level = \\"info\\"[39m
[31m+[39m
[2m  [mode][22m
[32m- # Specify the client mode.[39m
[2m  [mode.clients][22m
[32m- # Whether or not to enable the client workers. [Required][39m
[2m  enabled = true[22m
[32m- # Whether or not to enable periodic refresh of clients. [Default: true][39m
[32m- # This feature only applies to clients that underlie an open channel.[39m
[32m- # For Tendermint clients, the frequency at which Hermes refreshes them is 2/3 of their[39m
[32m- # trusting period (e.g., refresh every ~9 days if the trusting period is 14 days).[39m
[32m- # Note: Even if this is disabled, clients will be refreshed automatically if[39m
[32m- #      there is activity on a connection or channel they are involved with.[39m
[2m  refresh = true[22m
[32m- # Whether or not to enable misbehaviour detection for clients. [Default: false][39m
[2m  misbehaviour = true[22m
[32m- # Specify the connections mode.[39m
[31m+[39m
[2m  [mode.connections][22m
[32m- # Whether or not to enable the connection workers for handshake completion. [Required][39m
[2m  enabled = true[22m
[32m- # Specify the channels mode.[39m
[31m+[39m
[2m  [mode.channels][22m
[32m- # Whether or not to enable the channel workers for handshake completion. [Required][39m
[2m  enabled = true[22m
[32m- # Specify the packets mode.[39m
[31m+[39m
[2m  [mode.packets][22m
[32m- # Whether or not to enable the packet workers. [Required][39m
[2m  enabled = true[22m
[32m- # Parametrize the periodic packet clearing feature.[39m
[32m- # Interval (in number of blocks) at which pending packets[39m
[32m- # should be periodically cleared. A value of '0' will disable[39m
[32m- # periodic packet clearing. [Default: 100][39m
[2m  clear_interval = 100[22m
[32m- # Whether or not to clear packets on start. [Default: false][39m
[2m  clear_on_start = true[22m
[32m- # Toggle the transaction confirmation mechanism.[39m
[32m- # The tx confirmation mechanism periodically queries the \`/tx_search\` RPC[39m
[32m- # endpoint to check that previously-submitted transactions[39m
[32m- # (to any chain in this config file) have been successfully delivered.[39m
[32m- # If they have not been, and \`clear_interval = 0\`, then those packets are[39m
[32m- # queued up for re-submission.[39m
[32m- # Experimental feature. Affects telemetry if set to false.[39m
[32m- # [Default: true][39m
[2m  tx_confirmation = true[22m
[32m- # Auto register the counterparty payee on a destination chain to[39m
[32m- # the relayer's address on the source chain. This can be used[39m
[32m- # for simple configuration of the relayer to receive fees for[39m
[32m- # relaying RecvPacket on fee-enabled channels.[39m
[32m- # For more complex configuration, turn this off and use the CLI[39m
[32m- # to manually register the payee addresses.[39m
[32m- # [Default: false][39m
[32m- auto_register_counterparty_payee = false[39m
[32m- # The REST section defines parameters for Hermes' built-in RESTful API.[39m
[32m- # https://hermes.informal.systems/rest.html[39m
[31m+[39m
[2m  [rest][22m
[32m- # Whether or not to enable the REST service. Default: false[39m
[2m  enabled = true[22m
[32m- # Specify the IPv4/6 host over which the built-in HTTP server will serve the RESTful[39m
[32m- # API requests. Default: 127.0.0.1[39m
[32m- host =  '0.0.0.0'[39m
[32m- # Specify the port over which the built-in HTTP server will serve the restful API[39m
[32m- # requests. Default: 3000[39m
[31m+ host = \\"0.0.0.0\\"[39m
[2m  port = 3000[22m
[32m- # The telemetry section defines parameters for Hermes' built-in telemetry capabilities.[39m
[32m- # https://hermes.informal.systems/telemetry.html[39m
[31m+[39m
[2m  [telemetry][22m
[32m- # Whether or not to enable the telemetry service. Default: false[39m
[2m  enabled = true[22m
[32m- # Specify the IPv4/6 host over which the built-in HTTP server will serve the metrics[39m
[32m- # gathered by the telemetry service. Default: 127.0.0.1[39m
[32m- host = '0.0.0.0'[39m
[32m- # Specify the port over which the built-in HTTP server will serve the metrics gathered[39m
[32m- # by the telemetry service. Default: 3001[39m
[31m+ host = \\"0.0.0.0\\"[39m
[2m  port = 3001[22m
[32m-[39m


[2m  [[chains]][22m
[2m  id = \\"injective-1\\"[22m
[2m  type = \\"CosmosSdk\\"[22m
[2m  key_name = \\"injective-1\\"[22m
[32m- rpc_addr = \\"http://injective-1-genesis.default.svc.cluster.local:26657\\"[39m
[32m- grpc_addr = \\"http://injective-1-genesis.default.svc.cluster.local:9090\\"[39m
[32m- event_source = { mode = 'push', url = \\"ws://injective-1-genesis.default.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[32m- # Experimental: Whether or not the full node is trusted.[39m
[31m+[39m
[31m+ rpc_addr = \\"http://injective-1-genesis.$NAMESPACE.svc.cluster.local:26657\\"[39m
[31m+ grpc_addr = \\"http://injective-1-genesis.$NAMESPACE.svc.cluster.local:9090\\"[39m
[31m+ event_source = { mode = 'push', url = \\"ws://injective-1-genesis.$NAMESPACE.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[2m  trusted_node = false[22m
[2m  account_prefix = \\"inj\\"[22m
[2m  default_gas = 500000000[22m
[33m@@ -234,16 +138,14 @@[39m
[2m  address_type = { derivation = 'ethermint', proto_type = { pk_type = '/injective.crypto.v1beta1.ethsecp256k1.PubKey' } }[22m
[2m  gas_price = { price = 2500000, denom = \\"inj\\" }[22m

[32m-[39m
[32m-[39m
[2m  [[chains]][22m
[2m  id = \\"cosmoshub-4\\"[22m
[2m  type = \\"CosmosSdk\\"[22m
[2m  key_name = \\"cosmoshub-4\\"[22m
[32m- rpc_addr = \\"http://cosmoshub-4-genesis.default.svc.cluster.local:26657\\"[39m
[32m- grpc_addr = \\"http://cosmoshub-4-genesis.default.svc.cluster.local:9090\\"[39m
[32m- event_source = { mode = 'push', url = \\"ws://cosmoshub-4-genesis.default.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[32m- # Experimental: Whether or not the full node is trusted.[39m
[31m+[39m
[31m+ rpc_addr = \\"http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:26657\\"[39m
[31m+ grpc_addr = \\"http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:9090\\"[39m
[31m+ event_source = { mode = 'push', url = \\"ws://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[2m  trusted_node = false[22m
[2m  account_prefix = \\"cosmos\\"[22m
[2m  default_gas = 500000000[22m
[33m@@ -262,6 +164,15 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "relayer",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "hermes-injective-cosmos",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/role": "hermes",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "hermes-injective-cosmos",[22m
[2m    },[22m
[2m  }[22m

--- StatefulSet/hermes-injective-cosmos ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,15 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "relayer",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "hermes-injective-cosmos",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/role": "hermes",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "hermes-injective-cosmos",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -29,16 +38,18 @@[39m
[2m            "app.kubernetes.io/name": "hermes-injective-cosmos",[22m
[2m            "app.kubernetes.io/rawname": "injective-cosmos",[22m
[2m            "app.kubernetes.io/type": "hermes",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[2m          "containers": Array [[22m
[2m            Object {[22m
[31m+             "args": Array [[39m
[31m+               "/exposer/exposer",[39m
[31m+             ],[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "/exposer/exposer",[39m
[2m              ],[22m
[2m              "env": Array [[22m
[2m                Object {[22m
[33m@@ -55,11 +66,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -83,14 +94,24 @@[39m
[2m              ],[22m
[2m            },[22m
[2m            Object {[22m
[31m+             "args": Array [[39m
[31m+               "RLY_INDEX=\${HOSTNAME##*-}[39m
[31m+ echo \\"Relayer Index: $RLY_INDEX\\"[39m
[31m+ hermes start",[39m
[31m+             ],[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "RLY_INDEX=\${HOSTNAME##*-}[39m
[32m- echo \\"Relayer Index: $RLY_INDEX\\"[39m
[32m- hermes start",[39m
[2m              ],[22m
[2m              "env": Array [[22m
[31m+               Object {[39m
[31m+                 "name": "NAMESPACE",[39m
[31m+                 "valueFrom": Object {[39m
[31m+                   "fieldRef": Object {[39m
[31m+                     "fieldPath": "metadata.namespace",[39m
[31m+                   },[39m
[31m+                 },[39m
[31m+               },[39m
[2m                Object {[22m
[2m                  "name": "RELAYER_DIR",[22m
[2m                  "value": "/root/.hermes",[22m
[33m@@ -101,12 +122,12 @@[39m
[2m              "name": "relayer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[2m              },[22m
[2m              "securityContext": Object {[22m
[33m@@ -127,24 +148,26 @@[39m
[2m          ],[22m
[2m          "initContainers": Array [[22m
[2m            Object {[22m
[31m+             "args": Array [[39m
[31m+               "# Install exposer binary from the image[39m
[31m+ cp /bin/exposer /exposer/exposer[39m
[31m+ chmod +x /exposer/exposer",[39m
[31m+             ],[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "# Install exposer binary from the image[39m
[32m- cp /bin/exposer /exposer/exposer[39m
[32m- chmod +x /exposer/exposer",[39m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/exposer:20250205-544757d",[22m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "init-exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "100M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "100M",[39m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[33m@@ -155,9 +178,7 @@[39m
[2m              ],[22m
[2m            },[22m
[2m            Object {[22m
[32m-             "command": Array [[39m
[32m-               "bash",[39m
[32m-               "-c",[39m
[31m+             "args": Array [[39m
[2m                "set -ux[22m

[2m  RLY_INDEX=\${HOSTNAME##*-}[22m
[33m@@ -166,18 +187,16 @@[39m
[2m  mkdir -p $RELAYER_DIR[22m
[2m  cp /configs/config.toml $RELAYER_DIR/config.toml[22m
[2m  cp /configs/config-cli.toml $RELAYER_DIR/config-cli.toml[22m
[32m- cat $RELAYER_DIR/config.toml[39m
[31m+[39m
[31m+ # Replace namespace placeholder with actual namespace environment variable[39m
[31m+ sed -i \\"s|\\\\$NAMESPACE|$NAMESPACE|g\\" $RELAYER_DIR/config.toml[39m
[31m+ sed -i \\"s|\\\\$NAMESPACE|$NAMESPACE|g\\" $RELAYER_DIR/config-cli.toml[39m

[32m- MNEMONIC=$(jq -r \\".relayers[$RELAYER_INDEX].mnemonic\\" $KEYS_CONFIG)[39m
[31m+ MNEMONIC=$(jq -r \\".relayers[$RLY_INDEX].mnemonic\\" $KEYS_CONFIG)[39m
[2m  echo $MNEMONIC > $RELAYER_DIR/mnemonic.txt[22m
[32m- MNEMONIC_CLI=$(jq -r \\".relayers_cli[$RELAYER_INDEX].mnemonic\\" $KEYS_CONFIG)[39m
[31m+ MNEMONIC_CLI=$(jq -r \\".relayers_cli[$RLY_INDEX].mnemonic\\" $KEYS_CONFIG)[39m
[2m  echo $MNEMONIC_CLI > $RELAYER_DIR/mnemonic-cli.txt[22m

[32m- echo \\"Debug output for injective-cosmos...\\"[39m
[32m- cat << EOF[39m
[32m-               map[string]interface {}[39m
[32m-               {\\"chains\\":[\\"injective-1\\",\\"cosmoshub-4\\"],\\"channels\\":[{\\"a-chain\\":\\"injective-1\\",\\"a-port\\":\\"transfer\\",\\"b-chain\\":\\"cosmoshub-4\\",\\"b-port\\":\\"transfer\\",\\"new-connection\\":true}],\\"config\\":{\\"event_source\\":{\\"mode\\":\\"push\\"},\\"global\\":{\\"log_level\\":\\"info\\"},\\"mode\\":{\\"channels\\":{\\"enabled\\":true},\\"clients\\":{\\"enabled\\":true,\\"misbehaviour\\":true,\\"refresh\\":true},\\"connections\\":{\\"enabled\\":true},\\"packets\\":{\\"clear_interval\\":100,\\"clear_on_start\\":true,\\"enabled\\":true,\\"tx_confirmation\\":true}},\\"rest\\":{\\"enabled\\":true,\\"host\\":\\"0.0.0.0\\",\\"port\\":3000},\\"telemetry\\":{\\"enabled\\":true,\\"host\\":\\"0.0.0.0\\",\\"port\\":3001}},\\"fullname\\":\\"hermes-injective-cosmos\\",\\"ics\\":{\\"enabled\\":false},\\"image\\":\\"ghcr.io/cosmology-tech/starship/hermes:1.10.0\\",\\"name\\":\\"injective-cosmos\\",\\"replicas\\":1,\\"type\\":\\"hermes\\"}[39m
[32m- EOF[39m

[2m  echo \\"Creating key for injective-1...\\"[22m
[2m  hermes keys add \\\\[22m
[33m@@ -240,12 +259,17 @@[39m
[2m    $DENOM \\\\[22m
[2m    http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:8000/credit \\\\[22m
[2m    \\"true\\" || true[22m
[31m+[39m
[2m  hermes create channel \\\\[22m
[2m    --new-client-connection --yes \\\\[22m
[2m    --b-chain cosmoshub-4 \\\\[22m
[2m    --a-chain injective-1 \\\\[22m
[2m    --a-port transfer \\\\[22m
[2m    --b-port transfer",[22m
[31m+             ],[39m
[31m+             "command": Array [[39m
[31m+               "bash",[39m
[31m+               "-c",[39m
[2m              ],[22m
[2m              "env": Array [[22m
[2m                Object {[22m
[33m@@ -266,7 +290,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "RELAYER_INDEX",[22m
[32m-                 "value": "0",[39m
[31m+                 "value": "\${HOSTNAME##*-}",[39m
[2m                },[22m
[2m              ],[22m
[2m              "image": "ghcr.io/cosmology-tech/starship/hermes:1.10.0",[22m
[33m@@ -274,12 +298,12 @@[39m
[2m              "name": "init-relayer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[33m@@ -310,6 +334,7 @@[39m
[2m    echo \\"Checking: http://injective-1-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id\\"[22m
[2m    sleep 10;[22m
[2m  done[22m
[31m+[39m
[2m  while [ $(curl -sw '%{http_code}' http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id -o /dev/null) -ne 200 ]; do[22m
[2m    echo \\"Genesis validator does not seem to be ready for: cosmoshub-4. Waiting for it to start...\\"[22m
[2m    echo \\"Checking: http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id\\"[22m
[33m@@ -332,16 +357,16 @@[39m
[2m                  },[22m
[2m                },[22m
[2m              ],[22m
[32m-             "image": "curlimages/curl",[39m
[31m+             "image": "curlimages/curl:latest",[39m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "wait-for-chains",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m"
`;

exports[`Manifest Comparison Tests Individual Config Comparisons should generate manifests for multi-relayer that match the snapshot 1`] = `
"ðŸ”„ MODIFIED_RESOURCES:

--- ConfigMap/keys ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -98,6 +98,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "configmap",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "keys",[39m
[31m+       "app.kubernetes.io/part-of": "global",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "keys",[22m
[2m    },[22m
[2m  }[22m

--- ConfigMap/setup-scripts ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -208,6 +208,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "configmap",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts",[39m
[31m+       "app.kubernetes.io/part-of": "global",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts",[22m
[2m    },[22m
[2m  }[22m

--- StatefulSet/cosmoshub-4-genesis ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,18 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/id": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "cosmoshub-4-genesis",[39m
[31m+       "app.kubernetes.io/part-of": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/role": "genesis",[39m
[31m+       "app.kubernetes.io/type": "cosmoshub-4-statefulset",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-name": "cosmoshub",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "cosmoshub-4-genesis",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +21,7 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "cosmoshub",[39m
[31m+         "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m          "app.kubernetes.io/name": "cosmoshub-4-genesis",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -23,11 +35,12 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "cosmoshub",[39m
[31m+           "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m            "app.kubernetes.io/name": "cosmoshub-4-genesis",[22m
[2m            "app.kubernetes.io/rawname": "cosmoshub-4",[22m
[31m+           "app.kubernetes.io/role": "genesis",[39m
[2m            "app.kubernetes.io/type": "cosmoshub-4",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[33m@@ -91,11 +104,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -114,7 +127,12 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "START_ARGS=\\"\\"[39m
[31m+               "#!/bin/bash[39m
[31m+ set -euo pipefail[39m
[31m+[39m
[31m+ START_ARGS=\\"\\"[39m
[31m+[39m
[31m+[39m
[2m  $CHAIN_BIN start $START_ARGS",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -177,11 +195,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -210,6 +228,7 @@[39m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m

[2m  echo \\"Running setup config script...\\"[22m
[31m+[39m
[2m  bash -e /scripts/update-config.sh",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -251,7 +270,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "TIME_IOTA_MS",[22m
[33m@@ -291,11 +310,11 @@[39m
[2m              "name": "init-config",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -428,11 +447,11 @@[39m
[2m              "name": "init-genesis",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m

--- ConfigMap/setup-scripts-cosmoshub-4 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -608,6 +608,17 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts-cosmoshub-4",[39m
[31m+       "app.kubernetes.io/part-of": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/role": "setup-scripts",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-id": "cosmoshub-4",[39m
[31m+       "starship.io/chain-name": "cosmoshub",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts-cosmoshub-4",[22m
[2m    },[22m
[2m  }[22m

--- StatefulSet/juno-2-genesis ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,18 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/id": "juno-2",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "juno-2-genesis",[39m
[31m+       "app.kubernetes.io/part-of": "juno-2",[39m
[31m+       "app.kubernetes.io/role": "genesis",[39m
[31m+       "app.kubernetes.io/type": "juno-2-statefulset",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-name": "juno",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "juno-2-genesis",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +21,7 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "juno",[39m
[31m+         "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m          "app.kubernetes.io/name": "juno-2-genesis",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -23,11 +35,12 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "juno",[39m
[31m+           "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m            "app.kubernetes.io/name": "juno-2-genesis",[22m
[2m            "app.kubernetes.io/rawname": "juno-2",[22m
[31m+           "app.kubernetes.io/role": "genesis",[39m
[2m            "app.kubernetes.io/type": "juno-2",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[33m@@ -91,11 +104,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -114,7 +127,12 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "START_ARGS=\\"\\"[39m
[31m+               "#!/bin/bash[39m
[31m+ set -euo pipefail[39m
[31m+[39m
[31m+ START_ARGS=\\"\\"[39m
[31m+[39m
[31m+[39m
[2m  $CHAIN_BIN start $START_ARGS",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -177,11 +195,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -210,6 +228,7 @@[39m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m

[2m  echo \\"Running setup config script...\\"[22m
[31m+[39m
[2m  bash -e /scripts/update-config.sh",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -251,7 +270,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "TIME_IOTA_MS",[22m
[33m@@ -291,11 +310,11 @@[39m
[2m              "name": "init-config",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -428,11 +447,11 @@[39m
[2m              "name": "init-genesis",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m

--- ConfigMap/setup-scripts-juno-2 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -608,6 +608,17 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts-juno-2",[39m
[31m+       "app.kubernetes.io/part-of": "juno-2",[39m
[31m+       "app.kubernetes.io/role": "setup-scripts",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-id": "juno-2",[39m
[31m+       "starship.io/chain-name": "juno",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts-juno-2",[22m
[2m    },[22m
[2m  }[22m

--- StatefulSet/osmosis-1-genesis ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,18 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/id": "osmosis-1",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "osmosis-1-genesis",[39m
[31m+       "app.kubernetes.io/part-of": "osmosis-1",[39m
[31m+       "app.kubernetes.io/role": "genesis",[39m
[31m+       "app.kubernetes.io/type": "osmosis-1-statefulset",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-name": "osmosis",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "osmosis-1-genesis",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +21,7 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "osmosis",[39m
[31m+         "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m          "app.kubernetes.io/name": "osmosis-1-genesis",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -23,11 +35,12 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "osmosis",[39m
[31m+           "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m            "app.kubernetes.io/name": "osmosis-1-genesis",[22m
[2m            "app.kubernetes.io/rawname": "osmosis-1",[22m
[31m+           "app.kubernetes.io/role": "genesis",[39m
[2m            "app.kubernetes.io/type": "osmosis-1",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[33m@@ -91,11 +104,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -114,7 +127,12 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "START_ARGS=\\"\\"[39m
[31m+               "#!/bin/bash[39m
[31m+ set -euo pipefail[39m
[31m+[39m
[31m+ START_ARGS=\\"\\"[39m
[31m+[39m
[31m+[39m
[2m  $CHAIN_BIN start $START_ARGS",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -177,11 +195,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -210,6 +228,7 @@[39m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m

[2m  echo \\"Running setup config script...\\"[22m
[31m+[39m
[2m  bash -e /scripts/update-config.sh",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -251,7 +270,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "TIME_IOTA_MS",[22m
[33m@@ -291,11 +310,11 @@[39m
[2m              "name": "init-config",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -428,11 +447,11 @@[39m
[2m              "name": "init-genesis",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m

--- ConfigMap/setup-scripts-osmosis-1 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -608,6 +608,17 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts-osmosis-1",[39m
[31m+       "app.kubernetes.io/part-of": "osmosis-1",[39m
[31m+       "app.kubernetes.io/role": "setup-scripts",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-id": "osmosis-1",[39m
[31m+       "starship.io/chain-name": "osmosis",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts-osmosis-1",[22m
[2m    },[22m
[2m  }[22m

--- ConfigMap/registry-cosmoshub-4 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -7,7 +7,14 @@[39m
[2m    \\"assets\\": [[22m
[2m      {[22m
[2m        \\"base\\": \\"uatom\\",[22m
[32m-       \\"coingecko_id\\": \\"atom\\",[39m
[31m+       \\"description\\": \\"The native staking and governance token of the Cosmos Hub.\\",[39m
[31m+       \\"name\\": \\"Cosmos Hub Atom\\",[39m
[31m+       \\"display\\": \\"atom\\",[39m
[31m+       \\"symbol\\": \\"ATOM\\",[39m
[31m+       \\"logo_URIs\\": {[39m
[31m+         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/cosmoshub/images/atom.png\\",[39m
[31m+         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/cosmoshub/images/atom.svg\\"[39m
[31m+       },[39m
[2m        \\"denom_units\\": [[22m
[2m          {[22m
[2m            \\"denom\\": \\"uatom\\",[22m
[33m@@ -18,14 +25,7 @@[39m
[2m            \\"exponent\\": 6[22m
[2m          }[22m
[2m        ],[22m
[32m-       \\"description\\": \\"The native staking and governance token of the Cosmos Hub.\\",[39m
[32m-       \\"display\\": \\"atom\\",[39m
[32m-       \\"logo_URIs\\": {[39m
[32m-         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/cosmoshub/images/atom.png\\",[39m
[32m-         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/cosmoshub/images/atom.svg\\"[39m
[32m-       },[39m
[32m-       \\"name\\": \\"Cosmos Hub Atom\\",[39m
[32m-       \\"symbol\\": \\"ATOM\\"[39m
[31m+       \\"coingecko_id\\": \\"atom\\"[39m
[2m      }[22m
[2m    ][22m
[2m  }",[22m
[33m@@ -82,6 +82,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "registry",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "registry-cosmoshub-4",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "registry-cosmoshub-4",[22m
[2m    },[22m
[2m  }[22m

--- Deployment/registry ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,14 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "Deployment",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "registry",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "registry",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "registry",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +17,6 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "registry",[39m
[2m          "app.kubernetes.io/name": "registry",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -22,19 +29,17 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "registry",[39m
[31m+           "app.kubernetes.io/component": "registry",[39m
[31m+           "app.kubernetes.io/managed-by": "starship",[39m
[2m            "app.kubernetes.io/name": "registry",[22m
[32m-           "app.kubernetes.io/rawname": "registry",[39m
[32m-           "app.kubernetes.io/type": "registry",[39m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/part-of": "starship",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+           "starship.io/name": "starship-e2e-tests",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[2m          "containers": Array [[22m
[2m            Object {[22m
[32m-             "command": Array [[39m
[32m-               "registry",[39m
[32m-             ],[39m
[2m              "env": Array [[22m
[2m                Object {[22m
[2m                  "name": "NAMESPACE",[22m
[33m@@ -74,21 +79,20 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "REGISTRY_CHAIN_REGISTRY",[22m
[32m-                 "value": "/configs",[39m
[31m+                 "value": "/chains",[39m
[2m                },[22m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/registry:20250205-544757d",[22m
[32m-             "imagePullPolicy": "IfNotPresent",[39m
[2m              "livenessProbe": Object {[22m
[32m-               "initialDelaySeconds": 20,[39m
[32m-               "periodSeconds": 10,[39m
[31m+               "initialDelaySeconds": 15,[39m
[31m+               "periodSeconds": 20,[39m
[2m                "tcpSocket": Object {[22m
[2m                  "port": 8080,[22m
[2m                },[22m
[2m              },[22m
[2m              "name": "registry",[22m
[2m              "readinessProbe": Object {[22m
[32m-               "initialDelaySeconds": 20,[39m
[31m+               "initialDelaySeconds": 5,[39m
[2m                "periodSeconds": 10,[22m
[2m                "tcpSocket": Object {[22m
[2m                  "port": 8080,[22m
[33m@@ -96,26 +100,26 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[2m                Object {[22m
[32m-                 "mountPath": "/configs/cosmoshub-4",[39m
[32m-                 "name": "registry-configs-cosmoshub-4",[39m
[31m+                 "mountPath": "/chains/cosmoshub-4",[39m
[31m+                 "name": "registry-cosmoshub-4",[39m
[2m                },[22m
[2m                Object {[22m
[32m-                 "mountPath": "/configs/juno-2",[39m
[32m-                 "name": "registry-configs-juno-2",[39m
[31m+                 "mountPath": "/chains/juno-2",[39m
[31m+                 "name": "registry-juno-2",[39m
[2m                },[22m
[2m                Object {[22m
[32m-                 "mountPath": "/configs/osmosis-1",[39m
[32m-                 "name": "registry-configs-osmosis-1",[39m
[31m+                 "mountPath": "/chains/osmosis-1",[39m
[31m+                 "name": "registry-osmosis-1",[39m
[2m                },[22m
[2m              ],[22m
[2m            },[22m
[33m@@ -130,11 +134,13 @@[39m
[2m    echo \\"Checking: http://osmosis-1-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id\\"[22m
[2m    sleep 10;[22m
[2m  done[22m
[31m+[39m
[2m  while [ $(curl -sw '%{http_code}' http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id -o /dev/null) -ne 200 ]; do[22m
[2m    echo \\"Genesis validator does not seem to be ready for: cosmoshub-4. Waiting for it to start...\\"[22m
[2m    echo \\"Checking: http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id\\"[22m
[2m    sleep 10;[22m
[2m  done[22m
[31m+[39m
[2m  while [ $(curl -sw '%{http_code}' http://juno-2-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id -o /dev/null) -ne 200 ]; do[22m
[2m    echo \\"Genesis validator does not seem to be ready for: juno-2. Waiting for it to start...\\"[22m
[2m    echo \\"Checking: http://juno-2-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id\\"[22m
[33m@@ -157,16 +163,16 @@[39m
[2m                  },[22m
[2m                },[22m
[2m              ],[22m
[32m-             "image": "curlimages/curl",[39m
[31m+             "image": "curlimages/curl:latest",[39m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "wait-for-chains",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -177,19 +183,19 @@[39m
[2m              "configMap": Object {[22m
[2m                "name": "registry-cosmoshub-4",[22m
[2m              },[22m
[32m-             "name": "registry-configs-cosmoshub-4",[39m
[31m+             "name": "registry-cosmoshub-4",[39m
[2m            },[22m
[2m            Object {[22m
[2m              "configMap": Object {[22m
[2m                "name": "registry-juno-2",[22m
[2m              },[22m
[32m-             "name": "registry-configs-juno-2",[39m
[31m+             "name": "registry-juno-2",[39m
[2m            },[22m
[2m            Object {[22m
[2m              "configMap": Object {[22m
[2m                "name": "registry-osmosis-1",[22m
[2m              },[22m
[32m-             "name": "registry-configs-osmosis-1",[39m
[31m+             "name": "registry-osmosis-1",[39m
[2m            },[22m
[2m          ],[22m
[2m        },[22m

--- ConfigMap/registry-juno-2 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -7,7 +7,14 @@[39m
[2m    \\"assets\\": [[22m
[2m      {[22m
[2m        \\"base\\": \\"ujuno\\",[22m
[32m-       \\"coingecko_id\\": \\"juno-network\\",[39m
[31m+       \\"description\\": \\"The native token of JUNO Chain\\",[39m
[31m+       \\"name\\": \\"Juno\\",[39m
[31m+       \\"display\\": \\"juno\\",[39m
[31m+       \\"symbol\\": \\"JUNO\\",[39m
[31m+       \\"logo_URIs\\": {[39m
[31m+         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/juno/images/juno.png\\",[39m
[31m+         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/juno/images/juno.svg\\"[39m
[31m+       },[39m
[2m        \\"denom_units\\": [[22m
[2m          {[22m
[2m            \\"denom\\": \\"ujuno\\",[22m
[33m@@ -18,14 +25,7 @@[39m
[2m            \\"exponent\\": 6[22m
[2m          }[22m
[2m        ],[22m
[32m-       \\"description\\": \\"The native token of JUNO Chain\\",[39m
[32m-       \\"display\\": \\"juno\\",[39m
[32m-       \\"logo_URIs\\": {[39m
[32m-         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/juno/images/juno.png\\",[39m
[32m-         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/juno/images/juno.svg\\"[39m
[32m-       },[39m
[32m-       \\"name\\": \\"Juno\\",[39m
[32m-       \\"symbol\\": \\"JUNO\\"[39m
[31m+       \\"coingecko_id\\": \\"juno-network\\"[39m
[2m      }[22m
[2m    ][22m
[2m  }",[22m
[33m@@ -82,6 +82,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "registry",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "registry-juno-2",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "registry-juno-2",[22m
[2m    },[22m
[2m  }[22m

--- ConfigMap/registry-osmosis-1 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -7,7 +7,14 @@[39m
[2m    \\"assets\\": [[22m
[2m      {[22m
[2m        \\"base\\": \\"uosmo\\",[22m
[32m-       \\"coingecko_id\\": \\"osmosis\\",[39m
[31m+       \\"description\\": \\"The native token of Osmosis\\",[39m
[31m+       \\"name\\": \\"Osmosis\\",[39m
[31m+       \\"display\\": \\"osmo\\",[39m
[31m+       \\"symbol\\": \\"OSMO\\",[39m
[31m+       \\"logo_URIs\\": {[39m
[31m+         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/osmo.png\\",[39m
[31m+         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/osmo.svg\\"[39m
[31m+       },[39m
[2m        \\"denom_units\\": [[22m
[2m          {[22m
[2m            \\"denom\\": \\"uosmo\\",[22m
[33m@@ -18,22 +25,21 @@[39m
[2m            \\"exponent\\": 6[22m
[2m          }[22m
[2m        ],[22m
[32m-       \\"description\\": \\"The native token of Osmosis\\",[39m
[32m-       \\"display\\": \\"osmo\\",[39m
[31m+       \\"coingecko_id\\": \\"osmosis\\",[39m
[2m        \\"keywords\\": [[22m
[2m          \\"staking\\",[22m
[2m          \\"dex\\"[22m
[32m-       ],[39m
[32m-       \\"logo_URIs\\": {[39m
[32m-         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/osmo.png\\",[39m
[32m-         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/osmo.svg\\"[39m
[32m-       },[39m
[32m-       \\"name\\": \\"Osmosis\\",[39m
[32m-       \\"symbol\\": \\"OSMO\\"[39m
[31m+       ][39m
[2m      },[22m
[2m      {[22m
[2m        \\"base\\": \\"uion\\",[22m
[32m-       \\"coingecko_id\\": \\"ion\\",[39m
[31m+       \\"name\\": \\"Ion\\",[39m
[31m+       \\"display\\": \\"ion\\",[39m
[31m+       \\"symbol\\": \\"ION\\",[39m
[31m+       \\"logo_URIs\\": {[39m
[31m+         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/ion.png\\",[39m
[31m+         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/ion.svg\\"[39m
[31m+       },[39m
[2m        \\"denom_units\\": [[22m
[2m          {[22m
[2m            \\"denom\\": \\"uion\\",[22m
[33m@@ -44,16 +50,10 @@[39m
[2m            \\"exponent\\": 6[22m
[2m          }[22m
[2m        ],[22m
[32m-       \\"display\\": \\"ion\\",[39m
[31m+       \\"coingecko_id\\": \\"ion\\",[39m
[2m        \\"keywords\\": [[22m
[2m          \\"memecoin\\"[22m
[32m-       ],[39m
[32m-       \\"logo_URIs\\": {[39m
[32m-         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/ion.png\\",[39m
[32m-         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/ion.svg\\"[39m
[32m-       },[39m
[32m-       \\"name\\": \\"Ion\\",[39m
[32m-       \\"symbol\\": \\"ION\\"[39m
[31m+       ][39m
[2m      }[22m
[2m    ][22m
[2m  }",[22m
[33m@@ -110,6 +110,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "registry",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "registry-osmosis-1",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "registry-osmosis-1",[22m
[2m    },[22m
[2m  }[22m

--- ConfigMap/hermes-juno-cosmos ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -3,92 +3,45 @@[39m
[2m    "data": Object {[22m
[2m      "config-cli.toml": "# The global section has parameters that apply globally to the relayer operation.[22m
[2m  [global][22m
[32m- # Specify the verbosity for the relayer logging output. Default: 'info'[39m
[32m- # Valid options are 'error', 'warn', 'info', 'debug', 'trace'.[39m
[32m- log_level = 'info'[39m
[32m- # Specify the mode to be used by the relayer. [Required][39m
[31m+ log_level = \\"info\\"[39m
[31m+[39m
[2m  [mode][22m
[32m- # Specify the client mode.[39m
[2m  [mode.clients][22m
[32m- # Whether or not to enable the client workers. [Required][39m
[2m  enabled = true[22m
[32m- # Whether or not to enable periodic refresh of clients. [Default: true][39m
[32m- # This feature only applies to clients that underlie an open channel.[39m
[32m- # For Tendermint clients, the frequency at which Hermes refreshes them is 2/3 of their[39m
[32m- # trusting period (e.g., refresh every ~9 days if the trusting period is 14 days).[39m
[32m- # Note: Even if this is disabled, clients will be refreshed automatically if[39m
[32m- #      there is activity on a connection or channel they are involved with.[39m
[2m  refresh = true[22m
[32m- # Whether or not to enable misbehaviour detection for clients. [Default: false][39m
[2m  misbehaviour = true[22m
[32m- # Specify the connections mode.[39m
[31m+[39m
[2m  [mode.connections][22m
[32m- # Whether or not to enable the connection workers for handshake completion. [Required][39m
[2m  enabled = true[22m
[32m- # Specify the channels mode.[39m
[31m+[39m
[2m  [mode.channels][22m
[32m- # Whether or not to enable the channel workers for handshake completion. [Required][39m
[2m  enabled = true[22m
[32m- # Specify the packets mode.[39m
[31m+[39m
[2m  [mode.packets][22m
[32m- # Whether or not to enable the packet workers. [Required][39m
[2m  enabled = true[22m
[32m- # Parametrize the periodic packet clearing feature.[39m
[32m- # Interval (in number of blocks) at which pending packets[39m
[32m- # should be periodically cleared. A value of '0' will disable[39m
[32m- # periodic packet clearing. [Default: 100][39m
[2m  clear_interval = 100[22m
[32m- # Whether or not to clear packets on start. [Default: false][39m
[2m  clear_on_start = true[22m
[32m- # Toggle the transaction confirmation mechanism.[39m
[32m- # The tx confirmation mechanism periodically queries the \`/tx_search\` RPC[39m
[32m- # endpoint to check that previously-submitted transactions[39m
[32m- # (to any chain in this config file) have been successfully delivered.[39m
[32m- # If they have not been, and \`clear_interval = 0\`, then those packets are[39m
[32m- # queued up for re-submission.[39m
[32m- # Experimental feature. Affects telemetry if set to false.[39m
[32m- # [Default: true][39m
[2m  tx_confirmation = true[22m
[32m- # Auto register the counterparty payee on a destination chain to[39m
[32m- # the relayer's address on the source chain. This can be used[39m
[32m- # for simple configuration of the relayer to receive fees for[39m
[32m- # relaying RecvPacket on fee-enabled channels.[39m
[32m- # For more complex configuration, turn this off and use the CLI[39m
[32m- # to manually register the payee addresses.[39m
[32m- # [Default: false][39m
[32m- auto_register_counterparty_payee = false[39m
[32m- # The REST section defines parameters for Hermes' built-in RESTful API.[39m
[32m- # https://hermes.informal.systems/rest.html[39m
[31m+[39m
[2m  [rest][22m
[32m- # Whether or not to enable the REST service. Default: false[39m
[2m  enabled = true[22m
[32m- # Specify the IPv4/6 host over which the built-in HTTP server will serve the RESTful[39m
[32m- # API requests. Default: 127.0.0.1[39m
[32m- host =  '0.0.0.0'[39m
[32m- # Specify the port over which the built-in HTTP server will serve the restful API[39m
[32m- # requests. Default: 3000[39m
[31m+ host = \\"0.0.0.0\\"[39m
[2m  port = 3000[22m
[32m- # The telemetry section defines parameters for Hermes' built-in telemetry capabilities.[39m
[32m- # https://hermes.informal.systems/telemetry.html[39m
[31m+[39m
[2m  [telemetry][22m
[32m- # Whether or not to enable the telemetry service. Default: false[39m
[2m  enabled = true[22m
[32m- # Specify the IPv4/6 host over which the built-in HTTP server will serve the metrics[39m
[32m- # gathered by the telemetry service. Default: 127.0.0.1[39m
[32m- host = '0.0.0.0'[39m
[32m- # Specify the port over which the built-in HTTP server will serve the metrics gathered[39m
[32m- # by the telemetry service. Default: 3001[39m
[31m+ host = \\"0.0.0.0\\"[39m
[2m  port = 3001[22m
[32m-[39m


[2m  [[chains]][22m
[2m  id = \\"juno-2\\"[22m
[31m+ type = \\"CosmosSdk\\"[39m
[2m  key_name = \\"juno-2-cli\\"[22m
[32m- rpc_addr = \\"http://juno-2-genesis.default.svc.cluster.local:26657\\"[39m
[32m- grpc_addr = \\"http://juno-2-genesis.default.svc.cluster.local:9090\\"[39m
[32m- event_source = { mode = 'push', url = \\"ws://juno-2-genesis.default.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[32m- # Experimental: Whether or not the full node is trusted.[39m
[31m+[39m
[31m+ rpc_addr = \\"http://juno-2-genesis.$NAMESPACE.svc.cluster.local:26657\\"[39m
[31m+ grpc_addr = \\"http://juno-2-genesis.$NAMESPACE.svc.cluster.local:9090\\"[39m
[31m+ event_source = { mode = 'push', url = \\"ws://juno-2-genesis.$NAMESPACE.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[2m  trusted_node = false[22m
[2m  account_prefix = \\"juno\\"[22m
[2m  default_gas = 500000000[22m
[33m@@ -103,17 +56,16 @@[39m
[2m  trusting_period = \\"75s\\"[22m
[2m  trust_threshold = { numerator = \\"2\\", denominator = \\"3\\" }[22m
[2m  address_type = { derivation = 'cosmos' }[22m
[32m- gas_price = { price = 0.25, denom = \\"ujuno\\" }[39m
[32m-[39m
[32m-[39m
[31m+ gas_price = { price = 1.25, denom = \\"ujuno\\" }[39m

[2m  [[chains]][22m
[2m  id = \\"cosmoshub-4\\"[22m
[31m+ type = \\"CosmosSdk\\"[39m
[2m  key_name = \\"cosmoshub-4-cli\\"[22m
[32m- rpc_addr = \\"http://cosmoshub-4-genesis.default.svc.cluster.local:26657\\"[39m
[32m- grpc_addr = \\"http://cosmoshub-4-genesis.default.svc.cluster.local:9090\\"[39m
[32m- event_source = { mode = 'push', url = \\"ws://cosmoshub-4-genesis.default.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[32m- # Experimental: Whether or not the full node is trusted.[39m
[31m+[39m
[31m+ rpc_addr = \\"http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:26657\\"[39m
[31m+ grpc_addr = \\"http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:9090\\"[39m
[31m+ event_source = { mode = 'push', url = \\"ws://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[2m  trusted_node = false[22m
[2m  account_prefix = \\"cosmos\\"[22m
[2m  default_gas = 500000000[22m
[33m@@ -128,96 +80,48 @@[39m
[2m  trusting_period = \\"75s\\"[22m
[2m  trust_threshold = { numerator = \\"2\\", denominator = \\"3\\" }[22m
[2m  address_type = { derivation = 'cosmos' }[22m
[32m- gas_price = { price = 0.25, denom = \\"uatom\\" }",[39m
[31m+ gas_price = { price = 1.25, denom = \\"uatom\\" }",[39m
[2m      "config.toml": "# The global section has parameters that apply globally to the relayer operation.[22m
[2m  [global][22m
[32m- # Specify the verbosity for the relayer logging output. Default: 'info'[39m
[32m- # Valid options are 'error', 'warn', 'info', 'debug', 'trace'.[39m
[32m- log_level = 'info'[39m
[32m- # Specify the mode to be used by the relayer. [Required][39m
[31m+ log_level = \\"info\\"[39m
[31m+[39m
[2m  [mode][22m
[32m- # Specify the client mode.[39m
[2m  [mode.clients][22m
[32m- # Whether or not to enable the client workers. [Required][39m
[2m  enabled = true[22m
[32m- # Whether or not to enable periodic refresh of clients. [Default: true][39m
[32m- # This feature only applies to clients that underlie an open channel.[39m
[32m- # For Tendermint clients, the frequency at which Hermes refreshes them is 2/3 of their[39m
[32m- # trusting period (e.g., refresh every ~9 days if the trusting period is 14 days).[39m
[32m- # Note: Even if this is disabled, clients will be refreshed automatically if[39m
[32m- #      there is activity on a connection or channel they are involved with.[39m
[2m  refresh = true[22m
[32m- # Whether or not to enable misbehaviour detection for clients. [Default: false][39m
[2m  misbehaviour = true[22m
[32m- # Specify the connections mode.[39m
[31m+[39m
[2m  [mode.connections][22m
[32m- # Whether or not to enable the connection workers for handshake completion. [Required][39m
[2m  enabled = true[22m
[32m- # Specify the channels mode.[39m
[31m+[39m
[2m  [mode.channels][22m
[32m- # Whether or not to enable the channel workers for handshake completion. [Required][39m
[2m  enabled = true[22m
[32m- # Specify the packets mode.[39m
[31m+[39m
[2m  [mode.packets][22m
[32m- # Whether or not to enable the packet workers. [Required][39m
[2m  enabled = true[22m
[32m- # Parametrize the periodic packet clearing feature.[39m
[32m- # Interval (in number of blocks) at which pending packets[39m
[32m- # should be periodically cleared. A value of '0' will disable[39m
[32m- # periodic packet clearing. [Default: 100][39m
[2m  clear_interval = 100[22m
[32m- # Whether or not to clear packets on start. [Default: false][39m
[2m  clear_on_start = true[22m
[32m- # Toggle the transaction confirmation mechanism.[39m
[32m- # The tx confirmation mechanism periodically queries the \`/tx_search\` RPC[39m
[32m- # endpoint to check that previously-submitted transactions[39m
[32m- # (to any chain in this config file) have been successfully delivered.[39m
[32m- # If they have not been, and \`clear_interval = 0\`, then those packets are[39m
[32m- # queued up for re-submission.[39m
[32m- # Experimental feature. Affects telemetry if set to false.[39m
[32m- # [Default: true][39m
[2m  tx_confirmation = true[22m
[32m- # Auto register the counterparty payee on a destination chain to[39m
[32m- # the relayer's address on the source chain. This can be used[39m
[32m- # for simple configuration of the relayer to receive fees for[39m
[32m- # relaying RecvPacket on fee-enabled channels.[39m
[32m- # For more complex configuration, turn this off and use the CLI[39m
[32m- # to manually register the payee addresses.[39m
[32m- # [Default: false][39m
[32m- auto_register_counterparty_payee = false[39m
[32m- # The REST section defines parameters for Hermes' built-in RESTful API.[39m
[32m- # https://hermes.informal.systems/rest.html[39m
[31m+[39m
[2m  [rest][22m
[32m- # Whether or not to enable the REST service. Default: false[39m
[2m  enabled = true[22m
[32m- # Specify the IPv4/6 host over which the built-in HTTP server will serve the RESTful[39m
[32m- # API requests. Default: 127.0.0.1[39m
[32m- host =  '0.0.0.0'[39m
[32m- # Specify the port over which the built-in HTTP server will serve the restful API[39m
[32m- # requests. Default: 3000[39m
[31m+ host = \\"0.0.0.0\\"[39m
[2m  port = 3000[22m
[32m- # The telemetry section defines parameters for Hermes' built-in telemetry capabilities.[39m
[32m- # https://hermes.informal.systems/telemetry.html[39m
[31m+[39m
[2m  [telemetry][22m
[32m- # Whether or not to enable the telemetry service. Default: false[39m
[2m  enabled = true[22m
[32m- # Specify the IPv4/6 host over which the built-in HTTP server will serve the metrics[39m
[32m- # gathered by the telemetry service. Default: 127.0.0.1[39m
[32m- host = '0.0.0.0'[39m
[32m- # Specify the port over which the built-in HTTP server will serve the metrics gathered[39m
[32m- # by the telemetry service. Default: 3001[39m
[31m+ host = \\"0.0.0.0\\"[39m
[2m  port = 3001[22m
[32m-[39m


[2m  [[chains]][22m
[2m  id = \\"juno-2\\"[22m
[2m  type = \\"CosmosSdk\\"[22m
[2m  key_name = \\"juno-2\\"[22m
[32m- rpc_addr = \\"http://juno-2-genesis.default.svc.cluster.local:26657\\"[39m
[32m- grpc_addr = \\"http://juno-2-genesis.default.svc.cluster.local:9090\\"[39m
[32m- event_source = { mode = 'push', url = \\"ws://juno-2-genesis.default.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[32m- # Experimental: Whether or not the full node is trusted.[39m
[31m+[39m
[31m+ rpc_addr = \\"http://juno-2-genesis.$NAMESPACE.svc.cluster.local:26657\\"[39m
[31m+ grpc_addr = \\"http://juno-2-genesis.$NAMESPACE.svc.cluster.local:9090\\"[39m
[31m+ event_source = { mode = 'push', url = \\"ws://juno-2-genesis.$NAMESPACE.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[2m  trusted_node = false[22m
[2m  account_prefix = \\"juno\\"[22m
[2m  default_gas = 500000000[22m
[33m@@ -233,17 +137,15 @@[39m
[2m  trust_threshold = { numerator = \\"2\\", denominator = \\"3\\" }[22m
[2m  address_type = { derivation = 'cosmos' }[22m
[2m  gas_price = { price = 1.25, denom = \\"ujuno\\" }[22m
[32m-[39m
[32m-[39m

[2m  [[chains]][22m
[2m  id = \\"cosmoshub-4\\"[22m
[2m  type = \\"CosmosSdk\\"[22m
[2m  key_name = \\"cosmoshub-4\\"[22m
[32m- rpc_addr = \\"http://cosmoshub-4-genesis.default.svc.cluster.local:26657\\"[39m
[32m- grpc_addr = \\"http://cosmoshub-4-genesis.default.svc.cluster.local:9090\\"[39m
[32m- event_source = { mode = 'push', url = \\"ws://cosmoshub-4-genesis.default.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[32m- # Experimental: Whether or not the full node is trusted.[39m
[31m+[39m
[31m+ rpc_addr = \\"http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:26657\\"[39m
[31m+ grpc_addr = \\"http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:9090\\"[39m
[31m+ event_source = { mode = 'push', url = \\"ws://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[2m  trusted_node = false[22m
[2m  account_prefix = \\"cosmos\\"[22m
[2m  default_gas = 500000000[22m
[33m@@ -262,6 +164,15 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "relayer",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "hermes-juno-cosmos",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/role": "hermes",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "hermes-juno-cosmos",[22m
[2m    },[22m
[2m  }[22m

--- StatefulSet/hermes-juno-cosmos ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,15 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "relayer",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "hermes-juno-cosmos",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/role": "hermes",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "hermes-juno-cosmos",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -29,16 +38,18 @@[39m
[2m            "app.kubernetes.io/name": "hermes-juno-cosmos",[22m
[2m            "app.kubernetes.io/rawname": "juno-cosmos",[22m
[2m            "app.kubernetes.io/type": "hermes",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[2m          "containers": Array [[22m
[2m            Object {[22m
[31m+             "args": Array [[39m
[31m+               "/exposer/exposer",[39m
[31m+             ],[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "/exposer/exposer",[39m
[2m              ],[22m
[2m              "env": Array [[22m
[2m                Object {[22m
[33m@@ -55,11 +66,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -83,14 +94,24 @@[39m
[2m              ],[22m
[2m            },[22m
[2m            Object {[22m
[31m+             "args": Array [[39m
[31m+               "RLY_INDEX=\${HOSTNAME##*-}[39m
[31m+ echo \\"Relayer Index: $RLY_INDEX\\"[39m
[31m+ hermes start",[39m
[31m+             ],[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "RLY_INDEX=\${HOSTNAME##*-}[39m
[32m- echo \\"Relayer Index: $RLY_INDEX\\"[39m
[32m- hermes start",[39m
[2m              ],[22m
[2m              "env": Array [[22m
[31m+               Object {[39m
[31m+                 "name": "NAMESPACE",[39m
[31m+                 "valueFrom": Object {[39m
[31m+                   "fieldRef": Object {[39m
[31m+                     "fieldPath": "metadata.namespace",[39m
[31m+                   },[39m
[31m+                 },[39m
[31m+               },[39m
[2m                Object {[22m
[2m                  "name": "RELAYER_DIR",[22m
[2m                  "value": "/root/.hermes",[22m
[33m@@ -101,12 +122,12 @@[39m
[2m              "name": "relayer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[2m              },[22m
[2m              "securityContext": Object {[22m
[33m@@ -127,24 +148,26 @@[39m
[2m          ],[22m
[2m          "initContainers": Array [[22m
[2m            Object {[22m
[31m+             "args": Array [[39m
[31m+               "# Install exposer binary from the image[39m
[31m+ cp /bin/exposer /exposer/exposer[39m
[31m+ chmod +x /exposer/exposer",[39m
[31m+             ],[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "# Install exposer binary from the image[39m
[32m- cp /bin/exposer /exposer/exposer[39m
[32m- chmod +x /exposer/exposer",[39m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/exposer:20250205-544757d",[22m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "init-exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "100M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "100M",[39m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[33m@@ -155,9 +178,7 @@[39m
[2m              ],[22m
[2m            },[22m
[2m            Object {[22m
[32m-             "command": Array [[39m
[32m-               "bash",[39m
[32m-               "-c",[39m
[31m+             "args": Array [[39m
[2m                "set -ux[22m

[2m  RLY_INDEX=\${HOSTNAME##*-}[22m
[33m@@ -166,18 +187,16 @@[39m
[2m  mkdir -p $RELAYER_DIR[22m
[2m  cp /configs/config.toml $RELAYER_DIR/config.toml[22m
[2m  cp /configs/config-cli.toml $RELAYER_DIR/config-cli.toml[22m
[32m- cat $RELAYER_DIR/config.toml[39m
[31m+[39m
[31m+ # Replace namespace placeholder with actual namespace environment variable[39m
[31m+ sed -i \\"s|\\\\$NAMESPACE|$NAMESPACE|g\\" $RELAYER_DIR/config.toml[39m
[31m+ sed -i \\"s|\\\\$NAMESPACE|$NAMESPACE|g\\" $RELAYER_DIR/config-cli.toml[39m

[32m- MNEMONIC=$(jq -r \\".relayers[$RELAYER_INDEX].mnemonic\\" $KEYS_CONFIG)[39m
[31m+ MNEMONIC=$(jq -r \\".relayers[$RLY_INDEX].mnemonic\\" $KEYS_CONFIG)[39m
[2m  echo $MNEMONIC > $RELAYER_DIR/mnemonic.txt[22m
[32m- MNEMONIC_CLI=$(jq -r \\".relayers_cli[$RELAYER_INDEX].mnemonic\\" $KEYS_CONFIG)[39m
[31m+ MNEMONIC_CLI=$(jq -r \\".relayers_cli[$RLY_INDEX].mnemonic\\" $KEYS_CONFIG)[39m
[2m  echo $MNEMONIC_CLI > $RELAYER_DIR/mnemonic-cli.txt[22m

[32m- echo \\"Debug output for juno-cosmos...\\"[39m
[32m- cat << EOF[39m
[32m-               map[string]interface {}[39m
[32m-               {\\"chains\\":[\\"juno-2\\",\\"cosmoshub-4\\"],\\"channels\\":[{\\"a-chain\\":\\"juno-2\\",\\"a-port\\":\\"transfer\\",\\"b-chain\\":\\"cosmoshub-4\\",\\"b-port\\":\\"transfer\\",\\"new-connection\\":true}],\\"config\\":{\\"event_source\\":{\\"mode\\":\\"push\\"},\\"global\\":{\\"log_level\\":\\"info\\"},\\"mode\\":{\\"channels\\":{\\"enabled\\":true},\\"clients\\":{\\"enabled\\":true,\\"misbehaviour\\":true,\\"refresh\\":true},\\"connections\\":{\\"enabled\\":true},\\"packets\\":{\\"clear_interval\\":100,\\"clear_on_start\\":true,\\"enabled\\":true,\\"tx_confirmation\\":true}},\\"rest\\":{\\"enabled\\":true,\\"host\\":\\"0.0.0.0\\",\\"port\\":3000},\\"telemetry\\":{\\"enabled\\":true,\\"host\\":\\"0.0.0.0\\",\\"port\\":3001}},\\"fullname\\":\\"hermes-juno-cosmos\\",\\"ics\\":{\\"enabled\\":false},\\"image\\":\\"ghcr.io/cosmology-tech/starship/hermes:1.10.0\\",\\"name\\":\\"juno-cosmos\\",\\"ports\\":{\\"exposer\\":4002},\\"replicas\\":1,\\"type\\":\\"hermes\\"}[39m
[32m- EOF[39m

[2m  echo \\"Creating key for juno-2...\\"[22m
[2m  hermes keys add \\\\[22m
[33m@@ -240,12 +259,17 @@[39m
[2m    $DENOM \\\\[22m
[2m    http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:8000/credit \\\\[22m
[2m    \\"false\\" || true[22m
[31m+[39m
[2m  hermes create channel \\\\[22m
[2m    --new-client-connection --yes \\\\[22m
[2m    --b-chain cosmoshub-4 \\\\[22m
[2m    --a-chain juno-2 \\\\[22m
[2m    --a-port transfer \\\\[22m
[2m    --b-port transfer",[22m
[31m+             ],[39m
[31m+             "command": Array [[39m
[31m+               "bash",[39m
[31m+               "-c",[39m
[2m              ],[22m
[2m              "env": Array [[22m
[2m                Object {[22m
[33m@@ -266,7 +290,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "RELAYER_INDEX",[22m
[32m-                 "value": "1",[39m
[31m+                 "value": "\${HOSTNAME##*-}",[39m
[2m                },[22m
[2m              ],[22m
[2m              "image": "ghcr.io/cosmology-tech/starship/hermes:1.10.0",[22m
[33m@@ -274,12 +298,12 @@[39m
[2m              "name": "init-relayer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[33m@@ -310,6 +334,7 @@[39m
[2m    echo \\"Checking: http://juno-2-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id\\"[22m
[2m    sleep 10;[22m
[2m  done[22m
[31m+[39m
[2m  while [ $(curl -sw '%{http_code}' http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id -o /dev/null) -ne 200 ]; do[22m
[2m    echo \\"Genesis validator does not seem to be ready for: cosmoshub-4. Waiting for it to start...\\"[22m
[2m    echo \\"Checking: http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id\\"[22m
[33m@@ -332,16 +357,16 @@[39m
[2m                  },[22m
[2m                },[22m
[2m              ],[22m
[32m-             "image": "curlimages/curl",[39m
[31m+             "image": "curlimages/curl:latest",[39m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "wait-for-chains",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m

--- ConfigMap/hermes-osmos-cosmos ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -3,92 +3,45 @@[39m
[2m    "data": Object {[22m
[2m      "config-cli.toml": "# The global section has parameters that apply globally to the relayer operation.[22m
[2m  [global][22m
[32m- # Specify the verbosity for the relayer logging output. Default: 'info'[39m
[32m- # Valid options are 'error', 'warn', 'info', 'debug', 'trace'.[39m
[32m- log_level = 'info'[39m
[32m- # Specify the mode to be used by the relayer. [Required][39m
[31m+ log_level = \\"info\\"[39m
[31m+[39m
[2m  [mode][22m
[32m- # Specify the client mode.[39m
[2m  [mode.clients][22m
[32m- # Whether or not to enable the client workers. [Required][39m
[2m  enabled = true[22m
[32m- # Whether or not to enable periodic refresh of clients. [Default: true][39m
[32m- # This feature only applies to clients that underlie an open channel.[39m
[32m- # For Tendermint clients, the frequency at which Hermes refreshes them is 2/3 of their[39m
[32m- # trusting period (e.g., refresh every ~9 days if the trusting period is 14 days).[39m
[32m- # Note: Even if this is disabled, clients will be refreshed automatically if[39m
[32m- #      there is activity on a connection or channel they are involved with.[39m
[2m  refresh = true[22m
[32m- # Whether or not to enable misbehaviour detection for clients. [Default: false][39m
[2m  misbehaviour = true[22m
[32m- # Specify the connections mode.[39m
[31m+[39m
[2m  [mode.connections][22m
[32m- # Whether or not to enable the connection workers for handshake completion. [Required][39m
[2m  enabled = true[22m
[32m- # Specify the channels mode.[39m
[31m+[39m
[2m  [mode.channels][22m
[32m- # Whether or not to enable the channel workers for handshake completion. [Required][39m
[2m  enabled = true[22m
[32m- # Specify the packets mode.[39m
[31m+[39m
[2m  [mode.packets][22m
[32m- # Whether or not to enable the packet workers. [Required][39m
[2m  enabled = true[22m
[32m- # Parametrize the periodic packet clearing feature.[39m
[32m- # Interval (in number of blocks) at which pending packets[39m
[32m- # should be periodically cleared. A value of '0' will disable[39m
[32m- # periodic packet clearing. [Default: 100][39m
[2m  clear_interval = 100[22m
[32m- # Whether or not to clear packets on start. [Default: false][39m
[2m  clear_on_start = true[22m
[32m- # Toggle the transaction confirmation mechanism.[39m
[32m- # The tx confirmation mechanism periodically queries the \`/tx_search\` RPC[39m
[32m- # endpoint to check that previously-submitted transactions[39m
[32m- # (to any chain in this config file) have been successfully delivered.[39m
[32m- # If they have not been, and \`clear_interval = 0\`, then those packets are[39m
[32m- # queued up for re-submission.[39m
[32m- # Experimental feature. Affects telemetry if set to false.[39m
[32m- # [Default: true][39m
[2m  tx_confirmation = true[22m
[32m- # Auto register the counterparty payee on a destination chain to[39m
[32m- # the relayer's address on the source chain. This can be used[39m
[32m- # for simple configuration of the relayer to receive fees for[39m
[32m- # relaying RecvPacket on fee-enabled channels.[39m
[32m- # For more complex configuration, turn this off and use the CLI[39m
[32m- # to manually register the payee addresses.[39m
[32m- # [Default: false][39m
[32m- auto_register_counterparty_payee = false[39m
[32m- # The REST section defines parameters for Hermes' built-in RESTful API.[39m
[32m- # https://hermes.informal.systems/rest.html[39m
[31m+[39m
[2m  [rest][22m
[32m- # Whether or not to enable the REST service. Default: false[39m
[2m  enabled = true[22m
[32m- # Specify the IPv4/6 host over which the built-in HTTP server will serve the RESTful[39m
[32m- # API requests. Default: 127.0.0.1[39m
[32m- host =  '0.0.0.0'[39m
[32m- # Specify the port over which the built-in HTTP server will serve the restful API[39m
[32m- # requests. Default: 3000[39m
[31m+ host = \\"0.0.0.0\\"[39m
[2m  port = 3000[22m
[32m- # The telemetry section defines parameters for Hermes' built-in telemetry capabilities.[39m
[32m- # https://hermes.informal.systems/telemetry.html[39m
[31m+[39m
[2m  [telemetry][22m
[32m- # Whether or not to enable the telemetry service. Default: false[39m
[2m  enabled = true[22m
[32m- # Specify the IPv4/6 host over which the built-in HTTP server will serve the metrics[39m
[32m- # gathered by the telemetry service. Default: 127.0.0.1[39m
[32m- host = '0.0.0.0'[39m
[32m- # Specify the port over which the built-in HTTP server will serve the metrics gathered[39m
[32m- # by the telemetry service. Default: 3001[39m
[31m+ host = \\"0.0.0.0\\"[39m
[2m  port = 3001[22m
[32m-[39m


[2m  [[chains]][22m
[2m  id = \\"osmosis-1\\"[22m
[31m+ type = \\"CosmosSdk\\"[39m
[2m  key_name = \\"osmosis-1-cli\\"[22m
[32m- rpc_addr = \\"http://osmosis-1-genesis.default.svc.cluster.local:26657\\"[39m
[32m- grpc_addr = \\"http://osmosis-1-genesis.default.svc.cluster.local:9090\\"[39m
[32m- event_source = { mode = 'push', url = \\"ws://osmosis-1-genesis.default.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[32m- # Experimental: Whether or not the full node is trusted.[39m
[31m+[39m
[31m+ rpc_addr = \\"http://osmosis-1-genesis.$NAMESPACE.svc.cluster.local:26657\\"[39m
[31m+ grpc_addr = \\"http://osmosis-1-genesis.$NAMESPACE.svc.cluster.local:9090\\"[39m
[31m+ event_source = { mode = 'push', url = \\"ws://osmosis-1-genesis.$NAMESPACE.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[2m  trusted_node = false[22m
[2m  account_prefix = \\"osmo\\"[22m
[2m  default_gas = 500000000[22m
[33m@@ -103,17 +56,16 @@[39m
[2m  trusting_period = \\"75s\\"[22m
[2m  trust_threshold = { numerator = \\"2\\", denominator = \\"3\\" }[22m
[2m  address_type = { derivation = 'cosmos' }[22m
[32m- gas_price = { price = 0.25, denom = \\"uosmo\\" }[39m
[32m-[39m
[32m-[39m
[31m+ gas_price = { price = 1.25, denom = \\"uosmo\\" }[39m

[2m  [[chains]][22m
[2m  id = \\"cosmoshub-4\\"[22m
[31m+ type = \\"CosmosSdk\\"[39m
[2m  key_name = \\"cosmoshub-4-cli\\"[22m
[32m- rpc_addr = \\"http://cosmoshub-4-genesis.default.svc.cluster.local:26657\\"[39m
[32m- grpc_addr = \\"http://cosmoshub-4-genesis.default.svc.cluster.local:9090\\"[39m
[32m- event_source = { mode = 'push', url = \\"ws://cosmoshub-4-genesis.default.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[32m- # Experimental: Whether or not the full node is trusted.[39m
[31m+[39m
[31m+ rpc_addr = \\"http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:26657\\"[39m
[31m+ grpc_addr = \\"http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:9090\\"[39m
[31m+ event_source = { mode = 'push', url = \\"ws://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[2m  trusted_node = false[22m
[2m  account_prefix = \\"cosmos\\"[22m
[2m  default_gas = 500000000[22m
[33m@@ -128,96 +80,48 @@[39m
[2m  trusting_period = \\"75s\\"[22m
[2m  trust_threshold = { numerator = \\"2\\", denominator = \\"3\\" }[22m
[2m  address_type = { derivation = 'cosmos' }[22m
[32m- gas_price = { price = 0.25, denom = \\"uatom\\" }",[39m
[31m+ gas_price = { price = 1.25, denom = \\"uatom\\" }",[39m
[2m      "config.toml": "# The global section has parameters that apply globally to the relayer operation.[22m
[2m  [global][22m
[32m- # Specify the verbosity for the relayer logging output. Default: 'info'[39m
[32m- # Valid options are 'error', 'warn', 'info', 'debug', 'trace'.[39m
[32m- log_level = 'info'[39m
[32m- # Specify the mode to be used by the relayer. [Required][39m
[31m+ log_level = \\"info\\"[39m
[31m+[39m
[2m  [mode][22m
[32m- # Specify the client mode.[39m
[2m  [mode.clients][22m
[32m- # Whether or not to enable the client workers. [Required][39m
[2m  enabled = true[22m
[32m- # Whether or not to enable periodic refresh of clients. [Default: true][39m
[32m- # This feature only applies to clients that underlie an open channel.[39m
[32m- # For Tendermint clients, the frequency at which Hermes refreshes them is 2/3 of their[39m
[32m- # trusting period (e.g., refresh every ~9 days if the trusting period is 14 days).[39m
[32m- # Note: Even if this is disabled, clients will be refreshed automatically if[39m
[32m- #      there is activity on a connection or channel they are involved with.[39m
[2m  refresh = true[22m
[32m- # Whether or not to enable misbehaviour detection for clients. [Default: false][39m
[2m  misbehaviour = true[22m
[32m- # Specify the connections mode.[39m
[31m+[39m
[2m  [mode.connections][22m
[32m- # Whether or not to enable the connection workers for handshake completion. [Required][39m
[2m  enabled = true[22m
[32m- # Specify the channels mode.[39m
[31m+[39m
[2m  [mode.channels][22m
[32m- # Whether or not to enable the channel workers for handshake completion. [Required][39m
[2m  enabled = true[22m
[32m- # Specify the packets mode.[39m
[31m+[39m
[2m  [mode.packets][22m
[32m- # Whether or not to enable the packet workers. [Required][39m
[2m  enabled = true[22m
[32m- # Parametrize the periodic packet clearing feature.[39m
[32m- # Interval (in number of blocks) at which pending packets[39m
[32m- # should be periodically cleared. A value of '0' will disable[39m
[32m- # periodic packet clearing. [Default: 100][39m
[2m  clear_interval = 100[22m
[32m- # Whether or not to clear packets on start. [Default: false][39m
[2m  clear_on_start = true[22m
[32m- # Toggle the transaction confirmation mechanism.[39m
[32m- # The tx confirmation mechanism periodically queries the \`/tx_search\` RPC[39m
[32m- # endpoint to check that previously-submitted transactions[39m
[32m- # (to any chain in this config file) have been successfully delivered.[39m
[32m- # If they have not been, and \`clear_interval = 0\`, then those packets are[39m
[32m- # queued up for re-submission.[39m
[32m- # Experimental feature. Affects telemetry if set to false.[39m
[32m- # [Default: true][39m
[2m  tx_confirmation = true[22m
[32m- # Auto register the counterparty payee on a destination chain to[39m
[32m- # the relayer's address on the source chain. This can be used[39m
[32m- # for simple configuration of the relayer to receive fees for[39m
[32m- # relaying RecvPacket on fee-enabled channels.[39m
[32m- # For more complex configuration, turn this off and use the CLI[39m
[32m- # to manually register the payee addresses.[39m
[32m- # [Default: false][39m
[32m- auto_register_counterparty_payee = false[39m
[32m- # The REST section defines parameters for Hermes' built-in RESTful API.[39m
[32m- # https://hermes.informal.systems/rest.html[39m
[31m+[39m
[2m  [rest][22m
[32m- # Whether or not to enable the REST service. Default: false[39m
[2m  enabled = true[22m
[32m- # Specify the IPv4/6 host over which the built-in HTTP server will serve the RESTful[39m
[32m- # API requests. Default: 127.0.0.1[39m
[32m- host =  '0.0.0.0'[39m
[32m- # Specify the port over which the built-in HTTP server will serve the restful API[39m
[32m- # requests. Default: 3000[39m
[31m+ host = \\"0.0.0.0\\"[39m
[2m  port = 3000[22m
[32m- # The telemetry section defines parameters for Hermes' built-in telemetry capabilities.[39m
[32m- # https://hermes.informal.systems/telemetry.html[39m
[31m+[39m
[2m  [telemetry][22m
[32m- # Whether or not to enable the telemetry service. Default: false[39m
[2m  enabled = true[22m
[32m- # Specify the IPv4/6 host over which the built-in HTTP server will serve the metrics[39m
[32m- # gathered by the telemetry service. Default: 127.0.0.1[39m
[32m- host = '0.0.0.0'[39m
[32m- # Specify the port over which the built-in HTTP server will serve the metrics gathered[39m
[32m- # by the telemetry service. Default: 3001[39m
[31m+ host = \\"0.0.0.0\\"[39m
[2m  port = 3001[22m
[32m-[39m


[2m  [[chains]][22m
[2m  id = \\"osmosis-1\\"[22m
[2m  type = \\"CosmosSdk\\"[22m
[2m  key_name = \\"osmosis-1\\"[22m
[32m- rpc_addr = \\"http://osmosis-1-genesis.default.svc.cluster.local:26657\\"[39m
[32m- grpc_addr = \\"http://osmosis-1-genesis.default.svc.cluster.local:9090\\"[39m
[32m- event_source = { mode = 'push', url = \\"ws://osmosis-1-genesis.default.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[32m- # Experimental: Whether or not the full node is trusted.[39m
[31m+[39m
[31m+ rpc_addr = \\"http://osmosis-1-genesis.$NAMESPACE.svc.cluster.local:26657\\"[39m
[31m+ grpc_addr = \\"http://osmosis-1-genesis.$NAMESPACE.svc.cluster.local:9090\\"[39m
[31m+ event_source = { mode = 'push', url = \\"ws://osmosis-1-genesis.$NAMESPACE.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[2m  trusted_node = false[22m
[2m  account_prefix = \\"osmo\\"[22m
[2m  default_gas = 500000000[22m
[33m@@ -233,17 +137,15 @@[39m
[2m  trust_threshold = { numerator = \\"2\\", denominator = \\"3\\" }[22m
[2m  address_type = { derivation = 'cosmos' }[22m
[2m  gas_price = { price = 1.25, denom = \\"uosmo\\" }[22m
[32m-[39m
[32m-[39m

[2m  [[chains]][22m
[2m  id = \\"cosmoshub-4\\"[22m
[2m  type = \\"CosmosSdk\\"[22m
[2m  key_name = \\"cosmoshub-4\\"[22m
[32m- rpc_addr = \\"http://cosmoshub-4-genesis.default.svc.cluster.local:26657\\"[39m
[32m- grpc_addr = \\"http://cosmoshub-4-genesis.default.svc.cluster.local:9090\\"[39m
[32m- event_source = { mode = 'push', url = \\"ws://cosmoshub-4-genesis.default.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[32m- # Experimental: Whether or not the full node is trusted.[39m
[31m+[39m
[31m+ rpc_addr = \\"http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:26657\\"[39m
[31m+ grpc_addr = \\"http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:9090\\"[39m
[31m+ event_source = { mode = 'push', url = \\"ws://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[2m  trusted_node = false[22m
[2m  account_prefix = \\"cosmos\\"[22m
[2m  default_gas = 500000000[22m
[33m@@ -262,6 +164,15 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "relayer",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "hermes-osmos-cosmos",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/role": "hermes",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "hermes-osmos-cosmos",[22m
[2m    },[22m
[2m  }[22m

--- StatefulSet/hermes-osmos-cosmos ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,15 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "relayer",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "hermes-osmos-cosmos",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/role": "hermes",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "hermes-osmos-cosmos",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -29,16 +38,18 @@[39m
[2m            "app.kubernetes.io/name": "hermes-osmos-cosmos",[22m
[2m            "app.kubernetes.io/rawname": "osmos-cosmos",[22m
[2m            "app.kubernetes.io/type": "hermes",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[2m          "containers": Array [[22m
[2m            Object {[22m
[31m+             "args": Array [[39m
[31m+               "/exposer/exposer",[39m
[31m+             ],[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "/exposer/exposer",[39m
[2m              ],[22m
[2m              "env": Array [[22m
[2m                Object {[22m
[33m@@ -55,11 +66,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -83,14 +94,24 @@[39m
[2m              ],[22m
[2m            },[22m
[2m            Object {[22m
[31m+             "args": Array [[39m
[31m+               "RLY_INDEX=\${HOSTNAME##*-}[39m
[31m+ echo \\"Relayer Index: $RLY_INDEX\\"[39m
[31m+ hermes start",[39m
[31m+             ],[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "RLY_INDEX=\${HOSTNAME##*-}[39m
[32m- echo \\"Relayer Index: $RLY_INDEX\\"[39m
[32m- hermes start",[39m
[2m              ],[22m
[2m              "env": Array [[22m
[31m+               Object {[39m
[31m+                 "name": "NAMESPACE",[39m
[31m+                 "valueFrom": Object {[39m
[31m+                   "fieldRef": Object {[39m
[31m+                     "fieldPath": "metadata.namespace",[39m
[31m+                   },[39m
[31m+                 },[39m
[31m+               },[39m
[2m                Object {[22m
[2m                  "name": "RELAYER_DIR",[22m
[2m                  "value": "/root/.hermes",[22m
[33m@@ -101,12 +122,12 @@[39m
[2m              "name": "relayer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[2m              },[22m
[2m              "securityContext": Object {[22m
[33m@@ -127,24 +148,26 @@[39m
[2m          ],[22m
[2m          "initContainers": Array [[22m
[2m            Object {[22m
[31m+             "args": Array [[39m
[31m+               "# Install exposer binary from the image[39m
[31m+ cp /bin/exposer /exposer/exposer[39m
[31m+ chmod +x /exposer/exposer",[39m
[31m+             ],[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "# Install exposer binary from the image[39m
[32m- cp /bin/exposer /exposer/exposer[39m
[32m- chmod +x /exposer/exposer",[39m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/exposer:20250205-544757d",[22m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "init-exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "100M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "100M",[39m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[33m@@ -155,9 +178,7 @@[39m
[2m              ],[22m
[2m            },[22m
[2m            Object {[22m
[32m-             "command": Array [[39m
[32m-               "bash",[39m
[32m-               "-c",[39m
[31m+             "args": Array [[39m
[2m                "set -ux[22m

[2m  RLY_INDEX=\${HOSTNAME##*-}[22m
[33m@@ -166,18 +187,16 @@[39m
[2m  mkdir -p $RELAYER_DIR[22m
[2m  cp /configs/config.toml $RELAYER_DIR/config.toml[22m
[2m  cp /configs/config-cli.toml $RELAYER_DIR/config-cli.toml[22m
[32m- cat $RELAYER_DIR/config.toml[39m
[31m+[39m
[31m+ # Replace namespace placeholder with actual namespace environment variable[39m
[31m+ sed -i \\"s|\\\\$NAMESPACE|$NAMESPACE|g\\" $RELAYER_DIR/config.toml[39m
[31m+ sed -i \\"s|\\\\$NAMESPACE|$NAMESPACE|g\\" $RELAYER_DIR/config-cli.toml[39m

[32m- MNEMONIC=$(jq -r \\".relayers[$RELAYER_INDEX].mnemonic\\" $KEYS_CONFIG)[39m
[31m+ MNEMONIC=$(jq -r \\".relayers[$RLY_INDEX].mnemonic\\" $KEYS_CONFIG)[39m
[2m  echo $MNEMONIC > $RELAYER_DIR/mnemonic.txt[22m
[32m- MNEMONIC_CLI=$(jq -r \\".relayers_cli[$RELAYER_INDEX].mnemonic\\" $KEYS_CONFIG)[39m
[31m+ MNEMONIC_CLI=$(jq -r \\".relayers_cli[$RLY_INDEX].mnemonic\\" $KEYS_CONFIG)[39m
[2m  echo $MNEMONIC_CLI > $RELAYER_DIR/mnemonic-cli.txt[22m

[32m- echo \\"Debug output for osmos-cosmos...\\"[39m
[32m- cat << EOF[39m
[32m-               map[string]interface {}[39m
[32m-               {\\"chains\\":[\\"osmosis-1\\",\\"cosmoshub-4\\"],\\"channels\\":[{\\"a-chain\\":\\"osmosis-1\\",\\"a-port\\":\\"transfer\\",\\"b-chain\\":\\"cosmoshub-4\\",\\"b-port\\":\\"transfer\\",\\"new-connection\\":true}],\\"config\\":{\\"event_source\\":{\\"mode\\":\\"push\\"},\\"global\\":{\\"log_level\\":\\"info\\"},\\"mode\\":{\\"channels\\":{\\"enabled\\":true},\\"clients\\":{\\"enabled\\":true,\\"misbehaviour\\":true,\\"refresh\\":true},\\"connections\\":{\\"enabled\\":true},\\"packets\\":{\\"clear_interval\\":100,\\"clear_on_start\\":true,\\"enabled\\":true,\\"tx_confirmation\\":true}},\\"rest\\":{\\"enabled\\":true,\\"host\\":\\"0.0.0.0\\",\\"port\\":3000},\\"telemetry\\":{\\"enabled\\":true,\\"host\\":\\"0.0.0.0\\",\\"port\\":3001}},\\"fullname\\":\\"hermes-osmos-cosmos\\",\\"ics\\":{\\"enabled\\":false},\\"image\\":\\"ghcr.io/cosmology-tech/starship/hermes:1.10.0\\",\\"name\\":\\"osmos-cosmos\\",\\"ports\\":{\\"exposer\\":3002},\\"replicas\\":1,\\"type\\":\\"hermes\\"}[39m
[32m- EOF[39m

[2m  echo \\"Creating key for osmosis-1...\\"[22m
[2m  hermes keys add \\\\[22m
[33m@@ -240,12 +259,17 @@[39m
[2m    $DENOM \\\\[22m
[2m    http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:8000/credit \\\\[22m
[2m    \\"false\\" || true[22m
[31m+[39m
[2m  hermes create channel \\\\[22m
[2m    --new-client-connection --yes \\\\[22m
[2m    --b-chain cosmoshub-4 \\\\[22m
[2m    --a-chain osmosis-1 \\\\[22m
[2m    --a-port transfer \\\\[22m
[2m    --b-port transfer",[22m
[31m+             ],[39m
[31m+             "command": Array [[39m
[31m+               "bash",[39m
[31m+               "-c",[39m
[2m              ],[22m
[2m              "env": Array [[22m
[2m                Object {[22m
[33m@@ -266,7 +290,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "RELAYER_INDEX",[22m
[32m-                 "value": "0",[39m
[31m+                 "value": "\${HOSTNAME##*-}",[39m
[2m                },[22m
[2m              ],[22m
[2m              "image": "ghcr.io/cosmology-tech/starship/hermes:1.10.0",[22m
[33m@@ -274,12 +298,12 @@[39m
[2m              "name": "init-relayer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[33m@@ -310,6 +334,7 @@[39m
[2m    echo \\"Checking: http://osmosis-1-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id\\"[22m
[2m    sleep 10;[22m
[2m  done[22m
[31m+[39m
[2m  while [ $(curl -sw '%{http_code}' http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id -o /dev/null) -ne 200 ]; do[22m
[2m    echo \\"Genesis validator does not seem to be ready for: cosmoshub-4. Waiting for it to start...\\"[22m
[2m    echo \\"Checking: http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id\\"[22m
[33m@@ -332,16 +357,16 @@[39m
[2m                  },[22m
[2m                },[22m
[2m              ],[22m
[32m-             "image": "curlimages/curl",[39m
[31m+             "image": "curlimages/curl:latest",[39m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "wait-for-chains",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m

--- ConfigMap/hermes-osmosis-juno ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -3,92 +3,45 @@[39m
[2m    "data": Object {[22m
[2m      "config-cli.toml": "# The global section has parameters that apply globally to the relayer operation.[22m
[2m  [global][22m
[32m- # Specify the verbosity for the relayer logging output. Default: 'info'[39m
[32m- # Valid options are 'error', 'warn', 'info', 'debug', 'trace'.[39m
[32m- log_level = 'info'[39m
[32m- # Specify the mode to be used by the relayer. [Required][39m
[31m+ log_level = \\"info\\"[39m
[31m+[39m
[2m  [mode][22m
[32m- # Specify the client mode.[39m
[2m  [mode.clients][22m
[32m- # Whether or not to enable the client workers. [Required][39m
[2m  enabled = true[22m
[32m- # Whether or not to enable periodic refresh of clients. [Default: true][39m
[32m- # This feature only applies to clients that underlie an open channel.[39m
[32m- # For Tendermint clients, the frequency at which Hermes refreshes them is 2/3 of their[39m
[32m- # trusting period (e.g., refresh every ~9 days if the trusting period is 14 days).[39m
[32m- # Note: Even if this is disabled, clients will be refreshed automatically if[39m
[32m- #      there is activity on a connection or channel they are involved with.[39m
[2m  refresh = true[22m
[32m- # Whether or not to enable misbehaviour detection for clients. [Default: false][39m
[2m  misbehaviour = true[22m
[32m- # Specify the connections mode.[39m
[31m+[39m
[2m  [mode.connections][22m
[32m- # Whether or not to enable the connection workers for handshake completion. [Required][39m
[2m  enabled = true[22m
[32m- # Specify the channels mode.[39m
[31m+[39m
[2m  [mode.channels][22m
[32m- # Whether or not to enable the channel workers for handshake completion. [Required][39m
[2m  enabled = true[22m
[32m- # Specify the packets mode.[39m
[31m+[39m
[2m  [mode.packets][22m
[32m- # Whether or not to enable the packet workers. [Required][39m
[2m  enabled = true[22m
[32m- # Parametrize the periodic packet clearing feature.[39m
[32m- # Interval (in number of blocks) at which pending packets[39m
[32m- # should be periodically cleared. A value of '0' will disable[39m
[32m- # periodic packet clearing. [Default: 100][39m
[2m  clear_interval = 100[22m
[32m- # Whether or not to clear packets on start. [Default: false][39m
[2m  clear_on_start = true[22m
[32m- # Toggle the transaction confirmation mechanism.[39m
[32m- # The tx confirmation mechanism periodically queries the \`/tx_search\` RPC[39m
[32m- # endpoint to check that previously-submitted transactions[39m
[32m- # (to any chain in this config file) have been successfully delivered.[39m
[32m- # If they have not been, and \`clear_interval = 0\`, then those packets are[39m
[32m- # queued up for re-submission.[39m
[32m- # Experimental feature. Affects telemetry if set to false.[39m
[32m- # [Default: true][39m
[2m  tx_confirmation = true[22m
[32m- # Auto register the counterparty payee on a destination chain to[39m
[32m- # the relayer's address on the source chain. This can be used[39m
[32m- # for simple configuration of the relayer to receive fees for[39m
[32m- # relaying RecvPacket on fee-enabled channels.[39m
[32m- # For more complex configuration, turn this off and use the CLI[39m
[32m- # to manually register the payee addresses.[39m
[32m- # [Default: false][39m
[32m- auto_register_counterparty_payee = false[39m
[32m- # The REST section defines parameters for Hermes' built-in RESTful API.[39m
[32m- # https://hermes.informal.systems/rest.html[39m
[31m+[39m
[2m  [rest][22m
[32m- # Whether or not to enable the REST service. Default: false[39m
[2m  enabled = true[22m
[32m- # Specify the IPv4/6 host over which the built-in HTTP server will serve the RESTful[39m
[32m- # API requests. Default: 127.0.0.1[39m
[32m- host =  '0.0.0.0'[39m
[32m- # Specify the port over which the built-in HTTP server will serve the restful API[39m
[32m- # requests. Default: 3000[39m
[31m+ host = \\"0.0.0.0\\"[39m
[2m  port = 3000[22m
[32m- # The telemetry section defines parameters for Hermes' built-in telemetry capabilities.[39m
[32m- # https://hermes.informal.systems/telemetry.html[39m
[31m+[39m
[2m  [telemetry][22m
[32m- # Whether or not to enable the telemetry service. Default: false[39m
[2m  enabled = true[22m
[32m- # Specify the IPv4/6 host over which the built-in HTTP server will serve the metrics[39m
[32m- # gathered by the telemetry service. Default: 127.0.0.1[39m
[32m- host = '0.0.0.0'[39m
[32m- # Specify the port over which the built-in HTTP server will serve the metrics gathered[39m
[32m- # by the telemetry service. Default: 3001[39m
[31m+ host = \\"0.0.0.0\\"[39m
[2m  port = 3001[22m
[32m-[39m


[2m  [[chains]][22m
[2m  id = \\"osmosis-1\\"[22m
[31m+ type = \\"CosmosSdk\\"[39m
[2m  key_name = \\"osmosis-1-cli\\"[22m
[32m- rpc_addr = \\"http://osmosis-1-genesis.default.svc.cluster.local:26657\\"[39m
[32m- grpc_addr = \\"http://osmosis-1-genesis.default.svc.cluster.local:9090\\"[39m
[32m- event_source = { mode = 'push', url = \\"ws://osmosis-1-genesis.default.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[32m- # Experimental: Whether or not the full node is trusted.[39m
[31m+[39m
[31m+ rpc_addr = \\"http://osmosis-1-genesis.$NAMESPACE.svc.cluster.local:26657\\"[39m
[31m+ grpc_addr = \\"http://osmosis-1-genesis.$NAMESPACE.svc.cluster.local:9090\\"[39m
[31m+ event_source = { mode = 'push', url = \\"ws://osmosis-1-genesis.$NAMESPACE.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[2m  trusted_node = false[22m
[2m  account_prefix = \\"osmo\\"[22m
[2m  default_gas = 500000000[22m
[33m@@ -103,17 +56,16 @@[39m
[2m  trusting_period = \\"75s\\"[22m
[2m  trust_threshold = { numerator = \\"2\\", denominator = \\"3\\" }[22m
[2m  address_type = { derivation = 'cosmos' }[22m
[32m- gas_price = { price = 0.25, denom = \\"uosmo\\" }[39m
[32m-[39m
[32m-[39m
[31m+ gas_price = { price = 1.25, denom = \\"uosmo\\" }[39m

[2m  [[chains]][22m
[2m  id = \\"juno-2\\"[22m
[31m+ type = \\"CosmosSdk\\"[39m
[2m  key_name = \\"juno-2-cli\\"[22m
[32m- rpc_addr = \\"http://juno-2-genesis.default.svc.cluster.local:26657\\"[39m
[32m- grpc_addr = \\"http://juno-2-genesis.default.svc.cluster.local:9090\\"[39m
[32m- event_source = { mode = 'push', url = \\"ws://juno-2-genesis.default.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[32m- # Experimental: Whether or not the full node is trusted.[39m
[31m+[39m
[31m+ rpc_addr = \\"http://juno-2-genesis.$NAMESPACE.svc.cluster.local:26657\\"[39m
[31m+ grpc_addr = \\"http://juno-2-genesis.$NAMESPACE.svc.cluster.local:9090\\"[39m
[31m+ event_source = { mode = 'push', url = \\"ws://juno-2-genesis.$NAMESPACE.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[2m  trusted_node = false[22m
[2m  account_prefix = \\"juno\\"[22m
[2m  default_gas = 500000000[22m
[33m@@ -128,96 +80,48 @@[39m
[2m  trusting_period = \\"75s\\"[22m
[2m  trust_threshold = { numerator = \\"2\\", denominator = \\"3\\" }[22m
[2m  address_type = { derivation = 'cosmos' }[22m
[32m- gas_price = { price = 0.25, denom = \\"ujuno\\" }",[39m
[31m+ gas_price = { price = 1.25, denom = \\"ujuno\\" }",[39m
[2m      "config.toml": "# The global section has parameters that apply globally to the relayer operation.[22m
[2m  [global][22m
[32m- # Specify the verbosity for the relayer logging output. Default: 'info'[39m
[32m- # Valid options are 'error', 'warn', 'info', 'debug', 'trace'.[39m
[32m- log_level = 'info'[39m
[32m- # Specify the mode to be used by the relayer. [Required][39m
[31m+ log_level = \\"info\\"[39m
[31m+[39m
[2m  [mode][22m
[32m- # Specify the client mode.[39m
[2m  [mode.clients][22m
[32m- # Whether or not to enable the client workers. [Required][39m
[2m  enabled = true[22m
[32m- # Whether or not to enable periodic refresh of clients. [Default: true][39m
[32m- # This feature only applies to clients that underlie an open channel.[39m
[32m- # For Tendermint clients, the frequency at which Hermes refreshes them is 2/3 of their[39m
[32m- # trusting period (e.g., refresh every ~9 days if the trusting period is 14 days).[39m
[32m- # Note: Even if this is disabled, clients will be refreshed automatically if[39m
[32m- #      there is activity on a connection or channel they are involved with.[39m
[2m  refresh = true[22m
[32m- # Whether or not to enable misbehaviour detection for clients. [Default: false][39m
[2m  misbehaviour = true[22m
[32m- # Specify the connections mode.[39m
[31m+[39m
[2m  [mode.connections][22m
[32m- # Whether or not to enable the connection workers for handshake completion. [Required][39m
[2m  enabled = true[22m
[32m- # Specify the channels mode.[39m
[31m+[39m
[2m  [mode.channels][22m
[32m- # Whether or not to enable the channel workers for handshake completion. [Required][39m
[2m  enabled = true[22m
[32m- # Specify the packets mode.[39m
[31m+[39m
[2m  [mode.packets][22m
[32m- # Whether or not to enable the packet workers. [Required][39m
[2m  enabled = true[22m
[32m- # Parametrize the periodic packet clearing feature.[39m
[32m- # Interval (in number of blocks) at which pending packets[39m
[32m- # should be periodically cleared. A value of '0' will disable[39m
[32m- # periodic packet clearing. [Default: 100][39m
[2m  clear_interval = 100[22m
[32m- # Whether or not to clear packets on start. [Default: false][39m
[2m  clear_on_start = true[22m
[32m- # Toggle the transaction confirmation mechanism.[39m
[32m- # The tx confirmation mechanism periodically queries the \`/tx_search\` RPC[39m
[32m- # endpoint to check that previously-submitted transactions[39m
[32m- # (to any chain in this config file) have been successfully delivered.[39m
[32m- # If they have not been, and \`clear_interval = 0\`, then those packets are[39m
[32m- # queued up for re-submission.[39m
[32m- # Experimental feature. Affects telemetry if set to false.[39m
[32m- # [Default: true][39m
[2m  tx_confirmation = true[22m
[32m- # Auto register the counterparty payee on a destination chain to[39m
[32m- # the relayer's address on the source chain. This can be used[39m
[32m- # for simple configuration of the relayer to receive fees for[39m
[32m- # relaying RecvPacket on fee-enabled channels.[39m
[32m- # For more complex configuration, turn this off and use the CLI[39m
[32m- # to manually register the payee addresses.[39m
[32m- # [Default: false][39m
[32m- auto_register_counterparty_payee = false[39m
[32m- # The REST section defines parameters for Hermes' built-in RESTful API.[39m
[32m- # https://hermes.informal.systems/rest.html[39m
[31m+[39m
[2m  [rest][22m
[32m- # Whether or not to enable the REST service. Default: false[39m
[2m  enabled = true[22m
[32m- # Specify the IPv4/6 host over which the built-in HTTP server will serve the RESTful[39m
[32m- # API requests. Default: 127.0.0.1[39m
[32m- host =  '0.0.0.0'[39m
[32m- # Specify the port over which the built-in HTTP server will serve the restful API[39m
[32m- # requests. Default: 3000[39m
[31m+ host = \\"0.0.0.0\\"[39m
[2m  port = 3000[22m
[32m- # The telemetry section defines parameters for Hermes' built-in telemetry capabilities.[39m
[32m- # https://hermes.informal.systems/telemetry.html[39m
[31m+[39m
[2m  [telemetry][22m
[32m- # Whether or not to enable the telemetry service. Default: false[39m
[2m  enabled = true[22m
[32m- # Specify the IPv4/6 host over which the built-in HTTP server will serve the metrics[39m
[32m- # gathered by the telemetry service. Default: 127.0.0.1[39m
[32m- host = '0.0.0.0'[39m
[32m- # Specify the port over which the built-in HTTP server will serve the metrics gathered[39m
[32m- # by the telemetry service. Default: 3001[39m
[31m+ host = \\"0.0.0.0\\"[39m
[2m  port = 3001[22m
[32m-[39m


[2m  [[chains]][22m
[2m  id = \\"osmosis-1\\"[22m
[2m  type = \\"CosmosSdk\\"[22m
[2m  key_name = \\"osmosis-1\\"[22m
[32m- rpc_addr = \\"http://osmosis-1-genesis.default.svc.cluster.local:26657\\"[39m
[32m- grpc_addr = \\"http://osmosis-1-genesis.default.svc.cluster.local:9090\\"[39m
[32m- event_source = { mode = 'push', url = \\"ws://osmosis-1-genesis.default.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[32m- # Experimental: Whether or not the full node is trusted.[39m
[31m+[39m
[31m+ rpc_addr = \\"http://osmosis-1-genesis.$NAMESPACE.svc.cluster.local:26657\\"[39m
[31m+ grpc_addr = \\"http://osmosis-1-genesis.$NAMESPACE.svc.cluster.local:9090\\"[39m
[31m+ event_source = { mode = 'push', url = \\"ws://osmosis-1-genesis.$NAMESPACE.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[2m  trusted_node = false[22m
[2m  account_prefix = \\"osmo\\"[22m
[2m  default_gas = 500000000[22m
[33m@@ -233,17 +137,15 @@[39m
[2m  trust_threshold = { numerator = \\"2\\", denominator = \\"3\\" }[22m
[2m  address_type = { derivation = 'cosmos' }[22m
[2m  gas_price = { price = 1.25, denom = \\"uosmo\\" }[22m
[32m-[39m
[32m-[39m

[2m  [[chains]][22m
[2m  id = \\"juno-2\\"[22m
[2m  type = \\"CosmosSdk\\"[22m
[2m  key_name = \\"juno-2\\"[22m
[32m- rpc_addr = \\"http://juno-2-genesis.default.svc.cluster.local:26657\\"[39m
[32m- grpc_addr = \\"http://juno-2-genesis.default.svc.cluster.local:9090\\"[39m
[32m- event_source = { mode = 'push', url = \\"ws://juno-2-genesis.default.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[32m- # Experimental: Whether or not the full node is trusted.[39m
[31m+[39m
[31m+ rpc_addr = \\"http://juno-2-genesis.$NAMESPACE.svc.cluster.local:26657\\"[39m
[31m+ grpc_addr = \\"http://juno-2-genesis.$NAMESPACE.svc.cluster.local:9090\\"[39m
[31m+ event_source = { mode = 'push', url = \\"ws://juno-2-genesis.$NAMESPACE.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[2m  trusted_node = false[22m
[2m  account_prefix = \\"juno\\"[22m
[2m  default_gas = 500000000[22m
[33m@@ -262,6 +164,15 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "relayer",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "hermes-osmosis-juno",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/role": "hermes",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "hermes-osmosis-juno",[22m
[2m    },[22m
[2m  }[22m

--- StatefulSet/hermes-osmosis-juno ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,15 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "relayer",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "hermes-osmosis-juno",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/role": "hermes",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "hermes-osmosis-juno",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -29,16 +38,18 @@[39m
[2m            "app.kubernetes.io/name": "hermes-osmosis-juno",[22m
[2m            "app.kubernetes.io/rawname": "osmosis-juno",[22m
[2m            "app.kubernetes.io/type": "hermes",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[2m          "containers": Array [[22m
[2m            Object {[22m
[31m+             "args": Array [[39m
[31m+               "/exposer/exposer",[39m
[31m+             ],[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "/exposer/exposer",[39m
[2m              ],[22m
[2m              "env": Array [[22m
[2m                Object {[22m
[33m@@ -55,11 +66,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -83,14 +94,24 @@[39m
[2m              ],[22m
[2m            },[22m
[2m            Object {[22m
[31m+             "args": Array [[39m
[31m+               "RLY_INDEX=\${HOSTNAME##*-}[39m
[31m+ echo \\"Relayer Index: $RLY_INDEX\\"[39m
[31m+ hermes start",[39m
[31m+             ],[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "RLY_INDEX=\${HOSTNAME##*-}[39m
[32m- echo \\"Relayer Index: $RLY_INDEX\\"[39m
[32m- hermes start",[39m
[2m              ],[22m
[2m              "env": Array [[22m
[31m+               Object {[39m
[31m+                 "name": "NAMESPACE",[39m
[31m+                 "valueFrom": Object {[39m
[31m+                   "fieldRef": Object {[39m
[31m+                     "fieldPath": "metadata.namespace",[39m
[31m+                   },[39m
[31m+                 },[39m
[31m+               },[39m
[2m                Object {[22m
[2m                  "name": "RELAYER_DIR",[22m
[2m                  "value": "/root/.hermes",[22m
[33m@@ -101,12 +122,12 @@[39m
[2m              "name": "relayer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[2m              },[22m
[2m              "securityContext": Object {[22m
[33m@@ -127,24 +148,26 @@[39m
[2m          ],[22m
[2m          "initContainers": Array [[22m
[2m            Object {[22m
[31m+             "args": Array [[39m
[31m+               "# Install exposer binary from the image[39m
[31m+ cp /bin/exposer /exposer/exposer[39m
[31m+ chmod +x /exposer/exposer",[39m
[31m+             ],[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "# Install exposer binary from the image[39m
[32m- cp /bin/exposer /exposer/exposer[39m
[32m- chmod +x /exposer/exposer",[39m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/exposer:20250205-544757d",[22m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "init-exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "100M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "100M",[39m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[33m@@ -155,9 +178,7 @@[39m
[2m              ],[22m
[2m            },[22m
[2m            Object {[22m
[32m-             "command": Array [[39m
[32m-               "bash",[39m
[32m-               "-c",[39m
[31m+             "args": Array [[39m
[2m                "set -ux[22m

[2m  RLY_INDEX=\${HOSTNAME##*-}[22m
[33m@@ -166,18 +187,16 @@[39m
[2m  mkdir -p $RELAYER_DIR[22m
[2m  cp /configs/config.toml $RELAYER_DIR/config.toml[22m
[2m  cp /configs/config-cli.toml $RELAYER_DIR/config-cli.toml[22m
[32m- cat $RELAYER_DIR/config.toml[39m
[31m+[39m
[31m+ # Replace namespace placeholder with actual namespace environment variable[39m
[31m+ sed -i \\"s|\\\\$NAMESPACE|$NAMESPACE|g\\" $RELAYER_DIR/config.toml[39m
[31m+ sed -i \\"s|\\\\$NAMESPACE|$NAMESPACE|g\\" $RELAYER_DIR/config-cli.toml[39m

[32m- MNEMONIC=$(jq -r \\".relayers[$RELAYER_INDEX].mnemonic\\" $KEYS_CONFIG)[39m
[31m+ MNEMONIC=$(jq -r \\".relayers[$RLY_INDEX].mnemonic\\" $KEYS_CONFIG)[39m
[2m  echo $MNEMONIC > $RELAYER_DIR/mnemonic.txt[22m
[32m- MNEMONIC_CLI=$(jq -r \\".relayers_cli[$RELAYER_INDEX].mnemonic\\" $KEYS_CONFIG)[39m
[31m+ MNEMONIC_CLI=$(jq -r \\".relayers_cli[$RLY_INDEX].mnemonic\\" $KEYS_CONFIG)[39m
[2m  echo $MNEMONIC_CLI > $RELAYER_DIR/mnemonic-cli.txt[22m

[32m- echo \\"Debug output for osmosis-juno...\\"[39m
[32m- cat << EOF[39m
[32m-               map[string]interface {}[39m
[32m-               {\\"chains\\":[\\"osmosis-1\\",\\"juno-2\\"],\\"channels\\":[{\\"a-chain\\":\\"osmosis-1\\",\\"a-port\\":\\"transfer\\",\\"b-chain\\":\\"juno-2\\",\\"b-port\\":\\"transfer\\",\\"new-connection\\":true}],\\"config\\":{\\"event_source\\":{\\"mode\\":\\"push\\"},\\"global\\":{\\"log_level\\":\\"info\\"},\\"mode\\":{\\"channels\\":{\\"enabled\\":true},\\"clients\\":{\\"enabled\\":true,\\"misbehaviour\\":true,\\"refresh\\":true},\\"connections\\":{\\"enabled\\":true},\\"packets\\":{\\"clear_interval\\":100,\\"clear_on_start\\":true,\\"enabled\\":true,\\"tx_confirmation\\":true}},\\"rest\\":{\\"enabled\\":true,\\"host\\":\\"0.0.0.0\\",\\"port\\":3000},\\"telemetry\\":{\\"enabled\\":true,\\"host\\":\\"0.0.0.0\\",\\"port\\":3001}},\\"fullname\\":\\"hermes-osmosis-juno\\",\\"ics\\":{\\"enabled\\":false},\\"image\\":\\"ghcr.io/cosmology-tech/starship/hermes:1.10.0\\",\\"name\\":\\"osmosis-juno\\",\\"ports\\":{\\"exposer\\":5002},\\"replicas\\":1,\\"type\\":\\"hermes\\"}[39m
[32m- EOF[39m

[2m  echo \\"Creating key for osmosis-1...\\"[22m
[2m  hermes keys add \\\\[22m
[33m@@ -240,12 +259,17 @@[39m
[2m    $DENOM \\\\[22m
[2m    http://juno-2-genesis.$NAMESPACE.svc.cluster.local:8000/credit \\\\[22m
[2m    \\"false\\" || true[22m
[31m+[39m
[2m  hermes create channel \\\\[22m
[2m    --new-client-connection --yes \\\\[22m
[2m    --b-chain juno-2 \\\\[22m
[2m    --a-chain osmosis-1 \\\\[22m
[2m    --a-port transfer \\\\[22m
[2m    --b-port transfer",[22m
[31m+             ],[39m
[31m+             "command": Array [[39m
[31m+               "bash",[39m
[31m+               "-c",[39m
[2m              ],[22m
[2m              "env": Array [[22m
[2m                Object {[22m
[33m@@ -266,7 +290,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "RELAYER_INDEX",[22m
[32m-                 "value": "2",[39m
[31m+                 "value": "\${HOSTNAME##*-}",[39m
[2m                },[22m
[2m              ],[22m
[2m              "image": "ghcr.io/cosmology-tech/starship/hermes:1.10.0",[22m
[33m@@ -274,12 +298,12 @@[39m
[2m              "name": "init-relayer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[33m@@ -310,6 +334,7 @@[39m
[2m    echo \\"Checking: http://osmosis-1-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id\\"[22m
[2m    sleep 10;[22m
[2m  done[22m
[31m+[39m
[2m  while [ $(curl -sw '%{http_code}' http://juno-2-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id -o /dev/null) -ne 200 ]; do[22m
[2m    echo \\"Genesis validator does not seem to be ready for: juno-2. Waiting for it to start...\\"[22m
[2m    echo \\"Checking: http://juno-2-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id\\"[22m
[33m@@ -332,16 +357,16 @@[39m
[2m                  },[22m
[2m                },[22m
[2m              ],[22m
[32m-             "image": "curlimages/curl",[39m
[31m+             "image": "curlimages/curl:latest",[39m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "wait-for-chains",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m"
`;

exports[`Manifest Comparison Tests Individual Config Comparisons should generate manifests for multi-validator that match the snapshot 1`] = `
"ðŸ”„ MODIFIED_RESOURCES:

--- ConfigMap/keys ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -98,6 +98,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "configmap",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "keys",[39m
[31m+       "app.kubernetes.io/part-of": "global",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "keys",[22m
[2m    },[22m
[2m  }[22m

--- ConfigMap/setup-scripts ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -208,6 +208,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "configmap",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts",[39m
[31m+       "app.kubernetes.io/part-of": "global",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts",[22m
[2m    },[22m
[2m  }[22m

--- StatefulSet/osmosis-1-genesis ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,18 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/id": "osmosis-1",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "osmosis-1-genesis",[39m
[31m+       "app.kubernetes.io/part-of": "osmosis-1",[39m
[31m+       "app.kubernetes.io/role": "genesis",[39m
[31m+       "app.kubernetes.io/type": "osmosis-1-statefulset",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-name": "osmosis",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "osmosis-1-genesis",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +21,7 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "osmosis",[39m
[31m+         "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m          "app.kubernetes.io/name": "osmosis-1-genesis",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -23,11 +35,12 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "osmosis",[39m
[31m+           "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m            "app.kubernetes.io/name": "osmosis-1-genesis",[22m
[2m            "app.kubernetes.io/rawname": "osmosis-1",[22m
[31m+           "app.kubernetes.io/role": "genesis",[39m
[2m            "app.kubernetes.io/type": "osmosis-1",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[33m@@ -91,11 +104,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -184,11 +197,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -211,7 +224,12 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "START_ARGS=\\"\\"[39m
[31m+               "#!/bin/bash[39m
[31m+ set -euo pipefail[39m
[31m+[39m
[31m+ START_ARGS=\\"\\"[39m
[31m+[39m
[31m+[39m
[2m  $CHAIN_BIN start $START_ARGS",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -274,11 +292,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.3,[39m
[31m+                 "cpu": "0.3",[39m
[2m                  "memory": "600M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.3,[39m
[31m+                 "cpu": "0.3",[39m
[2m                  "memory": "600M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -307,6 +325,7 @@[39m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m

[2m  echo \\"Running setup config script...\\"[22m
[31m+[39m
[2m  bash -e /scripts/update-config.sh",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -348,7 +367,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "TIME_IOTA_MS",[22m
[33m@@ -388,11 +407,11 @@[39m
[2m              "name": "init-config",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.3,[39m
[31m+                 "cpu": "0.3",[39m
[2m                  "memory": "600M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.3,[39m
[31m+                 "cpu": "0.3",[39m
[2m                  "memory": "600M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -415,20 +434,18 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "# Install faucet binary from the image[39m
[32m- cp /bin/faucet /faucet/faucet[39m
[32m- chmod +x /faucet/faucet",[39m
[31m+               "cp /bin/faucet /faucet/faucet && chmod +x /faucet/faucet",[39m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/faucet:20250325-2207109",[22m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "init-faucet",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.3,[39m
[31m+                 "cpu": "0.3",[39m
[2m                  "memory": "600M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.3,[39m
[31m+                 "cpu": "0.3",[39m
[2m                  "memory": "600M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -553,11 +570,11 @@[39m
[2m              "name": "init-genesis",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.3,[39m
[31m+                 "cpu": "0.3",[39m
[2m                  "memory": "600M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.3,[39m
[31m+                 "cpu": "0.3",[39m
[2m                  "memory": "600M",[22m
[2m                },[22m
[2m              },[22m

--- ConfigMap/setup-scripts-osmosis-1 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -608,6 +608,17 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts-osmosis-1",[39m
[31m+       "app.kubernetes.io/part-of": "osmosis-1",[39m
[31m+       "app.kubernetes.io/role": "setup-scripts",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-id": "osmosis-1",[39m
[31m+       "starship.io/chain-name": "osmosis",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts-osmosis-1",[22m
[2m    },[22m
[2m  }[22m

--- Service/osmosis-1-validator ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -23,6 +23,12 @@[39m
[2m          "targetPort": 8081,[22m
[2m        },[22m
[2m        Object {[22m
[31m+         "name": "faucet",[39m
[31m+         "port": 8000,[39m
[31m+         "protocol": "TCP",[39m
[31m+         "targetPort": 8000,[39m
[31m+       },[39m
[31m+       Object {[39m
[2m          "name": "grpc",[22m
[2m          "port": 9090,[22m
[2m          "protocol": "TCP",[22m

--- StatefulSet/osmosis-1-validator ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,18 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/id": "osmosis-1",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "osmosis-1-validator",[39m
[31m+       "app.kubernetes.io/part-of": "osmosis-1",[39m
[31m+       "app.kubernetes.io/role": "validator",[39m
[31m+       "app.kubernetes.io/type": "osmosis-1-statefulset",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-name": "osmosis",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "osmosis-1-validator",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -10,7 +22,7 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "osmosis",[39m
[31m+         "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m          "app.kubernetes.io/name": "osmosis-1-validator",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -24,10 +36,11 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "osmosis",[39m
[31m+           "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m            "app.kubernetes.io/name": "osmosis-1-validator",[22m
[31m+           "app.kubernetes.io/role": "validator",[39m
[2m            "app.kubernetes.io/type": "osmosis-1",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[33m@@ -119,11 +132,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -145,7 +158,9 @@[39m
[2m                "set -eux[22m
[2m  START_ARGS=\\"\\"[22m

[31m+[39m
[2m  # Starting the chain[22m
[31m+[39m
[2m  $CHAIN_BIN start $START_ARGS",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -255,11 +270,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.3,[39m
[31m+                 "cpu": "0.3",[39m
[2m                  "memory": "600M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.3,[39m
[31m+                 "cpu": "0.3",[39m
[2m                  "memory": "600M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -286,6 +301,7 @@[39m
[2m                "-c",[22m
[2m                "VAL_INDEX=\${HOSTNAME##*-}[22m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m
[31m+[39m

[2m  echo \\"Running setup config script...\\"[22m
[2m  bash -e /scripts/update-config.sh[22m
[33m@@ -351,7 +367,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "NAMESPACE",[22m
[33m@@ -399,11 +415,11 @@[39m
[2m              "name": "init-config",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.3,[39m
[31m+                 "cpu": "0.3",[39m
[2m                  "memory": "600M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.3,[39m
[31m+                 "cpu": "0.3",[39m
[2m                  "memory": "600M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -428,6 +444,7 @@[39m
[2m                "-c",[22m
[2m                "VAL_INDEX=\${HOSTNAME##*-}[22m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m
[31m+[39m

[2m  if [ -f $CHAIN_DIR/config/genesis.json ]; then[22m
[2m    echo \\"Genesis file exists, exiting early\\"[22m
[33m@@ -500,7 +517,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "NAMESPACE",[22m
[33m@@ -548,11 +565,11 @@[39m
[2m              "name": "init-validator",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.3,[39m
[31m+                 "cpu": "0.3",[39m
[2m                  "memory": "600M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.3,[39m
[31m+                 "cpu": "0.3",[39m
[2m                  "memory": "600M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -597,16 +614,16 @@[39m
[2m                  },[22m
[2m                },[22m
[2m              ],[22m
[32m-             "image": "curlimages/curl",[39m
[31m+             "image": "curlimages/curl:latest",[39m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "wait-for-chains",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -618,6 +635,10 @@[39m
[2m                "name": "keys",[22m
[2m              },[22m
[2m              "name": "addresses",[22m
[31m+           },[39m
[31m+           Object {[39m
[31m+             "emptyDir": Object {},[39m
[31m+             "name": "faucet",[39m
[2m            },[22m
[2m            Object {[22m
[2m              "emptyDir": Object {},[22m

--- Deployment/registry ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,14 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "Deployment",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "registry",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "registry",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "registry",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +17,6 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "registry",[39m
[2m          "app.kubernetes.io/name": "registry",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -22,19 +29,17 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "registry",[39m
[31m+           "app.kubernetes.io/component": "registry",[39m
[31m+           "app.kubernetes.io/managed-by": "starship",[39m
[2m            "app.kubernetes.io/name": "registry",[22m
[32m-           "app.kubernetes.io/rawname": "registry",[39m
[32m-           "app.kubernetes.io/type": "registry",[39m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/part-of": "starship",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+           "starship.io/name": "starship-e2e-tests",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[2m          "containers": Array [[22m
[2m            Object {[22m
[32m-             "command": Array [[39m
[32m-               "registry",[39m
[32m-             ],[39m
[2m              "env": Array [[22m
[2m                Object {[22m
[2m                  "name": "NAMESPACE",[22m
[33m@@ -74,21 +79,20 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "REGISTRY_CHAIN_REGISTRY",[22m
[32m-                 "value": "/configs",[39m
[31m+                 "value": "/chains",[39m
[2m                },[22m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/registry:20250205-544757d",[22m
[32m-             "imagePullPolicy": "IfNotPresent",[39m
[2m              "livenessProbe": Object {[22m
[32m-               "initialDelaySeconds": 20,[39m
[32m-               "periodSeconds": 10,[39m
[31m+               "initialDelaySeconds": 15,[39m
[31m+               "periodSeconds": 20,[39m
[2m                "tcpSocket": Object {[22m
[2m                  "port": 8080,[22m
[2m                },[22m
[2m              },[22m
[2m              "name": "registry",[22m
[2m              "readinessProbe": Object {[22m
[32m-               "initialDelaySeconds": 20,[39m
[31m+               "initialDelaySeconds": 5,[39m
[2m                "periodSeconds": 10,[22m
[2m                "tcpSocket": Object {[22m
[2m                  "port": 8080,[22m
[33m@@ -96,18 +100,18 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[2m                Object {[22m
[32m-                 "mountPath": "/configs/osmosis-1",[39m
[32m-                 "name": "registry-configs-osmosis-1",[39m
[31m+                 "mountPath": "/chains/osmosis-1",[39m
[31m+                 "name": "registry-osmosis-1",[39m
[2m                },[22m
[2m              ],[22m
[2m            },[22m
[33m@@ -139,16 +143,16 @@[39m
[2m                  },[22m
[2m                },[22m
[2m              ],[22m
[32m-             "image": "curlimages/curl",[39m
[31m+             "image": "curlimages/curl:latest",[39m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "wait-for-chains",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -159,7 +163,7 @@[39m
[2m              "configMap": Object {[22m
[2m                "name": "registry-osmosis-1",[22m
[2m              },[22m
[32m-             "name": "registry-configs-osmosis-1",[39m
[31m+             "name": "registry-osmosis-1",[39m
[2m            },[22m
[2m          ],[22m
[2m        },[22m

--- ConfigMap/registry-osmosis-1 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -7,7 +7,14 @@[39m
[2m    \\"assets\\": [[22m
[2m      {[22m
[2m        \\"base\\": \\"uosmo\\",[22m
[32m-       \\"coingecko_id\\": \\"osmosis\\",[39m
[31m+       \\"description\\": \\"The native token of Osmosis\\",[39m
[31m+       \\"name\\": \\"Osmosis\\",[39m
[31m+       \\"display\\": \\"osmo\\",[39m
[31m+       \\"symbol\\": \\"OSMO\\",[39m
[31m+       \\"logo_URIs\\": {[39m
[31m+         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/osmo.png\\",[39m
[31m+         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/osmo.svg\\"[39m
[31m+       },[39m
[2m        \\"denom_units\\": [[22m
[2m          {[22m
[2m            \\"denom\\": \\"uosmo\\",[22m
[33m@@ -18,22 +25,21 @@[39m
[2m            \\"exponent\\": 6[22m
[2m          }[22m
[2m        ],[22m
[32m-       \\"description\\": \\"The native token of Osmosis\\",[39m
[32m-       \\"display\\": \\"osmo\\",[39m
[31m+       \\"coingecko_id\\": \\"osmosis\\",[39m
[2m        \\"keywords\\": [[22m
[2m          \\"staking\\",[22m
[2m          \\"dex\\"[22m
[32m-       ],[39m
[32m-       \\"logo_URIs\\": {[39m
[32m-         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/osmo.png\\",[39m
[32m-         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/osmo.svg\\"[39m
[32m-       },[39m
[32m-       \\"name\\": \\"Osmosis\\",[39m
[32m-       \\"symbol\\": \\"OSMO\\"[39m
[31m+       ][39m
[2m      },[22m
[2m      {[22m
[2m        \\"base\\": \\"uion\\",[22m
[32m-       \\"coingecko_id\\": \\"ion\\",[39m
[31m+       \\"name\\": \\"Ion\\",[39m
[31m+       \\"display\\": \\"ion\\",[39m
[31m+       \\"symbol\\": \\"ION\\",[39m
[31m+       \\"logo_URIs\\": {[39m
[31m+         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/ion.png\\",[39m
[31m+         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/ion.svg\\"[39m
[31m+       },[39m
[2m        \\"denom_units\\": [[22m
[2m          {[22m
[2m            \\"denom\\": \\"uion\\",[22m
[33m@@ -44,16 +50,10 @@[39m
[2m            \\"exponent\\": 6[22m
[2m          }[22m
[2m        ],[22m
[32m-       \\"display\\": \\"ion\\",[39m
[31m+       \\"coingecko_id\\": \\"ion\\",[39m
[2m        \\"keywords\\": [[22m
[2m          \\"memecoin\\"[22m
[32m-       ],[39m
[32m-       \\"logo_URIs\\": {[39m
[32m-         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/ion.png\\",[39m
[32m-         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/ion.svg\\"[39m
[32m-       },[39m
[32m-       \\"name\\": \\"Ion\\",[39m
[32m-       \\"symbol\\": \\"ION\\"[39m
[31m+       ][39m
[2m      }[22m
[2m    ][22m
[2m  }",[22m
[33m@@ -110,6 +110,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "registry",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "registry-osmosis-1",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "registry-osmosis-1",[22m
[2m    },[22m
[2m  }[22m"
`;

exports[`Manifest Comparison Tests Individual Config Comparisons should generate manifests for multi-validator-starship-faucet that match the snapshot 1`] = `
"ðŸ”„ MODIFIED_RESOURCES:

--- ConfigMap/keys ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -98,6 +98,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "configmap",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "keys",[39m
[31m+       "app.kubernetes.io/part-of": "global",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "keys",[22m
[2m    },[22m
[2m  }[22m

--- ConfigMap/setup-scripts ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -208,6 +208,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "configmap",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts",[39m
[31m+       "app.kubernetes.io/part-of": "global",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts",[22m
[2m    },[22m
[2m  }[22m

--- StatefulSet/osmosis-1-genesis ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,18 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/id": "osmosis-1",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "osmosis-1-genesis",[39m
[31m+       "app.kubernetes.io/part-of": "osmosis-1",[39m
[31m+       "app.kubernetes.io/role": "genesis",[39m
[31m+       "app.kubernetes.io/type": "osmosis-1-statefulset",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-name": "osmosis",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "osmosis-1-genesis",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +21,7 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "osmosis",[39m
[31m+         "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m          "app.kubernetes.io/name": "osmosis-1-genesis",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -23,11 +35,12 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "osmosis",[39m
[31m+           "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m            "app.kubernetes.io/name": "osmosis-1-genesis",[22m
[2m            "app.kubernetes.io/rawname": "osmosis-1",[22m
[31m+           "app.kubernetes.io/role": "genesis",[39m
[2m            "app.kubernetes.io/type": "osmosis-1",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[33m@@ -91,11 +104,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -184,11 +197,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -211,7 +224,12 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "START_ARGS=\\"\\"[39m
[31m+               "#!/bin/bash[39m
[31m+ set -euo pipefail[39m
[31m+[39m
[31m+ START_ARGS=\\"\\"[39m
[31m+[39m
[31m+[39m
[2m  $CHAIN_BIN start $START_ARGS",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -307,6 +325,7 @@[39m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m

[2m  echo \\"Running setup config script...\\"[22m
[31m+[39m
[2m  bash -e /scripts/update-config.sh",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -348,7 +367,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "TIME_IOTA_MS",[22m
[33m@@ -415,9 +434,7 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "# Install faucet binary from the image[39m
[32m- cp /bin/faucet /faucet/faucet[39m
[32m- chmod +x /faucet/faucet",[39m
[31m+               "cp /bin/faucet /faucet/faucet && chmod +x /faucet/faucet",[39m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/faucet:20250325-2207109",[22m
[2m              "imagePullPolicy": "IfNotPresent",[22m

--- ConfigMap/setup-scripts-osmosis-1 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -608,6 +608,17 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts-osmosis-1",[39m
[31m+       "app.kubernetes.io/part-of": "osmosis-1",[39m
[31m+       "app.kubernetes.io/role": "setup-scripts",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-id": "osmosis-1",[39m
[31m+       "starship.io/chain-name": "osmosis",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts-osmosis-1",[22m
[2m    },[22m
[2m  }[22m

--- Service/osmosis-1-validator ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -23,6 +23,12 @@[39m
[2m          "targetPort": 8081,[22m
[2m        },[22m
[2m        Object {[22m
[31m+         "name": "faucet",[39m
[31m+         "port": 8000,[39m
[31m+         "protocol": "TCP",[39m
[31m+         "targetPort": 8000,[39m
[31m+       },[39m
[31m+       Object {[39m
[2m          "name": "grpc",[22m
[2m          "port": 9090,[22m
[2m          "protocol": "TCP",[22m

--- StatefulSet/osmosis-1-validator ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,18 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/id": "osmosis-1",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "osmosis-1-validator",[39m
[31m+       "app.kubernetes.io/part-of": "osmosis-1",[39m
[31m+       "app.kubernetes.io/role": "validator",[39m
[31m+       "app.kubernetes.io/type": "osmosis-1-statefulset",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-name": "osmosis",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "osmosis-1-validator",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -10,7 +22,7 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "osmosis",[39m
[31m+         "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m          "app.kubernetes.io/name": "osmosis-1-validator",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -24,10 +36,11 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "osmosis",[39m
[31m+           "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m            "app.kubernetes.io/name": "osmosis-1-validator",[22m
[31m+           "app.kubernetes.io/role": "validator",[39m
[2m            "app.kubernetes.io/type": "osmosis-1",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[33m@@ -119,11 +132,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -145,7 +158,9 @@[39m
[2m                "set -eux[22m
[2m  START_ARGS=\\"\\"[22m

[31m+[39m
[2m  # Starting the chain[22m
[31m+[39m
[2m  $CHAIN_BIN start $START_ARGS",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -286,6 +301,7 @@[39m
[2m                "-c",[22m
[2m                "VAL_INDEX=\${HOSTNAME##*-}[22m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m
[31m+[39m

[2m  echo \\"Running setup config script...\\"[22m
[2m  bash -e /scripts/update-config.sh[22m
[33m@@ -351,7 +367,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "NAMESPACE",[22m
[33m@@ -428,6 +444,7 @@[39m
[2m                "-c",[22m
[2m                "VAL_INDEX=\${HOSTNAME##*-}[22m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m
[31m+[39m

[2m  if [ -f $CHAIN_DIR/config/genesis.json ]; then[22m
[2m    echo \\"Genesis file exists, exiting early\\"[22m
[33m@@ -500,7 +517,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "NAMESPACE",[22m
[33m@@ -597,16 +614,16 @@[39m
[2m                  },[22m
[2m                },[22m
[2m              ],[22m
[32m-             "image": "curlimages/curl",[39m
[31m+             "image": "curlimages/curl:latest",[39m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "wait-for-chains",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -618,6 +635,10 @@[39m
[2m                "name": "keys",[22m
[2m              },[22m
[2m              "name": "addresses",[22m
[31m+           },[39m
[31m+           Object {[39m
[31m+             "emptyDir": Object {},[39m
[31m+             "name": "faucet",[39m
[2m            },[22m
[2m            Object {[22m
[2m              "emptyDir": Object {},[22m

--- Deployment/registry ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,14 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "Deployment",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "registry",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "registry",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "registry",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +17,6 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "registry",[39m
[2m          "app.kubernetes.io/name": "registry",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -22,19 +29,17 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "registry",[39m
[31m+           "app.kubernetes.io/component": "registry",[39m
[31m+           "app.kubernetes.io/managed-by": "starship",[39m
[2m            "app.kubernetes.io/name": "registry",[22m
[32m-           "app.kubernetes.io/rawname": "registry",[39m
[32m-           "app.kubernetes.io/type": "registry",[39m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/part-of": "starship",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+           "starship.io/name": "starship-e2e-tests",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[2m          "containers": Array [[22m
[2m            Object {[22m
[32m-             "command": Array [[39m
[32m-               "registry",[39m
[32m-             ],[39m
[2m              "env": Array [[22m
[2m                Object {[22m
[2m                  "name": "NAMESPACE",[22m
[33m@@ -74,21 +79,20 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "REGISTRY_CHAIN_REGISTRY",[22m
[32m-                 "value": "/configs",[39m
[31m+                 "value": "/chains",[39m
[2m                },[22m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/registry:20250205-544757d",[22m
[32m-             "imagePullPolicy": "IfNotPresent",[39m
[2m              "livenessProbe": Object {[22m
[32m-               "initialDelaySeconds": 20,[39m
[32m-               "periodSeconds": 10,[39m
[31m+               "initialDelaySeconds": 15,[39m
[31m+               "periodSeconds": 20,[39m
[2m                "tcpSocket": Object {[22m
[2m                  "port": 8080,[22m
[2m                },[22m
[2m              },[22m
[2m              "name": "registry",[22m
[2m              "readinessProbe": Object {[22m
[32m-               "initialDelaySeconds": 20,[39m
[31m+               "initialDelaySeconds": 5,[39m
[2m                "periodSeconds": 10,[22m
[2m                "tcpSocket": Object {[22m
[2m                  "port": 8080,[22m
[33m@@ -96,18 +100,18 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[2m                Object {[22m
[32m-                 "mountPath": "/configs/osmosis-1",[39m
[32m-                 "name": "registry-configs-osmosis-1",[39m
[31m+                 "mountPath": "/chains/osmosis-1",[39m
[31m+                 "name": "registry-osmosis-1",[39m
[2m                },[22m
[2m              ],[22m
[2m            },[22m
[33m@@ -139,16 +143,16 @@[39m
[2m                  },[22m
[2m                },[22m
[2m              ],[22m
[32m-             "image": "curlimages/curl",[39m
[31m+             "image": "curlimages/curl:latest",[39m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "wait-for-chains",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -159,7 +163,7 @@[39m
[2m              "configMap": Object {[22m
[2m                "name": "registry-osmosis-1",[22m
[2m              },[22m
[32m-             "name": "registry-configs-osmosis-1",[39m
[31m+             "name": "registry-osmosis-1",[39m
[2m            },[22m
[2m          ],[22m
[2m        },[22m

--- ConfigMap/registry-osmosis-1 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -7,7 +7,14 @@[39m
[2m    \\"assets\\": [[22m
[2m      {[22m
[2m        \\"base\\": \\"uosmo\\",[22m
[32m-       \\"coingecko_id\\": \\"osmosis\\",[39m
[31m+       \\"description\\": \\"The native token of Osmosis\\",[39m
[31m+       \\"name\\": \\"Osmosis\\",[39m
[31m+       \\"display\\": \\"osmo\\",[39m
[31m+       \\"symbol\\": \\"OSMO\\",[39m
[31m+       \\"logo_URIs\\": {[39m
[31m+         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/osmo.png\\",[39m
[31m+         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/osmo.svg\\"[39m
[31m+       },[39m
[2m        \\"denom_units\\": [[22m
[2m          {[22m
[2m            \\"denom\\": \\"uosmo\\",[22m
[33m@@ -18,22 +25,21 @@[39m
[2m            \\"exponent\\": 6[22m
[2m          }[22m
[2m        ],[22m
[32m-       \\"description\\": \\"The native token of Osmosis\\",[39m
[32m-       \\"display\\": \\"osmo\\",[39m
[31m+       \\"coingecko_id\\": \\"osmosis\\",[39m
[2m        \\"keywords\\": [[22m
[2m          \\"staking\\",[22m
[2m          \\"dex\\"[22m
[32m-       ],[39m
[32m-       \\"logo_URIs\\": {[39m
[32m-         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/osmo.png\\",[39m
[32m-         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/osmo.svg\\"[39m
[32m-       },[39m
[32m-       \\"name\\": \\"Osmosis\\",[39m
[32m-       \\"symbol\\": \\"OSMO\\"[39m
[31m+       ][39m
[2m      },[22m
[2m      {[22m
[2m        \\"base\\": \\"uion\\",[22m
[32m-       \\"coingecko_id\\": \\"ion\\",[39m
[31m+       \\"name\\": \\"Ion\\",[39m
[31m+       \\"display\\": \\"ion\\",[39m
[31m+       \\"symbol\\": \\"ION\\",[39m
[31m+       \\"logo_URIs\\": {[39m
[31m+         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/ion.png\\",[39m
[31m+         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/ion.svg\\"[39m
[31m+       },[39m
[2m        \\"denom_units\\": [[22m
[2m          {[22m
[2m            \\"denom\\": \\"uion\\",[22m
[33m@@ -44,16 +50,10 @@[39m
[2m            \\"exponent\\": 6[22m
[2m          }[22m
[2m        ],[22m
[32m-       \\"display\\": \\"ion\\",[39m
[31m+       \\"coingecko_id\\": \\"ion\\",[39m
[2m        \\"keywords\\": [[22m
[2m          \\"memecoin\\"[22m
[32m-       ],[39m
[32m-       \\"logo_URIs\\": {[39m
[32m-         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/ion.png\\",[39m
[32m-         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/ion.svg\\"[39m
[32m-       },[39m
[32m-       \\"name\\": \\"Ion\\",[39m
[32m-       \\"symbol\\": \\"ION\\"[39m
[31m+       ][39m
[2m      }[22m
[2m    ][22m
[2m  }",[22m
[33m@@ -110,6 +110,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "registry",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "registry-osmosis-1",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "registry-osmosis-1",[22m
[2m    },[22m
[2m  }[22m"
`;

exports[`Manifest Comparison Tests Individual Config Comparisons should generate manifests for neutron that match the snapshot 1`] = `
"ðŸ”„ MODIFIED_RESOURCES:

--- ConfigMap/keys ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -98,6 +98,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "configmap",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "keys",[39m
[31m+       "app.kubernetes.io/part-of": "global",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "keys",[22m
[2m    },[22m
[2m  }[22m

--- ConfigMap/setup-scripts ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -208,6 +208,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "configmap",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts",[39m
[31m+       "app.kubernetes.io/part-of": "global",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts",[22m
[2m    },[22m
[2m  }[22m

--- StatefulSet/cosmoshub-4-genesis ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,18 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/id": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "cosmoshub-4-genesis",[39m
[31m+       "app.kubernetes.io/part-of": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/role": "genesis",[39m
[31m+       "app.kubernetes.io/type": "cosmoshub-4-statefulset",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-name": "cosmoshub",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "cosmoshub-4-genesis",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +21,7 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "cosmoshub",[39m
[31m+         "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m          "app.kubernetes.io/name": "cosmoshub-4-genesis",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -23,11 +35,12 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "cosmoshub",[39m
[31m+           "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m            "app.kubernetes.io/name": "cosmoshub-4-genesis",[22m
[2m            "app.kubernetes.io/rawname": "cosmoshub-4",[22m
[31m+           "app.kubernetes.io/role": "genesis",[39m
[2m            "app.kubernetes.io/type": "cosmoshub-4",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[33m@@ -91,11 +104,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -184,12 +197,12 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[32m-                 "memory": "200M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "128M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[32m-                 "memory": "200M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "128M",[39m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[33m@@ -211,7 +224,12 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "START_ARGS=\\"\\"[39m
[31m+               "#!/bin/bash[39m
[31m+ set -euo pipefail[39m
[31m+[39m
[31m+ START_ARGS=\\"\\"[39m
[31m+[39m
[31m+[39m
[2m  $CHAIN_BIN start $START_ARGS",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -274,11 +292,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -307,6 +325,7 @@[39m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m

[2m  echo \\"Running setup config script...\\"[22m
[31m+[39m
[2m  bash -e /scripts/update-config.sh",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -348,7 +367,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "TIME_IOTA_MS",[22m
[33m@@ -388,11 +407,11 @@[39m
[2m              "name": "init-config",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -415,20 +434,18 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "# Install faucet binary from the image[39m
[32m- cp /bin/faucet /faucet/faucet[39m
[32m- chmod +x /faucet/faucet",[39m
[31m+               "cp /bin/faucet /faucet/faucet && chmod +x /faucet/faucet",[39m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/faucet:20250325-2207109",[22m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "init-faucet",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -553,11 +570,11 @@[39m
[2m              "name": "init-genesis",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m

--- ConfigMap/setup-scripts-cosmoshub-4 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -608,6 +608,17 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts-cosmoshub-4",[39m
[31m+       "app.kubernetes.io/part-of": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/role": "setup-scripts",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-id": "cosmoshub-4",[39m
[31m+       "starship.io/chain-name": "cosmoshub",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts-cosmoshub-4",[22m
[2m    },[22m
[2m  }[22m

--- StatefulSet/neutron-1-genesis ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,18 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/id": "neutron-1",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "neutron-1-genesis",[39m
[31m+       "app.kubernetes.io/part-of": "neutron-1",[39m
[31m+       "app.kubernetes.io/role": "genesis",[39m
[31m+       "app.kubernetes.io/type": "neutron-1-statefulset",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-name": "neutron",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "neutron-1-genesis",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +21,7 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "neutron",[39m
[31m+         "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m          "app.kubernetes.io/name": "neutron-1-genesis",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -23,11 +35,12 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "neutron",[39m
[31m+           "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m            "app.kubernetes.io/name": "neutron-1-genesis",[22m
[2m            "app.kubernetes.io/rawname": "neutron-1",[22m
[31m+           "app.kubernetes.io/role": "genesis",[39m
[2m            "app.kubernetes.io/type": "neutron-1",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[33m@@ -91,11 +104,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -114,7 +127,12 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "START_ARGS=\\"\\"[39m
[31m+               "#!/bin/bash[39m
[31m+ set -euo pipefail[39m
[31m+[39m
[31m+ START_ARGS=\\"\\"[39m
[31m+[39m
[31m+[39m
[2m  $CHAIN_BIN start $START_ARGS",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -177,11 +195,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -210,6 +228,7 @@[39m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m

[2m  echo \\"Running setup config script...\\"[22m
[31m+[39m
[2m  bash -e /scripts/update-config.sh",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -251,7 +270,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "TIME_IOTA_MS",[22m
[33m@@ -291,11 +310,11 @@[39m
[2m              "name": "init-config",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -428,11 +447,11 @@[39m
[2m              "name": "init-genesis",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -535,11 +554,11 @@[39m
[2m              "name": "init-ics",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -588,16 +607,16 @@[39m
[2m                  },[22m
[2m                },[22m
[2m              ],[22m
[32m-             "image": "curlimages/curl",[39m
[31m+             "image": "curlimages/curl:latest",[39m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "wait-for-chains",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m

--- ConfigMap/consumer-proposal-neutron-1 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -29,6 +29,17 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "neutron",[39m
[31m+       "app.kubernetes.io/part-of": "neutron-1",[39m
[31m+       "app.kubernetes.io/role": "ics-proposal",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-id": "neutron-1",[39m
[31m+       "starship.io/chain-name": "neutron",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "consumer-proposal-neutron-1",[22m
[2m    },[22m
[2m  }[22m

--- ConfigMap/setup-scripts-neutron-1 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -87,8 +87,261 @@[39m

[2m  echo \\"$json\\" | jq -r .result[22m
[2m  exit 0",[22m
[32m-     "create-genesis.sh": "#!/bin/bash[39m
[31m+     "create-ics.sh": "#!/bin/bash[39m
[31m+[39m
[31m+ set -euxo pipefail[39m
[31m+[39m
[31m+ DENOM=\\"\${DENOM:=uatom}\\"[39m
[31m+ CHAIN_ID=\\"\${CHAIN_ID:=cosmoshub-1}\\"[39m
[31m+ CHAIN_BIN=\\"\${CHAIN_BIN:=gaiad}\\"[39m
[31m+ NODE_URL=\\"\${NODE_URL:=http://0.0.0.0:26657}\\"[39m
[31m+ KEYS_CONFIG=\\"\${KEYS_CONFIG:=configs/keys.json}\\"[39m
[31m+[39m
[31m+ PROPOSAL_FILE=\\"\${PROPOSAL_FILE}\\"[39m
[31m+ KEY_NAME=\\"ics-setup\\"[39m
[31m+ MAX_RETRIES=3[39m
[31m+ RETRY_INTERVAL=30[39m
[31m+ SUBMIT_PROPOSAL_CMD=\\"\\"[39m
[31m+[39m
[31m+ add_key() {[39m
[31m+   # Add test keys to the keyring and self delegate initial coins[39m
[31m+   echo \\"Adding key....\\" $(jq -r \\".keys[0].name\\" $KEYS_CONFIG)[39m
[31m+   jq -r \\".keys[0].mnemonic\\" $KEYS_CONFIG | $CHAIN_BIN keys add $KEY_NAME --recover --keyring-backend=\\"test\\"[39m
[31m+   echo $($CHAIN_BIN keys show -a $KEY_NAME --keyring-backend=\\"test\\")[39m
[31m+ }[39m
[31m+[39m
[31m+ get_validator_address() {[39m
[31m+   echo \\"Getting validator address...\\"[39m
[31m+   VALIDATOR_ADDRESS=$($CHAIN_BIN q staking validators --node $NODE_URL --output json | jq -r '.validators[0].operator_address')[39m
[31m+   echo \\"Selected validator address: $VALIDATOR_ADDRESS\\"[39m
[31m+ }[39m
[31m+[39m
[31m+ stake_tokens() {[39m
[31m+   COINS=\\"10000000$DENOM\\"[39m
[31m+   echo \\"Staking tokens...\\"[39m
[31m+   $CHAIN_BIN tx staking delegate $VALIDATOR_ADDRESS $COINS \\\\[39m
[31m+     --from $KEY_NAME \\\\[39m
[31m+     --chain-id $CHAIN_ID \\\\[39m
[31m+     --node $NODE_URL \\\\[39m
[31m+     --keyring-backend=\\"test\\" \\\\[39m
[31m+     --gas auto --gas-adjustment 2 \\\\[39m
[31m+     --output json \\\\[39m
[31m+     --yes[39m
[31m+   sleep 5[39m
[31m+ }[39m
[31m+[39m
[31m+ determine_proposal_command() {[39m
[31m+   echo \\"Determining the correct command to submit proposals...\\"[39m
[31m+   HELP_OUTPUT=$($CHAIN_BIN tx gov --help)[39m
[31m+   if echo \\"$HELP_OUTPUT\\" | grep -q \\"submit-legacy-proposal\\"; then[39m
[31m+     SUBMIT_PROPOSAL_CMD=\\"submit-legacy-proposal\\"[39m
[31m+   else[39m
[31m+     SUBMIT_PROPOSAL_CMD=\\"submit-proposal\\"[39m
[31m+   fi[39m
[31m+   echo \\"Using $SUBMIT_PROPOSAL_CMD for submitting proposals.\\"[39m
[31m+ }[39m
[31m+[39m
[31m+ submit_proposal() {[39m
[31m+   echo \\"Get all proposals\\"[39m
[31m+   PROPOSALS_OUTPUT=$($CHAIN_BIN query gov proposals --output json --node $NODE_URL 2>&1 || true)[39m
[31m+   if echo \\"$PROPOSALS_OUTPUT\\" | grep -q \\"no proposals found\\"; then[39m
[31m+     echo \\"No existing proposals found. Proceeding to submit a new proposal.\\"[39m
[31m+   else[39m
[31m+     echo \\"Existing proposals: $PROPOSALS_OUTPUT\\"[39m
[31m+   fi[39m
[31m+[39m
[31m+   echo \\"Submit gov proposal on chain\\"[39m
[31m+   PROPOSAL_TX=$($CHAIN_BIN tx gov $SUBMIT_PROPOSAL_CMD consumer-addition $PROPOSAL_FILE \\\\[39m
[31m+     --from $KEY_NAME \\\\[39m
[31m+     --chain-id $CHAIN_ID \\\\[39m
[31m+     --node $NODE_URL \\\\[39m
[31m+     --keyring-backend=\\"test\\" \\\\[39m
[31m+     --gas auto --gas-adjustment 2 \\\\[39m
[31m+     --output json \\\\[39m
[31m+     --yes)[39m
[31m+   echo $PROPOSAL_TX[39m
[31m+[39m
[31m+   # Extract JSON part from the output[39m
[31m+   TX_HASH=$(echo \\"$PROPOSAL_TX\\" | grep -o '{.*}' | jq -r '.txhash')[39m
[31m+   if [ -n \\"$TX_HASH\\" ]; then[39m
[31m+     echo \\"Transaction hash: $TX_HASH\\"[39m
[31m+   else[39m
[31m+     echo \\"Failed to submit proposal. Output was not as expected.\\"[39m
[31m+     exit 1[39m
[31m+   fi[39m
[31m+[39m
[31m+   sleep 5[39m
[31m+ }[39m
[31m+[39m
[31m+ get_proposal_id() {[39m
[31m+   echo \\"Getting proposal ID\\"[39m
[31m+   PROPOSAL_QUERY=$(gaiad query tx $TX_HASH --node $NODE_URL --output json)[39m
[31m+   LOGS=$(echo $PROPOSAL_QUERY | jq -r '.logs')[39m
[31m+   if [ \\"$LOGS\\" != \\"null\\" ] && [ \\"$LOGS\\" != \\"[]\\" ]; then[39m
[31m+     PROPOSAL_ID=$(echo $PROPOSAL_QUERY | jq -r '.logs[0].events[] | select(.type==\\"submit_proposal\\").attributes[] | select(.key==\\"proposal_id\\").value')[39m
[31m+     if [ -n \\"$PROPOSAL_ID\\" ]; then[39m
[31m+       echo \\"Proposal ID: $PROPOSAL_ID\\"[39m
[31m+       return 0[39m
[31m+     fi[39m
[31m+   fi[39m
[31m+   echo \\"Failed to retrieve proposal ID from transaction logs. Logs might be empty.\\"[39m
[31m+   exit 1[39m
[31m+ }[39m
[31m+[39m
[31m+ vote_proposal() {[39m
[31m+   echo \\"Voting on proposal\\"[39m
[31m+   $CHAIN_BIN tx gov vote $PROPOSAL_ID yes \\\\[39m
[31m+     --from $KEY_NAME \\\\[39m
[31m+     --chain-id $CHAIN_ID \\\\[39m
[31m+     --node $NODE_URL \\\\[39m
[31m+     --keyring-backend=\\"test\\" \\\\[39m
[31m+     --gas auto --gas-adjustment 2 \\\\[39m
[31m+     --output json \\\\[39m
[31m+     --yes[39m
[31m+   sleep 5[39m
[31m+ }[39m
[31m+[39m
[31m+ wait_for_proposal_to_pass() {[39m
[31m+   echo \\"Waiting for proposal to pass\\"[39m
[31m+   for ((i=1; i<=$MAX_RETRIES; i++)); do[39m
[31m+     STATUS=$($CHAIN_BIN query gov proposal $PROPOSAL_ID --node $NODE_URL --output json | jq -r '.status')[39m
[31m+     if [ \\"$STATUS\\" == \\"PROPOSAL_STATUS_PASSED\\" ]; then[39m
[31m+       echo \\"Proposal has passed!\\"[39m
[31m+       return 0[39m
[31m+     else[39m
[31m+       echo \\"Current status: $STATUS. Attempt $i/$MAX_RETRIES. Waiting...\\"[39m
[31m+       sleep $RETRY_INTERVAL[39m
[31m+     fi[39m
[31m+   done[39m
[31m+   echo \\"Proposal did not pass after $MAX_RETRIES attempts.\\"[39m
[31m+   exit 1[39m
[31m+ }[39m
[31m+[39m
[31m+ main() {[39m
[31m+   add_key[39m
[31m+   get_validator_address[39m
[31m+   stake_tokens[39m
[31m+   determine_proposal_command[39m
[31m+   submit_proposal[39m
[31m+   get_proposal_id[39m
[31m+   vote_proposal[39m
[31m+   wait_for_proposal_to_pass[39m
[31m+ }[39m
[31m+[39m
[31m+ main",[39m
[31m+     "create-validator.sh": "#!/bin/bash[39m
[31m+[39m
[31m+ DENOM=\\"\${DENOM:=uosmo}\\"[39m
[31m+ CHAIN_BIN=\\"\${CHAIN_BIN:=osmosisd}\\"[39m
[31m+ CHAIN_DIR=\\"\${CHAIN_DIR:=$HOME/.osmosisd}\\"[39m
[31m+ KEYS_CONFIG=\\"\${KEYS_CONFIG:=configs/keys.json}\\"[39m
[31m+ VAL_NAME=\\"\${VAL_NAME:=osmosis}\\"[39m
[31m+ NODE_URL=\\"\${NODE_URL:=http://0.0.0.0:26657}\\"[39m
[31m+ NODE_ARGS=\\"\${NODE_ARGS}\\"[39m
[31m+ GAS=\\"\${GAS:=auto}\\"[39m
[31m+[39m
[31m+ set -eux[39m
[31m+[39m
[31m+ # Wait for the node to be synced[39m
[31m+ max_tries=10[39m
[31m+ while [[ $($CHAIN_BIN status --output json --node $NODE_URL 2>&1 | jq \\".SyncInfo.catching_up\\") == true ]][39m
[31m+ do[39m
[31m+   if [[ max_tries -lt 0 ]]; then echo \\"Not able to sync with genesis node\\"; exit 1; fi[39m
[31m+   echo \\"Still syncing... Sleeping for 15 secs. Tries left $max_tries\\"[39m
[31m+   ((max_tries--))[39m
[31m+   sleep 30[39m
[31m+ done[39m
[31m+[39m
[31m+ # Function to compare version numbers[39m
[31m+ version_compare() {[39m
[31m+     version1=\\"$1\\"[39m
[31m+     version2=\\"$2\\"[39m
[31m+     if [[ \\"$(printf '%s\\\\n' \\"$version1\\" \\"$version2\\" | sort -V | head -n 1)\\" == \\"$version1\\" ]]; then[39m
[31m+         return 1 # version1 is greater[39m
[31m+     else[39m
[31m+         return 0 # version2 is greater or equal[39m
[31m+     fi[39m
[31m+ }[39m
[31m+[39m
[31m+ # Check if cosmos_sdk_version is greater than a specified version[39m
[31m+ is_greater() {[39m
[31m+     version_compare \\"$1\\" \\"$2\\"[39m
[31m+     return $?[39m
[31m+ }[39m
[31m+[39m
[31m+ function cosmos-sdk-version-v50() {[39m
[31m+   # Content for the validator.json file[39m
[31m+   json_content='{[39m
[31m+     \\"pubkey\\": '$($CHAIN_BIN tendermint show-validator $NODE_ARGS)'[39m
[31m+     \\"amount\\": \\"5000000000'$DENOM'\\"[39m
[31m+     \\"moniker\\": \\"'$VAL_NAME'\\"[39m
[31m+     \\"commission-rate\\": \\"0.1\\"[39m
[31m+     \\"commission-max-rate\\": \\"0.2\\"[39m
[31m+     \\"commission-max-change-rate\\": \\"0.01\\"[39m
[31m+     \\"min-self-delegation\\": \\"1000000\\"[39m
[31m+   }'[39m
[31m+   echo \\"$json_content\\" > /validator.json[39m
[31m+   cat /validator.json[39m
[31m+[39m
[31m+   # Run create validator tx command[39m
[31m+   echo \\"Running txn for create-validator\\"[39m
[31m+   $CHAIN_BIN tx staking create-validator /validator.json \\\\[39m
[31m+     --node $NODE_URL \\\\[39m
[31m+     --chain-id $CHAIN_ID \\\\[39m
[31m+     --from $VAL_NAME \\\\[39m
[31m+     --fees 100000$DENOM \\\\[39m
[31m+     --keyring-backend=\\"test\\" \\\\[39m
[31m+     --output json \\\\[39m
[31m+     --gas $GAS \\\\[39m
[31m+     --gas-adjustment 1.5 $NODE_ARGS --yes > /validator.log[39m
[31m+[39m
[31m+   cat /validator.log | jq[39m
[31m+ }[39m
[31m+[39m
[31m+ function cosmos-sdk-version-default() {[39m
[31m+   # Run create validator tx command[39m
[31m+   echo \\"Running txn for create-validator\\"[39m
[31m+   args=''[39m
[31m+   if [[ $($CHAIN_BIN tx staking create-validator --help | grep -c \\"min-self-delegation\\") -gt 0 ]];[39m
[31m+   then[39m
[31m+     args+='--min-self-delegation=1000000'[39m
[31m+   fi[39m
[31m+   $CHAIN_BIN keys list --keyring-backend test --output json --home $CHAIN_DIR | jq[39m
[31m+   $CHAIN_BIN tx staking create-validator \\\\[39m
[31m+     --node $NODE_URL \\\\[39m
[31m+     --pubkey=$($CHAIN_BIN tendermint show-validator $NODE_ARGS) \\\\[39m
[31m+     --moniker $VAL_NAME \\\\[39m
[31m+     --amount 5000000000$DENOM \\\\[39m
[31m+     --chain-id $CHAIN_ID \\\\[39m
[31m+     --from $VAL_NAME \\\\[39m
[31m+     --commission-rate=\\"0.10\\" \\\\[39m
[31m+     --commission-max-rate=\\"0.20\\" \\\\[39m
[31m+     --commission-max-change-rate=\\"0.01\\" \\\\[39m
[31m+     --keyring-backend test \\\\[39m
[31m+     --home $CHAIN_DIR \\\\[39m
[31m+     --fees 100000$DENOM \\\\[39m
[31m+     --gas $GAS \\\\[39m
[31m+     --output json \\\\[39m
[31m+     --gas-adjustment 1.5 $args $NODE_ARGS --yes > /validator.log[39m

[31m+   cat /validator.log | jq[39m
[31m+ }[39m
[31m+[39m
[31m+ set +e[39m
[31m+ # Fetch the cosmos-sdk version to be able to perform the create-validator tx[39m
[31m+ cosmos_sdk_version=$($CHAIN_BIN version --long | sed -n 's/cosmos_sdk_version: \\\\(.*\\\\)/\\\\1/p')[39m
[31m+ echo \\"cosmos_sdk_version: $cosmos_sdk_version\\"[39m
[31m+ set -e[39m
[31m+[39m
[31m+ if is_greater \\"$cosmos_sdk_version\\" \\"v0.50.0\\"; then[39m
[31m+   echo \\"cosmos_sdk_version is greater than v0.50.0, running create-validator tx with new format\\"[39m
[31m+   cosmos-sdk-version-v50[39m
[31m+ else[39m
[31m+   echo \\"cosmos_sdk_version is less than v0.50.0, running create-validator tx with old format\\"[39m
[31m+   cosmos-sdk-version-default[39m
[31m+ fi",[39m
[31m+     "createGenesis.sh": "#!/bin/bash[39m
[31m+[39m
[2m  DENOM=\\"\${DENOM:=untrn}\\"[22m
[2m  STAKEDENOM=\${DENOM:-untrn}[22m
[2m  COINS=\\"\${COINS:=100000000000000000untrn}\\"[22m
[33m@@ -898,259 +1151,6 @@[39m
[2m  fi[22m

[2m  echo \\"DAO $DAO_CONTRACT_ADDRESS\\"",[22m
[32m-     "create-ics.sh": "#!/bin/bash[39m
[32m-[39m
[32m- set -euxo pipefail[39m
[32m-[39m
[32m- DENOM=\\"\${DENOM:=uatom}\\"[39m
[32m- CHAIN_ID=\\"\${CHAIN_ID:=cosmoshub-1}\\"[39m
[32m- CHAIN_BIN=\\"\${CHAIN_BIN:=gaiad}\\"[39m
[32m- NODE_URL=\\"\${NODE_URL:=http://0.0.0.0:26657}\\"[39m
[32m- KEYS_CONFIG=\\"\${KEYS_CONFIG:=configs/keys.json}\\"[39m
[32m-[39m
[32m- PROPOSAL_FILE=\\"\${PROPOSAL_FILE}\\"[39m
[32m- KEY_NAME=\\"ics-setup\\"[39m
[32m- MAX_RETRIES=3[39m
[32m- RETRY_INTERVAL=30[39m
[32m- SUBMIT_PROPOSAL_CMD=\\"\\"[39m
[32m-[39m
[32m- add_key() {[39m
[32m-   # Add test keys to the keyring and self delegate initial coins[39m
[32m-   echo \\"Adding key....\\" $(jq -r \\".keys[0].name\\" $KEYS_CONFIG)[39m
[32m-   jq -r \\".keys[0].mnemonic\\" $KEYS_CONFIG | $CHAIN_BIN keys add $KEY_NAME --recover --keyring-backend=\\"test\\"[39m
[32m-   echo $($CHAIN_BIN keys show -a $KEY_NAME --keyring-backend=\\"test\\")[39m
[32m- }[39m
[32m-[39m
[32m- get_validator_address() {[39m
[32m-   echo \\"Getting validator address...\\"[39m
[32m-   VALIDATOR_ADDRESS=$($CHAIN_BIN q staking validators --node $NODE_URL --output json | jq -r '.validators[0].operator_address')[39m
[32m-   echo \\"Selected validator address: $VALIDATOR_ADDRESS\\"[39m
[32m- }[39m
[32m-[39m
[32m- stake_tokens() {[39m
[32m-   COINS=\\"10000000$DENOM\\"[39m
[32m-   echo \\"Staking tokens...\\"[39m
[32m-   $CHAIN_BIN tx staking delegate $VALIDATOR_ADDRESS $COINS \\\\[39m
[32m-     --from $KEY_NAME \\\\[39m
[32m-     --chain-id $CHAIN_ID \\\\[39m
[32m-     --node $NODE_URL \\\\[39m
[32m-     --keyring-backend=\\"test\\" \\\\[39m
[32m-     --gas auto --gas-adjustment 2 \\\\[39m
[32m-     --output json \\\\[39m
[32m-     --yes[39m
[32m-   sleep 5[39m
[32m- }[39m
[32m-[39m
[32m- determine_proposal_command() {[39m
[32m-   echo \\"Determining the correct command to submit proposals...\\"[39m
[32m-   HELP_OUTPUT=$($CHAIN_BIN tx gov --help)[39m
[32m-   if echo \\"$HELP_OUTPUT\\" | grep -q \\"submit-legacy-proposal\\"; then[39m
[32m-     SUBMIT_PROPOSAL_CMD=\\"submit-legacy-proposal\\"[39m
[32m-   else[39m
[32m-     SUBMIT_PROPOSAL_CMD=\\"submit-proposal\\"[39m
[32m-   fi[39m
[32m-   echo \\"Using $SUBMIT_PROPOSAL_CMD for submitting proposals.\\"[39m
[32m- }[39m
[32m-[39m
[32m- submit_proposal() {[39m
[32m-   echo \\"Get all proposals\\"[39m
[32m-   PROPOSALS_OUTPUT=$($CHAIN_BIN query gov proposals --output json --node $NODE_URL 2>&1 || true)[39m
[32m-   if echo \\"$PROPOSALS_OUTPUT\\" | grep -q \\"no proposals found\\"; then[39m
[32m-     echo \\"No existing proposals found. Proceeding to submit a new proposal.\\"[39m
[32m-   else[39m
[32m-     echo \\"Existing proposals: $PROPOSALS_OUTPUT\\"[39m
[32m-   fi[39m
[32m-[39m
[32m-   echo \\"Submit gov proposal on chain\\"[39m
[32m-   PROPOSAL_TX=$($CHAIN_BIN tx gov $SUBMIT_PROPOSAL_CMD consumer-addition $PROPOSAL_FILE \\\\[39m
[32m-     --from $KEY_NAME \\\\[39m
[32m-     --chain-id $CHAIN_ID \\\\[39m
[32m-     --node $NODE_URL \\\\[39m
[32m-     --keyring-backend=\\"test\\" \\\\[39m
[32m-     --gas auto --gas-adjustment 2 \\\\[39m
[32m-     --output json \\\\[39m
[32m-     --yes)[39m
[32m-   echo $PROPOSAL_TX[39m
[32m-[39m
[32m-   # Extract JSON part from the output[39m
[32m-   TX_HASH=$(echo \\"$PROPOSAL_TX\\" | grep -o '{.*}' | jq -r '.txhash')[39m
[32m-   if [ -n \\"$TX_HASH\\" ]; then[39m
[32m-     echo \\"Transaction hash: $TX_HASH\\"[39m
[32m-   else[39m
[32m-     echo \\"Failed to submit proposal. Output was not as expected.\\"[39m
[32m-     exit 1[39m
[32m-   fi[39m
[32m-[39m
[32m-   sleep 5[39m
[32m- }[39m
[32m-[39m
[32m- get_proposal_id() {[39m
[32m-   echo \\"Getting proposal ID\\"[39m
[32m-   PROPOSAL_QUERY=$(gaiad query tx $TX_HASH --node $NODE_URL --output json)[39m
[32m-   LOGS=$(echo $PROPOSAL_QUERY | jq -r '.logs')[39m
[32m-   if [ \\"$LOGS\\" != \\"null\\" ] && [ \\"$LOGS\\" != \\"[]\\" ]; then[39m
[32m-     PROPOSAL_ID=$(echo $PROPOSAL_QUERY | jq -r '.logs[0].events[] | select(.type==\\"submit_proposal\\").attributes[] | select(.key==\\"proposal_id\\").value')[39m
[32m-     if [ -n \\"$PROPOSAL_ID\\" ]; then[39m
[32m-       echo \\"Proposal ID: $PROPOSAL_ID\\"[39m
[32m-       return 0[39m
[32m-     fi[39m
[32m-   fi[39m
[32m-   echo \\"Failed to retrieve proposal ID from transaction logs. Logs might be empty.\\"[39m
[32m-   exit 1[39m
[32m- }[39m
[32m-[39m
[32m- vote_proposal() {[39m
[32m-   echo \\"Voting on proposal\\"[39m
[32m-   $CHAIN_BIN tx gov vote $PROPOSAL_ID yes \\\\[39m
[32m-     --from $KEY_NAME \\\\[39m
[32m-     --chain-id $CHAIN_ID \\\\[39m
[32m-     --node $NODE_URL \\\\[39m
[32m-     --keyring-backend=\\"test\\" \\\\[39m
[32m-     --gas auto --gas-adjustment 2 \\\\[39m
[32m-     --output json \\\\[39m
[32m-     --yes[39m
[32m-   sleep 5[39m
[32m- }[39m
[32m-[39m
[32m- wait_for_proposal_to_pass() {[39m
[32m-   echo \\"Waiting for proposal to pass\\"[39m
[32m-   for ((i=1; i<=$MAX_RETRIES; i++)); do[39m
[32m-     STATUS=$($CHAIN_BIN query gov proposal $PROPOSAL_ID --node $NODE_URL --output json | jq -r '.status')[39m
[32m-     if [ \\"$STATUS\\" == \\"PROPOSAL_STATUS_PASSED\\" ]; then[39m
[32m-       echo \\"Proposal has passed!\\"[39m
[32m-       return 0[39m
[32m-     else[39m
[32m-       echo \\"Current status: $STATUS. Attempt $i/$MAX_RETRIES. Waiting...\\"[39m
[32m-       sleep $RETRY_INTERVAL[39m
[32m-     fi[39m
[32m-   done[39m
[32m-   echo \\"Proposal did not pass after $MAX_RETRIES attempts.\\"[39m
[32m-   exit 1[39m
[32m- }[39m
[32m-[39m
[32m- main() {[39m
[32m-   add_key[39m
[32m-   get_validator_address[39m
[32m-   stake_tokens[39m
[32m-   determine_proposal_command[39m
[32m-   submit_proposal[39m
[32m-   get_proposal_id[39m
[32m-   vote_proposal[39m
[32m-   wait_for_proposal_to_pass[39m
[32m- }[39m
[32m-[39m
[32m- main",[39m
[32m-     "create-validator.sh": "#!/bin/bash[39m
[32m-[39m
[32m- DENOM=\\"\${DENOM:=uosmo}\\"[39m
[32m- CHAIN_BIN=\\"\${CHAIN_BIN:=osmosisd}\\"[39m
[32m- CHAIN_DIR=\\"\${CHAIN_DIR:=$HOME/.osmosisd}\\"[39m
[32m- KEYS_CONFIG=\\"\${KEYS_CONFIG:=configs/keys.json}\\"[39m
[32m- VAL_NAME=\\"\${VAL_NAME:=osmosis}\\"[39m
[32m- NODE_URL=\\"\${NODE_URL:=http://0.0.0.0:26657}\\"[39m
[32m- NODE_ARGS=\\"\${NODE_ARGS}\\"[39m
[32m- GAS=\\"\${GAS:=auto}\\"[39m
[32m-[39m
[32m- set -eux[39m
[32m-[39m
[32m- # Wait for the node to be synced[39m
[32m- max_tries=10[39m
[32m- while [[ $($CHAIN_BIN status --output json --node $NODE_URL 2>&1 | jq \\".SyncInfo.catching_up\\") == true ]][39m
[32m- do[39m
[32m-   if [[ max_tries -lt 0 ]]; then echo \\"Not able to sync with genesis node\\"; exit 1; fi[39m
[32m-   echo \\"Still syncing... Sleeping for 15 secs. Tries left $max_tries\\"[39m
[32m-   ((max_tries--))[39m
[32m-   sleep 30[39m
[32m- done[39m
[32m-[39m
[32m- # Function to compare version numbers[39m
[32m- version_compare() {[39m
[32m-     version1=\\"$1\\"[39m
[32m-     version2=\\"$2\\"[39m
[32m-     if [[ \\"$(printf '%s\\\\n' \\"$version1\\" \\"$version2\\" | sort -V | head -n 1)\\" == \\"$version1\\" ]]; then[39m
[32m-         return 1 # version1 is greater[39m
[32m-     else[39m
[32m-         return 0 # version2 is greater or equal[39m
[32m-     fi[39m
[32m- }[39m
[32m-[39m
[32m- # Check if cosmos_sdk_version is greater than a specified version[39m
[32m- is_greater() {[39m
[32m-     version_compare \\"$1\\" \\"$2\\"[39m
[32m-     return $?[39m
[32m- }[39m
[32m-[39m
[32m- function cosmos-sdk-version-v50() {[39m
[32m-   # Content for the validator.json file[39m
[32m-   json_content='{[39m
[32m-     \\"pubkey\\": '$($CHAIN_BIN tendermint show-validator $NODE_ARGS)'[39m
[32m-     \\"amount\\": \\"5000000000'$DENOM'\\"[39m
[32m-     \\"moniker\\": \\"'$VAL_NAME'\\"[39m
[32m-     \\"commission-rate\\": \\"0.1\\"[39m
[32m-     \\"commission-max-rate\\": \\"0.2\\"[39m
[32m-     \\"commission-max-change-rate\\": \\"0.01\\"[39m
[32m-     \\"min-self-delegation\\": \\"1000000\\"[39m
[32m-   }'[39m
[32m-   echo \\"$json_content\\" > /validator.json[39m
[32m-   cat /validator.json[39m
[32m-[39m
[32m-   # Run create validator tx command[39m
[32m-   echo \\"Running txn for create-validator\\"[39m
[32m-   $CHAIN_BIN tx staking create-validator /validator.json \\\\[39m
[32m-     --node $NODE_URL \\\\[39m
[32m-     --chain-id $CHAIN_ID \\\\[39m
[32m-     --from $VAL_NAME \\\\[39m
[32m-     --fees 100000$DENOM \\\\[39m
[32m-     --keyring-backend=\\"test\\" \\\\[39m
[32m-     --output json \\\\[39m
[32m-     --gas $GAS \\\\[39m
[32m-     --gas-adjustment 1.5 $NODE_ARGS --yes > /validator.log[39m
[32m-[39m
[32m-   cat /validator.log | jq[39m
[32m- }[39m
[32m-[39m
[32m- function cosmos-sdk-version-default() {[39m
[32m-   # Run create validator tx command[39m
[32m-   echo \\"Running txn for create-validator\\"[39m
[32m-   args=''[39m
[32m-   if [[ $($CHAIN_BIN tx staking create-validator --help | grep -c \\"min-self-delegation\\") -gt 0 ]];[39m
[32m-   then[39m
[32m-     args+='--min-self-delegation=1000000'[39m
[32m-   fi[39m
[32m-   $CHAIN_BIN keys list --keyring-backend test --output json --home $CHAIN_DIR | jq[39m
[32m-   $CHAIN_BIN tx staking create-validator \\\\[39m
[32m-     --node $NODE_URL \\\\[39m
[32m-     --pubkey=$($CHAIN_BIN tendermint show-validator $NODE_ARGS) \\\\[39m
[32m-     --moniker $VAL_NAME \\\\[39m
[32m-     --amount 5000000000$DENOM \\\\[39m
[32m-     --chain-id $CHAIN_ID \\\\[39m
[32m-     --from $VAL_NAME \\\\[39m
[32m-     --commission-rate=\\"0.10\\" \\\\[39m
[32m-     --commission-max-rate=\\"0.20\\" \\\\[39m
[32m-     --commission-max-change-rate=\\"0.01\\" \\\\[39m
[32m-     --keyring-backend test \\\\[39m
[32m-     --home $CHAIN_DIR \\\\[39m
[32m-     --fees 100000$DENOM \\\\[39m
[32m-     --gas $GAS \\\\[39m
[32m-     --output json \\\\[39m
[32m-     --gas-adjustment 1.5 $args $NODE_ARGS --yes > /validator.log[39m
[32m-[39m
[32m-   cat /validator.log | jq[39m
[32m- }[39m
[32m-[39m
[32m- set +e[39m
[32m- # Fetch the cosmos-sdk version to be able to perform the create-validator tx[39m
[32m- cosmos_sdk_version=$($CHAIN_BIN version --long | sed -n 's/cosmos_sdk_version: \\\\(.*\\\\)/\\\\1/p')[39m
[32m- echo \\"cosmos_sdk_version: $cosmos_sdk_version\\"[39m
[32m- set -e[39m
[32m-[39m
[32m- if is_greater \\"$cosmos_sdk_version\\" \\"v0.50.0\\"; then[39m
[32m-   echo \\"cosmos_sdk_version is greater than v0.50.0, running create-validator tx with new format\\"[39m
[32m-   cosmos-sdk-version-v50[39m
[32m- else[39m
[32m-   echo \\"cosmos_sdk_version is less than v0.50.0, running create-validator tx with old format\\"[39m
[32m-   cosmos-sdk-version-default[39m
[32m- fi",[39m
[2m      "ibc-connection.sh": "#!/bin/bash[22m

[2m  REGISTRY_URL=\\"$1\\"[22m
[33m@@ -1213,7 +1213,7 @@[39m
[2m    ((max_tries--))[22m
[2m    sleep 2[22m
[2m  done",[22m
[32m-     "update-config.sh": "#!/bin/bash[39m
[31m+     "updateConfig.sh": "#!/bin/bash[39m

[2m  STAKEDENOM=\${DENOM:-untrn}[22m
[2m  CHAIN_ID=\\"\${CHAIN_ID:=osmosis}\\"[22m
[33m@@ -1250,7 +1250,7 @@[39m
[2m  sed -i -e 's#keyring-backend = \\"os\\"#keyring-backend = \\"test\\"#g' $CHAIN_DIR/config/client.toml[22m
[2m  sed -i -e 's#output = \\"text\\"#output = \\"json\\"#g' $CHAIN_DIR/config/client.toml[22m
[2m  sed -i -e \\"s#chain-id = \\\\\\"\\\\\\"#chain-id = \\\\\\"$CHAIN_ID\\\\\\"#g\\" $CHAIN_DIR/config/client.toml",[22m
[32m-     "update-genesis.sh": "#!/bin/bash[39m
[31m+     "updateGenesis.sh": "#!/bin/bash[39m

[2m  DENOM=\\"\${DENOM:=uosmo}\\"[22m
[2m  CHAIN_BIN=\\"\${CHAIN_BIN:=osmosisd}\\"[22m
[33m@@ -1264,6 +1264,17 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts-neutron-1",[39m
[31m+       "app.kubernetes.io/part-of": "neutron-1",[39m
[31m+       "app.kubernetes.io/role": "setup-scripts",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-id": "neutron-1",[39m
[31m+       "starship.io/chain-name": "neutron",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts-neutron-1",[22m
[2m    },[22m
[2m  }[22m

--- ConfigMap/registry-cosmoshub-4 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -7,7 +7,14 @@[39m
[2m    \\"assets\\": [[22m
[2m      {[22m
[2m        \\"base\\": \\"uatom\\",[22m
[32m-       \\"coingecko_id\\": \\"atom\\",[39m
[31m+       \\"description\\": \\"The native staking and governance token of the Cosmos Hub.\\",[39m
[31m+       \\"name\\": \\"Cosmos Hub Atom\\",[39m
[31m+       \\"display\\": \\"atom\\",[39m
[31m+       \\"symbol\\": \\"ATOM\\",[39m
[31m+       \\"logo_URIs\\": {[39m
[31m+         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/cosmoshub/images/atom.png\\",[39m
[31m+         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/cosmoshub/images/atom.svg\\"[39m
[31m+       },[39m
[2m        \\"denom_units\\": [[22m
[2m          {[22m
[2m            \\"denom\\": \\"uatom\\",[22m
[33m@@ -18,14 +25,7 @@[39m
[2m            \\"exponent\\": 6[22m
[2m          }[22m
[2m        ],[22m
[32m-       \\"description\\": \\"The native staking and governance token of the Cosmos Hub.\\",[39m
[32m-       \\"display\\": \\"atom\\",[39m
[32m-       \\"logo_URIs\\": {[39m
[32m-         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/cosmoshub/images/atom.png\\",[39m
[32m-         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/cosmoshub/images/atom.svg\\"[39m
[32m-       },[39m
[32m-       \\"name\\": \\"Cosmos Hub Atom\\",[39m
[32m-       \\"symbol\\": \\"ATOM\\"[39m
[31m+       \\"coingecko_id\\": \\"atom\\"[39m
[2m      }[22m
[2m    ][22m
[2m  }",[22m
[33m@@ -82,6 +82,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "registry",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "registry-cosmoshub-4",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "registry-cosmoshub-4",[22m
[2m    },[22m
[2m  }[22m

--- Deployment/registry ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,14 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "Deployment",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "registry",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "registry",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "registry",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +17,6 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "registry",[39m
[2m          "app.kubernetes.io/name": "registry",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -22,19 +29,17 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "registry",[39m
[31m+           "app.kubernetes.io/component": "registry",[39m
[31m+           "app.kubernetes.io/managed-by": "starship",[39m
[2m            "app.kubernetes.io/name": "registry",[22m
[32m-           "app.kubernetes.io/rawname": "registry",[39m
[32m-           "app.kubernetes.io/type": "registry",[39m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/part-of": "starship",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+           "starship.io/name": "starship-e2e-tests",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[2m          "containers": Array [[22m
[2m            Object {[22m
[32m-             "command": Array [[39m
[32m-               "registry",[39m
[32m-             ],[39m
[2m              "env": Array [[22m
[2m                Object {[22m
[2m                  "name": "NAMESPACE",[22m
[33m@@ -74,21 +79,20 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "REGISTRY_CHAIN_REGISTRY",[22m
[32m-                 "value": "/configs",[39m
[31m+                 "value": "/chains",[39m
[2m                },[22m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/registry:20250205-544757d",[22m
[32m-             "imagePullPolicy": "IfNotPresent",[39m
[2m              "livenessProbe": Object {[22m
[32m-               "initialDelaySeconds": 20,[39m
[32m-               "periodSeconds": 10,[39m
[31m+               "initialDelaySeconds": 15,[39m
[31m+               "periodSeconds": 20,[39m
[2m                "tcpSocket": Object {[22m
[2m                  "port": 8080,[22m
[2m                },[22m
[2m              },[22m
[2m              "name": "registry",[22m
[2m              "readinessProbe": Object {[22m
[32m-               "initialDelaySeconds": 20,[39m
[31m+               "initialDelaySeconds": 5,[39m
[2m                "periodSeconds": 10,[22m
[2m                "tcpSocket": Object {[22m
[2m                  "port": 8080,[22m
[33m@@ -96,22 +100,22 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[2m                Object {[22m
[32m-                 "mountPath": "/configs/cosmoshub-4",[39m
[32m-                 "name": "registry-configs-cosmoshub-4",[39m
[31m+                 "mountPath": "/chains/cosmoshub-4",[39m
[31m+                 "name": "registry-cosmoshub-4",[39m
[2m                },[22m
[2m                Object {[22m
[32m-                 "mountPath": "/configs/neutron-1",[39m
[32m-                 "name": "registry-configs-neutron-1",[39m
[31m+                 "mountPath": "/chains/neutron-1",[39m
[31m+                 "name": "registry-neutron-1",[39m
[2m                },[22m
[2m              ],[22m
[2m            },[22m
[33m@@ -126,6 +130,7 @@[39m
[2m    echo \\"Checking: http://neutron-1-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id\\"[22m
[2m    sleep 10;[22m
[2m  done[22m
[31m+[39m
[2m  while [ $(curl -sw '%{http_code}' http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id -o /dev/null) -ne 200 ]; do[22m
[2m    echo \\"Genesis validator does not seem to be ready for: cosmoshub-4. Waiting for it to start...\\"[22m
[2m    echo \\"Checking: http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id\\"[22m
[33m@@ -148,16 +153,16 @@[39m
[2m                  },[22m
[2m                },[22m
[2m              ],[22m
[32m-             "image": "curlimages/curl",[39m
[31m+             "image": "curlimages/curl:latest",[39m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "wait-for-chains",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -168,13 +173,13 @@[39m
[2m              "configMap": Object {[22m
[2m                "name": "registry-cosmoshub-4",[22m
[2m              },[22m
[32m-             "name": "registry-configs-cosmoshub-4",[39m
[31m+             "name": "registry-cosmoshub-4",[39m
[2m            },[22m
[2m            Object {[22m
[2m              "configMap": Object {[22m
[2m                "name": "registry-neutron-1",[22m
[2m              },[22m
[32m-             "name": "registry-configs-neutron-1",[39m
[31m+             "name": "registry-neutron-1",[39m
[2m            },[22m
[2m          ],[22m
[2m        },[22m

--- ConfigMap/registry-neutron-1 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -6,8 +6,7 @@[39m
[2m    \\"chain_name\\": \\"neutron\\",[22m
[2m    \\"assets\\": [[22m
[2m      {[22m
[32m-       \\"base\\": \\"untrn\\",[39m
[32m-       \\"coingecko_id\\": \\"neutron\\",[39m
[31m+       \\"description\\": \\"The native token of Neutron chain.\\",[39m
[2m        \\"denom_units\\": [[22m
[2m          {[22m
[2m            \\"denom\\": \\"untrn\\",[22m
[33m@@ -18,14 +17,15 @@[39m
[2m            \\"exponent\\": 6[22m
[2m          }[22m
[2m        ],[22m
[32m-       \\"description\\": \\"The native token of Neutron chain.\\",[39m
[31m+       \\"base\\": \\"untrn\\",[39m
[31m+       \\"name\\": \\"Neutron\\",[39m
[2m        \\"display\\": \\"ntrn\\",[22m
[31m+       \\"symbol\\": \\"NTRN\\",[39m
[2m        \\"logo_URIs\\": {[22m
[2m          \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/neutron/images/ntrn.png\\",[22m
[2m          \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/neutron/images/ntrn.svg\\"[22m
[2m        },[22m
[32m-       \\"name\\": \\"Neutron\\",[39m
[32m-       \\"symbol\\": \\"NTRN\\"[39m
[31m+       \\"coingecko_id\\": \\"neutron\\"[39m
[2m      }[22m
[2m    ][22m
[2m  }",[22m
[33m@@ -82,6 +82,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "registry",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "registry-neutron-1",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "registry-neutron-1",[22m
[2m    },[22m
[2m  }[22m

--- ConfigMap/hermes-neutron-cosmos ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -3,93 +3,45 @@[39m
[2m    "data": Object {[22m
[2m      "config-cli.toml": "# The global section has parameters that apply globally to the relayer operation.[22m
[2m  [global][22m
[32m- # Specify the verbosity for the relayer logging output. Default: 'info'[39m
[32m- # Valid options are 'error', 'warn', 'info', 'debug', 'trace'.[39m
[32m- log_level = 'info'[39m
[32m- # Specify the mode to be used by the relayer. [Required][39m
[31m+ log_level = \\"info\\"[39m
[31m+[39m
[2m  [mode][22m
[32m- # Specify the client mode.[39m
[2m  [mode.clients][22m
[32m- # Whether or not to enable the client workers. [Required][39m
[2m  enabled = true[22m
[32m- # Whether or not to enable periodic refresh of clients. [Default: true][39m
[32m- # This feature only applies to clients that underlie an open channel.[39m
[32m- # For Tendermint clients, the frequency at which Hermes refreshes them is 2/3 of their[39m
[32m- # trusting period (e.g., refresh every ~9 days if the trusting period is 14 days).[39m
[32m- # Note: Even if this is disabled, clients will be refreshed automatically if[39m
[32m- #      there is activity on a connection or channel they are involved with.[39m
[2m  refresh = true[22m
[32m- # Whether or not to enable misbehaviour detection for clients. [Default: false][39m
[2m  misbehaviour = true[22m
[32m- # Specify the connections mode.[39m
[31m+[39m
[2m  [mode.connections][22m
[32m- # Whether or not to enable the connection workers for handshake completion. [Required][39m
[2m  enabled = true[22m
[32m- # Specify the channels mode.[39m
[31m+[39m
[2m  [mode.channels][22m
[32m- # Whether or not to enable the channel workers for handshake completion. [Required][39m
[2m  enabled = true[22m
[32m- # Specify the packets mode.[39m
[31m+[39m
[2m  [mode.packets][22m
[32m- # Whether or not to enable the packet workers. [Required][39m
[2m  enabled = true[22m
[32m- # Parametrize the periodic packet clearing feature.[39m
[32m- # Interval (in number of blocks) at which pending packets[39m
[32m- # should be periodically cleared. A value of '0' will disable[39m
[32m- # periodic packet clearing. [Default: 100][39m
[2m  clear_interval = 100[22m
[32m- # Whether or not to clear packets on start. [Default: false][39m
[2m  clear_on_start = true[22m
[32m- # Toggle the transaction confirmation mechanism.[39m
[32m- # The tx confirmation mechanism periodically queries the \`/tx_search\` RPC[39m
[32m- # endpoint to check that previously-submitted transactions[39m
[32m- # (to any chain in this config file) have been successfully delivered.[39m
[32m- # If they have not been, and \`clear_interval = 0\`, then those packets are[39m
[32m- # queued up for re-submission.[39m
[32m- # Experimental feature. Affects telemetry if set to false.[39m
[32m- # [Default: true][39m
[2m  tx_confirmation = true[22m
[32m- # Auto register the counterparty payee on a destination chain to[39m
[32m- # the relayer's address on the source chain. This can be used[39m
[32m- # for simple configuration of the relayer to receive fees for[39m
[32m- # relaying RecvPacket on fee-enabled channels.[39m
[32m- # For more complex configuration, turn this off and use the CLI[39m
[32m- # to manually register the payee addresses.[39m
[32m- # [Default: false][39m
[32m- auto_register_counterparty_payee = false[39m
[32m- # The REST section defines parameters for Hermes' built-in RESTful API.[39m
[32m- # https://hermes.informal.systems/rest.html[39m
[31m+[39m
[2m  [rest][22m
[32m- # Whether or not to enable the REST service. Default: false[39m
[2m  enabled = true[22m
[32m- # Specify the IPv4/6 host over which the built-in HTTP server will serve the RESTful[39m
[32m- # API requests. Default: 127.0.0.1[39m
[32m- host =  '0.0.0.0'[39m
[32m- # Specify the port over which the built-in HTTP server will serve the restful API[39m
[32m- # requests. Default: 3000[39m
[31m+ host = \\"0.0.0.0\\"[39m
[2m  port = 3000[22m
[32m- # The telemetry section defines parameters for Hermes' built-in telemetry capabilities.[39m
[32m- # https://hermes.informal.systems/telemetry.html[39m
[31m+[39m
[2m  [telemetry][22m
[32m- # Whether or not to enable the telemetry service. Default: false[39m
[2m  enabled = true[22m
[32m- # Specify the IPv4/6 host over which the built-in HTTP server will serve the metrics[39m
[32m- # gathered by the telemetry service. Default: 127.0.0.1[39m
[32m- host = '0.0.0.0'[39m
[32m- # Specify the port over which the built-in HTTP server will serve the metrics gathered[39m
[32m- # by the telemetry service. Default: 3001[39m
[31m+ host = \\"0.0.0.0\\"[39m
[2m  port = 3001[22m
[32m-[39m


[2m  [[chains]][22m
[2m  id = \\"neutron-1\\"[22m
[31m+ type = \\"CosmosSdk\\"[39m
[2m  key_name = \\"neutron-1-cli\\"[22m
[2m  ccv_consumer_chain = true[22m
[32m- rpc_addr = \\"http://neutron-1-genesis.default.svc.cluster.local:26657\\"[39m
[32m- grpc_addr = \\"http://neutron-1-genesis.default.svc.cluster.local:9090\\"[39m
[32m- event_source = { mode = 'push', url = \\"ws://neutron-1-genesis.default.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[32m- # Experimental: Whether or not the full node is trusted.[39m
[31m+ rpc_addr = \\"http://neutron-1-genesis.$NAMESPACE.svc.cluster.local:26657\\"[39m
[31m+ grpc_addr = \\"http://neutron-1-genesis.$NAMESPACE.svc.cluster.local:9090\\"[39m
[31m+ event_source = { mode = 'push', url = \\"ws://neutron-1-genesis.$NAMESPACE.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[2m  trusted_node = false[22m
[2m  account_prefix = \\"neutron\\"[22m
[2m  default_gas = 500000000[22m
[33m@@ -104,17 +56,16 @@[39m
[2m  trusting_period = \\"75s\\"[22m
[2m  trust_threshold = { numerator = \\"2\\", denominator = \\"3\\" }[22m
[2m  address_type = { derivation = 'cosmos' }[22m
[32m- gas_price = { price = 0.25, denom = \\"untrn\\" }[39m
[32m-[39m
[32m-[39m
[31m+ gas_price = { price = 1.25, denom = \\"untrn\\" }[39m

[2m  [[chains]][22m
[2m  id = \\"cosmoshub-4\\"[22m
[31m+ type = \\"CosmosSdk\\"[39m
[2m  key_name = \\"cosmoshub-4-cli\\"[22m
[32m- rpc_addr = \\"http://cosmoshub-4-genesis.default.svc.cluster.local:26657\\"[39m
[32m- grpc_addr = \\"http://cosmoshub-4-genesis.default.svc.cluster.local:9090\\"[39m
[32m- event_source = { mode = 'push', url = \\"ws://cosmoshub-4-genesis.default.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[32m- # Experimental: Whether or not the full node is trusted.[39m
[31m+[39m
[31m+ rpc_addr = \\"http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:26657\\"[39m
[31m+ grpc_addr = \\"http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:9090\\"[39m
[31m+ event_source = { mode = 'push', url = \\"ws://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[2m  trusted_node = false[22m
[2m  account_prefix = \\"cosmos\\"[22m
[2m  default_gas = 500000000[22m
[33m@@ -129,86 +80,38 @@[39m
[2m  trusting_period = \\"75s\\"[22m
[2m  trust_threshold = { numerator = \\"2\\", denominator = \\"3\\" }[22m
[2m  address_type = { derivation = 'cosmos' }[22m
[32m- gas_price = { price = 0.25, denom = \\"uatom\\" }",[39m
[31m+ gas_price = { price = 1.25, denom = \\"uatom\\" }",[39m
[2m      "config.toml": "# The global section has parameters that apply globally to the relayer operation.[22m
[2m  [global][22m
[32m- # Specify the verbosity for the relayer logging output. Default: 'info'[39m
[32m- # Valid options are 'error', 'warn', 'info', 'debug', 'trace'.[39m
[32m- log_level = 'info'[39m
[32m- # Specify the mode to be used by the relayer. [Required][39m
[31m+ log_level = \\"info\\"[39m
[31m+[39m
[2m  [mode][22m
[32m- # Specify the client mode.[39m
[2m  [mode.clients][22m
[32m- # Whether or not to enable the client workers. [Required][39m
[2m  enabled = true[22m
[32m- # Whether or not to enable periodic refresh of clients. [Default: true][39m
[32m- # This feature only applies to clients that underlie an open channel.[39m
[32m- # For Tendermint clients, the frequency at which Hermes refreshes them is 2/3 of their[39m
[32m- # trusting period (e.g., refresh every ~9 days if the trusting period is 14 days).[39m
[32m- # Note: Even if this is disabled, clients will be refreshed automatically if[39m
[32m- #      there is activity on a connection or channel they are involved with.[39m
[2m  refresh = true[22m
[32m- # Whether or not to enable misbehaviour detection for clients. [Default: false][39m
[2m  misbehaviour = true[22m
[32m- # Specify the connections mode.[39m
[31m+[39m
[2m  [mode.connections][22m
[32m- # Whether or not to enable the connection workers for handshake completion. [Required][39m
[2m  enabled = true[22m
[32m- # Specify the channels mode.[39m
[31m+[39m
[2m  [mode.channels][22m
[32m- # Whether or not to enable the channel workers for handshake completion. [Required][39m
[2m  enabled = true[22m
[32m- # Specify the packets mode.[39m
[31m+[39m
[2m  [mode.packets][22m
[32m- # Whether or not to enable the packet workers. [Required][39m
[2m  enabled = true[22m
[32m- # Parametrize the periodic packet clearing feature.[39m
[32m- # Interval (in number of blocks) at which pending packets[39m
[32m- # should be periodically cleared. A value of '0' will disable[39m
[32m- # periodic packet clearing. [Default: 100][39m
[2m  clear_interval = 100[22m
[32m- # Whether or not to clear packets on start. [Default: false][39m
[2m  clear_on_start = true[22m
[32m- # Toggle the transaction confirmation mechanism.[39m
[32m- # The tx confirmation mechanism periodically queries the \`/tx_search\` RPC[39m
[32m- # endpoint to check that previously-submitted transactions[39m
[32m- # (to any chain in this config file) have been successfully delivered.[39m
[32m- # If they have not been, and \`clear_interval = 0\`, then those packets are[39m
[32m- # queued up for re-submission.[39m
[32m- # Experimental feature. Affects telemetry if set to false.[39m
[32m- # [Default: true][39m
[2m  tx_confirmation = true[22m
[32m- # Auto register the counterparty payee on a destination chain to[39m
[32m- # the relayer's address on the source chain. This can be used[39m
[32m- # for simple configuration of the relayer to receive fees for[39m
[32m- # relaying RecvPacket on fee-enabled channels.[39m
[32m- # For more complex configuration, turn this off and use the CLI[39m
[32m- # to manually register the payee addresses.[39m
[32m- # [Default: false][39m
[32m- auto_register_counterparty_payee = false[39m
[32m- # The REST section defines parameters for Hermes' built-in RESTful API.[39m
[32m- # https://hermes.informal.systems/rest.html[39m
[31m+[39m
[2m  [rest][22m
[32m- # Whether or not to enable the REST service. Default: false[39m
[2m  enabled = true[22m
[32m- # Specify the IPv4/6 host over which the built-in HTTP server will serve the RESTful[39m
[32m- # API requests. Default: 127.0.0.1[39m
[32m- host =  '0.0.0.0'[39m
[32m- # Specify the port over which the built-in HTTP server will serve the restful API[39m
[32m- # requests. Default: 3000[39m
[31m+ host = \\"0.0.0.0\\"[39m
[2m  port = 3000[22m
[32m- # The telemetry section defines parameters for Hermes' built-in telemetry capabilities.[39m
[32m- # https://hermes.informal.systems/telemetry.html[39m
[31m+[39m
[2m  [telemetry][22m
[32m- # Whether or not to enable the telemetry service. Default: false[39m
[2m  enabled = true[22m
[32m- # Specify the IPv4/6 host over which the built-in HTTP server will serve the metrics[39m
[32m- # gathered by the telemetry service. Default: 127.0.0.1[39m
[32m- host = '0.0.0.0'[39m
[32m- # Specify the port over which the built-in HTTP server will serve the metrics gathered[39m
[32m- # by the telemetry service. Default: 3001[39m
[31m+ host = \\"0.0.0.0\\"[39m
[2m  port = 3001[22m
[32m-[39m


[2m  [[chains]][22m
[33m@@ -216,10 +119,9 @@[39m
[2m  type = \\"CosmosSdk\\"[22m
[2m  key_name = \\"neutron-1\\"[22m
[2m  ccv_consumer_chain = true[22m
[32m- rpc_addr = \\"http://neutron-1-genesis.default.svc.cluster.local:26657\\"[39m
[32m- grpc_addr = \\"http://neutron-1-genesis.default.svc.cluster.local:9090\\"[39m
[32m- event_source = { mode = 'push', url = \\"ws://neutron-1-genesis.default.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[32m- # Experimental: Whether or not the full node is trusted.[39m
[31m+ rpc_addr = \\"http://neutron-1-genesis.$NAMESPACE.svc.cluster.local:26657\\"[39m
[31m+ grpc_addr = \\"http://neutron-1-genesis.$NAMESPACE.svc.cluster.local:9090\\"[39m
[31m+ event_source = { mode = 'push', url = \\"ws://neutron-1-genesis.$NAMESPACE.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[2m  trusted_node = false[22m
[2m  account_prefix = \\"neutron\\"[22m
[2m  default_gas = 500000000[22m
[33m@@ -236,16 +138,14 @@[39m
[2m  address_type = { derivation = 'cosmos' }[22m
[2m  gas_price = { price = 1.25, denom = \\"untrn\\" }[22m

[32m-[39m
[32m-[39m
[2m  [[chains]][22m
[2m  id = \\"cosmoshub-4\\"[22m
[2m  type = \\"CosmosSdk\\"[22m
[2m  key_name = \\"cosmoshub-4\\"[22m
[32m- rpc_addr = \\"http://cosmoshub-4-genesis.default.svc.cluster.local:26657\\"[39m
[32m- grpc_addr = \\"http://cosmoshub-4-genesis.default.svc.cluster.local:9090\\"[39m
[32m- event_source = { mode = 'push', url = \\"ws://cosmoshub-4-genesis.default.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[32m- # Experimental: Whether or not the full node is trusted.[39m
[31m+[39m
[31m+ rpc_addr = \\"http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:26657\\"[39m
[31m+ grpc_addr = \\"http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:9090\\"[39m
[31m+ event_source = { mode = 'push', url = \\"ws://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[2m  trusted_node = false[22m
[2m  account_prefix = \\"cosmos\\"[22m
[2m  default_gas = 500000000[22m
[33m@@ -264,6 +164,15 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "relayer",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "hermes-neutron-cosmos",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/role": "hermes",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "hermes-neutron-cosmos",[22m
[2m    },[22m
[2m  }[22m

--- StatefulSet/hermes-neutron-cosmos ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,15 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "relayer",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "hermes-neutron-cosmos",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/role": "hermes",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "hermes-neutron-cosmos",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -29,16 +38,18 @@[39m
[2m            "app.kubernetes.io/name": "hermes-neutron-cosmos",[22m
[2m            "app.kubernetes.io/rawname": "neutron-cosmos",[22m
[2m            "app.kubernetes.io/type": "hermes",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[2m          "containers": Array [[22m
[2m            Object {[22m
[31m+             "args": Array [[39m
[31m+               "/exposer/exposer",[39m
[31m+             ],[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "/exposer/exposer",[39m
[2m              ],[22m
[2m              "env": Array [[22m
[2m                Object {[22m
[33m@@ -55,11 +66,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -83,14 +94,24 @@[39m
[2m              ],[22m
[2m            },[22m
[2m            Object {[22m
[31m+             "args": Array [[39m
[31m+               "RLY_INDEX=\${HOSTNAME##*-}[39m
[31m+ echo \\"Relayer Index: $RLY_INDEX\\"[39m
[31m+ hermes start",[39m
[31m+             ],[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "RLY_INDEX=\${HOSTNAME##*-}[39m
[32m- echo \\"Relayer Index: $RLY_INDEX\\"[39m
[32m- hermes start",[39m
[2m              ],[22m
[2m              "env": Array [[22m
[31m+               Object {[39m
[31m+                 "name": "NAMESPACE",[39m
[31m+                 "valueFrom": Object {[39m
[31m+                   "fieldRef": Object {[39m
[31m+                     "fieldPath": "metadata.namespace",[39m
[31m+                   },[39m
[31m+                 },[39m
[31m+               },[39m
[2m                Object {[22m
[2m                  "name": "RELAYER_DIR",[22m
[2m                  "value": "/root/.hermes",[22m
[33m@@ -101,12 +122,12 @@[39m
[2m              "name": "relayer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[2m              },[22m
[2m              "securityContext": Object {[22m
[33m@@ -127,24 +148,26 @@[39m
[2m          ],[22m
[2m          "initContainers": Array [[22m
[2m            Object {[22m
[32m-             "command": Array [[39m
[32m-               "bash",[39m
[32m-               "-c",[39m
[31m+             "args": Array [[39m
[2m                "# Install exposer binary from the image[22m
[2m  cp /bin/exposer /exposer/exposer[22m
[2m  chmod +x /exposer/exposer",[22m
[31m+             ],[39m
[31m+             "command": Array [[39m
[31m+               "bash",[39m
[31m+               "-c",[39m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/exposer:20250205-544757d",[22m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "init-exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "100M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "100M",[39m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[33m@@ -155,9 +178,7 @@[39m
[2m              ],[22m
[2m            },[22m
[2m            Object {[22m
[32m-             "command": Array [[39m
[32m-               "bash",[39m
[32m-               "-c",[39m
[31m+             "args": Array [[39m
[2m                "set -ux[22m

[2m  RLY_INDEX=\${HOSTNAME##*-}[22m
[33m@@ -166,18 +187,16 @@[39m
[2m  mkdir -p $RELAYER_DIR[22m
[2m  cp /configs/config.toml $RELAYER_DIR/config.toml[22m
[2m  cp /configs/config-cli.toml $RELAYER_DIR/config-cli.toml[22m
[32m- cat $RELAYER_DIR/config.toml[39m

[32m- MNEMONIC=$(jq -r \\".relayers[$RELAYER_INDEX].mnemonic\\" $KEYS_CONFIG)[39m
[31m+ # Replace namespace placeholder with actual namespace environment variable[39m
[31m+ sed -i \\"s|\\\\$NAMESPACE|$NAMESPACE|g\\" $RELAYER_DIR/config.toml[39m
[31m+ sed -i \\"s|\\\\$NAMESPACE|$NAMESPACE|g\\" $RELAYER_DIR/config-cli.toml[39m
[31m+[39m
[31m+ MNEMONIC=$(jq -r \\".relayers[$RLY_INDEX].mnemonic\\" $KEYS_CONFIG)[39m
[2m  echo $MNEMONIC > $RELAYER_DIR/mnemonic.txt[22m
[32m- MNEMONIC_CLI=$(jq -r \\".relayers_cli[$RELAYER_INDEX].mnemonic\\" $KEYS_CONFIG)[39m
[31m+ MNEMONIC_CLI=$(jq -r \\".relayers_cli[$RLY_INDEX].mnemonic\\" $KEYS_CONFIG)[39m
[2m  echo $MNEMONIC_CLI > $RELAYER_DIR/mnemonic-cli.txt[22m

[32m- echo \\"Debug output for neutron-cosmos...\\"[39m
[32m- cat << EOF[39m
[32m-               map[string]interface {}[39m
[32m-               {\\"chains\\":[\\"neutron-1\\",\\"cosmoshub-4\\"],\\"channels\\":[{\\"a-chain\\":\\"neutron-1\\",\\"a-connection\\":\\"connection-0\\",\\"a-port\\":\\"consumer\\",\\"b-port\\":\\"provider\\",\\"channel-version\\":1,\\"order\\":\\"ordered\\"},{\\"a-chain\\":\\"neutron-1\\",\\"a-connection\\":\\"connection-0\\",\\"a-port\\":\\"transfer\\",\\"b-port\\":\\"transfer\\"}],\\"config\\":{\\"event_source\\":{\\"mode\\":\\"push\\"},\\"global\\":{\\"log_level\\":\\"info\\"},\\"mode\\":{\\"channels\\":{\\"enabled\\":true},\\"clients\\":{\\"enabled\\":true,\\"misbehaviour\\":true,\\"refresh\\":true},\\"connections\\":{\\"enabled\\":true},\\"packets\\":{\\"clear_interval\\":100,\\"clear_on_start\\":true,\\"enabled\\":true,\\"tx_confirmation\\":true}},\\"rest\\":{\\"enabled\\":true,\\"host\\":\\"0.0.0.0\\",\\"port\\":3000},\\"telemetry\\":{\\"enabled\\":true,\\"host\\":\\"0.0.0.0\\",\\"port\\":3001}},\\"fullname\\":\\"hermes-neutron-cosmos\\",\\"ics\\":{\\"consumer\\":\\"neutron-1\\",\\"enabled\\":true,\\"provider\\":\\"cosmoshub-4\\"},\\"image\\":\\"ghcr.io/cosmology-tech/starship/hermes:1.10.0\\",\\"name\\":\\"neutron-cosmos\\",\\"replicas\\":1,\\"type\\":\\"hermes\\"}[39m
[32m- EOF[39m

[2m  echo \\"Creating key for neutron-1...\\"[22m
[2m  hermes keys add \\\\[22m
[33m@@ -240,8 +259,7 @@[39m
[2m    $DENOM \\\\[22m
[2m    http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:8000/credit \\\\[22m
[2m    \\"true\\" || true[22m
[32m- echo \\"Creating IBC connection for neutron-1...\\"[39m
[32m- hermes create connection --a-chain neutron-1 --a-client 07-tendermint-0 --b-client 07-tendermint-0[39m
[31m+[39m
[2m  hermes create channel \\\\[22m
[2m    --a-connection connection-0 \\\\[22m
[2m    --channel-version 1 \\\\[22m
[33m@@ -249,11 +267,16 @@[39m
[2m    --a-chain neutron-1 \\\\[22m
[2m    --a-port consumer \\\\[22m
[2m    --b-port provider[22m
[31m+[39m
[2m  hermes create channel \\\\[22m
[2m    --a-connection connection-0 \\\\[22m
[2m    --a-chain neutron-1 \\\\[22m
[2m    --a-port transfer \\\\[22m
[2m    --b-port transfer",[22m
[31m+             ],[39m
[31m+             "command": Array [[39m
[31m+               "bash",[39m
[31m+               "-c",[39m
[2m              ],[22m
[2m              "env": Array [[22m
[2m                Object {[22m
[33m@@ -274,7 +297,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "RELAYER_INDEX",[22m
[32m-                 "value": "0",[39m
[31m+                 "value": "\${HOSTNAME##*-}",[39m
[2m                },[22m
[2m              ],[22m
[2m              "image": "ghcr.io/cosmology-tech/starship/hermes:1.10.0",[22m
[33m@@ -282,12 +305,12 @@[39m
[2m              "name": "init-relayer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[33m@@ -318,6 +341,7 @@[39m
[2m    echo \\"Checking: http://neutron-1-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id\\"[22m
[2m    sleep 10;[22m
[2m  done[22m
[31m+[39m
[2m  while [ $(curl -sw '%{http_code}' http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id -o /dev/null) -ne 200 ]; do[22m
[2m    echo \\"Genesis validator does not seem to be ready for: cosmoshub-4. Waiting for it to start...\\"[22m
[2m    echo \\"Checking: http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id\\"[22m
[33m@@ -340,16 +364,16 @@[39m
[2m                  },[22m
[2m                },[22m
[2m              ],[22m
[32m-             "image": "curlimages/curl",[39m
[31m+             "image": "curlimages/curl:latest",[39m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "wait-for-chains",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m"
`;

exports[`Manifest Comparison Tests Individual Config Comparisons should generate manifests for neutron-relayer that match the snapshot 1`] = `
"ðŸ”„ MODIFIED_RESOURCES:

--- ConfigMap/keys ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -98,6 +98,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "configmap",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "keys",[39m
[31m+       "app.kubernetes.io/part-of": "global",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "keys",[22m
[2m    },[22m
[2m  }[22m

--- ConfigMap/setup-scripts ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -208,6 +208,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "configmap",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts",[39m
[31m+       "app.kubernetes.io/part-of": "global",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts",[22m
[2m    },[22m
[2m  }[22m

--- StatefulSet/cosmoshub-4-genesis ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,18 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/id": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "cosmoshub-4-genesis",[39m
[31m+       "app.kubernetes.io/part-of": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/role": "genesis",[39m
[31m+       "app.kubernetes.io/type": "cosmoshub-4-statefulset",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-name": "cosmoshub",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "cosmoshub-4-genesis",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +21,7 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "cosmoshub",[39m
[31m+         "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m          "app.kubernetes.io/name": "cosmoshub-4-genesis",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -23,11 +35,12 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "cosmoshub",[39m
[31m+           "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m            "app.kubernetes.io/name": "cosmoshub-4-genesis",[22m
[2m            "app.kubernetes.io/rawname": "cosmoshub-4",[22m
[31m+           "app.kubernetes.io/role": "genesis",[39m
[2m            "app.kubernetes.io/type": "cosmoshub-4",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[33m@@ -91,11 +104,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -184,12 +197,12 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[32m-                 "memory": "200M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "128M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[32m-                 "memory": "200M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "128M",[39m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[33m@@ -211,7 +224,12 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "START_ARGS=\\"\\"[39m
[31m+               "#!/bin/bash[39m
[31m+ set -euo pipefail[39m
[31m+[39m
[31m+ START_ARGS=\\"\\"[39m
[31m+[39m
[31m+[39m
[2m  $CHAIN_BIN start $START_ARGS",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -274,11 +292,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -307,6 +325,7 @@[39m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m

[2m  echo \\"Running setup config script...\\"[22m
[31m+[39m
[2m  bash -e /scripts/update-config.sh",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -348,7 +367,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "TIME_IOTA_MS",[22m
[33m@@ -388,11 +407,11 @@[39m
[2m              "name": "init-config",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -415,20 +434,18 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "# Install faucet binary from the image[39m
[32m- cp /bin/faucet /faucet/faucet[39m
[32m- chmod +x /faucet/faucet",[39m
[31m+               "cp /bin/faucet /faucet/faucet && chmod +x /faucet/faucet",[39m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/faucet:20250325-2207109",[22m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "init-faucet",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -553,11 +570,11 @@[39m
[2m              "name": "init-genesis",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m

--- ConfigMap/setup-scripts-cosmoshub-4 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -608,6 +608,17 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts-cosmoshub-4",[39m
[31m+       "app.kubernetes.io/part-of": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/role": "setup-scripts",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-id": "cosmoshub-4",[39m
[31m+       "starship.io/chain-name": "cosmoshub",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts-cosmoshub-4",[22m
[2m    },[22m
[2m  }[22m

--- StatefulSet/neutron-1-genesis ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,18 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/id": "neutron-1",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "neutron-1-genesis",[39m
[31m+       "app.kubernetes.io/part-of": "neutron-1",[39m
[31m+       "app.kubernetes.io/role": "genesis",[39m
[31m+       "app.kubernetes.io/type": "neutron-1-statefulset",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-name": "neutron",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "neutron-1-genesis",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +21,7 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "neutron",[39m
[31m+         "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m          "app.kubernetes.io/name": "neutron-1-genesis",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -23,11 +35,12 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "neutron",[39m
[31m+           "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m            "app.kubernetes.io/name": "neutron-1-genesis",[22m
[2m            "app.kubernetes.io/rawname": "neutron-1",[22m
[31m+           "app.kubernetes.io/role": "genesis",[39m
[2m            "app.kubernetes.io/type": "neutron-1",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[33m@@ -91,11 +104,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -114,7 +127,12 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "START_ARGS=\\"\\"[39m
[31m+               "#!/bin/bash[39m
[31m+ set -euo pipefail[39m
[31m+[39m
[31m+ START_ARGS=\\"\\"[39m
[31m+[39m
[31m+[39m
[2m  $CHAIN_BIN start $START_ARGS",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -177,11 +195,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -210,6 +228,7 @@[39m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m

[2m  echo \\"Running setup config script...\\"[22m
[31m+[39m
[2m  bash -e /scripts/update-config.sh",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -251,7 +270,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "TIME_IOTA_MS",[22m
[33m@@ -291,11 +310,11 @@[39m
[2m              "name": "init-config",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -428,11 +447,11 @@[39m
[2m              "name": "init-genesis",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -535,11 +554,11 @@[39m
[2m              "name": "init-ics",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -588,16 +607,16 @@[39m
[2m                  },[22m
[2m                },[22m
[2m              ],[22m
[32m-             "image": "curlimages/curl",[39m
[31m+             "image": "curlimages/curl:latest",[39m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "wait-for-chains",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m

--- ConfigMap/consumer-proposal-neutron-1 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -29,6 +29,17 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "neutron",[39m
[31m+       "app.kubernetes.io/part-of": "neutron-1",[39m
[31m+       "app.kubernetes.io/role": "ics-proposal",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-id": "neutron-1",[39m
[31m+       "starship.io/chain-name": "neutron",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "consumer-proposal-neutron-1",[22m
[2m    },[22m
[2m  }[22m

--- ConfigMap/setup-scripts-neutron-1 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -87,8 +87,261 @@[39m

[2m  echo \\"$json\\" | jq -r .result[22m
[2m  exit 0",[22m
[32m-     "create-genesis.sh": "#!/bin/bash[39m
[31m+     "create-ics.sh": "#!/bin/bash[39m
[31m+[39m
[31m+ set -euxo pipefail[39m
[31m+[39m
[31m+ DENOM=\\"\${DENOM:=uatom}\\"[39m
[31m+ CHAIN_ID=\\"\${CHAIN_ID:=cosmoshub-1}\\"[39m
[31m+ CHAIN_BIN=\\"\${CHAIN_BIN:=gaiad}\\"[39m
[31m+ NODE_URL=\\"\${NODE_URL:=http://0.0.0.0:26657}\\"[39m
[31m+ KEYS_CONFIG=\\"\${KEYS_CONFIG:=configs/keys.json}\\"[39m
[31m+[39m
[31m+ PROPOSAL_FILE=\\"\${PROPOSAL_FILE}\\"[39m
[31m+ KEY_NAME=\\"ics-setup\\"[39m
[31m+ MAX_RETRIES=3[39m
[31m+ RETRY_INTERVAL=30[39m
[31m+ SUBMIT_PROPOSAL_CMD=\\"\\"[39m
[31m+[39m
[31m+ add_key() {[39m
[31m+   # Add test keys to the keyring and self delegate initial coins[39m
[31m+   echo \\"Adding key....\\" $(jq -r \\".keys[0].name\\" $KEYS_CONFIG)[39m
[31m+   jq -r \\".keys[0].mnemonic\\" $KEYS_CONFIG | $CHAIN_BIN keys add $KEY_NAME --recover --keyring-backend=\\"test\\"[39m
[31m+   echo $($CHAIN_BIN keys show -a $KEY_NAME --keyring-backend=\\"test\\")[39m
[31m+ }[39m
[31m+[39m
[31m+ get_validator_address() {[39m
[31m+   echo \\"Getting validator address...\\"[39m
[31m+   VALIDATOR_ADDRESS=$($CHAIN_BIN q staking validators --node $NODE_URL --output json | jq -r '.validators[0].operator_address')[39m
[31m+   echo \\"Selected validator address: $VALIDATOR_ADDRESS\\"[39m
[31m+ }[39m
[31m+[39m
[31m+ stake_tokens() {[39m
[31m+   COINS=\\"10000000$DENOM\\"[39m
[31m+   echo \\"Staking tokens...\\"[39m
[31m+   $CHAIN_BIN tx staking delegate $VALIDATOR_ADDRESS $COINS \\\\[39m
[31m+     --from $KEY_NAME \\\\[39m
[31m+     --chain-id $CHAIN_ID \\\\[39m
[31m+     --node $NODE_URL \\\\[39m
[31m+     --keyring-backend=\\"test\\" \\\\[39m
[31m+     --gas auto --gas-adjustment 2 \\\\[39m
[31m+     --output json \\\\[39m
[31m+     --yes[39m
[31m+   sleep 5[39m
[31m+ }[39m
[31m+[39m
[31m+ determine_proposal_command() {[39m
[31m+   echo \\"Determining the correct command to submit proposals...\\"[39m
[31m+   HELP_OUTPUT=$($CHAIN_BIN tx gov --help)[39m
[31m+   if echo \\"$HELP_OUTPUT\\" | grep -q \\"submit-legacy-proposal\\"; then[39m
[31m+     SUBMIT_PROPOSAL_CMD=\\"submit-legacy-proposal\\"[39m
[31m+   else[39m
[31m+     SUBMIT_PROPOSAL_CMD=\\"submit-proposal\\"[39m
[31m+   fi[39m
[31m+   echo \\"Using $SUBMIT_PROPOSAL_CMD for submitting proposals.\\"[39m
[31m+ }[39m
[31m+[39m
[31m+ submit_proposal() {[39m
[31m+   echo \\"Get all proposals\\"[39m
[31m+   PROPOSALS_OUTPUT=$($CHAIN_BIN query gov proposals --output json --node $NODE_URL 2>&1 || true)[39m
[31m+   if echo \\"$PROPOSALS_OUTPUT\\" | grep -q \\"no proposals found\\"; then[39m
[31m+     echo \\"No existing proposals found. Proceeding to submit a new proposal.\\"[39m
[31m+   else[39m
[31m+     echo \\"Existing proposals: $PROPOSALS_OUTPUT\\"[39m
[31m+   fi[39m
[31m+[39m
[31m+   echo \\"Submit gov proposal on chain\\"[39m
[31m+   PROPOSAL_TX=$($CHAIN_BIN tx gov $SUBMIT_PROPOSAL_CMD consumer-addition $PROPOSAL_FILE \\\\[39m
[31m+     --from $KEY_NAME \\\\[39m
[31m+     --chain-id $CHAIN_ID \\\\[39m
[31m+     --node $NODE_URL \\\\[39m
[31m+     --keyring-backend=\\"test\\" \\\\[39m
[31m+     --gas auto --gas-adjustment 2 \\\\[39m
[31m+     --output json \\\\[39m
[31m+     --yes)[39m
[31m+   echo $PROPOSAL_TX[39m
[31m+[39m
[31m+   # Extract JSON part from the output[39m
[31m+   TX_HASH=$(echo \\"$PROPOSAL_TX\\" | grep -o '{.*}' | jq -r '.txhash')[39m
[31m+   if [ -n \\"$TX_HASH\\" ]; then[39m
[31m+     echo \\"Transaction hash: $TX_HASH\\"[39m
[31m+   else[39m
[31m+     echo \\"Failed to submit proposal. Output was not as expected.\\"[39m
[31m+     exit 1[39m
[31m+   fi[39m
[31m+[39m
[31m+   sleep 5[39m
[31m+ }[39m
[31m+[39m
[31m+ get_proposal_id() {[39m
[31m+   echo \\"Getting proposal ID\\"[39m
[31m+   PROPOSAL_QUERY=$(gaiad query tx $TX_HASH --node $NODE_URL --output json)[39m
[31m+   LOGS=$(echo $PROPOSAL_QUERY | jq -r '.logs')[39m
[31m+   if [ \\"$LOGS\\" != \\"null\\" ] && [ \\"$LOGS\\" != \\"[]\\" ]; then[39m
[31m+     PROPOSAL_ID=$(echo $PROPOSAL_QUERY | jq -r '.logs[0].events[] | select(.type==\\"submit_proposal\\").attributes[] | select(.key==\\"proposal_id\\").value')[39m
[31m+     if [ -n \\"$PROPOSAL_ID\\" ]; then[39m
[31m+       echo \\"Proposal ID: $PROPOSAL_ID\\"[39m
[31m+       return 0[39m
[31m+     fi[39m
[31m+   fi[39m
[31m+   echo \\"Failed to retrieve proposal ID from transaction logs. Logs might be empty.\\"[39m
[31m+   exit 1[39m
[31m+ }[39m
[31m+[39m
[31m+ vote_proposal() {[39m
[31m+   echo \\"Voting on proposal\\"[39m
[31m+   $CHAIN_BIN tx gov vote $PROPOSAL_ID yes \\\\[39m
[31m+     --from $KEY_NAME \\\\[39m
[31m+     --chain-id $CHAIN_ID \\\\[39m
[31m+     --node $NODE_URL \\\\[39m
[31m+     --keyring-backend=\\"test\\" \\\\[39m
[31m+     --gas auto --gas-adjustment 2 \\\\[39m
[31m+     --output json \\\\[39m
[31m+     --yes[39m
[31m+   sleep 5[39m
[31m+ }[39m
[31m+[39m
[31m+ wait_for_proposal_to_pass() {[39m
[31m+   echo \\"Waiting for proposal to pass\\"[39m
[31m+   for ((i=1; i<=$MAX_RETRIES; i++)); do[39m
[31m+     STATUS=$($CHAIN_BIN query gov proposal $PROPOSAL_ID --node $NODE_URL --output json | jq -r '.status')[39m
[31m+     if [ \\"$STATUS\\" == \\"PROPOSAL_STATUS_PASSED\\" ]; then[39m
[31m+       echo \\"Proposal has passed!\\"[39m
[31m+       return 0[39m
[31m+     else[39m
[31m+       echo \\"Current status: $STATUS. Attempt $i/$MAX_RETRIES. Waiting...\\"[39m
[31m+       sleep $RETRY_INTERVAL[39m
[31m+     fi[39m
[31m+   done[39m
[31m+   echo \\"Proposal did not pass after $MAX_RETRIES attempts.\\"[39m
[31m+   exit 1[39m
[31m+ }[39m
[31m+[39m
[31m+ main() {[39m
[31m+   add_key[39m
[31m+   get_validator_address[39m
[31m+   stake_tokens[39m
[31m+   determine_proposal_command[39m
[31m+   submit_proposal[39m
[31m+   get_proposal_id[39m
[31m+   vote_proposal[39m
[31m+   wait_for_proposal_to_pass[39m
[31m+ }[39m
[31m+[39m
[31m+ main",[39m
[31m+     "create-validator.sh": "#!/bin/bash[39m
[31m+[39m
[31m+ DENOM=\\"\${DENOM:=uosmo}\\"[39m
[31m+ CHAIN_BIN=\\"\${CHAIN_BIN:=osmosisd}\\"[39m
[31m+ CHAIN_DIR=\\"\${CHAIN_DIR:=$HOME/.osmosisd}\\"[39m
[31m+ KEYS_CONFIG=\\"\${KEYS_CONFIG:=configs/keys.json}\\"[39m
[31m+ VAL_NAME=\\"\${VAL_NAME:=osmosis}\\"[39m
[31m+ NODE_URL=\\"\${NODE_URL:=http://0.0.0.0:26657}\\"[39m
[31m+ NODE_ARGS=\\"\${NODE_ARGS}\\"[39m
[31m+ GAS=\\"\${GAS:=auto}\\"[39m
[31m+[39m
[31m+ set -eux[39m
[31m+[39m
[31m+ # Wait for the node to be synced[39m
[31m+ max_tries=10[39m
[31m+ while [[ $($CHAIN_BIN status --output json --node $NODE_URL 2>&1 | jq \\".SyncInfo.catching_up\\") == true ]][39m
[31m+ do[39m
[31m+   if [[ max_tries -lt 0 ]]; then echo \\"Not able to sync with genesis node\\"; exit 1; fi[39m
[31m+   echo \\"Still syncing... Sleeping for 15 secs. Tries left $max_tries\\"[39m
[31m+   ((max_tries--))[39m
[31m+   sleep 30[39m
[31m+ done[39m
[31m+[39m
[31m+ # Function to compare version numbers[39m
[31m+ version_compare() {[39m
[31m+     version1=\\"$1\\"[39m
[31m+     version2=\\"$2\\"[39m
[31m+     if [[ \\"$(printf '%s\\\\n' \\"$version1\\" \\"$version2\\" | sort -V | head -n 1)\\" == \\"$version1\\" ]]; then[39m
[31m+         return 1 # version1 is greater[39m
[31m+     else[39m
[31m+         return 0 # version2 is greater or equal[39m
[31m+     fi[39m
[31m+ }[39m
[31m+[39m
[31m+ # Check if cosmos_sdk_version is greater than a specified version[39m
[31m+ is_greater() {[39m
[31m+     version_compare \\"$1\\" \\"$2\\"[39m
[31m+     return $?[39m
[31m+ }[39m
[31m+[39m
[31m+ function cosmos-sdk-version-v50() {[39m
[31m+   # Content for the validator.json file[39m
[31m+   json_content='{[39m
[31m+     \\"pubkey\\": '$($CHAIN_BIN tendermint show-validator $NODE_ARGS)'[39m
[31m+     \\"amount\\": \\"5000000000'$DENOM'\\"[39m
[31m+     \\"moniker\\": \\"'$VAL_NAME'\\"[39m
[31m+     \\"commission-rate\\": \\"0.1\\"[39m
[31m+     \\"commission-max-rate\\": \\"0.2\\"[39m
[31m+     \\"commission-max-change-rate\\": \\"0.01\\"[39m
[31m+     \\"min-self-delegation\\": \\"1000000\\"[39m
[31m+   }'[39m
[31m+   echo \\"$json_content\\" > /validator.json[39m
[31m+   cat /validator.json[39m
[31m+[39m
[31m+   # Run create validator tx command[39m
[31m+   echo \\"Running txn for create-validator\\"[39m
[31m+   $CHAIN_BIN tx staking create-validator /validator.json \\\\[39m
[31m+     --node $NODE_URL \\\\[39m
[31m+     --chain-id $CHAIN_ID \\\\[39m
[31m+     --from $VAL_NAME \\\\[39m
[31m+     --fees 100000$DENOM \\\\[39m
[31m+     --keyring-backend=\\"test\\" \\\\[39m
[31m+     --output json \\\\[39m
[31m+     --gas $GAS \\\\[39m
[31m+     --gas-adjustment 1.5 $NODE_ARGS --yes > /validator.log[39m
[31m+[39m
[31m+   cat /validator.log | jq[39m
[31m+ }[39m
[31m+[39m
[31m+ function cosmos-sdk-version-default() {[39m
[31m+   # Run create validator tx command[39m
[31m+   echo \\"Running txn for create-validator\\"[39m
[31m+   args=''[39m
[31m+   if [[ $($CHAIN_BIN tx staking create-validator --help | grep -c \\"min-self-delegation\\") -gt 0 ]];[39m
[31m+   then[39m
[31m+     args+='--min-self-delegation=1000000'[39m
[31m+   fi[39m
[31m+   $CHAIN_BIN keys list --keyring-backend test --output json --home $CHAIN_DIR | jq[39m
[31m+   $CHAIN_BIN tx staking create-validator \\\\[39m
[31m+     --node $NODE_URL \\\\[39m
[31m+     --pubkey=$($CHAIN_BIN tendermint show-validator $NODE_ARGS) \\\\[39m
[31m+     --moniker $VAL_NAME \\\\[39m
[31m+     --amount 5000000000$DENOM \\\\[39m
[31m+     --chain-id $CHAIN_ID \\\\[39m
[31m+     --from $VAL_NAME \\\\[39m
[31m+     --commission-rate=\\"0.10\\" \\\\[39m
[31m+     --commission-max-rate=\\"0.20\\" \\\\[39m
[31m+     --commission-max-change-rate=\\"0.01\\" \\\\[39m
[31m+     --keyring-backend test \\\\[39m
[31m+     --home $CHAIN_DIR \\\\[39m
[31m+     --fees 100000$DENOM \\\\[39m
[31m+     --gas $GAS \\\\[39m
[31m+     --output json \\\\[39m
[31m+     --gas-adjustment 1.5 $args $NODE_ARGS --yes > /validator.log[39m

[31m+   cat /validator.log | jq[39m
[31m+ }[39m
[31m+[39m
[31m+ set +e[39m
[31m+ # Fetch the cosmos-sdk version to be able to perform the create-validator tx[39m
[31m+ cosmos_sdk_version=$($CHAIN_BIN version --long | sed -n 's/cosmos_sdk_version: \\\\(.*\\\\)/\\\\1/p')[39m
[31m+ echo \\"cosmos_sdk_version: $cosmos_sdk_version\\"[39m
[31m+ set -e[39m
[31m+[39m
[31m+ if is_greater \\"$cosmos_sdk_version\\" \\"v0.50.0\\"; then[39m
[31m+   echo \\"cosmos_sdk_version is greater than v0.50.0, running create-validator tx with new format\\"[39m
[31m+   cosmos-sdk-version-v50[39m
[31m+ else[39m
[31m+   echo \\"cosmos_sdk_version is less than v0.50.0, running create-validator tx with old format\\"[39m
[31m+   cosmos-sdk-version-default[39m
[31m+ fi",[39m
[31m+     "createGenesis.sh": "#!/bin/bash[39m
[31m+[39m
[2m  DENOM=\\"\${DENOM:=untrn}\\"[22m
[2m  STAKEDENOM=\${DENOM:-untrn}[22m
[2m  COINS=\\"\${COINS:=100000000000000000untrn}\\"[22m
[33m@@ -898,259 +1151,6 @@[39m
[2m  fi[22m

[2m  echo \\"DAO $DAO_CONTRACT_ADDRESS\\"",[22m
[32m-     "create-ics.sh": "#!/bin/bash[39m
[32m-[39m
[32m- set -euxo pipefail[39m
[32m-[39m
[32m- DENOM=\\"\${DENOM:=uatom}\\"[39m
[32m- CHAIN_ID=\\"\${CHAIN_ID:=cosmoshub-1}\\"[39m
[32m- CHAIN_BIN=\\"\${CHAIN_BIN:=gaiad}\\"[39m
[32m- NODE_URL=\\"\${NODE_URL:=http://0.0.0.0:26657}\\"[39m
[32m- KEYS_CONFIG=\\"\${KEYS_CONFIG:=configs/keys.json}\\"[39m
[32m-[39m
[32m- PROPOSAL_FILE=\\"\${PROPOSAL_FILE}\\"[39m
[32m- KEY_NAME=\\"ics-setup\\"[39m
[32m- MAX_RETRIES=3[39m
[32m- RETRY_INTERVAL=30[39m
[32m- SUBMIT_PROPOSAL_CMD=\\"\\"[39m
[32m-[39m
[32m- add_key() {[39m
[32m-   # Add test keys to the keyring and self delegate initial coins[39m
[32m-   echo \\"Adding key....\\" $(jq -r \\".keys[0].name\\" $KEYS_CONFIG)[39m
[32m-   jq -r \\".keys[0].mnemonic\\" $KEYS_CONFIG | $CHAIN_BIN keys add $KEY_NAME --recover --keyring-backend=\\"test\\"[39m
[32m-   echo $($CHAIN_BIN keys show -a $KEY_NAME --keyring-backend=\\"test\\")[39m
[32m- }[39m
[32m-[39m
[32m- get_validator_address() {[39m
[32m-   echo \\"Getting validator address...\\"[39m
[32m-   VALIDATOR_ADDRESS=$($CHAIN_BIN q staking validators --node $NODE_URL --output json | jq -r '.validators[0].operator_address')[39m
[32m-   echo \\"Selected validator address: $VALIDATOR_ADDRESS\\"[39m
[32m- }[39m
[32m-[39m
[32m- stake_tokens() {[39m
[32m-   COINS=\\"10000000$DENOM\\"[39m
[32m-   echo \\"Staking tokens...\\"[39m
[32m-   $CHAIN_BIN tx staking delegate $VALIDATOR_ADDRESS $COINS \\\\[39m
[32m-     --from $KEY_NAME \\\\[39m
[32m-     --chain-id $CHAIN_ID \\\\[39m
[32m-     --node $NODE_URL \\\\[39m
[32m-     --keyring-backend=\\"test\\" \\\\[39m
[32m-     --gas auto --gas-adjustment 2 \\\\[39m
[32m-     --output json \\\\[39m
[32m-     --yes[39m
[32m-   sleep 5[39m
[32m- }[39m
[32m-[39m
[32m- determine_proposal_command() {[39m
[32m-   echo \\"Determining the correct command to submit proposals...\\"[39m
[32m-   HELP_OUTPUT=$($CHAIN_BIN tx gov --help)[39m
[32m-   if echo \\"$HELP_OUTPUT\\" | grep -q \\"submit-legacy-proposal\\"; then[39m
[32m-     SUBMIT_PROPOSAL_CMD=\\"submit-legacy-proposal\\"[39m
[32m-   else[39m
[32m-     SUBMIT_PROPOSAL_CMD=\\"submit-proposal\\"[39m
[32m-   fi[39m
[32m-   echo \\"Using $SUBMIT_PROPOSAL_CMD for submitting proposals.\\"[39m
[32m- }[39m
[32m-[39m
[32m- submit_proposal() {[39m
[32m-   echo \\"Get all proposals\\"[39m
[32m-   PROPOSALS_OUTPUT=$($CHAIN_BIN query gov proposals --output json --node $NODE_URL 2>&1 || true)[39m
[32m-   if echo \\"$PROPOSALS_OUTPUT\\" | grep -q \\"no proposals found\\"; then[39m
[32m-     echo \\"No existing proposals found. Proceeding to submit a new proposal.\\"[39m
[32m-   else[39m
[32m-     echo \\"Existing proposals: $PROPOSALS_OUTPUT\\"[39m
[32m-   fi[39m
[32m-[39m
[32m-   echo \\"Submit gov proposal on chain\\"[39m
[32m-   PROPOSAL_TX=$($CHAIN_BIN tx gov $SUBMIT_PROPOSAL_CMD consumer-addition $PROPOSAL_FILE \\\\[39m
[32m-     --from $KEY_NAME \\\\[39m
[32m-     --chain-id $CHAIN_ID \\\\[39m
[32m-     --node $NODE_URL \\\\[39m
[32m-     --keyring-backend=\\"test\\" \\\\[39m
[32m-     --gas auto --gas-adjustment 2 \\\\[39m
[32m-     --output json \\\\[39m
[32m-     --yes)[39m
[32m-   echo $PROPOSAL_TX[39m
[32m-[39m
[32m-   # Extract JSON part from the output[39m
[32m-   TX_HASH=$(echo \\"$PROPOSAL_TX\\" | grep -o '{.*}' | jq -r '.txhash')[39m
[32m-   if [ -n \\"$TX_HASH\\" ]; then[39m
[32m-     echo \\"Transaction hash: $TX_HASH\\"[39m
[32m-   else[39m
[32m-     echo \\"Failed to submit proposal. Output was not as expected.\\"[39m
[32m-     exit 1[39m
[32m-   fi[39m
[32m-[39m
[32m-   sleep 5[39m
[32m- }[39m
[32m-[39m
[32m- get_proposal_id() {[39m
[32m-   echo \\"Getting proposal ID\\"[39m
[32m-   PROPOSAL_QUERY=$(gaiad query tx $TX_HASH --node $NODE_URL --output json)[39m
[32m-   LOGS=$(echo $PROPOSAL_QUERY | jq -r '.logs')[39m
[32m-   if [ \\"$LOGS\\" != \\"null\\" ] && [ \\"$LOGS\\" != \\"[]\\" ]; then[39m
[32m-     PROPOSAL_ID=$(echo $PROPOSAL_QUERY | jq -r '.logs[0].events[] | select(.type==\\"submit_proposal\\").attributes[] | select(.key==\\"proposal_id\\").value')[39m
[32m-     if [ -n \\"$PROPOSAL_ID\\" ]; then[39m
[32m-       echo \\"Proposal ID: $PROPOSAL_ID\\"[39m
[32m-       return 0[39m
[32m-     fi[39m
[32m-   fi[39m
[32m-   echo \\"Failed to retrieve proposal ID from transaction logs. Logs might be empty.\\"[39m
[32m-   exit 1[39m
[32m- }[39m
[32m-[39m
[32m- vote_proposal() {[39m
[32m-   echo \\"Voting on proposal\\"[39m
[32m-   $CHAIN_BIN tx gov vote $PROPOSAL_ID yes \\\\[39m
[32m-     --from $KEY_NAME \\\\[39m
[32m-     --chain-id $CHAIN_ID \\\\[39m
[32m-     --node $NODE_URL \\\\[39m
[32m-     --keyring-backend=\\"test\\" \\\\[39m
[32m-     --gas auto --gas-adjustment 2 \\\\[39m
[32m-     --output json \\\\[39m
[32m-     --yes[39m
[32m-   sleep 5[39m
[32m- }[39m
[32m-[39m
[32m- wait_for_proposal_to_pass() {[39m
[32m-   echo \\"Waiting for proposal to pass\\"[39m
[32m-   for ((i=1; i<=$MAX_RETRIES; i++)); do[39m
[32m-     STATUS=$($CHAIN_BIN query gov proposal $PROPOSAL_ID --node $NODE_URL --output json | jq -r '.status')[39m
[32m-     if [ \\"$STATUS\\" == \\"PROPOSAL_STATUS_PASSED\\" ]; then[39m
[32m-       echo \\"Proposal has passed!\\"[39m
[32m-       return 0[39m
[32m-     else[39m
[32m-       echo \\"Current status: $STATUS. Attempt $i/$MAX_RETRIES. Waiting...\\"[39m
[32m-       sleep $RETRY_INTERVAL[39m
[32m-     fi[39m
[32m-   done[39m
[32m-   echo \\"Proposal did not pass after $MAX_RETRIES attempts.\\"[39m
[32m-   exit 1[39m
[32m- }[39m
[32m-[39m
[32m- main() {[39m
[32m-   add_key[39m
[32m-   get_validator_address[39m
[32m-   stake_tokens[39m
[32m-   determine_proposal_command[39m
[32m-   submit_proposal[39m
[32m-   get_proposal_id[39m
[32m-   vote_proposal[39m
[32m-   wait_for_proposal_to_pass[39m
[32m- }[39m
[32m-[39m
[32m- main",[39m
[32m-     "create-validator.sh": "#!/bin/bash[39m
[32m-[39m
[32m- DENOM=\\"\${DENOM:=uosmo}\\"[39m
[32m- CHAIN_BIN=\\"\${CHAIN_BIN:=osmosisd}\\"[39m
[32m- CHAIN_DIR=\\"\${CHAIN_DIR:=$HOME/.osmosisd}\\"[39m
[32m- KEYS_CONFIG=\\"\${KEYS_CONFIG:=configs/keys.json}\\"[39m
[32m- VAL_NAME=\\"\${VAL_NAME:=osmosis}\\"[39m
[32m- NODE_URL=\\"\${NODE_URL:=http://0.0.0.0:26657}\\"[39m
[32m- NODE_ARGS=\\"\${NODE_ARGS}\\"[39m
[32m- GAS=\\"\${GAS:=auto}\\"[39m
[32m-[39m
[32m- set -eux[39m
[32m-[39m
[32m- # Wait for the node to be synced[39m
[32m- max_tries=10[39m
[32m- while [[ $($CHAIN_BIN status --output json --node $NODE_URL 2>&1 | jq \\".SyncInfo.catching_up\\") == true ]][39m
[32m- do[39m
[32m-   if [[ max_tries -lt 0 ]]; then echo \\"Not able to sync with genesis node\\"; exit 1; fi[39m
[32m-   echo \\"Still syncing... Sleeping for 15 secs. Tries left $max_tries\\"[39m
[32m-   ((max_tries--))[39m
[32m-   sleep 30[39m
[32m- done[39m
[32m-[39m
[32m- # Function to compare version numbers[39m
[32m- version_compare() {[39m
[32m-     version1=\\"$1\\"[39m
[32m-     version2=\\"$2\\"[39m
[32m-     if [[ \\"$(printf '%s\\\\n' \\"$version1\\" \\"$version2\\" | sort -V | head -n 1)\\" == \\"$version1\\" ]]; then[39m
[32m-         return 1 # version1 is greater[39m
[32m-     else[39m
[32m-         return 0 # version2 is greater or equal[39m
[32m-     fi[39m
[32m- }[39m
[32m-[39m
[32m- # Check if cosmos_sdk_version is greater than a specified version[39m
[32m- is_greater() {[39m
[32m-     version_compare \\"$1\\" \\"$2\\"[39m
[32m-     return $?[39m
[32m- }[39m
[32m-[39m
[32m- function cosmos-sdk-version-v50() {[39m
[32m-   # Content for the validator.json file[39m
[32m-   json_content='{[39m
[32m-     \\"pubkey\\": '$($CHAIN_BIN tendermint show-validator $NODE_ARGS)'[39m
[32m-     \\"amount\\": \\"5000000000'$DENOM'\\"[39m
[32m-     \\"moniker\\": \\"'$VAL_NAME'\\"[39m
[32m-     \\"commission-rate\\": \\"0.1\\"[39m
[32m-     \\"commission-max-rate\\": \\"0.2\\"[39m
[32m-     \\"commission-max-change-rate\\": \\"0.01\\"[39m
[32m-     \\"min-self-delegation\\": \\"1000000\\"[39m
[32m-   }'[39m
[32m-   echo \\"$json_content\\" > /validator.json[39m
[32m-   cat /validator.json[39m
[32m-[39m
[32m-   # Run create validator tx command[39m
[32m-   echo \\"Running txn for create-validator\\"[39m
[32m-   $CHAIN_BIN tx staking create-validator /validator.json \\\\[39m
[32m-     --node $NODE_URL \\\\[39m
[32m-     --chain-id $CHAIN_ID \\\\[39m
[32m-     --from $VAL_NAME \\\\[39m
[32m-     --fees 100000$DENOM \\\\[39m
[32m-     --keyring-backend=\\"test\\" \\\\[39m
[32m-     --output json \\\\[39m
[32m-     --gas $GAS \\\\[39m
[32m-     --gas-adjustment 1.5 $NODE_ARGS --yes > /validator.log[39m
[32m-[39m
[32m-   cat /validator.log | jq[39m
[32m- }[39m
[32m-[39m
[32m- function cosmos-sdk-version-default() {[39m
[32m-   # Run create validator tx command[39m
[32m-   echo \\"Running txn for create-validator\\"[39m
[32m-   args=''[39m
[32m-   if [[ $($CHAIN_BIN tx staking create-validator --help | grep -c \\"min-self-delegation\\") -gt 0 ]];[39m
[32m-   then[39m
[32m-     args+='--min-self-delegation=1000000'[39m
[32m-   fi[39m
[32m-   $CHAIN_BIN keys list --keyring-backend test --output json --home $CHAIN_DIR | jq[39m
[32m-   $CHAIN_BIN tx staking create-validator \\\\[39m
[32m-     --node $NODE_URL \\\\[39m
[32m-     --pubkey=$($CHAIN_BIN tendermint show-validator $NODE_ARGS) \\\\[39m
[32m-     --moniker $VAL_NAME \\\\[39m
[32m-     --amount 5000000000$DENOM \\\\[39m
[32m-     --chain-id $CHAIN_ID \\\\[39m
[32m-     --from $VAL_NAME \\\\[39m
[32m-     --commission-rate=\\"0.10\\" \\\\[39m
[32m-     --commission-max-rate=\\"0.20\\" \\\\[39m
[32m-     --commission-max-change-rate=\\"0.01\\" \\\\[39m
[32m-     --keyring-backend test \\\\[39m
[32m-     --home $CHAIN_DIR \\\\[39m
[32m-     --fees 100000$DENOM \\\\[39m
[32m-     --gas $GAS \\\\[39m
[32m-     --output json \\\\[39m
[32m-     --gas-adjustment 1.5 $args $NODE_ARGS --yes > /validator.log[39m
[32m-[39m
[32m-   cat /validator.log | jq[39m
[32m- }[39m
[32m-[39m
[32m- set +e[39m
[32m- # Fetch the cosmos-sdk version to be able to perform the create-validator tx[39m
[32m- cosmos_sdk_version=$($CHAIN_BIN version --long | sed -n 's/cosmos_sdk_version: \\\\(.*\\\\)/\\\\1/p')[39m
[32m- echo \\"cosmos_sdk_version: $cosmos_sdk_version\\"[39m
[32m- set -e[39m
[32m-[39m
[32m- if is_greater \\"$cosmos_sdk_version\\" \\"v0.50.0\\"; then[39m
[32m-   echo \\"cosmos_sdk_version is greater than v0.50.0, running create-validator tx with new format\\"[39m
[32m-   cosmos-sdk-version-v50[39m
[32m- else[39m
[32m-   echo \\"cosmos_sdk_version is less than v0.50.0, running create-validator tx with old format\\"[39m
[32m-   cosmos-sdk-version-default[39m
[32m- fi",[39m
[2m      "ibc-connection.sh": "#!/bin/bash[22m

[2m  REGISTRY_URL=\\"$1\\"[22m
[33m@@ -1213,7 +1213,7 @@[39m
[2m    ((max_tries--))[22m
[2m    sleep 2[22m
[2m  done",[22m
[32m-     "update-config.sh": "#!/bin/bash[39m
[31m+     "updateConfig.sh": "#!/bin/bash[39m

[2m  STAKEDENOM=\${DENOM:-untrn}[22m
[2m  CHAIN_ID=\\"\${CHAIN_ID:=osmosis}\\"[22m
[33m@@ -1250,7 +1250,7 @@[39m
[2m  sed -i -e 's#keyring-backend = \\"os\\"#keyring-backend = \\"test\\"#g' $CHAIN_DIR/config/client.toml[22m
[2m  sed -i -e 's#output = \\"text\\"#output = \\"json\\"#g' $CHAIN_DIR/config/client.toml[22m
[2m  sed -i -e \\"s#chain-id = \\\\\\"\\\\\\"#chain-id = \\\\\\"$CHAIN_ID\\\\\\"#g\\" $CHAIN_DIR/config/client.toml",[22m
[32m-     "update-genesis.sh": "#!/bin/bash[39m
[31m+     "updateGenesis.sh": "#!/bin/bash[39m

[2m  DENOM=\\"\${DENOM:=uosmo}\\"[22m
[2m  CHAIN_BIN=\\"\${CHAIN_BIN:=osmosisd}\\"[22m
[33m@@ -1264,6 +1264,17 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts-neutron-1",[39m
[31m+       "app.kubernetes.io/part-of": "neutron-1",[39m
[31m+       "app.kubernetes.io/role": "setup-scripts",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-id": "neutron-1",[39m
[31m+       "starship.io/chain-name": "neutron",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts-neutron-1",[22m
[2m    },[22m
[2m  }[22m

--- ConfigMap/registry-cosmoshub-4 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -7,7 +7,14 @@[39m
[2m    \\"assets\\": [[22m
[2m      {[22m
[2m        \\"base\\": \\"uatom\\",[22m
[32m-       \\"coingecko_id\\": \\"atom\\",[39m
[31m+       \\"description\\": \\"The native staking and governance token of the Cosmos Hub.\\",[39m
[31m+       \\"name\\": \\"Cosmos Hub Atom\\",[39m
[31m+       \\"display\\": \\"atom\\",[39m
[31m+       \\"symbol\\": \\"ATOM\\",[39m
[31m+       \\"logo_URIs\\": {[39m
[31m+         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/cosmoshub/images/atom.png\\",[39m
[31m+         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/cosmoshub/images/atom.svg\\"[39m
[31m+       },[39m
[2m        \\"denom_units\\": [[22m
[2m          {[22m
[2m            \\"denom\\": \\"uatom\\",[22m
[33m@@ -18,14 +25,7 @@[39m
[2m            \\"exponent\\": 6[22m
[2m          }[22m
[2m        ],[22m
[32m-       \\"description\\": \\"The native staking and governance token of the Cosmos Hub.\\",[39m
[32m-       \\"display\\": \\"atom\\",[39m
[32m-       \\"logo_URIs\\": {[39m
[32m-         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/cosmoshub/images/atom.png\\",[39m
[32m-         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/cosmoshub/images/atom.svg\\"[39m
[32m-       },[39m
[32m-       \\"name\\": \\"Cosmos Hub Atom\\",[39m
[32m-       \\"symbol\\": \\"ATOM\\"[39m
[31m+       \\"coingecko_id\\": \\"atom\\"[39m
[2m      }[22m
[2m    ][22m
[2m  }",[22m
[33m@@ -82,6 +82,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "registry",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "registry-cosmoshub-4",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "registry-cosmoshub-4",[22m
[2m    },[22m
[2m  }[22m

--- Deployment/registry ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,14 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "Deployment",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "registry",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "registry",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "registry",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +17,6 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "registry",[39m
[2m          "app.kubernetes.io/name": "registry",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -22,19 +29,17 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "registry",[39m
[31m+           "app.kubernetes.io/component": "registry",[39m
[31m+           "app.kubernetes.io/managed-by": "starship",[39m
[2m            "app.kubernetes.io/name": "registry",[22m
[32m-           "app.kubernetes.io/rawname": "registry",[39m
[32m-           "app.kubernetes.io/type": "registry",[39m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/part-of": "starship",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+           "starship.io/name": "starship-e2e-tests",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[2m          "containers": Array [[22m
[2m            Object {[22m
[32m-             "command": Array [[39m
[32m-               "registry",[39m
[32m-             ],[39m
[2m              "env": Array [[22m
[2m                Object {[22m
[2m                  "name": "NAMESPACE",[22m
[33m@@ -74,21 +79,20 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "REGISTRY_CHAIN_REGISTRY",[22m
[32m-                 "value": "/configs",[39m
[31m+                 "value": "/chains",[39m
[2m                },[22m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/registry:20250205-544757d",[22m
[32m-             "imagePullPolicy": "IfNotPresent",[39m
[2m              "livenessProbe": Object {[22m
[32m-               "initialDelaySeconds": 20,[39m
[32m-               "periodSeconds": 10,[39m
[31m+               "initialDelaySeconds": 15,[39m
[31m+               "periodSeconds": 20,[39m
[2m                "tcpSocket": Object {[22m
[2m                  "port": 8080,[22m
[2m                },[22m
[2m              },[22m
[2m              "name": "registry",[22m
[2m              "readinessProbe": Object {[22m
[32m-               "initialDelaySeconds": 20,[39m
[31m+               "initialDelaySeconds": 5,[39m
[2m                "periodSeconds": 10,[22m
[2m                "tcpSocket": Object {[22m
[2m                  "port": 8080,[22m
[33m@@ -96,22 +100,22 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[2m                Object {[22m
[32m-                 "mountPath": "/configs/cosmoshub-4",[39m
[32m-                 "name": "registry-configs-cosmoshub-4",[39m
[31m+                 "mountPath": "/chains/cosmoshub-4",[39m
[31m+                 "name": "registry-cosmoshub-4",[39m
[2m                },[22m
[2m                Object {[22m
[32m-                 "mountPath": "/configs/neutron-1",[39m
[32m-                 "name": "registry-configs-neutron-1",[39m
[31m+                 "mountPath": "/chains/neutron-1",[39m
[31m+                 "name": "registry-neutron-1",[39m
[2m                },[22m
[2m              ],[22m
[2m            },[22m
[33m@@ -126,6 +130,7 @@[39m
[2m    echo \\"Checking: http://neutron-1-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id\\"[22m
[2m    sleep 10;[22m
[2m  done[22m
[31m+[39m
[2m  while [ $(curl -sw '%{http_code}' http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id -o /dev/null) -ne 200 ]; do[22m
[2m    echo \\"Genesis validator does not seem to be ready for: cosmoshub-4. Waiting for it to start...\\"[22m
[2m    echo \\"Checking: http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id\\"[22m
[33m@@ -148,16 +153,16 @@[39m
[2m                  },[22m
[2m                },[22m
[2m              ],[22m
[32m-             "image": "curlimages/curl",[39m
[31m+             "image": "curlimages/curl:latest",[39m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "wait-for-chains",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -168,13 +173,13 @@[39m
[2m              "configMap": Object {[22m
[2m                "name": "registry-cosmoshub-4",[22m
[2m              },[22m
[32m-             "name": "registry-configs-cosmoshub-4",[39m
[31m+             "name": "registry-cosmoshub-4",[39m
[2m            },[22m
[2m            Object {[22m
[2m              "configMap": Object {[22m
[2m                "name": "registry-neutron-1",[22m
[2m              },[22m
[32m-             "name": "registry-configs-neutron-1",[39m
[31m+             "name": "registry-neutron-1",[39m
[2m            },[22m
[2m          ],[22m
[2m        },[22m

--- ConfigMap/registry-neutron-1 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -6,8 +6,7 @@[39m
[2m    \\"chain_name\\": \\"neutron\\",[22m
[2m    \\"assets\\": [[22m
[2m      {[22m
[32m-       \\"base\\": \\"untrn\\",[39m
[32m-       \\"coingecko_id\\": \\"neutron\\",[39m
[31m+       \\"description\\": \\"The native token of Neutron chain.\\",[39m
[2m        \\"denom_units\\": [[22m
[2m          {[22m
[2m            \\"denom\\": \\"untrn\\",[22m
[33m@@ -18,14 +17,15 @@[39m
[2m            \\"exponent\\": 6[22m
[2m          }[22m
[2m        ],[22m
[32m-       \\"description\\": \\"The native token of Neutron chain.\\",[39m
[31m+       \\"base\\": \\"untrn\\",[39m
[31m+       \\"name\\": \\"Neutron\\",[39m
[2m        \\"display\\": \\"ntrn\\",[22m
[31m+       \\"symbol\\": \\"NTRN\\",[39m
[2m        \\"logo_URIs\\": {[22m
[2m          \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/neutron/images/ntrn.png\\",[22m
[2m          \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/neutron/images/ntrn.svg\\"[22m
[2m        },[22m
[32m-       \\"name\\": \\"Neutron\\",[39m
[32m-       \\"symbol\\": \\"NTRN\\"[39m
[31m+       \\"coingecko_id\\": \\"neutron\\"[39m
[2m      }[22m
[2m    ][22m
[2m  }",[22m
[33m@@ -82,6 +82,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "registry",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "registry-neutron-1",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "registry-neutron-1",[22m
[2m    },[22m
[2m  }[22m

--- ConfigMap/hermes-neutron-cosmos ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -3,93 +3,45 @@[39m
[2m    "data": Object {[22m
[2m      "config-cli.toml": "# The global section has parameters that apply globally to the relayer operation.[22m
[2m  [global][22m
[32m- # Specify the verbosity for the relayer logging output. Default: 'info'[39m
[32m- # Valid options are 'error', 'warn', 'info', 'debug', 'trace'.[39m
[32m- log_level = 'info'[39m
[32m- # Specify the mode to be used by the relayer. [Required][39m
[31m+ log_level = \\"info\\"[39m
[31m+[39m
[2m  [mode][22m
[32m- # Specify the client mode.[39m
[2m  [mode.clients][22m
[32m- # Whether or not to enable the client workers. [Required][39m
[2m  enabled = true[22m
[32m- # Whether or not to enable periodic refresh of clients. [Default: true][39m
[32m- # This feature only applies to clients that underlie an open channel.[39m
[32m- # For Tendermint clients, the frequency at which Hermes refreshes them is 2/3 of their[39m
[32m- # trusting period (e.g., refresh every ~9 days if the trusting period is 14 days).[39m
[32m- # Note: Even if this is disabled, clients will be refreshed automatically if[39m
[32m- #      there is activity on a connection or channel they are involved with.[39m
[2m  refresh = true[22m
[32m- # Whether or not to enable misbehaviour detection for clients. [Default: false][39m
[2m  misbehaviour = true[22m
[32m- # Specify the connections mode.[39m
[31m+[39m
[2m  [mode.connections][22m
[32m- # Whether or not to enable the connection workers for handshake completion. [Required][39m
[2m  enabled = true[22m
[32m- # Specify the channels mode.[39m
[31m+[39m
[2m  [mode.channels][22m
[32m- # Whether or not to enable the channel workers for handshake completion. [Required][39m
[2m  enabled = true[22m
[32m- # Specify the packets mode.[39m
[31m+[39m
[2m  [mode.packets][22m
[32m- # Whether or not to enable the packet workers. [Required][39m
[2m  enabled = true[22m
[32m- # Parametrize the periodic packet clearing feature.[39m
[32m- # Interval (in number of blocks) at which pending packets[39m
[32m- # should be periodically cleared. A value of '0' will disable[39m
[32m- # periodic packet clearing. [Default: 100][39m
[2m  clear_interval = 100[22m
[32m- # Whether or not to clear packets on start. [Default: false][39m
[2m  clear_on_start = true[22m
[32m- # Toggle the transaction confirmation mechanism.[39m
[32m- # The tx confirmation mechanism periodically queries the \`/tx_search\` RPC[39m
[32m- # endpoint to check that previously-submitted transactions[39m
[32m- # (to any chain in this config file) have been successfully delivered.[39m
[32m- # If they have not been, and \`clear_interval = 0\`, then those packets are[39m
[32m- # queued up for re-submission.[39m
[32m- # Experimental feature. Affects telemetry if set to false.[39m
[32m- # [Default: true][39m
[2m  tx_confirmation = true[22m
[32m- # Auto register the counterparty payee on a destination chain to[39m
[32m- # the relayer's address on the source chain. This can be used[39m
[32m- # for simple configuration of the relayer to receive fees for[39m
[32m- # relaying RecvPacket on fee-enabled channels.[39m
[32m- # For more complex configuration, turn this off and use the CLI[39m
[32m- # to manually register the payee addresses.[39m
[32m- # [Default: false][39m
[32m- auto_register_counterparty_payee = false[39m
[32m- # The REST section defines parameters for Hermes' built-in RESTful API.[39m
[32m- # https://hermes.informal.systems/rest.html[39m
[31m+[39m
[2m  [rest][22m
[32m- # Whether or not to enable the REST service. Default: false[39m
[2m  enabled = true[22m
[32m- # Specify the IPv4/6 host over which the built-in HTTP server will serve the RESTful[39m
[32m- # API requests. Default: 127.0.0.1[39m
[32m- host =  '0.0.0.0'[39m
[32m- # Specify the port over which the built-in HTTP server will serve the restful API[39m
[32m- # requests. Default: 3000[39m
[31m+ host = \\"0.0.0.0\\"[39m
[2m  port = 3000[22m
[32m- # The telemetry section defines parameters for Hermes' built-in telemetry capabilities.[39m
[32m- # https://hermes.informal.systems/telemetry.html[39m
[31m+[39m
[2m  [telemetry][22m
[32m- # Whether or not to enable the telemetry service. Default: false[39m
[2m  enabled = true[22m
[32m- # Specify the IPv4/6 host over which the built-in HTTP server will serve the metrics[39m
[32m- # gathered by the telemetry service. Default: 127.0.0.1[39m
[32m- host = '0.0.0.0'[39m
[32m- # Specify the port over which the built-in HTTP server will serve the metrics gathered[39m
[32m- # by the telemetry service. Default: 3001[39m
[31m+ host = \\"0.0.0.0\\"[39m
[2m  port = 3001[22m
[32m-[39m


[2m  [[chains]][22m
[2m  id = \\"neutron-1\\"[22m
[31m+ type = \\"CosmosSdk\\"[39m
[2m  key_name = \\"neutron-1-cli\\"[22m
[2m  ccv_consumer_chain = true[22m
[32m- rpc_addr = \\"http://neutron-1-genesis.default.svc.cluster.local:26657\\"[39m
[32m- grpc_addr = \\"http://neutron-1-genesis.default.svc.cluster.local:9090\\"[39m
[32m- event_source = { mode = 'push', url = \\"ws://neutron-1-genesis.default.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[32m- # Experimental: Whether or not the full node is trusted.[39m
[31m+ rpc_addr = \\"http://neutron-1-genesis.$NAMESPACE.svc.cluster.local:26657\\"[39m
[31m+ grpc_addr = \\"http://neutron-1-genesis.$NAMESPACE.svc.cluster.local:9090\\"[39m
[31m+ event_source = { mode = 'push', url = \\"ws://neutron-1-genesis.$NAMESPACE.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[2m  trusted_node = false[22m
[2m  account_prefix = \\"neutron\\"[22m
[2m  default_gas = 500000000[22m
[33m@@ -104,17 +56,16 @@[39m
[2m  trusting_period = \\"75s\\"[22m
[2m  trust_threshold = { numerator = \\"2\\", denominator = \\"3\\" }[22m
[2m  address_type = { derivation = 'cosmos' }[22m
[32m- gas_price = { price = 0.25, denom = \\"untrn\\" }[39m
[32m-[39m
[32m-[39m
[31m+ gas_price = { price = 1.25, denom = \\"untrn\\" }[39m

[2m  [[chains]][22m
[2m  id = \\"cosmoshub-4\\"[22m
[31m+ type = \\"CosmosSdk\\"[39m
[2m  key_name = \\"cosmoshub-4-cli\\"[22m
[32m- rpc_addr = \\"http://cosmoshub-4-genesis.default.svc.cluster.local:26657\\"[39m
[32m- grpc_addr = \\"http://cosmoshub-4-genesis.default.svc.cluster.local:9090\\"[39m
[32m- event_source = { mode = 'push', url = \\"ws://cosmoshub-4-genesis.default.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[32m- # Experimental: Whether or not the full node is trusted.[39m
[31m+[39m
[31m+ rpc_addr = \\"http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:26657\\"[39m
[31m+ grpc_addr = \\"http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:9090\\"[39m
[31m+ event_source = { mode = 'push', url = \\"ws://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[2m  trusted_node = false[22m
[2m  account_prefix = \\"cosmos\\"[22m
[2m  default_gas = 500000000[22m
[33m@@ -129,86 +80,38 @@[39m
[2m  trusting_period = \\"75s\\"[22m
[2m  trust_threshold = { numerator = \\"2\\", denominator = \\"3\\" }[22m
[2m  address_type = { derivation = 'cosmos' }[22m
[32m- gas_price = { price = 0.25, denom = \\"uatom\\" }",[39m
[31m+ gas_price = { price = 1.25, denom = \\"uatom\\" }",[39m
[2m      "config.toml": "# The global section has parameters that apply globally to the relayer operation.[22m
[2m  [global][22m
[32m- # Specify the verbosity for the relayer logging output. Default: 'info'[39m
[32m- # Valid options are 'error', 'warn', 'info', 'debug', 'trace'.[39m
[32m- log_level = 'info'[39m
[32m- # Specify the mode to be used by the relayer. [Required][39m
[31m+ log_level = \\"info\\"[39m
[31m+[39m
[2m  [mode][22m
[32m- # Specify the client mode.[39m
[2m  [mode.clients][22m
[32m- # Whether or not to enable the client workers. [Required][39m
[2m  enabled = true[22m
[32m- # Whether or not to enable periodic refresh of clients. [Default: true][39m
[32m- # This feature only applies to clients that underlie an open channel.[39m
[32m- # For Tendermint clients, the frequency at which Hermes refreshes them is 2/3 of their[39m
[32m- # trusting period (e.g., refresh every ~9 days if the trusting period is 14 days).[39m
[32m- # Note: Even if this is disabled, clients will be refreshed automatically if[39m
[32m- #      there is activity on a connection or channel they are involved with.[39m
[2m  refresh = true[22m
[32m- # Whether or not to enable misbehaviour detection for clients. [Default: false][39m
[2m  misbehaviour = true[22m
[32m- # Specify the connections mode.[39m
[31m+[39m
[2m  [mode.connections][22m
[32m- # Whether or not to enable the connection workers for handshake completion. [Required][39m
[2m  enabled = true[22m
[32m- # Specify the channels mode.[39m
[31m+[39m
[2m  [mode.channels][22m
[32m- # Whether or not to enable the channel workers for handshake completion. [Required][39m
[2m  enabled = true[22m
[32m- # Specify the packets mode.[39m
[31m+[39m
[2m  [mode.packets][22m
[32m- # Whether or not to enable the packet workers. [Required][39m
[2m  enabled = true[22m
[32m- # Parametrize the periodic packet clearing feature.[39m
[32m- # Interval (in number of blocks) at which pending packets[39m
[32m- # should be periodically cleared. A value of '0' will disable[39m
[32m- # periodic packet clearing. [Default: 100][39m
[2m  clear_interval = 100[22m
[32m- # Whether or not to clear packets on start. [Default: false][39m
[2m  clear_on_start = true[22m
[32m- # Toggle the transaction confirmation mechanism.[39m
[32m- # The tx confirmation mechanism periodically queries the \`/tx_search\` RPC[39m
[32m- # endpoint to check that previously-submitted transactions[39m
[32m- # (to any chain in this config file) have been successfully delivered.[39m
[32m- # If they have not been, and \`clear_interval = 0\`, then those packets are[39m
[32m- # queued up for re-submission.[39m
[32m- # Experimental feature. Affects telemetry if set to false.[39m
[32m- # [Default: true][39m
[2m  tx_confirmation = true[22m
[32m- # Auto register the counterparty payee on a destination chain to[39m
[32m- # the relayer's address on the source chain. This can be used[39m
[32m- # for simple configuration of the relayer to receive fees for[39m
[32m- # relaying RecvPacket on fee-enabled channels.[39m
[32m- # For more complex configuration, turn this off and use the CLI[39m
[32m- # to manually register the payee addresses.[39m
[32m- # [Default: false][39m
[32m- auto_register_counterparty_payee = false[39m
[32m- # The REST section defines parameters for Hermes' built-in RESTful API.[39m
[32m- # https://hermes.informal.systems/rest.html[39m
[31m+[39m
[2m  [rest][22m
[32m- # Whether or not to enable the REST service. Default: false[39m
[2m  enabled = true[22m
[32m- # Specify the IPv4/6 host over which the built-in HTTP server will serve the RESTful[39m
[32m- # API requests. Default: 127.0.0.1[39m
[32m- host =  '0.0.0.0'[39m
[32m- # Specify the port over which the built-in HTTP server will serve the restful API[39m
[32m- # requests. Default: 3000[39m
[31m+ host = \\"0.0.0.0\\"[39m
[2m  port = 3000[22m
[32m- # The telemetry section defines parameters for Hermes' built-in telemetry capabilities.[39m
[32m- # https://hermes.informal.systems/telemetry.html[39m
[31m+[39m
[2m  [telemetry][22m
[32m- # Whether or not to enable the telemetry service. Default: false[39m
[2m  enabled = true[22m
[32m- # Specify the IPv4/6 host over which the built-in HTTP server will serve the metrics[39m
[32m- # gathered by the telemetry service. Default: 127.0.0.1[39m
[32m- host = '0.0.0.0'[39m
[32m- # Specify the port over which the built-in HTTP server will serve the metrics gathered[39m
[32m- # by the telemetry service. Default: 3001[39m
[31m+ host = \\"0.0.0.0\\"[39m
[2m  port = 3001[22m
[32m-[39m


[2m  [[chains]][22m
[33m@@ -216,10 +119,9 @@[39m
[2m  type = \\"CosmosSdk\\"[22m
[2m  key_name = \\"neutron-1\\"[22m
[2m  ccv_consumer_chain = true[22m
[32m- rpc_addr = \\"http://neutron-1-genesis.default.svc.cluster.local:26657\\"[39m
[32m- grpc_addr = \\"http://neutron-1-genesis.default.svc.cluster.local:9090\\"[39m
[32m- event_source = { mode = 'push', url = \\"ws://neutron-1-genesis.default.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[32m- # Experimental: Whether or not the full node is trusted.[39m
[31m+ rpc_addr = \\"http://neutron-1-genesis.$NAMESPACE.svc.cluster.local:26657\\"[39m
[31m+ grpc_addr = \\"http://neutron-1-genesis.$NAMESPACE.svc.cluster.local:9090\\"[39m
[31m+ event_source = { mode = 'push', url = \\"ws://neutron-1-genesis.$NAMESPACE.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[2m  trusted_node = false[22m
[2m  account_prefix = \\"neutron\\"[22m
[2m  default_gas = 500000000[22m
[33m@@ -236,16 +138,14 @@[39m
[2m  address_type = { derivation = 'cosmos' }[22m
[2m  gas_price = { price = 1.25, denom = \\"untrn\\" }[22m

[32m-[39m
[32m-[39m
[2m  [[chains]][22m
[2m  id = \\"cosmoshub-4\\"[22m
[2m  type = \\"CosmosSdk\\"[22m
[2m  key_name = \\"cosmoshub-4\\"[22m
[32m- rpc_addr = \\"http://cosmoshub-4-genesis.default.svc.cluster.local:26657\\"[39m
[32m- grpc_addr = \\"http://cosmoshub-4-genesis.default.svc.cluster.local:9090\\"[39m
[32m- event_source = { mode = 'push', url = \\"ws://cosmoshub-4-genesis.default.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[32m- # Experimental: Whether or not the full node is trusted.[39m
[31m+[39m
[31m+ rpc_addr = \\"http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:26657\\"[39m
[31m+ grpc_addr = \\"http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:9090\\"[39m
[31m+ event_source = { mode = 'push', url = \\"ws://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[2m  trusted_node = false[22m
[2m  account_prefix = \\"cosmos\\"[22m
[2m  default_gas = 500000000[22m
[33m@@ -264,6 +164,15 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "relayer",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "hermes-neutron-cosmos",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/role": "hermes",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "hermes-neutron-cosmos",[22m
[2m    },[22m
[2m  }[22m

--- StatefulSet/hermes-neutron-cosmos ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,15 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "relayer",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "hermes-neutron-cosmos",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/role": "hermes",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "hermes-neutron-cosmos",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -29,16 +38,18 @@[39m
[2m            "app.kubernetes.io/name": "hermes-neutron-cosmos",[22m
[2m            "app.kubernetes.io/rawname": "neutron-cosmos",[22m
[2m            "app.kubernetes.io/type": "hermes",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[2m          "containers": Array [[22m
[2m            Object {[22m
[31m+             "args": Array [[39m
[31m+               "/exposer/exposer",[39m
[31m+             ],[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "/exposer/exposer",[39m
[2m              ],[22m
[2m              "env": Array [[22m
[2m                Object {[22m
[33m@@ -55,11 +66,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -83,14 +94,24 @@[39m
[2m              ],[22m
[2m            },[22m
[2m            Object {[22m
[31m+             "args": Array [[39m
[31m+               "RLY_INDEX=\${HOSTNAME##*-}[39m
[31m+ echo \\"Relayer Index: $RLY_INDEX\\"[39m
[31m+ hermes start",[39m
[31m+             ],[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "RLY_INDEX=\${HOSTNAME##*-}[39m
[32m- echo \\"Relayer Index: $RLY_INDEX\\"[39m
[32m- hermes start",[39m
[2m              ],[22m
[2m              "env": Array [[22m
[31m+               Object {[39m
[31m+                 "name": "NAMESPACE",[39m
[31m+                 "valueFrom": Object {[39m
[31m+                   "fieldRef": Object {[39m
[31m+                     "fieldPath": "metadata.namespace",[39m
[31m+                   },[39m
[31m+                 },[39m
[31m+               },[39m
[2m                Object {[22m
[2m                  "name": "RELAYER_DIR",[22m
[2m                  "value": "/root/.hermes",[22m
[33m@@ -101,12 +122,12 @@[39m
[2m              "name": "relayer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[2m              },[22m
[2m              "securityContext": Object {[22m
[33m@@ -127,24 +148,26 @@[39m
[2m          ],[22m
[2m          "initContainers": Array [[22m
[2m            Object {[22m
[32m-             "command": Array [[39m
[32m-               "bash",[39m
[32m-               "-c",[39m
[31m+             "args": Array [[39m
[2m                "# Install exposer binary from the image[22m
[2m  cp /bin/exposer /exposer/exposer[22m
[2m  chmod +x /exposer/exposer",[22m
[31m+             ],[39m
[31m+             "command": Array [[39m
[31m+               "bash",[39m
[31m+               "-c",[39m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/exposer:20250205-544757d",[22m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "init-exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "100M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "100M",[39m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[33m@@ -155,9 +178,7 @@[39m
[2m              ],[22m
[2m            },[22m
[2m            Object {[22m
[32m-             "command": Array [[39m
[32m-               "bash",[39m
[32m-               "-c",[39m
[31m+             "args": Array [[39m
[2m                "set -ux[22m

[2m  RLY_INDEX=\${HOSTNAME##*-}[22m
[33m@@ -166,18 +187,16 @@[39m
[2m  mkdir -p $RELAYER_DIR[22m
[2m  cp /configs/config.toml $RELAYER_DIR/config.toml[22m
[2m  cp /configs/config-cli.toml $RELAYER_DIR/config-cli.toml[22m
[32m- cat $RELAYER_DIR/config.toml[39m

[32m- MNEMONIC=$(jq -r \\".relayers[$RELAYER_INDEX].mnemonic\\" $KEYS_CONFIG)[39m
[31m+ # Replace namespace placeholder with actual namespace environment variable[39m
[31m+ sed -i \\"s|\\\\$NAMESPACE|$NAMESPACE|g\\" $RELAYER_DIR/config.toml[39m
[31m+ sed -i \\"s|\\\\$NAMESPACE|$NAMESPACE|g\\" $RELAYER_DIR/config-cli.toml[39m
[31m+[39m
[31m+ MNEMONIC=$(jq -r \\".relayers[$RLY_INDEX].mnemonic\\" $KEYS_CONFIG)[39m
[2m  echo $MNEMONIC > $RELAYER_DIR/mnemonic.txt[22m
[32m- MNEMONIC_CLI=$(jq -r \\".relayers_cli[$RELAYER_INDEX].mnemonic\\" $KEYS_CONFIG)[39m
[31m+ MNEMONIC_CLI=$(jq -r \\".relayers_cli[$RLY_INDEX].mnemonic\\" $KEYS_CONFIG)[39m
[2m  echo $MNEMONIC_CLI > $RELAYER_DIR/mnemonic-cli.txt[22m

[32m- echo \\"Debug output for neutron-cosmos...\\"[39m
[32m- cat << EOF[39m
[32m-               map[string]interface {}[39m
[32m-               {\\"chains\\":[\\"neutron-1\\",\\"cosmoshub-4\\"],\\"channels\\":[{\\"a-chain\\":\\"neutron-1\\",\\"a-connection\\":\\"connection-0\\",\\"a-port\\":\\"consumer\\",\\"b-port\\":\\"provider\\",\\"channel-version\\":1,\\"order\\":\\"ordered\\"},{\\"a-chain\\":\\"neutron-1\\",\\"a-connection\\":\\"connection-0\\",\\"a-port\\":\\"transfer\\",\\"b-port\\":\\"transfer\\"}],\\"config\\":{\\"event_source\\":{\\"mode\\":\\"push\\"},\\"global\\":{\\"log_level\\":\\"info\\"},\\"mode\\":{\\"channels\\":{\\"enabled\\":true},\\"clients\\":{\\"enabled\\":true,\\"misbehaviour\\":true,\\"refresh\\":true},\\"connections\\":{\\"enabled\\":true},\\"packets\\":{\\"clear_interval\\":100,\\"clear_on_start\\":true,\\"enabled\\":true,\\"tx_confirmation\\":true}},\\"rest\\":{\\"enabled\\":true,\\"host\\":\\"0.0.0.0\\",\\"port\\":3000},\\"telemetry\\":{\\"enabled\\":true,\\"host\\":\\"0.0.0.0\\",\\"port\\":3001}},\\"fullname\\":\\"hermes-neutron-cosmos\\",\\"ics\\":{\\"consumer\\":\\"neutron-1\\",\\"enabled\\":true,\\"provider\\":\\"cosmoshub-4\\"},\\"image\\":\\"ghcr.io/cosmology-tech/starship/hermes:1.10.0\\",\\"name\\":\\"neutron-cosmos\\",\\"replicas\\":1,\\"type\\":\\"hermes\\"}[39m
[32m- EOF[39m

[2m  echo \\"Creating key for neutron-1...\\"[22m
[2m  hermes keys add \\\\[22m
[33m@@ -240,8 +259,7 @@[39m
[2m    $DENOM \\\\[22m
[2m    http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:8000/credit \\\\[22m
[2m    \\"true\\" || true[22m
[32m- echo \\"Creating IBC connection for neutron-1...\\"[39m
[32m- hermes create connection --a-chain neutron-1 --a-client 07-tendermint-0 --b-client 07-tendermint-0[39m
[31m+[39m
[2m  hermes create channel \\\\[22m
[2m    --a-connection connection-0 \\\\[22m
[2m    --channel-version 1 \\\\[22m
[33m@@ -249,11 +267,16 @@[39m
[2m    --a-chain neutron-1 \\\\[22m
[2m    --a-port consumer \\\\[22m
[2m    --b-port provider[22m
[31m+[39m
[2m  hermes create channel \\\\[22m
[2m    --a-connection connection-0 \\\\[22m
[2m    --a-chain neutron-1 \\\\[22m
[2m    --a-port transfer \\\\[22m
[2m    --b-port transfer",[22m
[31m+             ],[39m
[31m+             "command": Array [[39m
[31m+               "bash",[39m
[31m+               "-c",[39m
[2m              ],[22m
[2m              "env": Array [[22m
[2m                Object {[22m
[33m@@ -274,7 +297,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "RELAYER_INDEX",[22m
[32m-                 "value": "0",[39m
[31m+                 "value": "\${HOSTNAME##*-}",[39m
[2m                },[22m
[2m              ],[22m
[2m              "image": "ghcr.io/cosmology-tech/starship/hermes:1.10.0",[22m
[33m@@ -282,12 +305,12 @@[39m
[2m              "name": "init-relayer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[33m@@ -318,6 +341,7 @@[39m
[2m    echo \\"Checking: http://neutron-1-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id\\"[22m
[2m    sleep 10;[22m
[2m  done[22m
[31m+[39m
[2m  while [ $(curl -sw '%{http_code}' http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id -o /dev/null) -ne 200 ]; do[22m
[2m    echo \\"Genesis validator does not seem to be ready for: cosmoshub-4. Waiting for it to start...\\"[22m
[2m    echo \\"Checking: http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id\\"[22m
[33m@@ -340,16 +364,16 @@[39m
[2m                  },[22m
[2m                },[22m
[2m              ],[22m
[32m-             "image": "curlimages/curl",[39m
[31m+             "image": "curlimages/curl:latest",[39m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "wait-for-chains",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m

--- ConfigMap/neutron-query-relayer-nqr-neutron-cosmos ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[2m  Object {[22m
[2m    "apiVersion": "v1",[22m
[2m    "data": Object {[22m
[32m-     "relayer-listen-addr": "127.0.0.1:9999",[39m
[32m-     "relayer-neutron-chain-home-dir": "/root/.neutrond",[39m
[32m-     "relayer-neutron-chain-rest-addr": "http://neutron-1-genesis.default.svc.cluster.local:1317",[39m
[32m-     "relayer-neutron-chain-rpc-addr": "http://neutron-1-genesis.default.svc.cluster.local:26657",[39m
[32m-     "relayer-registry-addresses": "",[39m
[32m-     "relayer-target-chain-rpc-addr": "http://cosmoshub-4-genesis.default.svc.cluster.local:26657",[39m
[31m+     "config.json": "{[39m
[31m+   \\"relayer\\": {[39m
[31m+     \\"neutron_chain\\": {[39m
[31m+       \\"chain_id\\": \\"neutron-1\\",[39m
[31m+       \\"rpc_addr\\": \\"http://neutron-1-genesis.$(NAMESPACE).svc.cluster.local:26657\\",[39m
[31m+       \\"grpc_addr\\": \\"http://neutron-1-genesis.$(NAMESPACE).svc.cluster.local:9090\\",[39m
[31m+       \\"websocket_addr\\": \\"ws://neutron-1-genesis.$(NAMESPACE).svc.cluster.local:26657/websocket\\",[39m
[31m+       \\"account_prefix\\": \\"neutron\\",[39m
[31m+       \\"keyring_backend\\": \\"test\\",[39m
[31m+       \\"gas_prices\\": \\"0.025untrn\\",[39m
[31m+       \\"gas_adjustment\\": 1.5,[39m
[31m+       \\"connection_id\\": \\"connection-0\\",[39m
[31m+       \\"debug\\": false,[39m
[31m+       \\"timeout\\": \\"10s\\",[39m
[31m+       \\"tx_memo\\": \\"neutron-query-relayer\\"[39m
[31m+     },[39m
[31m+     \\"target_chain\\": {[39m
[31m+       \\"chain_id\\": \\"cosmoshub-4\\",[39m
[31m+       \\"rpc_addr\\": \\"http://cosmoshub-4-genesis.$(NAMESPACE).svc.cluster.local:26657\\",[39m
[31m+       \\"grpc_addr\\": \\"http://cosmoshub-4-genesis.$(NAMESPACE).svc.cluster.local:9090\\",[39m
[31m+       \\"websocket_addr\\": \\"ws://cosmoshub-4-genesis.$(NAMESPACE).svc.cluster.local:26657/websocket\\",[39m
[31m+       \\"account_prefix\\": \\"cosmos\\",[39m
[31m+       \\"keyring_backend\\": \\"test\\",[39m
[31m+       \\"gas_prices\\": \\"0.025uatom\\",[39m
[31m+       \\"gas_adjustment\\": 1.5,[39m
[31m+       \\"connection_id\\": \\"connection-0\\",[39m
[31m+       \\"debug\\": false,[39m
[31m+       \\"timeout\\": \\"10s\\",[39m
[31m+       \\"tx_memo\\": \\"neutron-query-relayer\\"[39m
[31m+     },[39m
[31m+     \\"queries_file\\": \\"/configs/queries.json\\",[39m
[31m+     \\"check_submitted_tx\\": true,[39m
[31m+     \\"storage_path\\": \\"./storage\\",[39m
[31m+     \\"log_level\\": \\"info\\"[39m
[31m+   }[39m
[31m+ }",[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "relayer",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "neutron-query-relayer-nqr-neutron-cosmos",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/role": "neutron-query-relayer",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "neutron-query-relayer-nqr-neutron-cosmos",[22m
[2m    },[22m
[2m  }[22m

--- Service/neutron-query-relayer-nqr-neutron-cosmos ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -11,10 +11,10 @@[39m
[2m      "clusterIP": "None",[22m
[2m      "ports": Array [[22m
[2m        Object {[22m
[32m-         "name": "rest",[39m
[32m-         "port": 3000,[39m
[31m+         "name": "metrics",[39m
[31m+         "port": 9090,[39m
[2m          "protocol": "TCP",[22m
[32m-         "targetPort": 9999,[39m
[31m+         "targetPort": 9090,[39m
[2m        },[22m
[2m      ],[22m
[2m      "selector": Object {[22m

--- StatefulSet/neutron-query-relayer-nqr-neutron-cosmos ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,15 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "relayer",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "neutron-query-relayer-nqr-neutron-cosmos",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/role": "neutron-query-relayer",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "neutron-query-relayer-nqr-neutron-cosmos",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -29,162 +38,53 @@[39m
[2m            "app.kubernetes.io/name": "neutron-query-relayer-nqr-neutron-cosmos",[22m
[2m            "app.kubernetes.io/rawname": "nqr-neutron-cosmos",[22m
[2m            "app.kubernetes.io/type": "neutron-query-relayer",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[2m          "containers": Array [[22m
[2m            Object {[22m
[31m+             "args": Array [[39m
[31m+               "RLY_INDEX=\${HOSTNAME##*-}[39m
[31m+ echo \\"Relayer Index: $RLY_INDEX\\"[39m
[31m+ neutron-query-relayer start --config /configs/config.json",[39m
[31m+             ],[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "RLY_INDEX=\${HOSTNAME##*-}[39m
[32m- echo \\"Relayer Index: $RLY_INDEX\\"[39m
[32m-[39m
[32m- echo \\"Query connection id from registry service\\"[39m
[32m- CONNECTION_ID=$(curl -s -X GET curl http://registry.$NAMESPACE.svc.cluster.local:8080/ibc/neutron-1/cosmoshub-4 | jq -r \\".chain_1.connection_id\\")[39m
[32m- echo \\"Connection ID: $CONNECTION_ID\\"[39m
[32m-[39m
[32m- RELAYER_NEUTRON_CHAIN_CONNECTION_ID=$CONNECTION_ID neutron_query_relayer start",[39m
[2m              ],[22m
[2m              "env": Array [[22m
[2m                Object {[22m
[32m-                 "name": "NAMESPACE",[39m
[32m-                 "valueFrom": Object {[39m
[32m-                   "fieldRef": Object {[39m
[32m-                     "fieldPath": "metadata.namespace",[39m
[32m-                   },[39m
[32m-                 },[39m
[32m-               },[39m
[32m-               Object {[39m
[32m-                 "name": "RELAYER_ALLOW_KV_CALLBACKS",[39m
[32m-                 "value": "true",[39m
[31m+                 "name": "CONFIG_PATH",[39m
[31m+                 "value": "/configs/config.json",[39m
[2m                },[22m
[2m                Object {[22m
[32m-                 "name": "RELAYER_ALLOW_TX_QUERIES",[39m
[32m-                 "value": "true",[39m
[31m+                 "name": "KEYS_CONFIG",[39m
[31m+                 "value": "/keys/keys.json",[39m
[2m                },[22m
[2m                Object {[22m
[32m-                 "name": "RELAYER_CHECK_SUBMITTED_TX_STATUS_DELAY",[39m
[32m-                 "value": "10s",[39m
[31m+                 "name": "LOG_LEVEL",[39m
[31m+                 "value": "info",[39m
[2m                },[22m
[2m                Object {[22m
[32m-                 "name": "RELAYER_DIR",[39m
[32m-                 "value": "/root/.hermes",[39m
[31m+                 "name": "METRICS_PORT",[39m
[31m+                 "value": "9090",[39m
[2m                },[22m
[2m                Object {[22m
[32m-                 "name": "RELAYER_LISTEN_ADDR",[39m
[31m+                 "name": "NAMESPACE",[39m
[2m                  "valueFrom": Object {[22m
[32m-                   "configMapKeyRef": Object {[39m
[32m-                     "key": "relayer-listen-addr",[39m
[32m-                     "name": "neutron-query-relayer-nqr-neutron-cosmos",[39m
[31m+                   "fieldRef": Object {[39m
[31m+                     "fieldPath": "metadata.namespace",[39m
[2m                    },[22m
[2m                  },[22m
[2m                },[22m
[2m                Object {[22m
[32m-                 "name": "RELAYER_MIN_KV_UPDATE_PERIOD",[39m
[32m-                 "value": "1",[39m
[31m+                 "name": "RELAYER_INDEX",[39m
[31m+                 "value": "\${HOSTNAME##*-}",[39m
[2m                },[22m
[2m                Object {[22m
[32m-                 "name": "RELAYER_NEUTRON_CHAIN_DEBUG",[39m
[32m-                 "value": "false",[39m
[32m-               },[39m
[32m-               Object {[39m
[32m-                 "name": "RELAYER_NEUTRON_CHAIN_GAS_ADJUSTMENT",[39m
[32m-                 "value": "2",[39m
[32m-               },[39m
[32m-               Object {[39m
[32m-                 "name": "RELAYER_NEUTRON_CHAIN_GAS_LIMIT",[39m
[32m-                 "value": "200000",[39m
[32m-               },[39m
[32m-               Object {[39m
[32m-                 "name": "RELAYER_NEUTRON_CHAIN_GAS_PRICES",[39m
[32m-                 "value": "0.5untrn",[39m
[32m-               },[39m
[32m-               Object {[39m
[32m-                 "name": "RELAYER_NEUTRON_CHAIN_HOME_DIR",[39m
[32m-                 "valueFrom": Object {[39m
[32m-                   "configMapKeyRef": Object {[39m
[32m-                     "key": "relayer-neutron-chain-home-dir",[39m
[32m-                     "name": "neutron-query-relayer-nqr-neutron-cosmos",[39m
[32m-                   },[39m
[32m-                 },[39m
[32m-               },[39m
[32m-               Object {[39m
[32m-                 "name": "RELAYER_NEUTRON_CHAIN_KEYRING_BACKEND",[39m
[32m-                 "value": "test",[39m
[32m-               },[39m
[32m-               Object {[39m
[32m-                 "name": "RELAYER_NEUTRON_CHAIN_OUTPUT_FORMAT",[39m
[32m-                 "value": "json",[39m
[32m-               },[39m
[32m-               Object {[39m
[32m-                 "name": "RELAYER_NEUTRON_CHAIN_REST_ADDR",[39m
[32m-                 "valueFrom": Object {[39m
[32m-                   "configMapKeyRef": Object {[39m
[32m-                     "key": "relayer-neutron-chain-rest-addr",[39m
[32m-                     "name": "neutron-query-relayer-nqr-neutron-cosmos",[39m
[32m-                   },[39m
[32m-                 },[39m
[32m-               },[39m
[32m-               Object {[39m
[32m-                 "name": "RELAYER_NEUTRON_CHAIN_RPC_ADDR",[39m
[32m-                 "valueFrom": Object {[39m
[32m-                   "configMapKeyRef": Object {[39m
[32m-                     "key": "relayer-neutron-chain-rpc-addr",[39m
[32m-                     "name": "neutron-query-relayer-nqr-neutron-cosmos",[39m
[32m-                   },[39m
[32m-                 },[39m
[32m-               },[39m
[32m-               Object {[39m
[32m-                 "name": "RELAYER_NEUTRON_CHAIN_SIGN_KEY_NAME",[39m
[32m-                 "value": "relayer",[39m
[32m-               },[39m
[32m-               Object {[39m
[32m-                 "name": "RELAYER_NEUTRON_CHAIN_SIGN_MODE_STR",[39m
[32m-                 "value": "direct",[39m
[32m-               },[39m
[32m-               Object {[39m
[32m-                 "name": "RELAYER_NEUTRON_CHAIN_TIMEOUT",[39m
[32m-                 "value": "1000s",[39m
[32m-               },[39m
[32m-               Object {[39m
[32m-                 "name": "RELAYER_QUERIES_TASK_QUEUE_CAPACITY",[39m
[32m-                 "value": "10000",[39m
[32m-               },[39m
[32m-               Object {[39m
[32m-                 "name": "RELAYER_REGISTRY_ADDRESS",[39m
[32m-                 "value": "",[39m
[32m-               },[39m
[32m-               Object {[39m
[32m-                 "name": "RELAYER_REGISTRY_ADDRESSES",[39m
[32m-                 "valueFrom": Object {[39m
[32m-                   "configMapKeyRef": Object {[39m
[32m-                     "key": "relayer-registry-addresses",[39m
[32m-                     "name": "neutron-query-relayer-nqr-neutron-cosmos",[39m
[32m-                   },[39m
[32m-                 },[39m
[32m-               },[39m
[32m-               Object {[39m
[32m-                 "name": "RELAYER_STORAGE_PATH",[39m
[32m-                 "value": "storage/leveldb",[39m
[32m-               },[39m
[32m-               Object {[39m
[32m-                 "name": "RELAYER_TARGET_CHAIN_DEBUG",[39m
[32m-                 "value": "true",[39m
[32m-               },[39m
[32m-               Object {[39m
[32m-                 "name": "RELAYER_TARGET_CHAIN_RPC_ADDR",[39m
[32m-                 "valueFrom": Object {[39m
[32m-                   "configMapKeyRef": Object {[39m
[32m-                     "key": "relayer-target-chain-rpc-addr",[39m
[32m-                     "name": "neutron-query-relayer-nqr-neutron-cosmos",[39m
[32m-                   },[39m
[32m-                 },[39m
[32m-               },[39m
[32m-               Object {[39m
[32m-                 "name": "RELAYER_TARGET_CHAIN_TIMEOUT",[39m
[32m-                 "value": "1000s",[39m
[31m+                 "name": "STORAGE_PATH",[39m
[31m+                 "value": "./storage",[39m
[2m                },[22m
[2m              ],[22m
[2m              "image": "ghcr.io/cosmology-tech/starship/neutron-query-relayer:v0.2.0",[22m
[33m@@ -192,12 +92,12 @@[39m
[2m              "name": "relayer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[2m              },[22m
[2m              "securityContext": Object {[22m
[33m@@ -218,35 +118,56 @@[39m
[2m          ],[22m
[2m          "initContainers": Array [[22m
[2m            Object {[22m
[32m-             "command": Array [[39m
[32m-               "bash",[39m
[32m-               "-c",[39m
[31m+             "args": Array [[39m
[2m                "set -ux[22m

[32m- echo \\"Adding key.... relayer\\"[39m
[32m- jq -r \\".relayers[$RELAYER_INDEX].mnemonic\\" $KEYS_CONFIG | neutrond keys add relayer --recover --keyring-backend=\\"test\\"[39m
[31m+ RLY_INDEX=\${HOSTNAME##*-}[39m
[31m+ echo \\"Relayer Index: $RLY_INDEX\\"[39m
[31m+[39m
[31m+ mkdir -p $STORAGE_PATH[39m
[31m+[39m
[31m+ NEUTRON_MNEMONIC=$(jq -r \\".relayers[$RLY_INDEX].mnemonic\\" $KEYS_CONFIG)[39m
[31m+ TARGET_MNEMONIC=$(jq -r \\".relayers[$RLY_INDEX].mnemonic\\" $KEYS_CONFIG)[39m
[31m+[39m
[31m+[39m
[31m+ echo \\"Setting up keys for neutron-1...\\"[39m
[31m+ # Keys will be managed through environment variables for neutron-query-relayer[39m

[2m  DENOM=\\"untrn\\"[22m
[32m- RLY_ADDR=$(neutrond keys show relayer -a --keyring-backend='test')[39m
[32m- echo \\"Transfer tokens to address $RLY_ADDR\\"[39m
[31m+ # For neutron-query-relayer, we need to derive the address from mnemonic[39m
[31m+ # This will be handled by the relayer binary itself[39m

[32m- echo \\"Transfer tokens to address $RLY_ADDR\\"[39m
[32m- bash -e /scripts/transfer-tokens.sh \\\\[39m
[32m-   $RLY_ADDR \\\\[39m
[32m-   $DENOM \\\\[39m
[32m-   http://neutron-1-genesis.$NAMESPACE.svc.cluster.local:8000/credit \\\\[39m
[32m-   \\"false\\" || true[39m
[31m+ echo \\"Chain neutron-1 setup completed\\"[39m
[31m+[39m
[31m+ echo \\"Setting up keys for cosmoshub-4...\\"[39m
[31m+ # Keys will be managed through environment variables for neutron-query-relayer[39m
[31m+[39m
[31m+ DENOM=\\"uatom\\"[39m
[31m+ # For neutron-query-relayer, we need to derive the address from mnemonic[39m
[31m+ # This will be handled by the relayer binary itself[39m

[32m- echo \\"Wait for connection id to be created\\"[39m
[32m- bash -e /scripts/ibc-connection.sh \\\\[39m
[32m-   http://registry.$NAMESPACE.svc.cluster.local:8080 \\\\[39m
[32m-   neutron-1 \\\\[39m
[32m-   cosmoshub-4",[39m
[31m+ echo \\"Chain cosmoshub-4 setup completed\\"",[39m
[31m+             ],[39m
[31m+             "command": Array [[39m
[31m+               "bash",[39m
[31m+               "-c",[39m
[2m              ],[22m
[2m              "env": Array [[22m
[2m                Object {[22m
[31m+                 "name": "CONFIG_PATH",[39m
[31m+                 "value": "/configs/config.json",[39m
[31m+               },[39m
[31m+               Object {[39m
[2m                  "name": "KEYS_CONFIG",[22m
[2m                  "value": "/keys/keys.json",[22m
[31m+               },[39m
[31m+               Object {[39m
[31m+                 "name": "LOG_LEVEL",[39m
[31m+                 "value": "info",[39m
[31m+               },[39m
[31m+               Object {[39m
[31m+                 "name": "METRICS_PORT",[39m
[31m+                 "value": "9090",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "NAMESPACE",[22m
[33m@@ -257,17 +178,27 @@[39m
[2m                  },[22m
[2m                },[22m
[2m                Object {[22m
[32m-                 "name": "RELAYER_DIR",[39m
[32m-                 "value": "/root/.neutrond",[39m
[31m+                 "name": "RELAYER_INDEX",[39m
[31m+                 "value": "\${HOSTNAME##*-}",[39m
[2m                },[22m
[2m                Object {[22m
[32m-                 "name": "RELAYER_INDEX",[39m
[32m-                 "value": "1",[39m
[31m+                 "name": "STORAGE_PATH",[39m
[31m+                 "value": "./storage",[39m
[2m                },[22m
[2m              ],[22m
[32m-             "image": "ghcr.io/cosmology-tech/starship/neutron:v3.0.5",[39m
[31m+             "image": "ghcr.io/cosmology-tech/starship/neutron-query-relayer:v0.2.0",[39m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "init-relayer",[22m
[31m+             "resources": Object {[39m
[31m+               "limits": Object {[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[31m+               },[39m
[31m+               "requests": Object {[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[31m+               },[39m
[31m+             },[39m
[2m              "volumeMounts": Array [[22m
[2m                Object {[22m
[2m                  "mountPath": "/keys",[22m
[33m@@ -296,6 +227,7 @@[39m
[2m    echo \\"Checking: http://neutron-1-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id\\"[22m
[2m    sleep 10;[22m
[2m  done[22m
[31m+[39m
[2m  while [ $(curl -sw '%{http_code}' http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id -o /dev/null) -ne 200 ]; do[22m
[2m    echo \\"Genesis validator does not seem to be ready for: cosmoshub-4. Waiting for it to start...\\"[22m
[2m    echo \\"Checking: http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id\\"[22m
[33m@@ -318,16 +250,16 @@[39m
[2m                  },[22m
[2m                },[22m
[2m              ],[22m
[32m-             "image": "curlimages/curl",[39m
[31m+             "image": "curlimages/curl:latest",[39m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "wait-for-chains",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m"
`;

exports[`Manifest Comparison Tests Individual Config Comparisons should generate manifests for noble that match the snapshot 1`] = `
"ðŸ”„ MODIFIED_RESOURCES:

--- ConfigMap/keys ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -98,6 +98,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "configmap",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "keys",[39m
[31m+       "app.kubernetes.io/part-of": "global",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "keys",[22m
[2m    },[22m
[2m  }[22m

--- ConfigMap/setup-scripts ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -208,6 +208,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "configmap",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts",[39m
[31m+       "app.kubernetes.io/part-of": "global",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts",[22m
[2m    },[22m
[2m  }[22m

--- StatefulSet/cosmoshub-4-genesis ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,18 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/id": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "cosmoshub-4-genesis",[39m
[31m+       "app.kubernetes.io/part-of": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/role": "genesis",[39m
[31m+       "app.kubernetes.io/type": "cosmoshub-4-statefulset",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-name": "cosmoshub",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "cosmoshub-4-genesis",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +21,7 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "cosmoshub",[39m
[31m+         "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m          "app.kubernetes.io/name": "cosmoshub-4-genesis",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -23,11 +35,12 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "cosmoshub",[39m
[31m+           "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m            "app.kubernetes.io/name": "cosmoshub-4-genesis",[22m
[2m            "app.kubernetes.io/rawname": "cosmoshub-4",[22m
[31m+           "app.kubernetes.io/role": "genesis",[39m
[2m            "app.kubernetes.io/type": "cosmoshub-4",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[33m@@ -91,11 +104,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -184,12 +197,12 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[32m-                 "memory": "200M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "128M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[32m-                 "memory": "200M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "128M",[39m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[33m@@ -211,7 +224,12 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "START_ARGS=\\"\\"[39m
[31m+               "#!/bin/bash[39m
[31m+ set -euo pipefail[39m
[31m+[39m
[31m+ START_ARGS=\\"\\"[39m
[31m+[39m
[31m+[39m
[2m  $CHAIN_BIN start $START_ARGS",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -274,11 +292,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -307,6 +325,7 @@[39m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m

[2m  echo \\"Running setup config script...\\"[22m
[31m+[39m
[2m  bash -e /scripts/update-config.sh",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -348,7 +367,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "TIME_IOTA_MS",[22m
[33m@@ -388,11 +407,11 @@[39m
[2m              "name": "init-config",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -415,20 +434,18 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "# Install faucet binary from the image[39m
[32m- cp /bin/faucet /faucet/faucet[39m
[32m- chmod +x /faucet/faucet",[39m
[31m+               "cp /bin/faucet /faucet/faucet && chmod +x /faucet/faucet",[39m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/faucet:20250325-2207109",[22m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "init-faucet",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -553,11 +570,11 @@[39m
[2m              "name": "init-genesis",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m

--- ConfigMap/setup-scripts-cosmoshub-4 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -608,6 +608,17 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts-cosmoshub-4",[39m
[31m+       "app.kubernetes.io/part-of": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/role": "setup-scripts",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-id": "cosmoshub-4",[39m
[31m+       "starship.io/chain-name": "cosmoshub",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts-cosmoshub-4",[22m
[2m    },[22m
[2m  }[22m

--- StatefulSet/noble-1-genesis ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,18 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/id": "noble-1",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "noble-1-genesis",[39m
[31m+       "app.kubernetes.io/part-of": "noble-1",[39m
[31m+       "app.kubernetes.io/role": "genesis",[39m
[31m+       "app.kubernetes.io/type": "noble-1-statefulset",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-name": "noble",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "noble-1-genesis",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +21,7 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "noble",[39m
[31m+         "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m          "app.kubernetes.io/name": "noble-1-genesis",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -23,11 +35,12 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "noble",[39m
[31m+           "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m            "app.kubernetes.io/name": "noble-1-genesis",[22m
[2m            "app.kubernetes.io/rawname": "noble-1",[22m
[31m+           "app.kubernetes.io/role": "genesis",[39m
[2m            "app.kubernetes.io/type": "noble-1",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[33m@@ -91,11 +104,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -184,12 +197,12 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[32m-                 "memory": "200M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "128M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[32m-                 "memory": "200M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "128M",[39m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[33m@@ -211,7 +224,12 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "START_ARGS=\\"\\"[39m
[31m+               "#!/bin/bash[39m
[31m+ set -euo pipefail[39m
[31m+[39m
[31m+ START_ARGS=\\"\\"[39m
[31m+[39m
[31m+[39m
[2m  $CHAIN_BIN start $START_ARGS",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -274,11 +292,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -307,6 +325,7 @@[39m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m

[2m  echo \\"Running setup config script...\\"[22m
[31m+[39m
[2m  bash -e /scripts/update-config.sh",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -348,7 +367,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "TIME_IOTA_MS",[22m
[33m@@ -388,11 +407,11 @@[39m
[2m              "name": "init-config",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -415,20 +434,18 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "# Install faucet binary from the image[39m
[32m- cp /bin/faucet /faucet/faucet[39m
[32m- chmod +x /faucet/faucet",[39m
[31m+               "cp /bin/faucet /faucet/faucet && chmod +x /faucet/faucet",[39m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/faucet:20250325-2207109",[22m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "init-faucet",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -553,11 +570,11 @@[39m
[2m              "name": "init-genesis",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m

--- ConfigMap/setup-scripts-noble-1 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -87,171 +87,6 @@[39m

[2m  echo \\"$json\\" | jq -r .result[22m
[2m  exit 0",[22m
[32m-     "create-genesis.sh": "#!/bin/bash[39m
[32m-[39m
[32m- set -eux[39m
[32m-[39m
[32m- DENOM=\\"\${DENOM:=uusdc}\\"[39m
[32m- COINS=\\"\${COINS:=100000000000000uusdc,100000000000000ustake}\\"[39m
[32m- CHAIN_ID=\\"\${CHAIN_ID:=noblelocal}\\"[39m
[32m- CHAIN_BIN=\\"\${CHAIN_BIN:=nobled}\\"[39m
[32m- CHAIN_DIR=\\"\${CHAIN_DIR:=$HOME/.nobled}\\"[39m
[32m- KEYS_CONFIG=\\"\${KEYS_CONFIG:=configs/keys.json}\\"[39m
[32m-[39m
[32m- FAUCET_ENABLED=\\"\${FAUCET_ENABLED:=true}\\"[39m
[32m- NUM_VALIDATORS=\\"\${NUM_VALIDATORS:=1}\\"[39m
[32m- NUM_RELAYERS=\\"\${NUM_RELAYERS:=0}\\"[39m
[32m-[39m
[32m- # FiatTokenFactory roles[39m
[32m- FIATTF_OWNER_KEY=\\"fiattf_owner\\"[39m
[32m- FIATTF_OWNER_MNEMONIC=\\"gesture inject test cycle original hollow east ridge hen combine junk child bacon zero hope comfort vacuum milk pitch cage oppose unhappy lunar seat\\"[39m
[32m-[39m
[32m- FIATTF_MASTER_MINTER_KEY=\\"fiattf_master_minter\\"[39m
[32m- FIATTF_MASTER_MINTER_MNEMONIC=\\"maximum display century economy unlock van census kite error heart snow filter midnight usage egg venture cash kick motor survey drastic edge muffin visual\\"[39m
[32m-[39m
[32m- FIATTF_MINTER_CONTROLLER_KEY=\\"fiattf_minter_controller\\"[39m
[32m- FIATTF_MINTER_CONTROLLER_MNEMONIC=\\"keep liar demand upon shed essence tip undo eagle run people strong sense another salute double peasant egg royal hair report winner student diamond\\"[39m
[32m-[39m
[32m- FIATTF_MINTER_CONTROLLER2_KEY=\\"fiattf_minter_controller2\\"[39m
[32m- FIATTF_MINTER_CONTROLLER2_MNEMONIC=\\"morning person bachelor illegal inner note learn problem cement river half sentence junk evidence mercy intact step nasty cotton elite real unveil business drum\\"[39m
[32m-[39m
[32m- FIATTF_MINTER_KEY=\\"fiattf_minter\\"[39m
[32m- FIATTF_MINTER_MNEMONIC=\\"shed spike wish soda inside awake satoshi fish length whisper garlic sketch diary trumpet tree nose stove tobacco vague target announce brave alley priority\\"[39m
[32m-[39m
[32m- FIATTF_BLACKLISTER_KEY=\\"fiattf_blacklister\\"[39m
[32m- FIATTF_BLACKLISTER_MNEMONIC=\\"planet reunion diet obscure curious swim suit kitchen fiscal creek jeans doll disorder color gown sweet have search repair exhaust clap assault dwarf design\\"[39m
[32m-[39m
[32m- FIATTF_PAUSER_KEY=\\"fiattf_pauser\\"[39m
[32m- FIATTF_PAUSER_MNEMONIC=\\"guilt juice tone exhibit vault stairs mesh often expect face search quality paddle broccoli hundred another elder range horror beef session found loop mobile\\"[39m
[32m-[39m
[32m- # TokenFactory roles[39m
[32m- TF_OWNER_KEY=\\"tf_owner\\"[39m
[32m- TF_OWNER_MNEMONIC=\\"poverty pride inject trumpet candy quiz mixed junk cricket food include involve uphold gasp wish gas save occur genius shoe slight occur sudden cute\\"[39m
[32m-[39m
[32m- TF_MASTER_MINTER_KEY=\\"tf_master_minter\\"[39m
[32m- TF_MASTER_MINTER_MNEMONIC=\\"belt cream catalog absurd hen toast ethics summer addict kick hood february spatial inmate cycle business double keep gravity private nose obvious phrase birth\\"[39m
[32m-[39m
[32m- TF_MINTER_CONTROLLER_KEY=\\"tf_minter_controller\\"[39m
[32m- TF_MINTER_CONTROLLER_MNEMONIC=\\"spider silk peasant tobacco cactus range draft merry fashion trick modify scale width omit admit face off property enact upper drink obvious off used\\"[39m
[32m-[39m
[32m- TF_MINTER_CONTROLLER2_KEY=\\"tf_minter_controller2\\"[39m
[32m- TF_MINTER_CONTROLLER2_MNEMONIC=\\"swear blossom hybrid write crash seven then ship brush market moral renew plug oval focus stairs brisk inner blue main barely broken burden fancy\\"[39m
[32m-[39m
[32m- TF_MINTER_KEY=\\"tf_minter\\"[39m
[32m- TF_MINTER_MNEMONIC=\\"muffin clog joy echo hello size reform mention patient pumpkin enough inside danger talk wire home doctor bone ensure bind arrest dizzy magnet arrest\\"[39m
[32m-[39m
[32m- TF_BLACKLISTER_KEY=\\"tf_blacklister\\"[39m
[32m- TF_BLACKLISTER_MNEMONIC=\\"gravity domain nothing stomach cousin print rally door bone ghost tuition opera witness paper color oak mistake toward current coach industry thought acid breeze\\"[39m
[32m-[39m
[32m- TF_PAUSER_KEY=\\"tf_pauser\\"[39m
[32m- TF_PAUSER_MNEMONIC=\\"sniff tail rotate pelican snap spawn champion thought recycle body caution grain brass armed hawk goat champion sunset soul answer panel present open room\\"[39m
[32m-[39m
[32m- # check if the binary has genesis subcommand or not, if not, set CHAIN_GENESIS_CMD to empty[39m
[32m- CHAIN_GENESIS_CMD=$($CHAIN_BIN 2>&1 | grep -q \\"genesis-related subcommands\\" && echo \\"genesis\\" || echo \\"\\")[39m
[32m-[39m
[32m- CHAIN_INIT_ID=\\"$CHAIN_ID\\"[39m
[32m- if [ \\"$CHAIN_BIN\\" == \\"osmosisd\\" ]; then[39m
[32m-   CHAIN_INIT_ID=\\"test-1\\"[39m
[32m- fi[39m
[32m- jq -r \\".genesis[0].mnemonic\\" $KEYS_CONFIG | $CHAIN_BIN init $CHAIN_ID --chain-id $CHAIN_INIT_ID --recover[39m
[32m- sed -i -e \\"s/$CHAIN_INIT_ID/$CHAIN_ID/g\\" $CHAIN_DIR/config/genesis.json[39m
[32m-[39m
[32m- # Add genesis keys to the keyring and self delegate initial coins[39m
[32m- echo \\"Adding key....\\" $(jq -r \\".genesis[0].name\\" $KEYS_CONFIG)[39m
[32m- jq -r \\".genesis[0].mnemonic\\" $KEYS_CONFIG | $CHAIN_BIN keys add $(jq -r \\".genesis[0].name\\" $KEYS_CONFIG) --recover --keyring-backend=\\"test\\"[39m
[32m- $CHAIN_BIN $CHAIN_GENESIS_CMD add-genesis-account $($CHAIN_BIN keys show -a $(jq -r .genesis[0].name $KEYS_CONFIG) --keyring-backend=\\"test\\") $COINS --keyring-backend=\\"test\\"[39m
[32m-[39m
[32m- # Add faucet key to the keyring and self delegate initial coins[39m
[32m- echo \\"Adding key....\\" $(jq -r \\".faucet[0].name\\" $KEYS_CONFIG)[39m
[32m- jq -r \\".faucet[0].mnemonic\\" $KEYS_CONFIG | $CHAIN_BIN keys add $(jq -r \\".faucet[0].name\\" $KEYS_CONFIG) --recover --keyring-backend=\\"test\\"[39m
[32m- $CHAIN_BIN $CHAIN_GENESIS_CMD add-genesis-account $($CHAIN_BIN keys show -a $(jq -r .faucet[0].name $KEYS_CONFIG) --keyring-backend=\\"test\\") $COINS --keyring-backend=\\"test\\"[39m
[32m-[39m
[32m- # Add test keys to the keyring and self delegate initial coins[39m
[32m- echo \\"Adding key....\\" $(jq -r \\".keys[0].name\\" $KEYS_CONFIG)[39m
[32m- jq -r \\".keys[0].mnemonic\\" $KEYS_CONFIG | $CHAIN_BIN keys add $(jq -r \\".keys[0].name\\" $KEYS_CONFIG) --recover --keyring-backend=\\"test\\"[39m
[32m- $CHAIN_BIN $CHAIN_GENESIS_CMD add-genesis-account $($CHAIN_BIN keys show -a $(jq -r .keys[0].name $KEYS_CONFIG) --keyring-backend=\\"test\\") $COINS --keyring-backend=\\"test\\"[39m
[32m-[39m
[32m- # Add FiatTokenFactory role keys[39m
[32m- echo \\"Adding FiatTokenFactory role keys...\\"[39m
[32m- echo \\"$FIATTF_OWNER_MNEMONIC\\" | $CHAIN_BIN keys add $FIATTF_OWNER_KEY --recover --keyring-backend=\\"test\\"[39m
[32m- echo \\"$FIATTF_MASTER_MINTER_MNEMONIC\\" | $CHAIN_BIN keys add $FIATTF_MASTER_MINTER_KEY --recover --keyring-backend=\\"test\\"[39m
[32m- echo \\"$FIATTF_MINTER_CONTROLLER_MNEMONIC\\" | $CHAIN_BIN keys add $FIATTF_MINTER_CONTROLLER_KEY --recover --keyring-backend=\\"test\\"[39m
[32m- echo \\"$FIATTF_MINTER_CONTROLLER2_MNEMONIC\\" | $CHAIN_BIN keys add $FIATTF_MINTER_CONTROLLER2_KEY --recover --keyring-backend=\\"test\\"[39m
[32m- echo \\"$FIATTF_MINTER_MNEMONIC\\" | $CHAIN_BIN keys add $FIATTF_MINTER_KEY --recover --keyring-backend=\\"test\\"[39m
[32m- echo \\"$FIATTF_BLACKLISTER_MNEMONIC\\" | $CHAIN_BIN keys add $FIATTF_BLACKLISTER_KEY --recover --keyring-backend=\\"test\\"[39m
[32m- echo \\"$FIATTF_PAUSER_MNEMONIC\\" | $CHAIN_BIN keys add $FIATTF_PAUSER_KEY --recover --keyring-backend=\\"test\\"[39m
[32m-[39m
[32m- # Add TokenFactory role keys[39m
[32m- echo \\"Adding TokenFactory role keys...\\"[39m
[32m- echo \\"$TF_OWNER_MNEMONIC\\" | $CHAIN_BIN keys add $TF_OWNER_KEY --recover --keyring-backend=\\"test\\"[39m
[32m- echo \\"$TF_MASTER_MINTER_MNEMONIC\\" | $CHAIN_BIN keys add $TF_MASTER_MINTER_KEY --recover --keyring-backend=\\"test\\"[39m
[32m- echo \\"$TF_MINTER_CONTROLLER_MNEMONIC\\" | $CHAIN_BIN keys add $TF_MINTER_CONTROLLER_KEY --recover --keyring-backend=\\"test\\"[39m
[32m- echo \\"$TF_MINTER_CONTROLLER2_MNEMONIC\\" | $CHAIN_BIN keys add $TF_MINTER_CONTROLLER2_KEY --recover --keyring-backend=\\"test\\"[39m
[32m- echo \\"$TF_MINTER_MNEMONIC\\" | $CHAIN_BIN keys add $TF_MINTER_KEY --recover --keyring-backend=\\"test\\"[39m
[32m- echo \\"$TF_BLACKLISTER_MNEMONIC\\" | $CHAIN_BIN keys add $TF_BLACKLISTER_KEY --recover --keyring-backend=\\"test\\"[39m
[32m- echo \\"$TF_PAUSER_MNEMONIC\\" | $CHAIN_BIN keys add $TF_PAUSER_KEY --recover --keyring-backend=\\"test\\"[39m
[32m-[39m
[32m- # Add genesis accounts for FiatTokenFactory roles[39m
[32m- $CHAIN_BIN $CHAIN_GENESIS_CMD add-genesis-account $($CHAIN_BIN keys show -a $FIATTF_OWNER_KEY --keyring-backend=\\"test\\") $COINS --keyring-backend=\\"test\\"[39m
[32m- $CHAIN_BIN $CHAIN_GENESIS_CMD add-genesis-account $($CHAIN_BIN keys show -a $FIATTF_MASTER_MINTER_KEY --keyring-backend=\\"test\\") $COINS --keyring-backend=\\"test\\"[39m
[32m- $CHAIN_BIN $CHAIN_GENESIS_CMD add-genesis-account $($CHAIN_BIN keys show -a $FIATTF_MINTER_CONTROLLER_KEY --keyring-backend=\\"test\\") $COINS --keyring-backend=\\"test\\"[39m
[32m- $CHAIN_BIN $CHAIN_GENESIS_CMD add-genesis-account $($CHAIN_BIN keys show -a $FIATTF_MINTER_CONTROLLER2_KEY --keyring-backend=\\"test\\") $COINS --keyring-backend=\\"test\\"[39m
[32m- $CHAIN_BIN $CHAIN_GENESIS_CMD add-genesis-account $($CHAIN_BIN keys show -a $FIATTF_MINTER_KEY --keyring-backend=\\"test\\") $COINS --keyring-backend=\\"test\\"[39m
[32m- $CHAIN_BIN $CHAIN_GENESIS_CMD add-genesis-account $($CHAIN_BIN keys show -a $FIATTF_BLACKLISTER_KEY --keyring-backend=\\"test\\") $COINS --keyring-backend=\\"test\\"[39m
[32m- $CHAIN_BIN $CHAIN_GENESIS_CMD add-genesis-account $($CHAIN_BIN keys show -a $FIATTF_PAUSER_KEY --keyring-backend=\\"test\\") $COINS --keyring-backend=\\"test\\"[39m
[32m-[39m
[32m- # Add genesis accounts for TokenFactory roles[39m
[32m- $CHAIN_BIN $CHAIN_GENESIS_CMD add-genesis-account $($CHAIN_BIN keys show -a $TF_OWNER_KEY --keyring-backend=\\"test\\") $COINS --keyring-backend=\\"test\\"[39m
[32m- $CHAIN_BIN $CHAIN_GENESIS_CMD add-genesis-account $($CHAIN_BIN keys show -a $TF_MASTER_MINTER_KEY --keyring-backend=\\"test\\") $COINS --keyring-backend=\\"test\\"[39m
[32m- $CHAIN_BIN $CHAIN_GENESIS_CMD add-genesis-account $($CHAIN_BIN keys show -a $TF_MINTER_CONTROLLER_KEY --keyring-backend=\\"test\\") $COINS --keyring-backend=\\"test\\"[39m
[32m- $CHAIN_BIN $CHAIN_GENESIS_CMD add-genesis-account $($CHAIN_BIN keys show -a $TF_MINTER_CONTROLLER2_KEY --keyring-backend=\\"test\\") $COINS --keyring-backend=\\"test\\"[39m
[32m- $CHAIN_BIN $CHAIN_GENESIS_CMD add-genesis-account $($CHAIN_BIN keys show -a $TF_MINTER_KEY --keyring-backend=\\"test\\") $COINS --keyring-backend=\\"test\\"[39m
[32m- $CHAIN_BIN $CHAIN_GENESIS_CMD add-genesis-account $($CHAIN_BIN keys show -a $TF_BLACKLISTER_KEY --keyring-backend=\\"test\\") $COINS --keyring-backend=\\"test\\"[39m
[32m- $CHAIN_BIN $CHAIN_GENESIS_CMD add-genesis-account $($CHAIN_BIN keys show -a $TF_PAUSER_KEY --keyring-backend=\\"test\\") $COINS --keyring-backend=\\"test\\"[39m
[32m-[39m
[32m- if [[ $FAUCET_ENABLED == \\"false\\" && $NUM_RELAYERS -gt \\"-1\\" ]];[39m
[32m- then[39m
[32m-   ## Add relayers keys and delegate tokens[39m
[32m-   for i in $(seq 0 $NUM_RELAYERS);[39m
[32m-   do[39m
[32m-     # Add relayer key and delegate tokens[39m
[32m-     RELAYER_KEY_NAME=\\"$(jq -r \\".relayers[$i].name\\" $KEYS_CONFIG)\\"[39m
[32m-     echo \\"Adding relayer key.... $RELAYER_KEY_NAME\\"[39m
[32m-     jq -r \\".relayers[$i].mnemonic\\" $KEYS_CONFIG | $CHAIN_BIN keys add $RELAYER_KEY_NAME --recover --keyring-backend=\\"test\\"[39m
[32m-     $CHAIN_BIN $CHAIN_GENESIS_CMD add-genesis-account $($CHAIN_BIN keys show -a $RELAYER_KEY_NAME --keyring-backend=\\"test\\") $COINS --keyring-backend=\\"test\\"[39m
[32m-     # Add relayer-cli key and delegate tokens[39m
[32m-     RELAYER_CLI_KEY_NAME=\\"$(jq -r \\".relayers_cli[$i].name\\" $KEYS_CONFIG)\\"[39m
[32m-     echo \\"Adding relayer-cli key.... $RELAYER_CLI_KEY_NAME\\"[39m
[32m-     jq -r \\".relayers_cli[$i].mnemonic\\" $KEYS_CONFIG | $CHAIN_BIN keys add $RELAYER_CLI_KEY_NAME --recover --keyring-backend=\\"test\\"[39m
[32m-     $CHAIN_BIN $CHAIN_GENESIS_CMD add-genesis-account $($CHAIN_BIN keys show -a $RELAYER_CLI_KEY_NAME --keyring-backend=\\"test\\") $COINS --keyring-backend=\\"test\\"[39m
[32m-   done[39m
[32m- fi[39m
[32m-[39m
[32m- ## if faucet not enabled then add validator and relayer with index as keys and into gentx[39m
[32m- if [[ $FAUCET_ENABLED == \\"false\\" && $NUM_VALIDATORS -gt \\"1\\" ]];[39m
[32m- then[39m
[32m-   ## Add validators key and delegate tokens[39m
[32m-   for i in $(seq 0 $NUM_VALIDATORS);[39m
[32m-   do[39m
[32m-     VAL_KEY_NAME=\\"$(jq -r '.validators[0].name' $KEYS_CONFIG)-$i\\"[39m
[32m-     echo \\"Adding validator key.... $VAL_KEY_NAME\\"[39m
[32m-     jq -r \\".validators[0].mnemonic\\" $KEYS_CONFIG | $CHAIN_BIN keys add $VAL_KEY_NAME --index $i --recover --keyring-backend=\\"test\\"[39m
[32m-     $CHAIN_BIN $CHAIN_GENESIS_CMD add-genesis-account $($CHAIN_BIN keys show -a $VAL_KEY_NAME --keyring-backend=\\"test\\") $COINS --keyring-backend=\\"test\\"[39m
[32m-   done[39m
[32m- fi[39m
[32m-[39m
[32m- echo \\"Creating gentx...\\"[39m
[32m- COIN=$(echo $COINS | cut -d ',' -f1)[39m
[32m- AMT=$(echo \${COIN//[!0-9]/} | sed -e \\"s/0000$//\\")[39m
[32m- $CHAIN_BIN $CHAIN_GENESIS_CMD gentx $(jq -r \\".genesis[0].name\\" $KEYS_CONFIG) $AMT$DENOM --keyring-backend=\\"test\\" --chain-id $CHAIN_ID[39m
[32m-[39m
[32m- echo \\"Output of gentx\\"[39m
[32m- cat $CHAIN_DIR/config/gentx/*.json | jq[39m
[32m-[39m
[32m- echo \\"Running collect-gentxs\\"[39m
[32m- $CHAIN_BIN $CHAIN_GENESIS_CMD collect-gentxs[39m
[32m-[39m
[32m- ls $CHAIN_DIR/config",[39m
[2m      "create-ics.sh": "#!/bin/bash[22m

[2m  set -euxo pipefail[22m
[33m@@ -505,6 +340,171 @@[39m
[2m    echo \\"cosmos_sdk_version is less than v0.50.0, running create-validator tx with old format\\"[22m
[2m    cosmos-sdk-version-default[22m
[2m  fi",[22m
[31m+     "createGenesis.sh": "#!/bin/bash[39m
[31m+[39m
[31m+ set -eux[39m
[31m+[39m
[31m+ DENOM=\\"\${DENOM:=uusdc}\\"[39m
[31m+ COINS=\\"\${COINS:=100000000000000uusdc,100000000000000ustake}\\"[39m
[31m+ CHAIN_ID=\\"\${CHAIN_ID:=noblelocal}\\"[39m
[31m+ CHAIN_BIN=\\"\${CHAIN_BIN:=nobled}\\"[39m
[31m+ CHAIN_DIR=\\"\${CHAIN_DIR:=$HOME/.nobled}\\"[39m
[31m+ KEYS_CONFIG=\\"\${KEYS_CONFIG:=configs/keys.json}\\"[39m
[31m+[39m
[31m+ FAUCET_ENABLED=\\"\${FAUCET_ENABLED:=true}\\"[39m
[31m+ NUM_VALIDATORS=\\"\${NUM_VALIDATORS:=1}\\"[39m
[31m+ NUM_RELAYERS=\\"\${NUM_RELAYERS:=0}\\"[39m
[31m+[39m
[31m+ # FiatTokenFactory roles[39m
[31m+ FIATTF_OWNER_KEY=\\"fiattf_owner\\"[39m
[31m+ FIATTF_OWNER_MNEMONIC=\\"gesture inject test cycle original hollow east ridge hen combine junk child bacon zero hope comfort vacuum milk pitch cage oppose unhappy lunar seat\\"[39m
[31m+[39m
[31m+ FIATTF_MASTER_MINTER_KEY=\\"fiattf_master_minter\\"[39m
[31m+ FIATTF_MASTER_MINTER_MNEMONIC=\\"maximum display century economy unlock van census kite error heart snow filter midnight usage egg venture cash kick motor survey drastic edge muffin visual\\"[39m
[31m+[39m
[31m+ FIATTF_MINTER_CONTROLLER_KEY=\\"fiattf_minter_controller\\"[39m
[31m+ FIATTF_MINTER_CONTROLLER_MNEMONIC=\\"keep liar demand upon shed essence tip undo eagle run people strong sense another salute double peasant egg royal hair report winner student diamond\\"[39m
[31m+[39m
[31m+ FIATTF_MINTER_CONTROLLER2_KEY=\\"fiattf_minter_controller2\\"[39m
[31m+ FIATTF_MINTER_CONTROLLER2_MNEMONIC=\\"morning person bachelor illegal inner note learn problem cement river half sentence junk evidence mercy intact step nasty cotton elite real unveil business drum\\"[39m
[31m+[39m
[31m+ FIATTF_MINTER_KEY=\\"fiattf_minter\\"[39m
[31m+ FIATTF_MINTER_MNEMONIC=\\"shed spike wish soda inside awake satoshi fish length whisper garlic sketch diary trumpet tree nose stove tobacco vague target announce brave alley priority\\"[39m
[31m+[39m
[31m+ FIATTF_BLACKLISTER_KEY=\\"fiattf_blacklister\\"[39m
[31m+ FIATTF_BLACKLISTER_MNEMONIC=\\"planet reunion diet obscure curious swim suit kitchen fiscal creek jeans doll disorder color gown sweet have search repair exhaust clap assault dwarf design\\"[39m
[31m+[39m
[31m+ FIATTF_PAUSER_KEY=\\"fiattf_pauser\\"[39m
[31m+ FIATTF_PAUSER_MNEMONIC=\\"guilt juice tone exhibit vault stairs mesh often expect face search quality paddle broccoli hundred another elder range horror beef session found loop mobile\\"[39m
[31m+[39m
[31m+ # TokenFactory roles[39m
[31m+ TF_OWNER_KEY=\\"tf_owner\\"[39m
[31m+ TF_OWNER_MNEMONIC=\\"poverty pride inject trumpet candy quiz mixed junk cricket food include involve uphold gasp wish gas save occur genius shoe slight occur sudden cute\\"[39m
[31m+[39m
[31m+ TF_MASTER_MINTER_KEY=\\"tf_master_minter\\"[39m
[31m+ TF_MASTER_MINTER_MNEMONIC=\\"belt cream catalog absurd hen toast ethics summer addict kick hood february spatial inmate cycle business double keep gravity private nose obvious phrase birth\\"[39m
[31m+[39m
[31m+ TF_MINTER_CONTROLLER_KEY=\\"tf_minter_controller\\"[39m
[31m+ TF_MINTER_CONTROLLER_MNEMONIC=\\"spider silk peasant tobacco cactus range draft merry fashion trick modify scale width omit admit face off property enact upper drink obvious off used\\"[39m
[31m+[39m
[31m+ TF_MINTER_CONTROLLER2_KEY=\\"tf_minter_controller2\\"[39m
[31m+ TF_MINTER_CONTROLLER2_MNEMONIC=\\"swear blossom hybrid write crash seven then ship brush market moral renew plug oval focus stairs brisk inner blue main barely broken burden fancy\\"[39m
[31m+[39m
[31m+ TF_MINTER_KEY=\\"tf_minter\\"[39m
[31m+ TF_MINTER_MNEMONIC=\\"muffin clog joy echo hello size reform mention patient pumpkin enough inside danger talk wire home doctor bone ensure bind arrest dizzy magnet arrest\\"[39m
[31m+[39m
[31m+ TF_BLACKLISTER_KEY=\\"tf_blacklister\\"[39m
[31m+ TF_BLACKLISTER_MNEMONIC=\\"gravity domain nothing stomach cousin print rally door bone ghost tuition opera witness paper color oak mistake toward current coach industry thought acid breeze\\"[39m
[31m+[39m
[31m+ TF_PAUSER_KEY=\\"tf_pauser\\"[39m
[31m+ TF_PAUSER_MNEMONIC=\\"sniff tail rotate pelican snap spawn champion thought recycle body caution grain brass armed hawk goat champion sunset soul answer panel present open room\\"[39m
[31m+[39m
[31m+ # check if the binary has genesis subcommand or not, if not, set CHAIN_GENESIS_CMD to empty[39m
[31m+ CHAIN_GENESIS_CMD=$($CHAIN_BIN 2>&1 | grep -q \\"genesis-related subcommands\\" && echo \\"genesis\\" || echo \\"\\")[39m
[31m+[39m
[31m+ CHAIN_INIT_ID=\\"$CHAIN_ID\\"[39m
[31m+ if [ \\"$CHAIN_BIN\\" == \\"osmosisd\\" ]; then[39m
[31m+   CHAIN_INIT_ID=\\"test-1\\"[39m
[31m+ fi[39m
[31m+ jq -r \\".genesis[0].mnemonic\\" $KEYS_CONFIG | $CHAIN_BIN init $CHAIN_ID --chain-id $CHAIN_INIT_ID --recover[39m
[31m+ sed -i -e \\"s/$CHAIN_INIT_ID/$CHAIN_ID/g\\" $CHAIN_DIR/config/genesis.json[39m
[31m+[39m
[31m+ # Add genesis keys to the keyring and self delegate initial coins[39m
[31m+ echo \\"Adding key....\\" $(jq -r \\".genesis[0].name\\" $KEYS_CONFIG)[39m
[31m+ jq -r \\".genesis[0].mnemonic\\" $KEYS_CONFIG | $CHAIN_BIN keys add $(jq -r \\".genesis[0].name\\" $KEYS_CONFIG) --recover --keyring-backend=\\"test\\"[39m
[31m+ $CHAIN_BIN $CHAIN_GENESIS_CMD add-genesis-account $($CHAIN_BIN keys show -a $(jq -r .genesis[0].name $KEYS_CONFIG) --keyring-backend=\\"test\\") $COINS --keyring-backend=\\"test\\"[39m
[31m+[39m
[31m+ # Add faucet key to the keyring and self delegate initial coins[39m
[31m+ echo \\"Adding key....\\" $(jq -r \\".faucet[0].name\\" $KEYS_CONFIG)[39m
[31m+ jq -r \\".faucet[0].mnemonic\\" $KEYS_CONFIG | $CHAIN_BIN keys add $(jq -r \\".faucet[0].name\\" $KEYS_CONFIG) --recover --keyring-backend=\\"test\\"[39m
[31m+ $CHAIN_BIN $CHAIN_GENESIS_CMD add-genesis-account $($CHAIN_BIN keys show -a $(jq -r .faucet[0].name $KEYS_CONFIG) --keyring-backend=\\"test\\") $COINS --keyring-backend=\\"test\\"[39m
[31m+[39m
[31m+ # Add test keys to the keyring and self delegate initial coins[39m
[31m+ echo \\"Adding key....\\" $(jq -r \\".keys[0].name\\" $KEYS_CONFIG)[39m
[31m+ jq -r \\".keys[0].mnemonic\\" $KEYS_CONFIG | $CHAIN_BIN keys add $(jq -r \\".keys[0].name\\" $KEYS_CONFIG) --recover --keyring-backend=\\"test\\"[39m
[31m+ $CHAIN_BIN $CHAIN_GENESIS_CMD add-genesis-account $($CHAIN_BIN keys show -a $(jq -r .keys[0].name $KEYS_CONFIG) --keyring-backend=\\"test\\") $COINS --keyring-backend=\\"test\\"[39m
[31m+[39m
[31m+ # Add FiatTokenFactory role keys[39m
[31m+ echo \\"Adding FiatTokenFactory role keys...\\"[39m
[31m+ echo \\"$FIATTF_OWNER_MNEMONIC\\" | $CHAIN_BIN keys add $FIATTF_OWNER_KEY --recover --keyring-backend=\\"test\\"[39m
[31m+ echo \\"$FIATTF_MASTER_MINTER_MNEMONIC\\" | $CHAIN_BIN keys add $FIATTF_MASTER_MINTER_KEY --recover --keyring-backend=\\"test\\"[39m
[31m+ echo \\"$FIATTF_MINTER_CONTROLLER_MNEMONIC\\" | $CHAIN_BIN keys add $FIATTF_MINTER_CONTROLLER_KEY --recover --keyring-backend=\\"test\\"[39m
[31m+ echo \\"$FIATTF_MINTER_CONTROLLER2_MNEMONIC\\" | $CHAIN_BIN keys add $FIATTF_MINTER_CONTROLLER2_KEY --recover --keyring-backend=\\"test\\"[39m
[31m+ echo \\"$FIATTF_MINTER_MNEMONIC\\" | $CHAIN_BIN keys add $FIATTF_MINTER_KEY --recover --keyring-backend=\\"test\\"[39m
[31m+ echo \\"$FIATTF_BLACKLISTER_MNEMONIC\\" | $CHAIN_BIN keys add $FIATTF_BLACKLISTER_KEY --recover --keyring-backend=\\"test\\"[39m
[31m+ echo \\"$FIATTF_PAUSER_MNEMONIC\\" | $CHAIN_BIN keys add $FIATTF_PAUSER_KEY --recover --keyring-backend=\\"test\\"[39m
[31m+[39m
[31m+ # Add TokenFactory role keys[39m
[31m+ echo \\"Adding TokenFactory role keys...\\"[39m
[31m+ echo \\"$TF_OWNER_MNEMONIC\\" | $CHAIN_BIN keys add $TF_OWNER_KEY --recover --keyring-backend=\\"test\\"[39m
[31m+ echo \\"$TF_MASTER_MINTER_MNEMONIC\\" | $CHAIN_BIN keys add $TF_MASTER_MINTER_KEY --recover --keyring-backend=\\"test\\"[39m
[31m+ echo \\"$TF_MINTER_CONTROLLER_MNEMONIC\\" | $CHAIN_BIN keys add $TF_MINTER_CONTROLLER_KEY --recover --keyring-backend=\\"test\\"[39m
[31m+ echo \\"$TF_MINTER_CONTROLLER2_MNEMONIC\\" | $CHAIN_BIN keys add $TF_MINTER_CONTROLLER2_KEY --recover --keyring-backend=\\"test\\"[39m
[31m+ echo \\"$TF_MINTER_MNEMONIC\\" | $CHAIN_BIN keys add $TF_MINTER_KEY --recover --keyring-backend=\\"test\\"[39m
[31m+ echo \\"$TF_BLACKLISTER_MNEMONIC\\" | $CHAIN_BIN keys add $TF_BLACKLISTER_KEY --recover --keyring-backend=\\"test\\"[39m
[31m+ echo \\"$TF_PAUSER_MNEMONIC\\" | $CHAIN_BIN keys add $TF_PAUSER_KEY --recover --keyring-backend=\\"test\\"[39m
[31m+[39m
[31m+ # Add genesis accounts for FiatTokenFactory roles[39m
[31m+ $CHAIN_BIN $CHAIN_GENESIS_CMD add-genesis-account $($CHAIN_BIN keys show -a $FIATTF_OWNER_KEY --keyring-backend=\\"test\\") $COINS --keyring-backend=\\"test\\"[39m
[31m+ $CHAIN_BIN $CHAIN_GENESIS_CMD add-genesis-account $($CHAIN_BIN keys show -a $FIATTF_MASTER_MINTER_KEY --keyring-backend=\\"test\\") $COINS --keyring-backend=\\"test\\"[39m
[31m+ $CHAIN_BIN $CHAIN_GENESIS_CMD add-genesis-account $($CHAIN_BIN keys show -a $FIATTF_MINTER_CONTROLLER_KEY --keyring-backend=\\"test\\") $COINS --keyring-backend=\\"test\\"[39m
[31m+ $CHAIN_BIN $CHAIN_GENESIS_CMD add-genesis-account $($CHAIN_BIN keys show -a $FIATTF_MINTER_CONTROLLER2_KEY --keyring-backend=\\"test\\") $COINS --keyring-backend=\\"test\\"[39m
[31m+ $CHAIN_BIN $CHAIN_GENESIS_CMD add-genesis-account $($CHAIN_BIN keys show -a $FIATTF_MINTER_KEY --keyring-backend=\\"test\\") $COINS --keyring-backend=\\"test\\"[39m
[31m+ $CHAIN_BIN $CHAIN_GENESIS_CMD add-genesis-account $($CHAIN_BIN keys show -a $FIATTF_BLACKLISTER_KEY --keyring-backend=\\"test\\") $COINS --keyring-backend=\\"test\\"[39m
[31m+ $CHAIN_BIN $CHAIN_GENESIS_CMD add-genesis-account $($CHAIN_BIN keys show -a $FIATTF_PAUSER_KEY --keyring-backend=\\"test\\") $COINS --keyring-backend=\\"test\\"[39m
[31m+[39m
[31m+ # Add genesis accounts for TokenFactory roles[39m
[31m+ $CHAIN_BIN $CHAIN_GENESIS_CMD add-genesis-account $($CHAIN_BIN keys show -a $TF_OWNER_KEY --keyring-backend=\\"test\\") $COINS --keyring-backend=\\"test\\"[39m
[31m+ $CHAIN_BIN $CHAIN_GENESIS_CMD add-genesis-account $($CHAIN_BIN keys show -a $TF_MASTER_MINTER_KEY --keyring-backend=\\"test\\") $COINS --keyring-backend=\\"test\\"[39m
[31m+ $CHAIN_BIN $CHAIN_GENESIS_CMD add-genesis-account $($CHAIN_BIN keys show -a $TF_MINTER_CONTROLLER_KEY --keyring-backend=\\"test\\") $COINS --keyring-backend=\\"test\\"[39m
[31m+ $CHAIN_BIN $CHAIN_GENESIS_CMD add-genesis-account $($CHAIN_BIN keys show -a $TF_MINTER_CONTROLLER2_KEY --keyring-backend=\\"test\\") $COINS --keyring-backend=\\"test\\"[39m
[31m+ $CHAIN_BIN $CHAIN_GENESIS_CMD add-genesis-account $($CHAIN_BIN keys show -a $TF_MINTER_KEY --keyring-backend=\\"test\\") $COINS --keyring-backend=\\"test\\"[39m
[31m+ $CHAIN_BIN $CHAIN_GENESIS_CMD add-genesis-account $($CHAIN_BIN keys show -a $TF_BLACKLISTER_KEY --keyring-backend=\\"test\\") $COINS --keyring-backend=\\"test\\"[39m
[31m+ $CHAIN_BIN $CHAIN_GENESIS_CMD add-genesis-account $($CHAIN_BIN keys show -a $TF_PAUSER_KEY --keyring-backend=\\"test\\") $COINS --keyring-backend=\\"test\\"[39m
[31m+[39m
[31m+ if [[ $FAUCET_ENABLED == \\"false\\" && $NUM_RELAYERS -gt \\"-1\\" ]];[39m
[31m+ then[39m
[31m+   ## Add relayers keys and delegate tokens[39m
[31m+   for i in $(seq 0 $NUM_RELAYERS);[39m
[31m+   do[39m
[31m+     # Add relayer key and delegate tokens[39m
[31m+     RELAYER_KEY_NAME=\\"$(jq -r \\".relayers[$i].name\\" $KEYS_CONFIG)\\"[39m
[31m+     echo \\"Adding relayer key.... $RELAYER_KEY_NAME\\"[39m
[31m+     jq -r \\".relayers[$i].mnemonic\\" $KEYS_CONFIG | $CHAIN_BIN keys add $RELAYER_KEY_NAME --recover --keyring-backend=\\"test\\"[39m
[31m+     $CHAIN_BIN $CHAIN_GENESIS_CMD add-genesis-account $($CHAIN_BIN keys show -a $RELAYER_KEY_NAME --keyring-backend=\\"test\\") $COINS --keyring-backend=\\"test\\"[39m
[31m+     # Add relayer-cli key and delegate tokens[39m
[31m+     RELAYER_CLI_KEY_NAME=\\"$(jq -r \\".relayers_cli[$i].name\\" $KEYS_CONFIG)\\"[39m
[31m+     echo \\"Adding relayer-cli key.... $RELAYER_CLI_KEY_NAME\\"[39m
[31m+     jq -r \\".relayers_cli[$i].mnemonic\\" $KEYS_CONFIG | $CHAIN_BIN keys add $RELAYER_CLI_KEY_NAME --recover --keyring-backend=\\"test\\"[39m
[31m+     $CHAIN_BIN $CHAIN_GENESIS_CMD add-genesis-account $($CHAIN_BIN keys show -a $RELAYER_CLI_KEY_NAME --keyring-backend=\\"test\\") $COINS --keyring-backend=\\"test\\"[39m
[31m+   done[39m
[31m+ fi[39m
[31m+[39m
[31m+ ## if faucet not enabled then add validator and relayer with index as keys and into gentx[39m
[31m+ if [[ $FAUCET_ENABLED == \\"false\\" && $NUM_VALIDATORS -gt \\"1\\" ]];[39m
[31m+ then[39m
[31m+   ## Add validators key and delegate tokens[39m
[31m+   for i in $(seq 0 $NUM_VALIDATORS);[39m
[31m+   do[39m
[31m+     VAL_KEY_NAME=\\"$(jq -r '.validators[0].name' $KEYS_CONFIG)-$i\\"[39m
[31m+     echo \\"Adding validator key.... $VAL_KEY_NAME\\"[39m
[31m+     jq -r \\".validators[0].mnemonic\\" $KEYS_CONFIG | $CHAIN_BIN keys add $VAL_KEY_NAME --index $i --recover --keyring-backend=\\"test\\"[39m
[31m+     $CHAIN_BIN $CHAIN_GENESIS_CMD add-genesis-account $($CHAIN_BIN keys show -a $VAL_KEY_NAME --keyring-backend=\\"test\\") $COINS --keyring-backend=\\"test\\"[39m
[31m+   done[39m
[31m+ fi[39m
[31m+[39m
[31m+ echo \\"Creating gentx...\\"[39m
[31m+ COIN=$(echo $COINS | cut -d ',' -f1)[39m
[31m+ AMT=$(echo \${COIN//[!0-9]/} | sed -e \\"s/0000$//\\")[39m
[31m+ $CHAIN_BIN $CHAIN_GENESIS_CMD gentx $(jq -r \\".genesis[0].name\\" $KEYS_CONFIG) $AMT$DENOM --keyring-backend=\\"test\\" --chain-id $CHAIN_ID[39m
[31m+[39m
[31m+ echo \\"Output of gentx\\"[39m
[31m+ cat $CHAIN_DIR/config/gentx/*.json | jq[39m
[31m+[39m
[31m+ echo \\"Running collect-gentxs\\"[39m
[31m+ $CHAIN_BIN $CHAIN_GENESIS_CMD collect-gentxs[39m
[31m+[39m
[31m+ ls $CHAIN_DIR/config",[39m
[2m      "ibc-connection.sh": "#!/bin/bash[22m

[2m  REGISTRY_URL=\\"$1\\"[22m
[33m@@ -633,7 +633,7 @@[39m
[2m  sed -i -e \\"s#timeout_precommit = \\\\\\".*\\\\\\"#timeout_precommit = \\\\\\"$TIMEOUT_PRECOMMIT\\\\\\"#g\\" $CHAIN_DIR/config/config.toml[22m
[2m  sed -i -e \\"s#timeout_precommit_delta = \\\\\\".*\\\\\\"#timeout_precommit_delta = \\\\\\"$TIMEOUT_PRECOMMIT_DELTA\\\\\\"#g\\" $CHAIN_DIR/config/config.toml[22m
[2m  sed -i -e \\"s#timeout_commit = \\\\\\".*\\\\\\"#timeout_commit = \\\\\\"$TIMEOUT_COMMIT\\\\\\"#g\\" $CHAIN_DIR/config/config.toml",[22m
[32m-     "update-genesis.sh": "#!/bin/bash[39m
[31m+     "updateGenesis.sh": "#!/bin/bash[39m

[2m  DENOM=\\"\${DENOM:=uusdc}\\"[22m
[2m  CHAIN_BIN=\\"\${CHAIN_BIN:=nobled}\\"[22m
[33m@@ -914,6 +914,17 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts-noble-1",[39m
[31m+       "app.kubernetes.io/part-of": "noble-1",[39m
[31m+       "app.kubernetes.io/role": "setup-scripts",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-id": "noble-1",[39m
[31m+       "starship.io/chain-name": "noble",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts-noble-1",[22m
[2m    },[22m
[2m  }[22m

--- ConfigMap/registry-cosmoshub-4 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -7,7 +7,14 @@[39m
[2m    \\"assets\\": [[22m
[2m      {[22m
[2m        \\"base\\": \\"uatom\\",[22m
[32m-       \\"coingecko_id\\": \\"atom\\",[39m
[31m+       \\"description\\": \\"The native staking and governance token of the Cosmos Hub.\\",[39m
[31m+       \\"name\\": \\"Cosmos Hub Atom\\",[39m
[31m+       \\"display\\": \\"atom\\",[39m
[31m+       \\"symbol\\": \\"ATOM\\",[39m
[31m+       \\"logo_URIs\\": {[39m
[31m+         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/cosmoshub/images/atom.png\\",[39m
[31m+         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/cosmoshub/images/atom.svg\\"[39m
[31m+       },[39m
[2m        \\"denom_units\\": [[22m
[2m          {[22m
[2m            \\"denom\\": \\"uatom\\",[22m
[33m@@ -18,14 +25,7 @@[39m
[2m            \\"exponent\\": 6[22m
[2m          }[22m
[2m        ],[22m
[32m-       \\"description\\": \\"The native staking and governance token of the Cosmos Hub.\\",[39m
[32m-       \\"display\\": \\"atom\\",[39m
[32m-       \\"logo_URIs\\": {[39m
[32m-         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/cosmoshub/images/atom.png\\",[39m
[32m-         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/cosmoshub/images/atom.svg\\"[39m
[32m-       },[39m
[32m-       \\"name\\": \\"Cosmos Hub Atom\\",[39m
[32m-       \\"symbol\\": \\"ATOM\\"[39m
[31m+       \\"coingecko_id\\": \\"atom\\"[39m
[2m      }[22m
[2m    ][22m
[2m  }",[22m
[33m@@ -82,6 +82,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "registry",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "registry-cosmoshub-4",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "registry-cosmoshub-4",[22m
[2m    },[22m
[2m  }[22m

--- Deployment/registry ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,14 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "Deployment",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "registry",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "registry",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "registry",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +17,6 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "registry",[39m
[2m          "app.kubernetes.io/name": "registry",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -22,19 +29,17 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "registry",[39m
[31m+           "app.kubernetes.io/component": "registry",[39m
[31m+           "app.kubernetes.io/managed-by": "starship",[39m
[2m            "app.kubernetes.io/name": "registry",[22m
[32m-           "app.kubernetes.io/rawname": "registry",[39m
[32m-           "app.kubernetes.io/type": "registry",[39m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/part-of": "starship",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+           "starship.io/name": "starship-e2e-tests",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[2m          "containers": Array [[22m
[2m            Object {[22m
[32m-             "command": Array [[39m
[32m-               "registry",[39m
[32m-             ],[39m
[2m              "env": Array [[22m
[2m                Object {[22m
[2m                  "name": "NAMESPACE",[22m
[33m@@ -74,21 +79,20 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "REGISTRY_CHAIN_REGISTRY",[22m
[32m-                 "value": "/configs",[39m
[31m+                 "value": "/chains",[39m
[2m                },[22m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/registry:20250205-544757d",[22m
[32m-             "imagePullPolicy": "IfNotPresent",[39m
[2m              "livenessProbe": Object {[22m
[32m-               "initialDelaySeconds": 20,[39m
[32m-               "periodSeconds": 10,[39m
[31m+               "initialDelaySeconds": 15,[39m
[31m+               "periodSeconds": 20,[39m
[2m                "tcpSocket": Object {[22m
[2m                  "port": 8080,[22m
[2m                },[22m
[2m              },[22m
[2m              "name": "registry",[22m
[2m              "readinessProbe": Object {[22m
[32m-               "initialDelaySeconds": 20,[39m
[31m+               "initialDelaySeconds": 5,[39m
[2m                "periodSeconds": 10,[22m
[2m                "tcpSocket": Object {[22m
[2m                  "port": 8080,[22m
[33m@@ -96,22 +100,22 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[2m                Object {[22m
[32m-                 "mountPath": "/configs/cosmoshub-4",[39m
[32m-                 "name": "registry-configs-cosmoshub-4",[39m
[31m+                 "mountPath": "/chains/cosmoshub-4",[39m
[31m+                 "name": "registry-cosmoshub-4",[39m
[2m                },[22m
[2m                Object {[22m
[32m-                 "mountPath": "/configs/noble-1",[39m
[32m-                 "name": "registry-configs-noble-1",[39m
[31m+                 "mountPath": "/chains/noble-1",[39m
[31m+                 "name": "registry-noble-1",[39m
[2m                },[22m
[2m              ],[22m
[2m            },[22m
[33m@@ -126,6 +130,7 @@[39m
[2m    echo \\"Checking: http://noble-1-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id\\"[22m
[2m    sleep 10;[22m
[2m  done[22m
[31m+[39m
[2m  while [ $(curl -sw '%{http_code}' http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id -o /dev/null) -ne 200 ]; do[22m
[2m    echo \\"Genesis validator does not seem to be ready for: cosmoshub-4. Waiting for it to start...\\"[22m
[2m    echo \\"Checking: http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id\\"[22m
[33m@@ -148,16 +153,16 @@[39m
[2m                  },[22m
[2m                },[22m
[2m              ],[22m
[32m-             "image": "curlimages/curl",[39m
[31m+             "image": "curlimages/curl:latest",[39m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "wait-for-chains",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -168,13 +173,13 @@[39m
[2m              "configMap": Object {[22m
[2m                "name": "registry-cosmoshub-4",[22m
[2m              },[22m
[32m-             "name": "registry-configs-cosmoshub-4",[39m
[31m+             "name": "registry-cosmoshub-4",[39m
[2m            },[22m
[2m            Object {[22m
[2m              "configMap": Object {[22m
[2m                "name": "registry-noble-1",[22m
[2m              },[22m
[32m-             "name": "registry-configs-noble-1",[39m
[31m+             "name": "registry-noble-1",[39m
[2m            },[22m
[2m          ],[22m
[2m        },[22m

--- ConfigMap/registry-noble-1 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -7,7 +7,14 @@[39m
[2m    \\"assets\\": [[22m
[2m      {[22m
[2m        \\"base\\": \\"uusdc\\",[22m
[32m-       \\"coingecko_id\\": \\"usdc\\",[39m
[31m+       \\"description\\": \\"USD Coin\\",[39m
[31m+       \\"name\\": \\"USDC\\",[39m
[31m+       \\"display\\": \\"usdc\\",[39m
[31m+       \\"symbol\\": \\"USDC\\",[39m
[31m+       \\"logo_URIs\\": {[39m
[31m+         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/noble/images/noble.png\\",[39m
[31m+         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/noble/images/noble.svg\\"[39m
[31m+       },[39m
[2m        \\"denom_units\\": [[22m
[2m          {[22m
[2m            \\"denom\\": \\"uusdc\\",[22m
[33m@@ -18,21 +25,21 @@[39m
[2m            \\"exponent\\": 6[22m
[2m          }[22m
[2m        ],[22m
[32m-       \\"description\\": \\"USD Coin\\",[39m
[32m-       \\"display\\": \\"usdc\\",[39m
[31m+       \\"coingecko_id\\": \\"usdc\\",[39m
[2m        \\"keywords\\": [[22m
[2m          \\"usdc\\"[22m
[32m-       ],[39m
[32m-       \\"logo_URIs\\": {[39m
[32m-         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/noble/images/noble.png\\",[39m
[32m-         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/noble/images/noble.svg\\"[39m
[32m-       },[39m
[32m-       \\"name\\": \\"USDC\\",[39m
[32m-       \\"symbol\\": \\"USDC\\"[39m
[31m+       ][39m
[2m      },[22m
[2m      {[22m
[2m        \\"base\\": \\"ustake\\",[22m
[32m-       \\"coingecko_id\\": \\"stake\\",[39m
[31m+       \\"description\\": \\"Permissioned stake token for noble\\",[39m
[31m+       \\"name\\": \\"Stake\\",[39m
[31m+       \\"display\\": \\"stake\\",[39m
[31m+       \\"symbol\\": \\"STAKE\\",[39m
[31m+       \\"logo_URIs\\": {[39m
[31m+         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/noble/images/stake.png\\",[39m
[31m+         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/noble/images/stake.svg\\"[39m
[31m+       },[39m
[2m        \\"denom_units\\": [[22m
[2m          {[22m
[2m            \\"denom\\": \\"ustake\\",[22m
[33m@@ -43,17 +50,10 @@[39m
[2m            \\"exponent\\": 6[22m
[2m          }[22m
[2m        ],[22m
[32m-       \\"description\\": \\"Permissioned stake token for noble\\",[39m
[32m-       \\"display\\": \\"stake\\",[39m
[31m+       \\"coingecko_id\\": \\"stake\\",[39m
[2m        \\"keywords\\": [[22m
[2m          \\"stake\\"[22m
[32m-       ],[39m
[32m-       \\"logo_URIs\\": {[39m
[32m-         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/noble/images/stake.png\\",[39m
[32m-         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/noble/images/stake.svg\\"[39m
[32m-       },[39m
[32m-       \\"name\\": \\"Stake\\",[39m
[32m-       \\"symbol\\": \\"STAKE\\"[39m
[31m+       ][39m
[2m      }[22m
[2m    ][22m
[2m  }",[22m
[33m@@ -110,6 +110,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "registry",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "registry-noble-1",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "registry-noble-1",[22m
[2m    },[22m
[2m  }[22m

--- ConfigMap/hermes-noble-cosmos ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -3,92 +3,45 @@[39m
[2m    "data": Object {[22m
[2m      "config-cli.toml": "# The global section has parameters that apply globally to the relayer operation.[22m
[2m  [global][22m
[32m- # Specify the verbosity for the relayer logging output. Default: 'info'[39m
[32m- # Valid options are 'error', 'warn', 'info', 'debug', 'trace'.[39m
[32m- log_level = 'info'[39m
[32m- # Specify the mode to be used by the relayer. [Required][39m
[31m+ log_level = \\"info\\"[39m
[31m+[39m
[2m  [mode][22m
[32m- # Specify the client mode.[39m
[2m  [mode.clients][22m
[32m- # Whether or not to enable the client workers. [Required][39m
[2m  enabled = true[22m
[32m- # Whether or not to enable periodic refresh of clients. [Default: true][39m
[32m- # This feature only applies to clients that underlie an open channel.[39m
[32m- # For Tendermint clients, the frequency at which Hermes refreshes them is 2/3 of their[39m
[32m- # trusting period (e.g., refresh every ~9 days if the trusting period is 14 days).[39m
[32m- # Note: Even if this is disabled, clients will be refreshed automatically if[39m
[32m- #      there is activity on a connection or channel they are involved with.[39m
[2m  refresh = true[22m
[32m- # Whether or not to enable misbehaviour detection for clients. [Default: false][39m
[2m  misbehaviour = true[22m
[32m- # Specify the connections mode.[39m
[31m+[39m
[2m  [mode.connections][22m
[32m- # Whether or not to enable the connection workers for handshake completion. [Required][39m
[2m  enabled = true[22m
[32m- # Specify the channels mode.[39m
[31m+[39m
[2m  [mode.channels][22m
[32m- # Whether or not to enable the channel workers for handshake completion. [Required][39m
[2m  enabled = true[22m
[32m- # Specify the packets mode.[39m
[31m+[39m
[2m  [mode.packets][22m
[32m- # Whether or not to enable the packet workers. [Required][39m
[2m  enabled = true[22m
[32m- # Parametrize the periodic packet clearing feature.[39m
[32m- # Interval (in number of blocks) at which pending packets[39m
[32m- # should be periodically cleared. A value of '0' will disable[39m
[32m- # periodic packet clearing. [Default: 100][39m
[2m  clear_interval = 100[22m
[32m- # Whether or not to clear packets on start. [Default: false][39m
[2m  clear_on_start = true[22m
[32m- # Toggle the transaction confirmation mechanism.[39m
[32m- # The tx confirmation mechanism periodically queries the \`/tx_search\` RPC[39m
[32m- # endpoint to check that previously-submitted transactions[39m
[32m- # (to any chain in this config file) have been successfully delivered.[39m
[32m- # If they have not been, and \`clear_interval = 0\`, then those packets are[39m
[32m- # queued up for re-submission.[39m
[32m- # Experimental feature. Affects telemetry if set to false.[39m
[32m- # [Default: true][39m
[2m  tx_confirmation = true[22m
[32m- # Auto register the counterparty payee on a destination chain to[39m
[32m- # the relayer's address on the source chain. This can be used[39m
[32m- # for simple configuration of the relayer to receive fees for[39m
[32m- # relaying RecvPacket on fee-enabled channels.[39m
[32m- # For more complex configuration, turn this off and use the CLI[39m
[32m- # to manually register the payee addresses.[39m
[32m- # [Default: false][39m
[32m- auto_register_counterparty_payee = false[39m
[32m- # The REST section defines parameters for Hermes' built-in RESTful API.[39m
[32m- # https://hermes.informal.systems/rest.html[39m
[31m+[39m
[2m  [rest][22m
[32m- # Whether or not to enable the REST service. Default: false[39m
[2m  enabled = true[22m
[32m- # Specify the IPv4/6 host over which the built-in HTTP server will serve the RESTful[39m
[32m- # API requests. Default: 127.0.0.1[39m
[32m- host =  '0.0.0.0'[39m
[32m- # Specify the port over which the built-in HTTP server will serve the restful API[39m
[32m- # requests. Default: 3000[39m
[31m+ host = \\"0.0.0.0\\"[39m
[2m  port = 3000[22m
[32m- # The telemetry section defines parameters for Hermes' built-in telemetry capabilities.[39m
[32m- # https://hermes.informal.systems/telemetry.html[39m
[31m+[39m
[2m  [telemetry][22m
[32m- # Whether or not to enable the telemetry service. Default: false[39m
[2m  enabled = true[22m
[32m- # Specify the IPv4/6 host over which the built-in HTTP server will serve the metrics[39m
[32m- # gathered by the telemetry service. Default: 127.0.0.1[39m
[32m- host = '0.0.0.0'[39m
[32m- # Specify the port over which the built-in HTTP server will serve the metrics gathered[39m
[32m- # by the telemetry service. Default: 3001[39m
[31m+ host = \\"0.0.0.0\\"[39m
[2m  port = 3001[22m
[32m-[39m


[2m  [[chains]][22m
[2m  id = \\"noble-1\\"[22m
[31m+ type = \\"CosmosSdk\\"[39m
[2m  key_name = \\"noble-1-cli\\"[22m
[32m- rpc_addr = \\"http://noble-1-genesis.default.svc.cluster.local:26657\\"[39m
[32m- grpc_addr = \\"http://noble-1-genesis.default.svc.cluster.local:9090\\"[39m
[32m- event_source = { mode = 'push', url = \\"ws://noble-1-genesis.default.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[32m- # Experimental: Whether or not the full node is trusted.[39m
[31m+[39m
[31m+ rpc_addr = \\"http://noble-1-genesis.$NAMESPACE.svc.cluster.local:26657\\"[39m
[31m+ grpc_addr = \\"http://noble-1-genesis.$NAMESPACE.svc.cluster.local:9090\\"[39m
[31m+ event_source = { mode = 'push', url = \\"ws://noble-1-genesis.$NAMESPACE.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[2m  trusted_node = false[22m
[2m  account_prefix = \\"noble\\"[22m
[2m  default_gas = 500000000[22m
[33m@@ -103,17 +56,16 @@[39m
[2m  trusting_period = \\"75s\\"[22m
[2m  trust_threshold = { numerator = \\"2\\", denominator = \\"3\\" }[22m
[2m  address_type = { derivation = 'cosmos' }[22m
[32m- gas_price = { price = 0.25, denom = \\"uusdc\\" }[39m
[32m-[39m
[32m-[39m
[31m+ gas_price = { price = 1.25, denom = \\"uusdc\\" }[39m

[2m  [[chains]][22m
[2m  id = \\"cosmoshub-4\\"[22m
[31m+ type = \\"CosmosSdk\\"[39m
[2m  key_name = \\"cosmoshub-4-cli\\"[22m
[32m- rpc_addr = \\"http://cosmoshub-4-genesis.default.svc.cluster.local:26657\\"[39m
[32m- grpc_addr = \\"http://cosmoshub-4-genesis.default.svc.cluster.local:9090\\"[39m
[32m- event_source = { mode = 'push', url = \\"ws://cosmoshub-4-genesis.default.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[32m- # Experimental: Whether or not the full node is trusted.[39m
[31m+[39m
[31m+ rpc_addr = \\"http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:26657\\"[39m
[31m+ grpc_addr = \\"http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:9090\\"[39m
[31m+ event_source = { mode = 'push', url = \\"ws://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[2m  trusted_node = false[22m
[2m  account_prefix = \\"cosmos\\"[22m
[2m  default_gas = 500000000[22m
[33m@@ -128,96 +80,48 @@[39m
[2m  trusting_period = \\"75s\\"[22m
[2m  trust_threshold = { numerator = \\"2\\", denominator = \\"3\\" }[22m
[2m  address_type = { derivation = 'cosmos' }[22m
[32m- gas_price = { price = 0.25, denom = \\"uatom\\" }",[39m
[31m+ gas_price = { price = 1.25, denom = \\"uatom\\" }",[39m
[2m      "config.toml": "# The global section has parameters that apply globally to the relayer operation.[22m
[2m  [global][22m
[32m- # Specify the verbosity for the relayer logging output. Default: 'info'[39m
[32m- # Valid options are 'error', 'warn', 'info', 'debug', 'trace'.[39m
[32m- log_level = 'info'[39m
[32m- # Specify the mode to be used by the relayer. [Required][39m
[31m+ log_level = \\"info\\"[39m
[31m+[39m
[2m  [mode][22m
[32m- # Specify the client mode.[39m
[2m  [mode.clients][22m
[32m- # Whether or not to enable the client workers. [Required][39m
[2m  enabled = true[22m
[32m- # Whether or not to enable periodic refresh of clients. [Default: true][39m
[32m- # This feature only applies to clients that underlie an open channel.[39m
[32m- # For Tendermint clients, the frequency at which Hermes refreshes them is 2/3 of their[39m
[32m- # trusting period (e.g., refresh every ~9 days if the trusting period is 14 days).[39m
[32m- # Note: Even if this is disabled, clients will be refreshed automatically if[39m
[32m- #      there is activity on a connection or channel they are involved with.[39m
[2m  refresh = true[22m
[32m- # Whether or not to enable misbehaviour detection for clients. [Default: false][39m
[2m  misbehaviour = true[22m
[32m- # Specify the connections mode.[39m
[31m+[39m
[2m  [mode.connections][22m
[32m- # Whether or not to enable the connection workers for handshake completion. [Required][39m
[2m  enabled = true[22m
[32m- # Specify the channels mode.[39m
[31m+[39m
[2m  [mode.channels][22m
[32m- # Whether or not to enable the channel workers for handshake completion. [Required][39m
[2m  enabled = true[22m
[32m- # Specify the packets mode.[39m
[31m+[39m
[2m  [mode.packets][22m
[32m- # Whether or not to enable the packet workers. [Required][39m
[2m  enabled = true[22m
[32m- # Parametrize the periodic packet clearing feature.[39m
[32m- # Interval (in number of blocks) at which pending packets[39m
[32m- # should be periodically cleared. A value of '0' will disable[39m
[32m- # periodic packet clearing. [Default: 100][39m
[2m  clear_interval = 100[22m
[32m- # Whether or not to clear packets on start. [Default: false][39m
[2m  clear_on_start = true[22m
[32m- # Toggle the transaction confirmation mechanism.[39m
[32m- # The tx confirmation mechanism periodically queries the \`/tx_search\` RPC[39m
[32m- # endpoint to check that previously-submitted transactions[39m
[32m- # (to any chain in this config file) have been successfully delivered.[39m
[32m- # If they have not been, and \`clear_interval = 0\`, then those packets are[39m
[32m- # queued up for re-submission.[39m
[32m- # Experimental feature. Affects telemetry if set to false.[39m
[32m- # [Default: true][39m
[2m  tx_confirmation = true[22m
[32m- # Auto register the counterparty payee on a destination chain to[39m
[32m- # the relayer's address on the source chain. This can be used[39m
[32m- # for simple configuration of the relayer to receive fees for[39m
[32m- # relaying RecvPacket on fee-enabled channels.[39m
[32m- # For more complex configuration, turn this off and use the CLI[39m
[32m- # to manually register the payee addresses.[39m
[32m- # [Default: false][39m
[32m- auto_register_counterparty_payee = false[39m
[32m- # The REST section defines parameters for Hermes' built-in RESTful API.[39m
[32m- # https://hermes.informal.systems/rest.html[39m
[31m+[39m
[2m  [rest][22m
[32m- # Whether or not to enable the REST service. Default: false[39m
[2m  enabled = true[22m
[32m- # Specify the IPv4/6 host over which the built-in HTTP server will serve the RESTful[39m
[32m- # API requests. Default: 127.0.0.1[39m
[32m- host =  '0.0.0.0'[39m
[32m- # Specify the port over which the built-in HTTP server will serve the restful API[39m
[32m- # requests. Default: 3000[39m
[31m+ host = \\"0.0.0.0\\"[39m
[2m  port = 3000[22m
[32m- # The telemetry section defines parameters for Hermes' built-in telemetry capabilities.[39m
[32m- # https://hermes.informal.systems/telemetry.html[39m
[31m+[39m
[2m  [telemetry][22m
[32m- # Whether or not to enable the telemetry service. Default: false[39m
[2m  enabled = true[22m
[32m- # Specify the IPv4/6 host over which the built-in HTTP server will serve the metrics[39m
[32m- # gathered by the telemetry service. Default: 127.0.0.1[39m
[32m- host = '0.0.0.0'[39m
[32m- # Specify the port over which the built-in HTTP server will serve the metrics gathered[39m
[32m- # by the telemetry service. Default: 3001[39m
[31m+ host = \\"0.0.0.0\\"[39m
[2m  port = 3001[22m
[32m-[39m


[2m  [[chains]][22m
[2m  id = \\"noble-1\\"[22m
[2m  type = \\"CosmosSdk\\"[22m
[2m  key_name = \\"noble-1\\"[22m
[32m- rpc_addr = \\"http://noble-1-genesis.default.svc.cluster.local:26657\\"[39m
[32m- grpc_addr = \\"http://noble-1-genesis.default.svc.cluster.local:9090\\"[39m
[32m- event_source = { mode = 'push', url = \\"ws://noble-1-genesis.default.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[32m- # Experimental: Whether or not the full node is trusted.[39m
[31m+[39m
[31m+ rpc_addr = \\"http://noble-1-genesis.$NAMESPACE.svc.cluster.local:26657\\"[39m
[31m+ grpc_addr = \\"http://noble-1-genesis.$NAMESPACE.svc.cluster.local:9090\\"[39m
[31m+ event_source = { mode = 'push', url = \\"ws://noble-1-genesis.$NAMESPACE.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[2m  trusted_node = false[22m
[2m  account_prefix = \\"noble\\"[22m
[2m  default_gas = 500000000[22m
[33m@@ -233,17 +137,15 @@[39m
[2m  trust_threshold = { numerator = \\"2\\", denominator = \\"3\\" }[22m
[2m  address_type = { derivation = 'cosmos' }[22m
[2m  gas_price = { price = 1.25, denom = \\"uusdc\\" }[22m
[32m-[39m
[32m-[39m

[2m  [[chains]][22m
[2m  id = \\"cosmoshub-4\\"[22m
[2m  type = \\"CosmosSdk\\"[22m
[2m  key_name = \\"cosmoshub-4\\"[22m
[32m- rpc_addr = \\"http://cosmoshub-4-genesis.default.svc.cluster.local:26657\\"[39m
[32m- grpc_addr = \\"http://cosmoshub-4-genesis.default.svc.cluster.local:9090\\"[39m
[32m- event_source = { mode = 'push', url = \\"ws://cosmoshub-4-genesis.default.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[32m- # Experimental: Whether or not the full node is trusted.[39m
[31m+[39m
[31m+ rpc_addr = \\"http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:26657\\"[39m
[31m+ grpc_addr = \\"http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:9090\\"[39m
[31m+ event_source = { mode = 'push', url = \\"ws://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[2m  trusted_node = false[22m
[2m  account_prefix = \\"cosmos\\"[22m
[2m  default_gas = 500000000[22m
[33m@@ -262,6 +164,15 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "relayer",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "hermes-noble-cosmos",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/role": "hermes",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "hermes-noble-cosmos",[22m
[2m    },[22m
[2m  }[22m

--- StatefulSet/hermes-noble-cosmos ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,15 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "relayer",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "hermes-noble-cosmos",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/role": "hermes",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "hermes-noble-cosmos",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -29,16 +38,18 @@[39m
[2m            "app.kubernetes.io/name": "hermes-noble-cosmos",[22m
[2m            "app.kubernetes.io/rawname": "noble-cosmos",[22m
[2m            "app.kubernetes.io/type": "hermes",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[2m          "containers": Array [[22m
[2m            Object {[22m
[31m+             "args": Array [[39m
[31m+               "/exposer/exposer",[39m
[31m+             ],[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "/exposer/exposer",[39m
[2m              ],[22m
[2m              "env": Array [[22m
[2m                Object {[22m
[33m@@ -55,11 +66,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -83,14 +94,24 @@[39m
[2m              ],[22m
[2m            },[22m
[2m            Object {[22m
[31m+             "args": Array [[39m
[31m+               "RLY_INDEX=\${HOSTNAME##*-}[39m
[31m+ echo \\"Relayer Index: $RLY_INDEX\\"[39m
[31m+ hermes start",[39m
[31m+             ],[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "RLY_INDEX=\${HOSTNAME##*-}[39m
[32m- echo \\"Relayer Index: $RLY_INDEX\\"[39m
[32m- hermes start",[39m
[2m              ],[22m
[2m              "env": Array [[22m
[31m+               Object {[39m
[31m+                 "name": "NAMESPACE",[39m
[31m+                 "valueFrom": Object {[39m
[31m+                   "fieldRef": Object {[39m
[31m+                     "fieldPath": "metadata.namespace",[39m
[31m+                   },[39m
[31m+                 },[39m
[31m+               },[39m
[2m                Object {[22m
[2m                  "name": "RELAYER_DIR",[22m
[2m                  "value": "/root/.hermes",[22m
[33m@@ -101,12 +122,12 @@[39m
[2m              "name": "relayer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[2m              },[22m
[2m              "securityContext": Object {[22m
[33m@@ -127,24 +148,26 @@[39m
[2m          ],[22m
[2m          "initContainers": Array [[22m
[2m            Object {[22m
[31m+             "args": Array [[39m
[31m+               "# Install exposer binary from the image[39m
[31m+ cp /bin/exposer /exposer/exposer[39m
[31m+ chmod +x /exposer/exposer",[39m
[31m+             ],[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "# Install exposer binary from the image[39m
[32m- cp /bin/exposer /exposer/exposer[39m
[32m- chmod +x /exposer/exposer",[39m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/exposer:20250205-544757d",[22m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "init-exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "100M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "100M",[39m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[33m@@ -155,9 +178,7 @@[39m
[2m              ],[22m
[2m            },[22m
[2m            Object {[22m
[32m-             "command": Array [[39m
[32m-               "bash",[39m
[32m-               "-c",[39m
[31m+             "args": Array [[39m
[2m                "set -ux[22m

[2m  RLY_INDEX=\${HOSTNAME##*-}[22m
[33m@@ -166,18 +187,16 @@[39m
[2m  mkdir -p $RELAYER_DIR[22m
[2m  cp /configs/config.toml $RELAYER_DIR/config.toml[22m
[2m  cp /configs/config-cli.toml $RELAYER_DIR/config-cli.toml[22m
[32m- cat $RELAYER_DIR/config.toml[39m
[31m+[39m
[31m+ # Replace namespace placeholder with actual namespace environment variable[39m
[31m+ sed -i \\"s|\\\\$NAMESPACE|$NAMESPACE|g\\" $RELAYER_DIR/config.toml[39m
[31m+ sed -i \\"s|\\\\$NAMESPACE|$NAMESPACE|g\\" $RELAYER_DIR/config-cli.toml[39m

[32m- MNEMONIC=$(jq -r \\".relayers[$RELAYER_INDEX].mnemonic\\" $KEYS_CONFIG)[39m
[31m+ MNEMONIC=$(jq -r \\".relayers[$RLY_INDEX].mnemonic\\" $KEYS_CONFIG)[39m
[2m  echo $MNEMONIC > $RELAYER_DIR/mnemonic.txt[22m
[32m- MNEMONIC_CLI=$(jq -r \\".relayers_cli[$RELAYER_INDEX].mnemonic\\" $KEYS_CONFIG)[39m
[31m+ MNEMONIC_CLI=$(jq -r \\".relayers_cli[$RLY_INDEX].mnemonic\\" $KEYS_CONFIG)[39m
[2m  echo $MNEMONIC_CLI > $RELAYER_DIR/mnemonic-cli.txt[22m

[32m- echo \\"Debug output for noble-cosmos...\\"[39m
[32m- cat << EOF[39m
[32m-               map[string]interface {}[39m
[32m-               {\\"chains\\":[\\"noble-1\\",\\"cosmoshub-4\\"],\\"channels\\":[{\\"a-chain\\":\\"noble-1\\",\\"a-port\\":\\"transfer\\",\\"b-chain\\":\\"cosmoshub-4\\",\\"b-port\\":\\"transfer\\",\\"new-connection\\":true}],\\"config\\":{\\"event_source\\":{\\"mode\\":\\"push\\"},\\"global\\":{\\"log_level\\":\\"info\\"},\\"mode\\":{\\"channels\\":{\\"enabled\\":true},\\"clients\\":{\\"enabled\\":true,\\"misbehaviour\\":true,\\"refresh\\":true},\\"connections\\":{\\"enabled\\":true},\\"packets\\":{\\"clear_interval\\":100,\\"clear_on_start\\":true,\\"enabled\\":true,\\"tx_confirmation\\":true}},\\"rest\\":{\\"enabled\\":true,\\"host\\":\\"0.0.0.0\\",\\"port\\":3000},\\"telemetry\\":{\\"enabled\\":true,\\"host\\":\\"0.0.0.0\\",\\"port\\":3001}},\\"fullname\\":\\"hermes-noble-cosmos\\",\\"ics\\":{\\"enabled\\":false},\\"image\\":\\"ghcr.io/cosmology-tech/starship/hermes:1.10.0\\",\\"name\\":\\"noble-cosmos\\",\\"replicas\\":1,\\"type\\":\\"hermes\\"}[39m
[32m- EOF[39m

[2m  echo \\"Creating key for noble-1...\\"[22m
[2m  hermes keys add \\\\[22m
[33m@@ -240,12 +259,17 @@[39m
[2m    $DENOM \\\\[22m
[2m    http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:8000/credit \\\\[22m
[2m    \\"true\\" || true[22m
[31m+[39m
[2m  hermes create channel \\\\[22m
[2m    --new-client-connection --yes \\\\[22m
[2m    --b-chain cosmoshub-4 \\\\[22m
[2m    --a-chain noble-1 \\\\[22m
[2m    --a-port transfer \\\\[22m
[2m    --b-port transfer",[22m
[31m+             ],[39m
[31m+             "command": Array [[39m
[31m+               "bash",[39m
[31m+               "-c",[39m
[2m              ],[22m
[2m              "env": Array [[22m
[2m                Object {[22m
[33m@@ -266,7 +290,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "RELAYER_INDEX",[22m
[32m-                 "value": "0",[39m
[31m+                 "value": "\${HOSTNAME##*-}",[39m
[2m                },[22m
[2m              ],[22m
[2m              "image": "ghcr.io/cosmology-tech/starship/hermes:1.10.0",[22m
[33m@@ -274,12 +298,12 @@[39m
[2m              "name": "init-relayer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[33m@@ -310,6 +334,7 @@[39m
[2m    echo \\"Checking: http://noble-1-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id\\"[22m
[2m    sleep 10;[22m
[2m  done[22m
[31m+[39m
[2m  while [ $(curl -sw '%{http_code}' http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id -o /dev/null) -ne 200 ]; do[22m
[2m    echo \\"Genesis validator does not seem to be ready for: cosmoshub-4. Waiting for it to start...\\"[22m
[2m    echo \\"Checking: http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id\\"[22m
[33m@@ -332,16 +357,16 @@[39m
[2m                  },[22m
[2m                },[22m
[2m              ],[22m
[32m-             "image": "curlimages/curl",[39m
[31m+             "image": "curlimages/curl:latest",[39m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "wait-for-chains",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m"
`;

exports[`Manifest Comparison Tests Individual Config Comparisons should generate manifests for one-chain that match the snapshot 1`] = `
"ðŸ”„ MODIFIED_RESOURCES:

--- ConfigMap/keys ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -98,6 +98,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "configmap",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "keys",[39m
[31m+       "app.kubernetes.io/part-of": "global",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "keys",[22m
[2m    },[22m
[2m  }[22m

--- ConfigMap/setup-scripts ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -208,6 +208,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "configmap",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts",[39m
[31m+       "app.kubernetes.io/part-of": "global",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts",[22m
[2m    },[22m
[2m  }[22m

--- ConfigMap/patch-osmosis-1 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -3,6 +3,11 @@[39m
[2m    "data": Object {[22m
[2m      "genesis.json": "{[22m
[2m    \\"app_state\\": {[22m
[31m+     \\"staking\\": {[39m
[31m+       \\"params\\": {[39m
[31m+         \\"unbonding_time\\": \\"5s\\"[39m
[31m+       }[39m
[31m+     },[39m
[2m      \\"gamm\\": {[22m
[2m        \\"params\\": {[22m
[2m          \\"pool_creation_fee\\": [[22m
[33m@@ -11,11 +16,6 @@[39m
[2m              \\"denom\\": \\"uosmo\\"[22m
[2m            }[22m
[2m          ][22m
[32m-       }[39m
[32m-     },[39m
[32m-     \\"staking\\": {[39m
[32m-       \\"params\\": {[39m
[32m-         \\"unbonding_time\\": \\"5s\\"[39m
[2m        }[22m
[2m      }[22m
[2m    }[22m
[33m@@ -23,6 +23,17 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "osmosis",[39m
[31m+       "app.kubernetes.io/part-of": "osmosis-1",[39m
[31m+       "app.kubernetes.io/role": "genesis-patch",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-id": "osmosis-1",[39m
[31m+       "starship.io/chain-name": "osmosis",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "patch-osmosis-1",[22m
[2m    },[22m
[2m  }[22m

--- StatefulSet/osmosis-1-genesis ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,18 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/id": "osmosis-1",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "osmosis-1-genesis",[39m
[31m+       "app.kubernetes.io/part-of": "osmosis-1",[39m
[31m+       "app.kubernetes.io/role": "genesis",[39m
[31m+       "app.kubernetes.io/type": "osmosis-1-statefulset",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-name": "osmosis",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "osmosis-1-genesis",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +21,7 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "osmosis",[39m
[31m+         "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m          "app.kubernetes.io/name": "osmosis-1-genesis",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -23,11 +35,12 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "osmosis",[39m
[31m+           "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m            "app.kubernetes.io/name": "osmosis-1-genesis",[22m
[2m            "app.kubernetes.io/rawname": "osmosis-1",[22m
[31m+           "app.kubernetes.io/role": "genesis",[39m
[2m            "app.kubernetes.io/type": "osmosis-1",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[33m@@ -91,11 +104,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -184,12 +197,12 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[32m-                 "memory": "200M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "128M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[32m-                 "memory": "200M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "128M",[39m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[33m@@ -211,7 +224,12 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "START_ARGS=\\"\\"[39m
[31m+               "#!/bin/bash[39m
[31m+ set -euo pipefail[39m
[31m+[39m
[31m+ START_ARGS=\\"\\"[39m
[31m+[39m
[31m+[39m
[2m  $CHAIN_BIN start $START_ARGS",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -274,11 +292,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -307,7 +325,9 @@[39m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m

[2m  echo \\"Running setup config script...\\"[22m
[31m+[39m
[2m  jq -s '.[0] * .[1]' $CHAIN_DIR/config/genesis.json /patch/genesis.json > $CHAIN_DIR/config/genesis.json.tmp && mv $CHAIN_DIR/config/genesis.json.tmp $CHAIN_DIR/config/genesis.json[22m
[31m+[39m
[2m  bash -e /scripts/update-config.sh",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -389,11 +409,11 @@[39m
[2m              "name": "init-config",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -420,20 +440,18 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "# Install faucet binary from the image[39m
[32m- cp /bin/faucet /faucet/faucet[39m
[32m- chmod +x /faucet/faucet",[39m
[31m+               "cp /bin/faucet /faucet/faucet && chmod +x /faucet/faucet",[39m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/faucet:20250325-2207109",[22m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "init-faucet",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -470,8 +488,10 @@[39m

[2m  echo \\"Add custom accounts and balances\\"[22m
[2m  CHAIN_GENESIS_CMD=$($CHAIN_BIN 2>&1 | grep -q \\"genesis-related subcommands\\" && echo \\"genesis\\" || echo \\"\\")[22m
[31m+[39m
[2m  echo \\"Adding balance to osmo1e9ucjn5fjmetky5wezzcsccp7hqcwzrrhthpf5\\"[22m
[2m  $CHAIN_BIN $CHAIN_GENESIS_CMD add-genesis-account osmo1e9ucjn5fjmetky5wezzcsccp7hqcwzrrhthpf5 2000000000000uosmo --keyring-backend=\\"test\\"[22m
[31m+[39m
[2m  echo \\"Adding balance to osmo10eykchznjdn8jdlwaj5v9wvlmdsp6kxx7u0hv9\\"[22m
[2m  $CHAIN_BIN $CHAIN_GENESIS_CMD add-genesis-account osmo10eykchznjdn8jdlwaj5v9wvlmdsp6kxx7u0hv9 2000000000000uosmo --keyring-backend=\\"test\\"",[22m
[2m              ],[22m
[33m@@ -562,11 +582,11 @@[39m
[2m              "name": "init-genesis",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m

--- ConfigMap/setup-scripts-osmosis-1 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -608,6 +608,17 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts-osmosis-1",[39m
[31m+       "app.kubernetes.io/part-of": "osmosis-1",[39m
[31m+       "app.kubernetes.io/role": "setup-scripts",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-id": "osmosis-1",[39m
[31m+       "starship.io/chain-name": "osmosis",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts-osmosis-1",[22m
[2m    },[22m
[2m  }[22m

--- Deployment/registry ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,14 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "Deployment",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "registry",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "registry",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "registry",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +17,6 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "registry",[39m
[2m          "app.kubernetes.io/name": "registry",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -22,19 +29,17 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "registry",[39m
[31m+           "app.kubernetes.io/component": "registry",[39m
[31m+           "app.kubernetes.io/managed-by": "starship",[39m
[2m            "app.kubernetes.io/name": "registry",[22m
[32m-           "app.kubernetes.io/rawname": "registry",[39m
[32m-           "app.kubernetes.io/type": "registry",[39m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/part-of": "starship",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+           "starship.io/name": "starship-e2e-tests",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[2m          "containers": Array [[22m
[2m            Object {[22m
[32m-             "command": Array [[39m
[32m-               "registry",[39m
[32m-             ],[39m
[2m              "env": Array [[22m
[2m                Object {[22m
[2m                  "name": "NAMESPACE",[22m
[33m@@ -74,21 +79,20 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "REGISTRY_CHAIN_REGISTRY",[22m
[32m-                 "value": "/configs",[39m
[31m+                 "value": "/chains",[39m
[2m                },[22m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/registry:20250205-544757d",[22m
[32m-             "imagePullPolicy": "IfNotPresent",[39m
[2m              "livenessProbe": Object {[22m
[32m-               "initialDelaySeconds": 20,[39m
[32m-               "periodSeconds": 10,[39m
[31m+               "initialDelaySeconds": 15,[39m
[31m+               "periodSeconds": 20,[39m
[2m                "tcpSocket": Object {[22m
[2m                  "port": 8080,[22m
[2m                },[22m
[2m              },[22m
[2m              "name": "registry",[22m
[2m              "readinessProbe": Object {[22m
[32m-               "initialDelaySeconds": 20,[39m
[31m+               "initialDelaySeconds": 5,[39m
[2m                "periodSeconds": 10,[22m
[2m                "tcpSocket": Object {[22m
[2m                  "port": 8080,[22m
[33m@@ -96,18 +100,18 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[2m                Object {[22m
[32m-                 "mountPath": "/configs/osmosis-1",[39m
[32m-                 "name": "registry-configs-osmosis-1",[39m
[31m+                 "mountPath": "/chains/osmosis-1",[39m
[31m+                 "name": "registry-osmosis-1",[39m
[2m                },[22m
[2m              ],[22m
[2m            },[22m
[33m@@ -139,16 +143,16 @@[39m
[2m                  },[22m
[2m                },[22m
[2m              ],[22m
[32m-             "image": "curlimages/curl",[39m
[31m+             "image": "curlimages/curl:latest",[39m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "wait-for-chains",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -159,7 +163,7 @@[39m
[2m              "configMap": Object {[22m
[2m                "name": "registry-osmosis-1",[22m
[2m              },[22m
[32m-             "name": "registry-configs-osmosis-1",[39m
[31m+             "name": "registry-osmosis-1",[39m
[2m            },[22m
[2m          ],[22m
[2m        },[22m

--- ConfigMap/registry-osmosis-1 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -7,7 +7,14 @@[39m
[2m    \\"assets\\": [[22m
[2m      {[22m
[2m        \\"base\\": \\"uosmo\\",[22m
[32m-       \\"coingecko_id\\": \\"osmosis\\",[39m
[31m+       \\"description\\": \\"The native token of Osmosis\\",[39m
[31m+       \\"name\\": \\"Osmosis\\",[39m
[31m+       \\"display\\": \\"osmo\\",[39m
[31m+       \\"symbol\\": \\"OSMO\\",[39m
[31m+       \\"logo_URIs\\": {[39m
[31m+         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/osmo.png\\",[39m
[31m+         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/osmo.svg\\"[39m
[31m+       },[39m
[2m        \\"denom_units\\": [[22m
[2m          {[22m
[2m            \\"denom\\": \\"uosmo\\",[22m
[33m@@ -18,22 +25,21 @@[39m
[2m            \\"exponent\\": 6[22m
[2m          }[22m
[2m        ],[22m
[32m-       \\"description\\": \\"The native token of Osmosis\\",[39m
[32m-       \\"display\\": \\"osmo\\",[39m
[31m+       \\"coingecko_id\\": \\"osmosis\\",[39m
[2m        \\"keywords\\": [[22m
[2m          \\"staking\\",[22m
[2m          \\"dex\\"[22m
[32m-       ],[39m
[32m-       \\"logo_URIs\\": {[39m
[32m-         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/osmo.png\\",[39m
[32m-         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/osmo.svg\\"[39m
[32m-       },[39m
[32m-       \\"name\\": \\"Osmosis\\",[39m
[32m-       \\"symbol\\": \\"OSMO\\"[39m
[31m+       ][39m
[2m      },[22m
[2m      {[22m
[2m        \\"base\\": \\"uion\\",[22m
[32m-       \\"coingecko_id\\": \\"ion\\",[39m
[31m+       \\"name\\": \\"Ion\\",[39m
[31m+       \\"display\\": \\"ion\\",[39m
[31m+       \\"symbol\\": \\"ION\\",[39m
[31m+       \\"logo_URIs\\": {[39m
[31m+         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/ion.png\\",[39m
[31m+         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/ion.svg\\"[39m
[31m+       },[39m
[2m        \\"denom_units\\": [[22m
[2m          {[22m
[2m            \\"denom\\": \\"uion\\",[22m
[33m@@ -44,16 +50,10 @@[39m
[2m            \\"exponent\\": 6[22m
[2m          }[22m
[2m        ],[22m
[32m-       \\"display\\": \\"ion\\",[39m
[31m+       \\"coingecko_id\\": \\"ion\\",[39m
[2m        \\"keywords\\": [[22m
[2m          \\"memecoin\\"[22m
[32m-       ],[39m
[32m-       \\"logo_URIs\\": {[39m
[32m-         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/ion.png\\",[39m
[32m-         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/ion.svg\\"[39m
[32m-       },[39m
[32m-       \\"name\\": \\"Ion\\",[39m
[32m-       \\"symbol\\": \\"ION\\"[39m
[31m+       ][39m
[2m      }[22m
[2m    ][22m
[2m  }",[22m
[33m@@ -110,6 +110,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "registry",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "registry-osmosis-1",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "registry-osmosis-1",[22m
[2m    },[22m
[2m  }[22m"
`;

exports[`Manifest Comparison Tests Individual Config Comparisons should generate manifests for one-chain-cometmock that match the snapshot 1`] = `
"ðŸ”„ MODIFIED_RESOURCES:

--- ConfigMap/keys ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -98,6 +98,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "configmap",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "keys",[39m
[31m+       "app.kubernetes.io/part-of": "global",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "keys",[22m
[2m    },[22m
[2m  }[22m

--- ConfigMap/setup-scripts ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -208,6 +208,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "configmap",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts",[39m
[31m+       "app.kubernetes.io/part-of": "global",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts",[22m
[2m    },[22m
[2m  }[22m

--- StatefulSet/cosmoshub-4-cometmock ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,18 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/id": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "cosmoshub-4-cometmock",[39m
[31m+       "app.kubernetes.io/part-of": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/role": "cometmock",[39m
[31m+       "app.kubernetes.io/type": "cosmoshub-4-statefulset",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-name": "cosmoshub",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "cosmoshub-4-cometmock",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -27,7 +39,7 @@[39m
[2m            "app.kubernetes.io/name": "cosmoshub-4-cometmock",[22m
[2m            "app.kubernetes.io/rawname": "cosmoshub-4-cometmock",[22m
[2m            "app.kubernetes.io/type": "cometmock",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[33m@@ -38,6 +50,7 @@[39m
[2m                "-c",[22m
[2m                "NODE_LISTEN_ADDR_STR=\\"tcp://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:26658\\"[22m
[2m  NODE_HOME_STR=\\"/chain/genesis\\"[22m
[31m+     [39m
[2m  /chain/cometmock --block-time=800 $NODE_LISTEN_ADDR_STR /chain/genesis/config/genesis.json tcp://0.0.0.0:22331 $NODE_HOME_STR grpc",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -107,11 +120,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.3,[39m
[31m+                 "cpu": "0.3",[39m
[2m                  "memory": "300M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.3,[39m
[31m+                 "cpu": "0.3",[39m
[2m                  "memory": "300M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -145,7 +158,7 @@[39m
[2m  ## fetch priv_validator and priv_validator_state of all validators[22m
[2m  curl http://$GENESIS_HOST.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/priv_keys -o /chain/genesis/config/priv_validator_key.json[22m
[2m  echo '{\\"height\\":\\"0\\",\\"round\\":0,\\"step\\":0}' > /chain/genesis/data/priv_validator_state.json[22m
[32m-[39m
[31m+     [39m
[2m  echo \\"copy cometmock binary to shared dir\\"[22m
[2m  cp /usr/local/bin/cometmock /chain/cometmock",[22m
[2m              ],[22m
[33m@@ -236,11 +249,11 @@[39m
[2m              "name": "init-comet",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.3,[39m
[31m+                 "cpu": "0.3",[39m
[2m                  "memory": "300M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.3,[39m
[31m+                 "cpu": "0.3",[39m
[2m                  "memory": "300M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -268,6 +281,7 @@[39m
[2m    echo \\"Checking: http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/priv_keys\\"[22m
[2m    sleep 10;[22m
[2m  done[22m
[31m+     [39m
[2m  echo \\"Ready to start\\"[22m
[2m  exit 0",[22m
[2m              ],[22m
[33m@@ -290,11 +304,11 @@[39m
[2m              "name": "init-wait",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m

--- StatefulSet/cosmoshub-4-genesis ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,18 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/id": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "cosmoshub-4-genesis",[39m
[31m+       "app.kubernetes.io/part-of": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/role": "genesis",[39m
[31m+       "app.kubernetes.io/type": "cosmoshub-4-statefulset",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-name": "cosmoshub",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "cosmoshub-4-genesis",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +21,7 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "cosmoshub",[39m
[31m+         "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m          "app.kubernetes.io/name": "cosmoshub-4-genesis",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -23,11 +35,12 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "cosmoshub",[39m
[31m+           "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m            "app.kubernetes.io/name": "cosmoshub-4-genesis",[22m
[2m            "app.kubernetes.io/rawname": "cosmoshub-4",[22m
[31m+           "app.kubernetes.io/role": "genesis",[39m
[2m            "app.kubernetes.io/type": "cosmoshub-4",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[33m@@ -91,11 +104,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -114,8 +127,12 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "START_ARGS=\\"\\"[39m
[31m+               "#!/bin/bash[39m
[31m+ set -euo pipefail[39m
[31m+[39m
[31m+ START_ARGS=\\"\\"[39m
[2m  START_ARGS=\\"--grpc-web.enable=false --transport=grpc --with-tendermint=false --address tcp://0.0.0.0:26658\\"[22m
[31m+[39m
[2m  $CHAIN_BIN start $START_ARGS",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -165,11 +182,11 @@[39m
[2m              "name": "validator",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.3,[39m
[31m+                 "cpu": "0.3",[39m
[2m                  "memory": "300M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.3,[39m
[31m+                 "cpu": "0.3",[39m
[2m                  "memory": "300M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -198,6 +215,7 @@[39m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m

[2m  echo \\"Running setup config script...\\"[22m
[31m+[39m
[2m  bash -e /scripts/update-config.sh",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -239,7 +257,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "TIME_IOTA_MS",[22m
[33m@@ -279,11 +297,11 @@[39m
[2m              "name": "init-config",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.3,[39m
[31m+                 "cpu": "0.3",[39m
[2m                  "memory": "300M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.3,[39m
[31m+                 "cpu": "0.3",[39m
[2m                  "memory": "300M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -416,11 +434,11 @@[39m
[2m              "name": "init-genesis",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.3,[39m
[31m+                 "cpu": "0.3",[39m
[2m                  "memory": "300M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.3,[39m
[31m+                 "cpu": "0.3",[39m
[2m                  "memory": "300M",[22m
[2m                },[22m
[2m              },[22m

--- ConfigMap/setup-scripts-cosmoshub-4 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -608,6 +608,17 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts-cosmoshub-4",[39m
[31m+       "app.kubernetes.io/part-of": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/role": "setup-scripts",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-id": "cosmoshub-4",[39m
[31m+       "starship.io/chain-name": "cosmoshub",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts-cosmoshub-4",[22m
[2m    },[22m
[2m  }[22m"
`;

exports[`Manifest Comparison Tests Individual Config Comparisons should generate manifests for one-chain-cosmjs-faucet that match the snapshot 1`] = `
"ðŸ”„ MODIFIED_RESOURCES:

--- ConfigMap/keys ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -98,6 +98,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "configmap",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "keys",[39m
[31m+       "app.kubernetes.io/part-of": "global",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "keys",[22m
[2m    },[22m
[2m  }[22m

--- ConfigMap/setup-scripts ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -208,6 +208,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "configmap",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts",[39m
[31m+       "app.kubernetes.io/part-of": "global",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts",[22m
[2m    },[22m
[2m  }[22m

--- StatefulSet/osmosis-1-genesis ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,18 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/id": "osmosis-1",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "osmosis-1-genesis",[39m
[31m+       "app.kubernetes.io/part-of": "osmosis-1",[39m
[31m+       "app.kubernetes.io/role": "genesis",[39m
[31m+       "app.kubernetes.io/type": "osmosis-1-statefulset",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-name": "osmosis",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "osmosis-1-genesis",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +21,7 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "osmosis",[39m
[31m+         "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m          "app.kubernetes.io/name": "osmosis-1-genesis",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -23,11 +35,12 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "osmosis",[39m
[31m+           "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m            "app.kubernetes.io/name": "osmosis-1-genesis",[22m
[2m            "app.kubernetes.io/rawname": "osmosis-1",[22m
[31m+           "app.kubernetes.io/role": "genesis",[39m
[2m            "app.kubernetes.io/type": "osmosis-1",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[33m@@ -91,11 +104,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -191,7 +204,7 @@[39m
[2m                  "value": "m/44'/118'/0'/0/0",[22m
[2m                },[22m
[2m              ],[22m
[32m-             "image": "ghcr.io/cosmology-tech/starship/cosmjs-faucet:v0.31.1",[39m
[31m+             "image": "ghcr.io/hyperweb-io/starship/faucet:20250325-2207109",[39m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "faucet",[22m
[2m              "readinessProbe": Object {[22m
[33m@@ -204,11 +217,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -227,7 +240,12 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "START_ARGS=\\"\\"[39m
[31m+               "#!/bin/bash[39m
[31m+ set -euo pipefail[39m
[31m+[39m
[31m+ START_ARGS=\\"\\"[39m
[31m+[39m
[31m+[39m
[2m  $CHAIN_BIN start $START_ARGS",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -290,11 +308,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -323,6 +341,7 @@[39m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m

[2m  echo \\"Running setup config script...\\"[22m
[31m+[39m
[2m  bash -e /scripts/update-config.sh",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -364,7 +383,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "TIME_IOTA_MS",[22m
[33m@@ -404,11 +423,11 @@[39m
[2m              "name": "init-config",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -541,11 +560,11 @@[39m
[2m              "name": "init-genesis",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m

--- ConfigMap/setup-scripts-osmosis-1 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -608,6 +608,17 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts-osmosis-1",[39m
[31m+       "app.kubernetes.io/part-of": "osmosis-1",[39m
[31m+       "app.kubernetes.io/role": "setup-scripts",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-id": "osmosis-1",[39m
[31m+       "starship.io/chain-name": "osmosis",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts-osmosis-1",[22m
[2m    },[22m
[2m  }[22m

--- Deployment/registry ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,14 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "Deployment",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "registry",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "registry",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "registry",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +17,6 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "registry",[39m
[2m          "app.kubernetes.io/name": "registry",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -22,19 +29,17 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "registry",[39m
[31m+           "app.kubernetes.io/component": "registry",[39m
[31m+           "app.kubernetes.io/managed-by": "starship",[39m
[2m            "app.kubernetes.io/name": "registry",[22m
[32m-           "app.kubernetes.io/rawname": "registry",[39m
[32m-           "app.kubernetes.io/type": "registry",[39m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/part-of": "starship",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+           "starship.io/name": "starship-e2e-tests",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[2m          "containers": Array [[22m
[2m            Object {[22m
[32m-             "command": Array [[39m
[32m-               "registry",[39m
[32m-             ],[39m
[2m              "env": Array [[22m
[2m                Object {[22m
[2m                  "name": "NAMESPACE",[22m
[33m@@ -74,21 +79,20 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "REGISTRY_CHAIN_REGISTRY",[22m
[32m-                 "value": "/configs",[39m
[31m+                 "value": "/chains",[39m
[2m                },[22m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/registry:20250205-544757d",[22m
[32m-             "imagePullPolicy": "IfNotPresent",[39m
[2m              "livenessProbe": Object {[22m
[32m-               "initialDelaySeconds": 20,[39m
[32m-               "periodSeconds": 10,[39m
[31m+               "initialDelaySeconds": 15,[39m
[31m+               "periodSeconds": 20,[39m
[2m                "tcpSocket": Object {[22m
[2m                  "port": 8080,[22m
[2m                },[22m
[2m              },[22m
[2m              "name": "registry",[22m
[2m              "readinessProbe": Object {[22m
[32m-               "initialDelaySeconds": 20,[39m
[31m+               "initialDelaySeconds": 5,[39m
[2m                "periodSeconds": 10,[22m
[2m                "tcpSocket": Object {[22m
[2m                  "port": 8080,[22m
[33m@@ -96,18 +100,18 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[2m                Object {[22m
[32m-                 "mountPath": "/configs/osmosis-1",[39m
[32m-                 "name": "registry-configs-osmosis-1",[39m
[31m+                 "mountPath": "/chains/osmosis-1",[39m
[31m+                 "name": "registry-osmosis-1",[39m
[2m                },[22m
[2m              ],[22m
[2m            },[22m
[33m@@ -139,16 +143,16 @@[39m
[2m                  },[22m
[2m                },[22m
[2m              ],[22m
[32m-             "image": "curlimages/curl",[39m
[31m+             "image": "curlimages/curl:latest",[39m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "wait-for-chains",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -159,7 +163,7 @@[39m
[2m              "configMap": Object {[22m
[2m                "name": "registry-osmosis-1",[22m
[2m              },[22m
[32m-             "name": "registry-configs-osmosis-1",[39m
[31m+             "name": "registry-osmosis-1",[39m
[2m            },[22m
[2m          ],[22m
[2m        },[22m

--- ConfigMap/registry-osmosis-1 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -7,7 +7,14 @@[39m
[2m    \\"assets\\": [[22m
[2m      {[22m
[2m        \\"base\\": \\"uosmo\\",[22m
[32m-       \\"coingecko_id\\": \\"osmosis\\",[39m
[31m+       \\"description\\": \\"The native token of Osmosis\\",[39m
[31m+       \\"name\\": \\"Osmosis\\",[39m
[31m+       \\"display\\": \\"osmo\\",[39m
[31m+       \\"symbol\\": \\"OSMO\\",[39m
[31m+       \\"logo_URIs\\": {[39m
[31m+         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/osmo.png\\",[39m
[31m+         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/osmo.svg\\"[39m
[31m+       },[39m
[2m        \\"denom_units\\": [[22m
[2m          {[22m
[2m            \\"denom\\": \\"uosmo\\",[22m
[33m@@ -18,22 +25,21 @@[39m
[2m            \\"exponent\\": 6[22m
[2m          }[22m
[2m        ],[22m
[32m-       \\"description\\": \\"The native token of Osmosis\\",[39m
[32m-       \\"display\\": \\"osmo\\",[39m
[31m+       \\"coingecko_id\\": \\"osmosis\\",[39m
[2m        \\"keywords\\": [[22m
[2m          \\"staking\\",[22m
[2m          \\"dex\\"[22m
[32m-       ],[39m
[32m-       \\"logo_URIs\\": {[39m
[32m-         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/osmo.png\\",[39m
[32m-         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/osmo.svg\\"[39m
[32m-       },[39m
[32m-       \\"name\\": \\"Osmosis\\",[39m
[32m-       \\"symbol\\": \\"OSMO\\"[39m
[31m+       ][39m
[2m      },[22m
[2m      {[22m
[2m        \\"base\\": \\"uion\\",[22m
[32m-       \\"coingecko_id\\": \\"ion\\",[39m
[31m+       \\"name\\": \\"Ion\\",[39m
[31m+       \\"display\\": \\"ion\\",[39m
[31m+       \\"symbol\\": \\"ION\\",[39m
[31m+       \\"logo_URIs\\": {[39m
[31m+         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/ion.png\\",[39m
[31m+         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/ion.svg\\"[39m
[31m+       },[39m
[2m        \\"denom_units\\": [[22m
[2m          {[22m
[2m            \\"denom\\": \\"uion\\",[22m
[33m@@ -44,16 +50,10 @@[39m
[2m            \\"exponent\\": 6[22m
[2m          }[22m
[2m        ],[22m
[32m-       \\"display\\": \\"ion\\",[39m
[31m+       \\"coingecko_id\\": \\"ion\\",[39m
[2m        \\"keywords\\": [[22m
[2m          \\"memecoin\\"[22m
[32m-       ],[39m
[32m-       \\"logo_URIs\\": {[39m
[32m-         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/ion.png\\",[39m
[32m-         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/ion.svg\\"[39m
[32m-       },[39m
[32m-       \\"name\\": \\"Ion\\",[39m
[32m-       \\"symbol\\": \\"ION\\"[39m
[31m+       ][39m
[2m      }[22m
[2m    ][22m
[2m  }",[22m
[33m@@ -110,6 +110,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "registry",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "registry-osmosis-1",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "registry-osmosis-1",[22m
[2m    },[22m
[2m  }[22m"
`;

exports[`Manifest Comparison Tests Individual Config Comparisons should generate manifests for one-chain-custom-scripts that match the snapshot 1`] = `
"ðŸ”„ MODIFIED_RESOURCES:

--- ConfigMap/keys ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -98,6 +98,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "configmap",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "keys",[39m
[31m+       "app.kubernetes.io/part-of": "global",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "keys",[22m
[2m    },[22m
[2m  }[22m

--- ConfigMap/setup-scripts ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -208,6 +208,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "configmap",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts",[39m
[31m+       "app.kubernetes.io/part-of": "global",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts",[22m
[2m    },[22m
[2m  }[22m

--- StatefulSet/osmosis-1-genesis ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,18 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/id": "osmosis-1",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "osmosis-1-genesis",[39m
[31m+       "app.kubernetes.io/part-of": "osmosis-1",[39m
[31m+       "app.kubernetes.io/role": "genesis",[39m
[31m+       "app.kubernetes.io/type": "osmosis-1-statefulset",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-name": "osmosis",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "osmosis-1-genesis",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +21,7 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "osmosis",[39m
[31m+         "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m          "app.kubernetes.io/name": "osmosis-1-genesis",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -23,11 +35,12 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "osmosis",[39m
[31m+           "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m            "app.kubernetes.io/name": "osmosis-1-genesis",[22m
[2m            "app.kubernetes.io/rawname": "osmosis-1",[22m
[31m+           "app.kubernetes.io/role": "genesis",[39m
[2m            "app.kubernetes.io/type": "osmosis-1",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[33m@@ -91,11 +104,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -184,12 +197,12 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[32m-                 "memory": "200M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "128M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[32m-                 "memory": "200M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "128M",[39m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[33m@@ -211,7 +224,12 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "START_ARGS=\\"\\"[39m
[31m+               "#!/bin/bash[39m
[31m+ set -euo pipefail[39m
[31m+[39m
[31m+ START_ARGS=\\"\\"[39m
[31m+[39m
[31m+[39m
[2m  $CHAIN_BIN start $START_ARGS",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -274,11 +292,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -307,6 +325,7 @@[39m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m

[2m  echo \\"Running setup config script...\\"[22m
[31m+[39m
[2m  bash -e /scripts/update-config.sh",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -348,7 +367,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "TIME_IOTA_MS",[22m
[33m@@ -388,11 +407,11 @@[39m
[2m              "name": "init-config",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -415,20 +434,18 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "# Install faucet binary from the image[39m
[32m- cp /bin/faucet /faucet/faucet[39m
[32m- chmod +x /faucet/faucet",[39m
[31m+               "cp /bin/faucet /faucet/faucet && chmod +x /faucet/faucet",[39m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/faucet:20250325-2207109",[22m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "init-faucet",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -553,11 +570,11 @@[39m
[2m              "name": "init-genesis",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m

--- ConfigMap/setup-scripts-osmosis-1 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -87,53 +87,6 @@[39m

[2m  echo \\"$json\\" | jq -r .result[22m
[2m  exit 0",[22m
[32m-     "create-genesis.sh": "#!/bin/bash[39m
[32m-[39m
[32m- DENOM=\\"\${DENOM:=uosmo}\\"[39m
[32m- COINS=\\"\${COINS:=100000000000000000uosmo}\\"[39m
[32m- CHAIN_ID=\\"\${CHAIN_ID:=osmosis}\\"[39m
[32m- CHAIN_BIN=\\"\${CHAIN_BIN:=osmosisd}\\"[39m
[32m- CHAIN_DIR=\\"\${CHAIN_DIR:=$HOME/.osmosisd}\\"[39m
[32m- KEYS_CONFIG=\\"\${KEYS_CONFIG:=configs/keys.json}\\"[39m
[32m-[39m
[32m- set -eu[39m
[32m-[39m
[32m- # check if the binary has genesis subcommand or not, if not, set CHAIN_GENESIS_CMD to empty[39m
[32m- CHAIN_GENESIS_CMD=$($CHAIN_BIN 2>&1 | grep -q \\"genesis-related subcommands\\" && echo \\"genesis\\" || echo \\"\\")[39m
[32m-[39m
[32m- CHAIN_INIT_ID=\\"$CHAIN_ID\\"[39m
[32m- if [ \\"$CHAIN_BIN\\" == \\"osmosisd\\" ]; then[39m
[32m-   CHAIN_INIT_ID=\\"test-1\\"[39m
[32m- fi[39m
[32m- jq -r \\".genesis[0].mnemonic\\" $KEYS_CONFIG | $CHAIN_BIN init $CHAIN_ID --chain-id $CHAIN_INIT_ID --recover[39m
[32m- sed -i -e \\"s/$CHAIN_INIT_ID/$CHAIN_ID/g\\" $CHAIN_DIR/config/genesis.json[39m
[32m-[39m
[32m- # Add genesis keys to the keyring and self delegate initial coins[39m
[32m- echo \\"Adding key....\\" $(jq -r \\".genesis[0].name\\" $KEYS_CONFIG)[39m
[32m- jq -r \\".genesis[0].mnemonic\\" $KEYS_CONFIG | $CHAIN_BIN keys add $(jq -r \\".genesis[0].name\\" $KEYS_CONFIG) --recover --keyring-backend=\\"test\\"[39m
[32m- $CHAIN_BIN $CHAIN_GENESIS_CMD add-genesis-account $($CHAIN_BIN keys show -a $(jq -r .genesis[0].name $KEYS_CONFIG) --keyring-backend=\\"test\\") $COINS --keyring-backend=\\"test\\"[39m
[32m-[39m
[32m-[39m
[32m- # Add faucet key to the keyring and self delegate initial coins[39m
[32m- echo \\"Adding key....\\" $(jq -r \\".faucet[0].name\\" $KEYS_CONFIG)[39m
[32m- jq -r \\".faucet[0].mnemonic\\" $KEYS_CONFIG | $CHAIN_BIN keys add $(jq -r \\".faucet[0].name\\" $KEYS_CONFIG) --recover --keyring-backend=\\"test\\"[39m
[32m- $CHAIN_BIN $CHAIN_GENESIS_CMD add-genesis-account $($CHAIN_BIN keys show -a $(jq -r .faucet[0].name $KEYS_CONFIG) --keyring-backend=\\"test\\") $COINS --keyring-backend=\\"test\\"[39m
[32m-[39m
[32m- # Add relayer key and delegate tokens[39m
[32m- echo \\"Adding key....\\" $(jq -r \\".relayers[0].name\\" $KEYS_CONFIG)[39m
[32m- jq -r \\".relayers[0].mnemonic\\" $KEYS_CONFIG | $CHAIN_BIN keys add $(jq -r \\".relayers[0].name\\" $KEYS_CONFIG) --recover --keyring-backend=\\"test\\"[39m
[32m- $CHAIN_BIN $CHAIN_GENESIS_CMD add-genesis-account $($CHAIN_BIN keys show -a $(jq -r .relayers[0].name $KEYS_CONFIG) --keyring-backend=\\"test\\") $COINS --keyring-backend=\\"test\\"[39m
[32m-[39m
[32m- echo \\"Creating gentx...\\"[39m
[32m- $CHAIN_BIN $CHAIN_GENESIS_CMD gentx $(jq -r \\".genesis[0].name\\" $KEYS_CONFIG) 5000000000$DENOM --keyring-backend=\\"test\\" --chain-id $CHAIN_ID[39m
[32m-[39m
[32m- echo \\"Output of gentx\\"[39m
[32m- cat $CHAIN_DIR/config/gentx/*.json | jq[39m
[32m-[39m
[32m- echo \\"Running collect-gentxs\\"[39m
[32m- $CHAIN_BIN $CHAIN_GENESIS_CMD collect-gentxs[39m
[32m-[39m
[32m- ls $CHAIN_DIR/config",[39m
[2m      "create-ics.sh": "#!/bin/bash[22m

[2m  set -euxo pipefail[22m
[33m@@ -276,8 +229,55 @@[39m
[2m  }[22m

[2m  main",[22m
[32m-     "create-validator.sh": "#!/bin/bash[39m
[31m+     "createGenesis.sh": "#!/bin/bash[39m
[31m+[39m
[31m+ DENOM=\\"\${DENOM:=uosmo}\\"[39m
[31m+ COINS=\\"\${COINS:=100000000000000000uosmo}\\"[39m
[31m+ CHAIN_ID=\\"\${CHAIN_ID:=osmosis}\\"[39m
[31m+ CHAIN_BIN=\\"\${CHAIN_BIN:=osmosisd}\\"[39m
[31m+ CHAIN_DIR=\\"\${CHAIN_DIR:=$HOME/.osmosisd}\\"[39m
[31m+ KEYS_CONFIG=\\"\${KEYS_CONFIG:=configs/keys.json}\\"[39m
[31m+[39m
[31m+ set -eu[39m
[31m+[39m
[31m+ # check if the binary has genesis subcommand or not, if not, set CHAIN_GENESIS_CMD to empty[39m
[31m+ CHAIN_GENESIS_CMD=$($CHAIN_BIN 2>&1 | grep -q \\"genesis-related subcommands\\" && echo \\"genesis\\" || echo \\"\\")[39m
[31m+[39m
[31m+ CHAIN_INIT_ID=\\"$CHAIN_ID\\"[39m
[31m+ if [ \\"$CHAIN_BIN\\" == \\"osmosisd\\" ]; then[39m
[31m+   CHAIN_INIT_ID=\\"test-1\\"[39m
[31m+ fi[39m
[31m+ jq -r \\".genesis[0].mnemonic\\" $KEYS_CONFIG | $CHAIN_BIN init $CHAIN_ID --chain-id $CHAIN_INIT_ID --recover[39m
[31m+ sed -i -e \\"s/$CHAIN_INIT_ID/$CHAIN_ID/g\\" $CHAIN_DIR/config/genesis.json[39m
[31m+[39m
[31m+ # Add genesis keys to the keyring and self delegate initial coins[39m
[31m+ echo \\"Adding key....\\" $(jq -r \\".genesis[0].name\\" $KEYS_CONFIG)[39m
[31m+ jq -r \\".genesis[0].mnemonic\\" $KEYS_CONFIG | $CHAIN_BIN keys add $(jq -r \\".genesis[0].name\\" $KEYS_CONFIG) --recover --keyring-backend=\\"test\\"[39m
[31m+ $CHAIN_BIN $CHAIN_GENESIS_CMD add-genesis-account $($CHAIN_BIN keys show -a $(jq -r .genesis[0].name $KEYS_CONFIG) --keyring-backend=\\"test\\") $COINS --keyring-backend=\\"test\\"[39m
[31m+[39m
[31m+[39m
[31m+ # Add faucet key to the keyring and self delegate initial coins[39m
[31m+ echo \\"Adding key....\\" $(jq -r \\".faucet[0].name\\" $KEYS_CONFIG)[39m
[31m+ jq -r \\".faucet[0].mnemonic\\" $KEYS_CONFIG | $CHAIN_BIN keys add $(jq -r \\".faucet[0].name\\" $KEYS_CONFIG) --recover --keyring-backend=\\"test\\"[39m
[31m+ $CHAIN_BIN $CHAIN_GENESIS_CMD add-genesis-account $($CHAIN_BIN keys show -a $(jq -r .faucet[0].name $KEYS_CONFIG) --keyring-backend=\\"test\\") $COINS --keyring-backend=\\"test\\"[39m
[31m+[39m
[31m+ # Add relayer key and delegate tokens[39m
[31m+ echo \\"Adding key....\\" $(jq -r \\".relayers[0].name\\" $KEYS_CONFIG)[39m
[31m+ jq -r \\".relayers[0].mnemonic\\" $KEYS_CONFIG | $CHAIN_BIN keys add $(jq -r \\".relayers[0].name\\" $KEYS_CONFIG) --recover --keyring-backend=\\"test\\"[39m
[31m+ $CHAIN_BIN $CHAIN_GENESIS_CMD add-genesis-account $($CHAIN_BIN keys show -a $(jq -r .relayers[0].name $KEYS_CONFIG) --keyring-backend=\\"test\\") $COINS --keyring-backend=\\"test\\"[39m
[31m+[39m
[31m+ echo \\"Creating gentx...\\"[39m
[31m+ $CHAIN_BIN $CHAIN_GENESIS_CMD gentx $(jq -r \\".genesis[0].name\\" $KEYS_CONFIG) 5000000000$DENOM --keyring-backend=\\"test\\" --chain-id $CHAIN_ID[39m
[31m+[39m
[31m+ echo \\"Output of gentx\\"[39m
[31m+ cat $CHAIN_DIR/config/gentx/*.json | jq[39m

[31m+ echo \\"Running collect-gentxs\\"[39m
[31m+ $CHAIN_BIN $CHAIN_GENESIS_CMD collect-gentxs[39m
[31m+[39m
[31m+ ls $CHAIN_DIR/config",[39m
[31m+     "createValidator.sh": "#!/bin/bash[39m
[31m+[39m
[2m  DENOM=\\"\${DENOM:=uosmo}\\"[22m
[2m  CHAIN_BIN=\\"\${CHAIN_BIN:=osmosisd}\\"[22m
[2m  KEYS_CONFIG=\\"\${KEYS_CONFIG:=configs/keys.json}\\"[22m
[33m@@ -395,7 +395,7 @@[39m
[2m    ((max_tries--))[22m
[2m    sleep 10[22m
[2m  done",[22m
[32m-     "transfer-tokens.sh": "#!/bin/bash[39m
[31m+     "transferTokens.sh": "#!/bin/bash[39m

[2m  ADDRESS=\\"$1\\"[22m
[2m  DENOM=\\"$2\\"[22m
[33m@@ -424,7 +424,7 @@[39m
[2m    ((max_tries--))[22m
[2m    sleep 2[22m
[2m  done",[22m
[32m-     "update-config.sh": "#!/bin/bash[39m
[31m+     "updateConfig.sh": "#!/bin/bash[39m

[2m  CHAIN_ID=\\"\${CHAIN_ID:=osmosis}\\"[22m
[2m  CHAIN_DIR=\\"\${CHAIN_DIR:=$HOME/.osmosisd}\\"[22m
[33m@@ -496,7 +496,7 @@[39m
[2m  fi[22m

[2m  $CHAIN_BIN tendermint show-node-id",[22m
[32m-     "update-genesis.sh": "#!/bin/bash[39m
[31m+     "updateGenesis.sh": "#!/bin/bash[39m

[2m  DENOM=\\"\${DENOM:=uosmo}\\"[22m
[2m  CHAIN_BIN=\\"\${CHAIN_BIN:=osmosisd}\\"[22m
[33m@@ -534,6 +534,17 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts-osmosis-1",[39m
[31m+       "app.kubernetes.io/part-of": "osmosis-1",[39m
[31m+       "app.kubernetes.io/role": "setup-scripts",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-id": "osmosis-1",[39m
[31m+       "starship.io/chain-name": "osmosis",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts-osmosis-1",[22m
[2m    },[22m
[2m  }[22m

--- Deployment/registry ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,14 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "Deployment",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "registry",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "registry",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "registry",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +17,6 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "registry",[39m
[2m          "app.kubernetes.io/name": "registry",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -22,19 +29,17 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "registry",[39m
[31m+           "app.kubernetes.io/component": "registry",[39m
[31m+           "app.kubernetes.io/managed-by": "starship",[39m
[2m            "app.kubernetes.io/name": "registry",[22m
[32m-           "app.kubernetes.io/rawname": "registry",[39m
[32m-           "app.kubernetes.io/type": "registry",[39m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/part-of": "starship",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+           "starship.io/name": "starship-e2e-tests",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[2m          "containers": Array [[22m
[2m            Object {[22m
[32m-             "command": Array [[39m
[32m-               "registry",[39m
[32m-             ],[39m
[2m              "env": Array [[22m
[2m                Object {[22m
[2m                  "name": "NAMESPACE",[22m
[33m@@ -74,21 +79,20 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "REGISTRY_CHAIN_REGISTRY",[22m
[32m-                 "value": "/configs",[39m
[31m+                 "value": "/chains",[39m
[2m                },[22m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/registry:20250205-544757d",[22m
[32m-             "imagePullPolicy": "IfNotPresent",[39m
[2m              "livenessProbe": Object {[22m
[32m-               "initialDelaySeconds": 20,[39m
[32m-               "periodSeconds": 10,[39m
[31m+               "initialDelaySeconds": 15,[39m
[31m+               "periodSeconds": 20,[39m
[2m                "tcpSocket": Object {[22m
[2m                  "port": 8080,[22m
[2m                },[22m
[2m              },[22m
[2m              "name": "registry",[22m
[2m              "readinessProbe": Object {[22m
[32m-               "initialDelaySeconds": 20,[39m
[31m+               "initialDelaySeconds": 5,[39m
[2m                "periodSeconds": 10,[22m
[2m                "tcpSocket": Object {[22m
[2m                  "port": 8080,[22m
[33m@@ -96,18 +100,18 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[2m                Object {[22m
[32m-                 "mountPath": "/configs/osmosis-1",[39m
[32m-                 "name": "registry-configs-osmosis-1",[39m
[31m+                 "mountPath": "/chains/osmosis-1",[39m
[31m+                 "name": "registry-osmosis-1",[39m
[2m                },[22m
[2m              ],[22m
[2m            },[22m
[33m@@ -139,16 +143,16 @@[39m
[2m                  },[22m
[2m                },[22m
[2m              ],[22m
[32m-             "image": "curlimages/curl",[39m
[31m+             "image": "curlimages/curl:latest",[39m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "wait-for-chains",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -159,7 +163,7 @@[39m
[2m              "configMap": Object {[22m
[2m                "name": "registry-osmosis-1",[22m
[2m              },[22m
[32m-             "name": "registry-configs-osmosis-1",[39m
[31m+             "name": "registry-osmosis-1",[39m
[2m            },[22m
[2m          ],[22m
[2m        },[22m

--- ConfigMap/registry-osmosis-1 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -7,7 +7,14 @@[39m
[2m    \\"assets\\": [[22m
[2m      {[22m
[2m        \\"base\\": \\"uosmo\\",[22m
[32m-       \\"coingecko_id\\": \\"osmosis\\",[39m
[31m+       \\"description\\": \\"The native token of Osmosis\\",[39m
[31m+       \\"name\\": \\"Osmosis\\",[39m
[31m+       \\"display\\": \\"osmo\\",[39m
[31m+       \\"symbol\\": \\"OSMO\\",[39m
[31m+       \\"logo_URIs\\": {[39m
[31m+         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/osmo.png\\",[39m
[31m+         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/osmo.svg\\"[39m
[31m+       },[39m
[2m        \\"denom_units\\": [[22m
[2m          {[22m
[2m            \\"denom\\": \\"uosmo\\",[22m
[33m@@ -18,22 +25,21 @@[39m
[2m            \\"exponent\\": 6[22m
[2m          }[22m
[2m        ],[22m
[32m-       \\"description\\": \\"The native token of Osmosis\\",[39m
[32m-       \\"display\\": \\"osmo\\",[39m
[31m+       \\"coingecko_id\\": \\"osmosis\\",[39m
[2m        \\"keywords\\": [[22m
[2m          \\"staking\\",[22m
[2m          \\"dex\\"[22m
[32m-       ],[39m
[32m-       \\"logo_URIs\\": {[39m
[32m-         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/osmo.png\\",[39m
[32m-         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/osmo.svg\\"[39m
[32m-       },[39m
[32m-       \\"name\\": \\"Osmosis\\",[39m
[32m-       \\"symbol\\": \\"OSMO\\"[39m
[31m+       ][39m
[2m      },[22m
[2m      {[22m
[2m        \\"base\\": \\"uion\\",[22m
[32m-       \\"coingecko_id\\": \\"ion\\",[39m
[31m+       \\"name\\": \\"Ion\\",[39m
[31m+       \\"display\\": \\"ion\\",[39m
[31m+       \\"symbol\\": \\"ION\\",[39m
[31m+       \\"logo_URIs\\": {[39m
[31m+         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/ion.png\\",[39m
[31m+         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/ion.svg\\"[39m
[31m+       },[39m
[2m        \\"denom_units\\": [[22m
[2m          {[22m
[2m            \\"denom\\": \\"uion\\",[22m
[33m@@ -44,16 +50,10 @@[39m
[2m            \\"exponent\\": 6[22m
[2m          }[22m
[2m        ],[22m
[32m-       \\"display\\": \\"ion\\",[39m
[31m+       \\"coingecko_id\\": \\"ion\\",[39m
[2m        \\"keywords\\": [[22m
[2m          \\"memecoin\\"[22m
[32m-       ],[39m
[32m-       \\"logo_URIs\\": {[39m
[32m-         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/ion.png\\",[39m
[32m-         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/ion.svg\\"[39m
[32m-       },[39m
[32m-       \\"name\\": \\"Ion\\",[39m
[32m-       \\"symbol\\": \\"ION\\"[39m
[31m+       ][39m
[2m      }[22m
[2m    ][22m
[2m  }",[22m
[33m@@ -110,6 +110,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "registry",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "registry-osmosis-1",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "registry-osmosis-1",[22m
[2m    },[22m
[2m  }[22m"
`;

exports[`Manifest Comparison Tests Individual Config Comparisons should generate manifests for one-cosmoshub-cosmjs-faucet that match the snapshot 1`] = `
"ðŸ”„ MODIFIED_RESOURCES:

--- ConfigMap/keys ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -98,6 +98,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "configmap",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "keys",[39m
[31m+       "app.kubernetes.io/part-of": "global",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "keys",[22m
[2m    },[22m
[2m  }[22m

--- ConfigMap/setup-scripts ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -208,6 +208,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "configmap",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts",[39m
[31m+       "app.kubernetes.io/part-of": "global",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts",[22m
[2m    },[22m
[2m  }[22m

--- StatefulSet/cosmoshub-4-genesis ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,18 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/id": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "cosmoshub-4-genesis",[39m
[31m+       "app.kubernetes.io/part-of": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/role": "genesis",[39m
[31m+       "app.kubernetes.io/type": "cosmoshub-4-statefulset",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-name": "cosmoshub",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "cosmoshub-4-genesis",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +21,7 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "cosmoshub",[39m
[31m+         "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m          "app.kubernetes.io/name": "cosmoshub-4-genesis",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -23,11 +35,12 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "cosmoshub",[39m
[31m+           "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m            "app.kubernetes.io/name": "cosmoshub-4-genesis",[22m
[2m            "app.kubernetes.io/rawname": "cosmoshub-4",[22m
[31m+           "app.kubernetes.io/role": "genesis",[39m
[2m            "app.kubernetes.io/type": "cosmoshub-4",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[33m@@ -91,11 +104,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -191,7 +204,7 @@[39m
[2m                  "value": "m/44'/118'/0'/0/0",[22m
[2m                },[22m
[2m              ],[22m
[32m-             "image": "ghcr.io/cosmology-tech/starship/cosmjs-faucet:v0.31.1",[39m
[31m+             "image": "ghcr.io/hyperweb-io/starship/faucet:20250325-2207109",[39m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "faucet",[22m
[2m              "readinessProbe": Object {[22m
[33m@@ -204,11 +217,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -227,7 +240,12 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "START_ARGS=\\"\\"[39m
[31m+               "#!/bin/bash[39m
[31m+ set -euo pipefail[39m
[31m+[39m
[31m+ START_ARGS=\\"\\"[39m
[31m+[39m
[31m+[39m
[2m  $CHAIN_BIN start $START_ARGS",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -290,11 +308,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -323,6 +341,7 @@[39m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m

[2m  echo \\"Running setup config script...\\"[22m
[31m+[39m
[2m  bash -e /scripts/update-config.sh",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -364,7 +383,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "TIME_IOTA_MS",[22m
[33m@@ -404,11 +423,11 @@[39m
[2m              "name": "init-config",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -541,11 +560,11 @@[39m
[2m              "name": "init-genesis",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m

--- ConfigMap/setup-scripts-cosmoshub-4 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -608,6 +608,17 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts-cosmoshub-4",[39m
[31m+       "app.kubernetes.io/part-of": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/role": "setup-scripts",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-id": "cosmoshub-4",[39m
[31m+       "starship.io/chain-name": "cosmoshub",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts-cosmoshub-4",[22m
[2m    },[22m
[2m  }[22m

--- ConfigMap/registry-cosmoshub-4 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -7,7 +7,14 @@[39m
[2m    \\"assets\\": [[22m
[2m      {[22m
[2m        \\"base\\": \\"uatom\\",[22m
[32m-       \\"coingecko_id\\": \\"atom\\",[39m
[31m+       \\"description\\": \\"The native staking and governance token of the Cosmos Hub.\\",[39m
[31m+       \\"name\\": \\"Cosmos Hub Atom\\",[39m
[31m+       \\"display\\": \\"atom\\",[39m
[31m+       \\"symbol\\": \\"ATOM\\",[39m
[31m+       \\"logo_URIs\\": {[39m
[31m+         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/cosmoshub/images/atom.png\\",[39m
[31m+         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/cosmoshub/images/atom.svg\\"[39m
[31m+       },[39m
[2m        \\"denom_units\\": [[22m
[2m          {[22m
[2m            \\"denom\\": \\"uatom\\",[22m
[33m@@ -18,14 +25,7 @@[39m
[2m            \\"exponent\\": 6[22m
[2m          }[22m
[2m        ],[22m
[32m-       \\"description\\": \\"The native staking and governance token of the Cosmos Hub.\\",[39m
[32m-       \\"display\\": \\"atom\\",[39m
[32m-       \\"logo_URIs\\": {[39m
[32m-         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/cosmoshub/images/atom.png\\",[39m
[32m-         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/cosmoshub/images/atom.svg\\"[39m
[32m-       },[39m
[32m-       \\"name\\": \\"Cosmos Hub Atom\\",[39m
[32m-       \\"symbol\\": \\"ATOM\\"[39m
[31m+       \\"coingecko_id\\": \\"atom\\"[39m
[2m      }[22m
[2m    ][22m
[2m  }",[22m
[33m@@ -82,6 +82,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "registry",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "registry-cosmoshub-4",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "registry-cosmoshub-4",[22m
[2m    },[22m
[2m  }[22m

--- Deployment/registry ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,14 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "Deployment",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "registry",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "registry",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "registry",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +17,6 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "registry",[39m
[2m          "app.kubernetes.io/name": "registry",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -22,19 +29,17 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "registry",[39m
[31m+           "app.kubernetes.io/component": "registry",[39m
[31m+           "app.kubernetes.io/managed-by": "starship",[39m
[2m            "app.kubernetes.io/name": "registry",[22m
[32m-           "app.kubernetes.io/rawname": "registry",[39m
[32m-           "app.kubernetes.io/type": "registry",[39m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/part-of": "starship",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+           "starship.io/name": "starship-e2e-tests",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[2m          "containers": Array [[22m
[2m            Object {[22m
[32m-             "command": Array [[39m
[32m-               "registry",[39m
[32m-             ],[39m
[2m              "env": Array [[22m
[2m                Object {[22m
[2m                  "name": "NAMESPACE",[22m
[33m@@ -74,21 +79,20 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "REGISTRY_CHAIN_REGISTRY",[22m
[32m-                 "value": "/configs",[39m
[31m+                 "value": "/chains",[39m
[2m                },[22m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/registry:20250205-544757d",[22m
[32m-             "imagePullPolicy": "IfNotPresent",[39m
[2m              "livenessProbe": Object {[22m
[32m-               "initialDelaySeconds": 20,[39m
[32m-               "periodSeconds": 10,[39m
[31m+               "initialDelaySeconds": 15,[39m
[31m+               "periodSeconds": 20,[39m
[2m                "tcpSocket": Object {[22m
[2m                  "port": 8080,[22m
[2m                },[22m
[2m              },[22m
[2m              "name": "registry",[22m
[2m              "readinessProbe": Object {[22m
[32m-               "initialDelaySeconds": 20,[39m
[31m+               "initialDelaySeconds": 5,[39m
[2m                "periodSeconds": 10,[22m
[2m                "tcpSocket": Object {[22m
[2m                  "port": 8080,[22m
[33m@@ -96,18 +100,18 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[2m                Object {[22m
[32m-                 "mountPath": "/configs/cosmoshub-4",[39m
[32m-                 "name": "registry-configs-cosmoshub-4",[39m
[31m+                 "mountPath": "/chains/cosmoshub-4",[39m
[31m+                 "name": "registry-cosmoshub-4",[39m
[2m                },[22m
[2m              ],[22m
[2m            },[22m
[33m@@ -139,16 +143,16 @@[39m
[2m                  },[22m
[2m                },[22m
[2m              ],[22m
[32m-             "image": "curlimages/curl",[39m
[31m+             "image": "curlimages/curl:latest",[39m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "wait-for-chains",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -159,7 +163,7 @@[39m
[2m              "configMap": Object {[22m
[2m                "name": "registry-cosmoshub-4",[22m
[2m              },[22m
[32m-             "name": "registry-configs-cosmoshub-4",[39m
[31m+             "name": "registry-cosmoshub-4",[39m
[2m            },[22m
[2m          ],[22m
[2m        },[22m"
`;

exports[`Manifest Comparison Tests Individual Config Comparisons should generate manifests for one-custom-chain that match the snapshot 1`] = `
"ðŸ”„ MODIFIED_RESOURCES:

--- ConfigMap/keys ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -98,6 +98,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "configmap",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "keys",[39m
[31m+       "app.kubernetes.io/part-of": "global",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "keys",[22m
[2m    },[22m
[2m  }[22m

--- ConfigMap/setup-scripts ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -208,6 +208,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "configmap",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts",[39m
[31m+       "app.kubernetes.io/part-of": "global",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts",[22m
[2m    },[22m
[2m  }[22m

--- StatefulSet/custom-1-genesis ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,18 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/id": "custom-1",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "custom-1-genesis",[39m
[31m+       "app.kubernetes.io/part-of": "custom-1",[39m
[31m+       "app.kubernetes.io/role": "genesis",[39m
[31m+       "app.kubernetes.io/type": "custom-1-statefulset",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-name": "custom",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "custom-1-genesis",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +21,7 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "custom",[39m
[31m+         "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m          "app.kubernetes.io/name": "custom-1-genesis",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -23,11 +35,12 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "custom",[39m
[31m+           "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m            "app.kubernetes.io/name": "custom-1-genesis",[22m
[2m            "app.kubernetes.io/rawname": "custom-1",[22m
[31m+           "app.kubernetes.io/role": "genesis",[39m
[2m            "app.kubernetes.io/type": "custom-1",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[33m@@ -91,11 +104,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -184,12 +197,12 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[32m-                 "memory": "200M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "128M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[32m-                 "memory": "200M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "128M",[39m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[33m@@ -211,7 +224,12 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "START_ARGS=\\"\\"[39m
[31m+               "#!/bin/bash[39m
[31m+ set -euo pipefail[39m
[31m+[39m
[31m+ START_ARGS=\\"\\"[39m
[31m+[39m
[31m+[39m
[2m  $CHAIN_BIN start $START_ARGS",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -274,11 +292,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -307,6 +325,7 @@[39m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m

[2m  echo \\"Running setup config script...\\"[22m
[31m+[39m
[2m  bash -e /scripts/update-config.sh",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -348,7 +367,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "TIME_IOTA_MS",[22m
[33m@@ -388,11 +407,11 @@[39m
[2m              "name": "init-config",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -415,20 +434,18 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "# Install faucet binary from the image[39m
[32m- cp /bin/faucet /faucet/faucet[39m
[32m- chmod +x /faucet/faucet",[39m
[31m+               "cp /bin/faucet /faucet/faucet && chmod +x /faucet/faucet",[39m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/faucet:20250325-2207109",[22m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "init-faucet",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -553,11 +570,11 @@[39m
[2m              "name": "init-genesis",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m

--- ConfigMap/setup-scripts-custom-1 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -608,6 +608,17 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts-custom-1",[39m
[31m+       "app.kubernetes.io/part-of": "custom-1",[39m
[31m+       "app.kubernetes.io/role": "setup-scripts",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-id": "custom-1",[39m
[31m+       "starship.io/chain-name": "custom",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts-custom-1",[22m
[2m    },[22m
[2m  }[22m

--- ConfigMap/registry-custom-1 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -31,7 +31,7 @@[39m
[2m    \\"status\\": \\"live\\",[22m
[2m    \\"network_type\\": \\"devnet\\",[22m
[2m    \\"chain_id\\": \\"custom-1\\",[22m
[32m-   \\"pretty_name\\": \\" Devnet\\",[39m
[31m+   \\"pretty_name\\": \\"undefined Devnet\\",[39m
[2m    \\"bech32_prefix\\": \\"osmo\\",[22m
[2m    \\"daemon_name\\": \\"osmosisd\\",[22m
[2m    \\"node_home\\": \\"/root/.osmosisd\\",[22m
[33m@@ -78,6 +78,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "registry",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "registry-custom-1",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "registry-custom-1",[22m
[2m    },[22m
[2m  }[22m

--- Deployment/registry ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,14 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "Deployment",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "registry",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "registry",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "registry",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +17,6 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "registry",[39m
[2m          "app.kubernetes.io/name": "registry",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -22,19 +29,17 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "registry",[39m
[31m+           "app.kubernetes.io/component": "registry",[39m
[31m+           "app.kubernetes.io/managed-by": "starship",[39m
[2m            "app.kubernetes.io/name": "registry",[22m
[32m-           "app.kubernetes.io/rawname": "registry",[39m
[32m-           "app.kubernetes.io/type": "registry",[39m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/part-of": "starship",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+           "starship.io/name": "starship-e2e-tests",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[2m          "containers": Array [[22m
[2m            Object {[22m
[32m-             "command": Array [[39m
[32m-               "registry",[39m
[32m-             ],[39m
[2m              "env": Array [[22m
[2m                Object {[22m
[2m                  "name": "NAMESPACE",[22m
[33m@@ -66,7 +71,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "REGISTRY_CHAIN_CLIENT_NAMES",[22m
[32m-                 "value": "custom-1",[39m
[31m+                 "value": "custom",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "REGISTRY_CHAIN_CLIENT_RPCS",[22m
[33m@@ -74,21 +79,20 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "REGISTRY_CHAIN_REGISTRY",[22m
[32m-                 "value": "/configs",[39m
[31m+                 "value": "/chains",[39m
[2m                },[22m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/registry:20250205-544757d",[22m
[32m-             "imagePullPolicy": "IfNotPresent",[39m
[2m              "livenessProbe": Object {[22m
[32m-               "initialDelaySeconds": 20,[39m
[32m-               "periodSeconds": 10,[39m
[31m+               "initialDelaySeconds": 15,[39m
[31m+               "periodSeconds": 20,[39m
[2m                "tcpSocket": Object {[22m
[2m                  "port": 8080,[22m
[2m                },[22m
[2m              },[22m
[2m              "name": "registry",[22m
[2m              "readinessProbe": Object {[22m
[32m-               "initialDelaySeconds": 20,[39m
[31m+               "initialDelaySeconds": 5,[39m
[2m                "periodSeconds": 10,[22m
[2m                "tcpSocket": Object {[22m
[2m                  "port": 8080,[22m
[33m@@ -96,18 +100,18 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[2m                Object {[22m
[32m-                 "mountPath": "/configs/custom-1",[39m
[32m-                 "name": "registry-configs-custom-1",[39m
[31m+                 "mountPath": "/chains/custom-1",[39m
[31m+                 "name": "registry-custom-1",[39m
[2m                },[22m
[2m              ],[22m
[2m            },[22m
[33m@@ -139,16 +143,16 @@[39m
[2m                  },[22m
[2m                },[22m
[2m              ],[22m
[32m-             "image": "curlimages/curl",[39m
[31m+             "image": "curlimages/curl:latest",[39m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "wait-for-chains",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -159,7 +163,7 @@[39m
[2m              "configMap": Object {[22m
[2m                "name": "registry-custom-1",[22m
[2m              },[22m
[32m-             "name": "registry-configs-custom-1",[39m
[31m+             "name": "registry-custom-1",[39m
[2m            },[22m
[2m          ],[22m
[2m        },[22m"
`;

exports[`Manifest Comparison Tests Individual Config Comparisons should generate manifests for simapp that match the snapshot 1`] = `
"ðŸ”„ MODIFIED_RESOURCES:

--- ConfigMap/keys ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -98,6 +98,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "configmap",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "keys",[39m
[31m+       "app.kubernetes.io/part-of": "global",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "keys",[22m
[2m    },[22m
[2m  }[22m

--- ConfigMap/setup-scripts ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -208,6 +208,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "configmap",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts",[39m
[31m+       "app.kubernetes.io/part-of": "global",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts",[22m
[2m    },[22m
[2m  }[22m

--- Deployment/registry ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,14 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "Deployment",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "registry",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "registry",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "registry",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +17,6 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "registry",[39m
[2m          "app.kubernetes.io/name": "registry",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -22,19 +29,17 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "registry",[39m
[31m+           "app.kubernetes.io/component": "registry",[39m
[31m+           "app.kubernetes.io/managed-by": "starship",[39m
[2m            "app.kubernetes.io/name": "registry",[22m
[32m-           "app.kubernetes.io/rawname": "registry",[39m
[32m-           "app.kubernetes.io/type": "registry",[39m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/part-of": "starship",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+           "starship.io/name": "starship-e2e-tests",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[2m          "containers": Array [[22m
[2m            Object {[22m
[32m-             "command": Array [[39m
[32m-               "registry",[39m
[32m-             ],[39m
[2m              "env": Array [[22m
[2m                Object {[22m
[2m                  "name": "NAMESPACE",[22m
[33m@@ -74,21 +79,20 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "REGISTRY_CHAIN_REGISTRY",[22m
[32m-                 "value": "/configs",[39m
[31m+                 "value": "/chains",[39m
[2m                },[22m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/registry:20250205-544757d",[22m
[32m-             "imagePullPolicy": "Always",[39m
[2m              "livenessProbe": Object {[22m
[32m-               "initialDelaySeconds": 20,[39m
[32m-               "periodSeconds": 10,[39m
[31m+               "initialDelaySeconds": 15,[39m
[31m+               "periodSeconds": 20,[39m
[2m                "tcpSocket": Object {[22m
[2m                  "port": 8080,[22m
[2m                },[22m
[2m              },[22m
[2m              "name": "registry",[22m
[2m              "readinessProbe": Object {[22m
[32m-               "initialDelaySeconds": 20,[39m
[31m+               "initialDelaySeconds": 5,[39m
[2m                "periodSeconds": 10,[22m
[2m                "tcpSocket": Object {[22m
[2m                  "port": 8080,[22m
[33m@@ -96,18 +100,18 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[2m                Object {[22m
[32m-                 "mountPath": "/configs/simapp",[39m
[32m-                 "name": "registry-configs-simapp",[39m
[31m+                 "mountPath": "/chains/simapp",[39m
[31m+                 "name": "registry-simapp",[39m
[2m                },[22m
[2m              ],[22m
[2m            },[22m
[33m@@ -139,16 +143,16 @@[39m
[2m                  },[22m
[2m                },[22m
[2m              ],[22m
[32m-             "image": "curlimages/curl",[39m
[31m+             "image": "curlimages/curl:latest",[39m
[2m              "imagePullPolicy": "Always",[22m
[2m              "name": "wait-for-chains",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -159,7 +163,7 @@[39m
[2m              "configMap": Object {[22m
[2m                "name": "registry-simapp",[22m
[2m              },[22m
[32m-             "name": "registry-configs-simapp",[39m
[31m+             "name": "registry-simapp",[39m
[2m            },[22m
[2m          ],[22m
[2m        },[22m

--- ConfigMap/registry-simapp ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -78,6 +78,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "registry",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "registry-simapp",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "registry-simapp",[22m
[2m    },[22m
[2m  }[22m

--- StatefulSet/simapp-genesis ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,18 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/id": "simapp",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "simapp-genesis",[39m
[31m+       "app.kubernetes.io/part-of": "simapp",[39m
[31m+       "app.kubernetes.io/role": "genesis",[39m
[31m+       "app.kubernetes.io/type": "simapp-statefulset",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-name": "simapp",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "simapp-genesis",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +21,7 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "simapp",[39m
[31m+         "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m          "app.kubernetes.io/name": "simapp-genesis",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -23,11 +35,12 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "simapp",[39m
[31m+           "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m            "app.kubernetes.io/name": "simapp-genesis",[22m
[2m            "app.kubernetes.io/rawname": "simapp",[22m
[31m+           "app.kubernetes.io/role": "genesis",[39m
[2m            "app.kubernetes.io/type": "simapp",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[33m@@ -91,11 +104,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -184,11 +197,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -211,7 +224,12 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "START_ARGS=\\"\\"[39m
[31m+               "#!/bin/bash[39m
[31m+ set -euo pipefail[39m
[31m+[39m
[31m+ START_ARGS=\\"\\"[39m
[31m+[39m
[31m+[39m
[2m  $CHAIN_BIN start $START_ARGS",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -274,11 +292,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "400M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "400M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -307,6 +325,7 @@[39m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m

[2m  echo \\"Running setup config script...\\"[22m
[31m+[39m
[2m  bash -e /scripts/update-config.sh",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -348,7 +367,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "TIME_IOTA_MS",[22m
[33m@@ -388,11 +407,11 @@[39m
[2m              "name": "init-config",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "400M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "400M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -415,20 +434,18 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "# Install faucet binary from the image[39m
[32m- cp /bin/faucet /faucet/faucet[39m
[32m- chmod +x /faucet/faucet",[39m
[31m+               "cp /bin/faucet /faucet/faucet && chmod +x /faucet/faucet",[39m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/faucet:20250325-2207109",[22m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "init-faucet",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "400M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "400M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -553,11 +570,11 @@[39m
[2m              "name": "init-genesis",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "400M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "400M",[22m
[2m                },[22m
[2m              },[22m

--- ConfigMap/setup-scripts-simapp ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -608,6 +608,17 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts-simapp",[39m
[31m+       "app.kubernetes.io/part-of": "simapp",[39m
[31m+       "app.kubernetes.io/role": "setup-scripts",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-id": "simapp",[39m
[31m+       "starship.io/chain-name": "simapp",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts-simapp",[22m
[2m    },[22m
[2m  }[22m

--- Service/simapp-validator ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -23,6 +23,12 @@[39m
[2m          "targetPort": 8081,[22m
[2m        },[22m
[2m        Object {[22m
[31m+         "name": "faucet",[39m
[31m+         "port": 8000,[39m
[31m+         "protocol": "TCP",[39m
[31m+         "targetPort": 8000,[39m
[31m+       },[39m
[31m+       Object {[39m
[2m          "name": "grpc",[22m
[2m          "port": 9090,[22m
[2m          "protocol": "TCP",[22m

--- StatefulSet/simapp-validator ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,18 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/id": "simapp",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "simapp-validator",[39m
[31m+       "app.kubernetes.io/part-of": "simapp",[39m
[31m+       "app.kubernetes.io/role": "validator",[39m
[31m+       "app.kubernetes.io/type": "simapp-statefulset",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-name": "simapp",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "simapp-validator",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -10,7 +22,7 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "simapp",[39m
[31m+         "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m          "app.kubernetes.io/name": "simapp-validator",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -24,10 +36,11 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "simapp",[39m
[31m+           "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m            "app.kubernetes.io/name": "simapp-validator",[22m
[31m+           "app.kubernetes.io/role": "validator",[39m
[2m            "app.kubernetes.io/type": "simapp",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[33m@@ -119,11 +132,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -145,7 +158,9 @@[39m
[2m                "set -eux[22m
[2m  START_ARGS=\\"\\"[22m

[31m+[39m
[2m  # Starting the chain[22m
[31m+[39m
[2m  $CHAIN_BIN start $START_ARGS",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -255,11 +270,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "400M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "400M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -286,6 +301,7 @@[39m
[2m                "-c",[22m
[2m                "VAL_INDEX=\${HOSTNAME##*-}[22m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m
[31m+[39m

[2m  echo \\"Running setup config script...\\"[22m
[2m  bash -e /scripts/update-config.sh[22m
[33m@@ -351,7 +367,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "NAMESPACE",[22m
[33m@@ -399,11 +415,11 @@[39m
[2m              "name": "init-config",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "400M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "400M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -428,6 +444,7 @@[39m
[2m                "-c",[22m
[2m                "VAL_INDEX=\${HOSTNAME##*-}[22m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m
[31m+[39m

[2m  if [ -f $CHAIN_DIR/config/genesis.json ]; then[22m
[2m    echo \\"Genesis file exists, exiting early\\"[22m
[33m@@ -500,7 +517,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "NAMESPACE",[22m
[33m@@ -548,11 +565,11 @@[39m
[2m              "name": "init-validator",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "400M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "400M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -597,16 +614,16 @@[39m
[2m                  },[22m
[2m                },[22m
[2m              ],[22m
[32m-             "image": "curlimages/curl",[39m
[31m+             "image": "curlimages/curl:latest",[39m
[2m              "imagePullPolicy": "Always",[22m
[2m              "name": "wait-for-chains",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -618,6 +635,10 @@[39m
[2m                "name": "keys",[22m
[2m              },[22m
[2m              "name": "addresses",[22m
[31m+           },[39m
[31m+           Object {[39m
[31m+             "emptyDir": Object {},[39m
[31m+             "name": "faucet",[39m
[2m            },[22m
[2m            Object {[22m
[2m              "emptyDir": Object {},[22m"
`;

exports[`Manifest Comparison Tests Individual Config Comparisons should generate manifests for three-chain that match the snapshot 1`] = `
"ðŸ”„ MODIFIED_RESOURCES:

--- ConfigMap/keys ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -98,6 +98,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "configmap",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "keys",[39m
[31m+       "app.kubernetes.io/part-of": "global",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "keys",[22m
[2m    },[22m
[2m  }[22m

--- ConfigMap/setup-scripts ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -208,6 +208,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "configmap",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts",[39m
[31m+       "app.kubernetes.io/part-of": "global",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts",[22m
[2m    },[22m
[2m  }[22m

--- StatefulSet/cosmoshub-4-genesis ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,18 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/id": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "cosmoshub-4-genesis",[39m
[31m+       "app.kubernetes.io/part-of": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/role": "genesis",[39m
[31m+       "app.kubernetes.io/type": "cosmoshub-4-statefulset",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-name": "cosmoshub",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "cosmoshub-4-genesis",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +21,7 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "cosmoshub",[39m
[31m+         "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m          "app.kubernetes.io/name": "cosmoshub-4-genesis",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -23,11 +35,12 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "cosmoshub",[39m
[31m+           "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m            "app.kubernetes.io/name": "cosmoshub-4-genesis",[22m
[2m            "app.kubernetes.io/rawname": "cosmoshub-4",[22m
[31m+           "app.kubernetes.io/role": "genesis",[39m
[2m            "app.kubernetes.io/type": "cosmoshub-4",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[33m@@ -91,11 +104,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -114,7 +127,12 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "START_ARGS=\\"\\"[39m
[31m+               "#!/bin/bash[39m
[31m+ set -euo pipefail[39m
[31m+[39m
[31m+ START_ARGS=\\"\\"[39m
[31m+[39m
[31m+[39m
[2m  $CHAIN_BIN start $START_ARGS",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -177,11 +195,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -210,6 +228,7 @@[39m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m

[2m  echo \\"Running setup config script...\\"[22m
[31m+[39m
[2m  bash -e /scripts/update-config.sh",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -251,7 +270,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "TIME_IOTA_MS",[22m
[33m@@ -291,11 +310,11 @@[39m
[2m              "name": "init-config",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -428,11 +447,11 @@[39m
[2m              "name": "init-genesis",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m

--- ConfigMap/setup-scripts-cosmoshub-4 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -608,6 +608,17 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts-cosmoshub-4",[39m
[31m+       "app.kubernetes.io/part-of": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/role": "setup-scripts",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-id": "cosmoshub-4",[39m
[31m+       "starship.io/chain-name": "cosmoshub",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts-cosmoshub-4",[22m
[2m    },[22m
[2m  }[22m

--- StatefulSet/juno-2-genesis ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,18 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/id": "juno-2",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "juno-2-genesis",[39m
[31m+       "app.kubernetes.io/part-of": "juno-2",[39m
[31m+       "app.kubernetes.io/role": "genesis",[39m
[31m+       "app.kubernetes.io/type": "juno-2-statefulset",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-name": "juno",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "juno-2-genesis",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +21,7 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "juno",[39m
[31m+         "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m          "app.kubernetes.io/name": "juno-2-genesis",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -23,11 +35,12 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "juno",[39m
[31m+           "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m            "app.kubernetes.io/name": "juno-2-genesis",[22m
[2m            "app.kubernetes.io/rawname": "juno-2",[22m
[31m+           "app.kubernetes.io/role": "genesis",[39m
[2m            "app.kubernetes.io/type": "juno-2",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[33m@@ -91,11 +104,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -114,7 +127,12 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "START_ARGS=\\"\\"[39m
[31m+               "#!/bin/bash[39m
[31m+ set -euo pipefail[39m
[31m+[39m
[31m+ START_ARGS=\\"\\"[39m
[31m+[39m
[31m+[39m
[2m  $CHAIN_BIN start $START_ARGS",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -177,11 +195,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -210,6 +228,7 @@[39m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m

[2m  echo \\"Running setup config script...\\"[22m
[31m+[39m
[2m  bash -e /scripts/update-config.sh",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -251,7 +270,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "TIME_IOTA_MS",[22m
[33m@@ -291,11 +310,11 @@[39m
[2m              "name": "init-config",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -428,11 +447,11 @@[39m
[2m              "name": "init-genesis",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m

--- ConfigMap/setup-scripts-juno-2 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -608,6 +608,17 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts-juno-2",[39m
[31m+       "app.kubernetes.io/part-of": "juno-2",[39m
[31m+       "app.kubernetes.io/role": "setup-scripts",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-id": "juno-2",[39m
[31m+       "starship.io/chain-name": "juno",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts-juno-2",[22m
[2m    },[22m
[2m  }[22m

--- StatefulSet/osmosis-1-genesis ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,18 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/id": "osmosis-1",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "osmosis-1-genesis",[39m
[31m+       "app.kubernetes.io/part-of": "osmosis-1",[39m
[31m+       "app.kubernetes.io/role": "genesis",[39m
[31m+       "app.kubernetes.io/type": "osmosis-1-statefulset",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-name": "osmosis",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "osmosis-1-genesis",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +21,7 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "osmosis",[39m
[31m+         "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m          "app.kubernetes.io/name": "osmosis-1-genesis",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -23,11 +35,12 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "osmosis",[39m
[31m+           "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m            "app.kubernetes.io/name": "osmosis-1-genesis",[22m
[2m            "app.kubernetes.io/rawname": "osmosis-1",[22m
[31m+           "app.kubernetes.io/role": "genesis",[39m
[2m            "app.kubernetes.io/type": "osmosis-1",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[33m@@ -91,11 +104,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -114,7 +127,12 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "START_ARGS=\\"\\"[39m
[31m+               "#!/bin/bash[39m
[31m+ set -euo pipefail[39m
[31m+[39m
[31m+ START_ARGS=\\"\\"[39m
[31m+[39m
[31m+[39m
[2m  $CHAIN_BIN start $START_ARGS",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -177,11 +195,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -210,6 +228,7 @@[39m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m

[2m  echo \\"Running setup config script...\\"[22m
[31m+[39m
[2m  bash -e /scripts/update-config.sh",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -251,7 +270,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "TIME_IOTA_MS",[22m
[33m@@ -291,11 +310,11 @@[39m
[2m              "name": "init-config",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -428,11 +447,11 @@[39m
[2m              "name": "init-genesis",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m

--- ConfigMap/setup-scripts-osmosis-1 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -608,6 +608,17 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts-osmosis-1",[39m
[31m+       "app.kubernetes.io/part-of": "osmosis-1",[39m
[31m+       "app.kubernetes.io/role": "setup-scripts",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-id": "osmosis-1",[39m
[31m+       "starship.io/chain-name": "osmosis",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts-osmosis-1",[22m
[2m    },[22m
[2m  }[22m

--- ConfigMap/registry-cosmoshub-4 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -7,7 +7,14 @@[39m
[2m    \\"assets\\": [[22m
[2m      {[22m
[2m        \\"base\\": \\"uatom\\",[22m
[32m-       \\"coingecko_id\\": \\"atom\\",[39m
[31m+       \\"description\\": \\"The native staking and governance token of the Cosmos Hub.\\",[39m
[31m+       \\"name\\": \\"Cosmos Hub Atom\\",[39m
[31m+       \\"display\\": \\"atom\\",[39m
[31m+       \\"symbol\\": \\"ATOM\\",[39m
[31m+       \\"logo_URIs\\": {[39m
[31m+         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/cosmoshub/images/atom.png\\",[39m
[31m+         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/cosmoshub/images/atom.svg\\"[39m
[31m+       },[39m
[2m        \\"denom_units\\": [[22m
[2m          {[22m
[2m            \\"denom\\": \\"uatom\\",[22m
[33m@@ -18,14 +25,7 @@[39m
[2m            \\"exponent\\": 6[22m
[2m          }[22m
[2m        ],[22m
[32m-       \\"description\\": \\"The native staking and governance token of the Cosmos Hub.\\",[39m
[32m-       \\"display\\": \\"atom\\",[39m
[32m-       \\"logo_URIs\\": {[39m
[32m-         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/cosmoshub/images/atom.png\\",[39m
[32m-         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/cosmoshub/images/atom.svg\\"[39m
[32m-       },[39m
[32m-       \\"name\\": \\"Cosmos Hub Atom\\",[39m
[32m-       \\"symbol\\": \\"ATOM\\"[39m
[31m+       \\"coingecko_id\\": \\"atom\\"[39m
[2m      }[22m
[2m    ][22m
[2m  }",[22m
[33m@@ -82,6 +82,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "registry",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "registry-cosmoshub-4",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "registry-cosmoshub-4",[22m
[2m    },[22m
[2m  }[22m

--- Deployment/registry ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,14 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "Deployment",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "registry",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "registry",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "registry",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +17,6 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "registry",[39m
[2m          "app.kubernetes.io/name": "registry",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -22,19 +29,17 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "registry",[39m
[31m+           "app.kubernetes.io/component": "registry",[39m
[31m+           "app.kubernetes.io/managed-by": "starship",[39m
[2m            "app.kubernetes.io/name": "registry",[22m
[32m-           "app.kubernetes.io/rawname": "registry",[39m
[32m-           "app.kubernetes.io/type": "registry",[39m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/part-of": "starship",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+           "starship.io/name": "starship-e2e-tests",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[2m          "containers": Array [[22m
[2m            Object {[22m
[32m-             "command": Array [[39m
[32m-               "registry",[39m
[32m-             ],[39m
[2m              "env": Array [[22m
[2m                Object {[22m
[2m                  "name": "NAMESPACE",[22m
[33m@@ -74,21 +79,20 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "REGISTRY_CHAIN_REGISTRY",[22m
[32m-                 "value": "/configs",[39m
[31m+                 "value": "/chains",[39m
[2m                },[22m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/registry:20250205-544757d",[22m
[32m-             "imagePullPolicy": "IfNotPresent",[39m
[2m              "livenessProbe": Object {[22m
[32m-               "initialDelaySeconds": 20,[39m
[32m-               "periodSeconds": 10,[39m
[31m+               "initialDelaySeconds": 15,[39m
[31m+               "periodSeconds": 20,[39m
[2m                "tcpSocket": Object {[22m
[2m                  "port": 8080,[22m
[2m                },[22m
[2m              },[22m
[2m              "name": "registry",[22m
[2m              "readinessProbe": Object {[22m
[32m-               "initialDelaySeconds": 20,[39m
[31m+               "initialDelaySeconds": 5,[39m
[2m                "periodSeconds": 10,[22m
[2m                "tcpSocket": Object {[22m
[2m                  "port": 8080,[22m
[33m@@ -96,26 +100,26 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[2m                Object {[22m
[32m-                 "mountPath": "/configs/cosmoshub-4",[39m
[32m-                 "name": "registry-configs-cosmoshub-4",[39m
[31m+                 "mountPath": "/chains/cosmoshub-4",[39m
[31m+                 "name": "registry-cosmoshub-4",[39m
[2m                },[22m
[2m                Object {[22m
[32m-                 "mountPath": "/configs/juno-2",[39m
[32m-                 "name": "registry-configs-juno-2",[39m
[31m+                 "mountPath": "/chains/juno-2",[39m
[31m+                 "name": "registry-juno-2",[39m
[2m                },[22m
[2m                Object {[22m
[32m-                 "mountPath": "/configs/osmosis-1",[39m
[32m-                 "name": "registry-configs-osmosis-1",[39m
[31m+                 "mountPath": "/chains/osmosis-1",[39m
[31m+                 "name": "registry-osmosis-1",[39m
[2m                },[22m
[2m              ],[22m
[2m            },[22m
[33m@@ -130,11 +134,13 @@[39m
[2m    echo \\"Checking: http://osmosis-1-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id\\"[22m
[2m    sleep 10;[22m
[2m  done[22m
[31m+[39m
[2m  while [ $(curl -sw '%{http_code}' http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id -o /dev/null) -ne 200 ]; do[22m
[2m    echo \\"Genesis validator does not seem to be ready for: cosmoshub-4. Waiting for it to start...\\"[22m
[2m    echo \\"Checking: http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id\\"[22m
[2m    sleep 10;[22m
[2m  done[22m
[31m+[39m
[2m  while [ $(curl -sw '%{http_code}' http://juno-2-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id -o /dev/null) -ne 200 ]; do[22m
[2m    echo \\"Genesis validator does not seem to be ready for: juno-2. Waiting for it to start...\\"[22m
[2m    echo \\"Checking: http://juno-2-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id\\"[22m
[33m@@ -157,16 +163,16 @@[39m
[2m                  },[22m
[2m                },[22m
[2m              ],[22m
[32m-             "image": "curlimages/curl",[39m
[31m+             "image": "curlimages/curl:latest",[39m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "wait-for-chains",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -177,19 +183,19 @@[39m
[2m              "configMap": Object {[22m
[2m                "name": "registry-cosmoshub-4",[22m
[2m              },[22m
[32m-             "name": "registry-configs-cosmoshub-4",[39m
[31m+             "name": "registry-cosmoshub-4",[39m
[2m            },[22m
[2m            Object {[22m
[2m              "configMap": Object {[22m
[2m                "name": "registry-juno-2",[22m
[2m              },[22m
[32m-             "name": "registry-configs-juno-2",[39m
[31m+             "name": "registry-juno-2",[39m
[2m            },[22m
[2m            Object {[22m
[2m              "configMap": Object {[22m
[2m                "name": "registry-osmosis-1",[22m
[2m              },[22m
[32m-             "name": "registry-configs-osmosis-1",[39m
[31m+             "name": "registry-osmosis-1",[39m
[2m            },[22m
[2m          ],[22m
[2m        },[22m

--- ConfigMap/registry-juno-2 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -7,7 +7,14 @@[39m
[2m    \\"assets\\": [[22m
[2m      {[22m
[2m        \\"base\\": \\"ujuno\\",[22m
[32m-       \\"coingecko_id\\": \\"juno-network\\",[39m
[31m+       \\"description\\": \\"The native token of JUNO Chain\\",[39m
[31m+       \\"name\\": \\"Juno\\",[39m
[31m+       \\"display\\": \\"juno\\",[39m
[31m+       \\"symbol\\": \\"JUNO\\",[39m
[31m+       \\"logo_URIs\\": {[39m
[31m+         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/juno/images/juno.png\\",[39m
[31m+         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/juno/images/juno.svg\\"[39m
[31m+       },[39m
[2m        \\"denom_units\\": [[22m
[2m          {[22m
[2m            \\"denom\\": \\"ujuno\\",[22m
[33m@@ -18,14 +25,7 @@[39m
[2m            \\"exponent\\": 6[22m
[2m          }[22m
[2m        ],[22m
[32m-       \\"description\\": \\"The native token of JUNO Chain\\",[39m
[32m-       \\"display\\": \\"juno\\",[39m
[32m-       \\"logo_URIs\\": {[39m
[32m-         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/juno/images/juno.png\\",[39m
[32m-         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/juno/images/juno.svg\\"[39m
[32m-       },[39m
[32m-       \\"name\\": \\"Juno\\",[39m
[32m-       \\"symbol\\": \\"JUNO\\"[39m
[31m+       \\"coingecko_id\\": \\"juno-network\\"[39m
[2m      }[22m
[2m    ][22m
[2m  }",[22m
[33m@@ -82,6 +82,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "registry",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "registry-juno-2",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "registry-juno-2",[22m
[2m    },[22m
[2m  }[22m

--- ConfigMap/registry-osmosis-1 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -7,7 +7,14 @@[39m
[2m    \\"assets\\": [[22m
[2m      {[22m
[2m        \\"base\\": \\"uosmo\\",[22m
[32m-       \\"coingecko_id\\": \\"osmosis\\",[39m
[31m+       \\"description\\": \\"The native token of Osmosis\\",[39m
[31m+       \\"name\\": \\"Osmosis\\",[39m
[31m+       \\"display\\": \\"osmo\\",[39m
[31m+       \\"symbol\\": \\"OSMO\\",[39m
[31m+       \\"logo_URIs\\": {[39m
[31m+         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/osmo.png\\",[39m
[31m+         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/osmo.svg\\"[39m
[31m+       },[39m
[2m        \\"denom_units\\": [[22m
[2m          {[22m
[2m            \\"denom\\": \\"uosmo\\",[22m
[33m@@ -18,22 +25,21 @@[39m
[2m            \\"exponent\\": 6[22m
[2m          }[22m
[2m        ],[22m
[32m-       \\"description\\": \\"The native token of Osmosis\\",[39m
[32m-       \\"display\\": \\"osmo\\",[39m
[31m+       \\"coingecko_id\\": \\"osmosis\\",[39m
[2m        \\"keywords\\": [[22m
[2m          \\"staking\\",[22m
[2m          \\"dex\\"[22m
[32m-       ],[39m
[32m-       \\"logo_URIs\\": {[39m
[32m-         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/osmo.png\\",[39m
[32m-         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/osmo.svg\\"[39m
[32m-       },[39m
[32m-       \\"name\\": \\"Osmosis\\",[39m
[32m-       \\"symbol\\": \\"OSMO\\"[39m
[31m+       ][39m
[2m      },[22m
[2m      {[22m
[2m        \\"base\\": \\"uion\\",[22m
[32m-       \\"coingecko_id\\": \\"ion\\",[39m
[31m+       \\"name\\": \\"Ion\\",[39m
[31m+       \\"display\\": \\"ion\\",[39m
[31m+       \\"symbol\\": \\"ION\\",[39m
[31m+       \\"logo_URIs\\": {[39m
[31m+         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/ion.png\\",[39m
[31m+         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/ion.svg\\"[39m
[31m+       },[39m
[2m        \\"denom_units\\": [[22m
[2m          {[22m
[2m            \\"denom\\": \\"uion\\",[22m
[33m@@ -44,16 +50,10 @@[39m
[2m            \\"exponent\\": 6[22m
[2m          }[22m
[2m        ],[22m
[32m-       \\"display\\": \\"ion\\",[39m
[31m+       \\"coingecko_id\\": \\"ion\\",[39m
[2m        \\"keywords\\": [[22m
[2m          \\"memecoin\\"[22m
[32m-       ],[39m
[32m-       \\"logo_URIs\\": {[39m
[32m-         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/ion.png\\",[39m
[32m-         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/ion.svg\\"[39m
[32m-       },[39m
[32m-       \\"name\\": \\"Ion\\",[39m
[32m-       \\"symbol\\": \\"ION\\"[39m
[31m+       ][39m
[2m      }[22m
[2m    ][22m
[2m  }",[22m
[33m@@ -110,6 +110,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "registry",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "registry-osmosis-1",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "registry-osmosis-1",[22m
[2m    },[22m
[2m  }[22m

--- ConfigMap/hermes-relayer ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -3,92 +3,45 @@[39m
[2m    "data": Object {[22m
[2m      "config-cli.toml": "# The global section has parameters that apply globally to the relayer operation.[22m
[2m  [global][22m
[32m- # Specify the verbosity for the relayer logging output. Default: 'info'[39m
[32m- # Valid options are 'error', 'warn', 'info', 'debug', 'trace'.[39m
[32m- log_level = 'info'[39m
[32m- # Specify the mode to be used by the relayer. [Required][39m
[31m+ log_level = \\"info\\"[39m
[31m+[39m
[2m  [mode][22m
[32m- # Specify the client mode.[39m
[2m  [mode.clients][22m
[32m- # Whether or not to enable the client workers. [Required][39m
[2m  enabled = true[22m
[32m- # Whether or not to enable periodic refresh of clients. [Default: true][39m
[32m- # This feature only applies to clients that underlie an open channel.[39m
[32m- # For Tendermint clients, the frequency at which Hermes refreshes them is 2/3 of their[39m
[32m- # trusting period (e.g., refresh every ~9 days if the trusting period is 14 days).[39m
[32m- # Note: Even if this is disabled, clients will be refreshed automatically if[39m
[32m- #      there is activity on a connection or channel they are involved with.[39m
[2m  refresh = true[22m
[32m- # Whether or not to enable misbehaviour detection for clients. [Default: false][39m
[2m  misbehaviour = true[22m
[32m- # Specify the connections mode.[39m
[31m+[39m
[2m  [mode.connections][22m
[32m- # Whether or not to enable the connection workers for handshake completion. [Required][39m
[2m  enabled = true[22m
[32m- # Specify the channels mode.[39m
[31m+[39m
[2m  [mode.channels][22m
[32m- # Whether or not to enable the channel workers for handshake completion. [Required][39m
[2m  enabled = true[22m
[32m- # Specify the packets mode.[39m
[31m+[39m
[2m  [mode.packets][22m
[32m- # Whether or not to enable the packet workers. [Required][39m
[2m  enabled = true[22m
[32m- # Parametrize the periodic packet clearing feature.[39m
[32m- # Interval (in number of blocks) at which pending packets[39m
[32m- # should be periodically cleared. A value of '0' will disable[39m
[32m- # periodic packet clearing. [Default: 100][39m
[2m  clear_interval = 100[22m
[32m- # Whether or not to clear packets on start. [Default: false][39m
[2m  clear_on_start = true[22m
[32m- # Toggle the transaction confirmation mechanism.[39m
[32m- # The tx confirmation mechanism periodically queries the \`/tx_search\` RPC[39m
[32m- # endpoint to check that previously-submitted transactions[39m
[32m- # (to any chain in this config file) have been successfully delivered.[39m
[32m- # If they have not been, and \`clear_interval = 0\`, then those packets are[39m
[32m- # queued up for re-submission.[39m
[32m- # Experimental feature. Affects telemetry if set to false.[39m
[32m- # [Default: true][39m
[2m  tx_confirmation = true[22m
[32m- # Auto register the counterparty payee on a destination chain to[39m
[32m- # the relayer's address on the source chain. This can be used[39m
[32m- # for simple configuration of the relayer to receive fees for[39m
[32m- # relaying RecvPacket on fee-enabled channels.[39m
[32m- # For more complex configuration, turn this off and use the CLI[39m
[32m- # to manually register the payee addresses.[39m
[32m- # [Default: false][39m
[32m- auto_register_counterparty_payee = false[39m
[32m- # The REST section defines parameters for Hermes' built-in RESTful API.[39m
[32m- # https://hermes.informal.systems/rest.html[39m
[31m+[39m
[2m  [rest][22m
[32m- # Whether or not to enable the REST service. Default: false[39m
[2m  enabled = true[22m
[32m- # Specify the IPv4/6 host over which the built-in HTTP server will serve the RESTful[39m
[32m- # API requests. Default: 127.0.0.1[39m
[32m- host =  '0.0.0.0'[39m
[32m- # Specify the port over which the built-in HTTP server will serve the restful API[39m
[32m- # requests. Default: 3000[39m
[31m+ host = \\"0.0.0.0\\"[39m
[2m  port = 3000[22m
[32m- # The telemetry section defines parameters for Hermes' built-in telemetry capabilities.[39m
[32m- # https://hermes.informal.systems/telemetry.html[39m
[31m+[39m
[2m  [telemetry][22m
[32m- # Whether or not to enable the telemetry service. Default: false[39m
[2m  enabled = true[22m
[32m- # Specify the IPv4/6 host over which the built-in HTTP server will serve the metrics[39m
[32m- # gathered by the telemetry service. Default: 127.0.0.1[39m
[32m- host = '0.0.0.0'[39m
[32m- # Specify the port over which the built-in HTTP server will serve the metrics gathered[39m
[32m- # by the telemetry service. Default: 3001[39m
[31m+ host = \\"0.0.0.0\\"[39m
[2m  port = 3001[22m


[32m-[39m
[2m  [[chains]][22m
[2m  id = \\"osmosis-1\\"[22m
[31m+ type = \\"CosmosSdk\\"[39m
[2m  key_name = \\"osmosis-1-cli\\"[22m
[32m- rpc_addr = \\"http://osmosis-1-genesis.default.svc.cluster.local:26657\\"[39m
[32m- grpc_addr = \\"http://osmosis-1-genesis.default.svc.cluster.local:9090\\"[39m
[32m- event_source = { mode = 'push', url = \\"ws://osmosis-1-genesis.default.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[32m- # Experimental: Whether or not the full node is trusted.[39m
[31m+[39m
[31m+ rpc_addr = \\"http://osmosis-1-genesis.$NAMESPACE.svc.cluster.local:26657\\"[39m
[31m+ grpc_addr = \\"http://osmosis-1-genesis.$NAMESPACE.svc.cluster.local:9090\\"[39m
[31m+ event_source = { mode = 'push', url = \\"ws://osmosis-1-genesis.$NAMESPACE.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[2m  trusted_node = false[22m
[2m  account_prefix = \\"osmo\\"[22m
[2m  default_gas = 500000000[22m
[33m@@ -103,17 +56,16 @@[39m
[2m  trusting_period = \\"75s\\"[22m
[2m  trust_threshold = { numerator = \\"2\\", denominator = \\"3\\" }[22m
[2m  address_type = { derivation = 'cosmos' }[22m
[32m- gas_price = { price = 0.25, denom = \\"uosmo\\" }[39m
[32m-[39m
[32m-[39m
[31m+ gas_price = { price = 1.25, denom = \\"uosmo\\" }[39m

[2m  [[chains]][22m
[2m  id = \\"cosmoshub-4\\"[22m
[31m+ type = \\"CosmosSdk\\"[39m
[2m  key_name = \\"cosmoshub-4-cli\\"[22m
[32m- rpc_addr = \\"http://cosmoshub-4-genesis.default.svc.cluster.local:26657\\"[39m
[32m- grpc_addr = \\"http://cosmoshub-4-genesis.default.svc.cluster.local:9090\\"[39m
[32m- event_source = { mode = 'push', url = \\"ws://cosmoshub-4-genesis.default.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[32m- # Experimental: Whether or not the full node is trusted.[39m
[31m+[39m
[31m+ rpc_addr = \\"http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:26657\\"[39m
[31m+ grpc_addr = \\"http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:9090\\"[39m
[31m+ event_source = { mode = 'push', url = \\"ws://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[2m  trusted_node = false[22m
[2m  account_prefix = \\"cosmos\\"[22m
[2m  default_gas = 500000000[22m
[33m@@ -128,17 +80,16 @@[39m
[2m  trusting_period = \\"75s\\"[22m
[2m  trust_threshold = { numerator = \\"2\\", denominator = \\"3\\" }[22m
[2m  address_type = { derivation = 'cosmos' }[22m
[32m- gas_price = { price = 0.25, denom = \\"uatom\\" }[39m
[31m+ gas_price = { price = 1.25, denom = \\"uatom\\" }[39m

[32m-[39m
[32m-[39m
[2m  [[chains]][22m
[2m  id = \\"juno-2\\"[22m
[31m+ type = \\"CosmosSdk\\"[39m
[2m  key_name = \\"juno-2-cli\\"[22m
[32m- rpc_addr = \\"http://juno-2-genesis.default.svc.cluster.local:26657\\"[39m
[32m- grpc_addr = \\"http://juno-2-genesis.default.svc.cluster.local:9090\\"[39m
[32m- event_source = { mode = 'push', url = \\"ws://juno-2-genesis.default.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[32m- # Experimental: Whether or not the full node is trusted.[39m
[31m+[39m
[31m+ rpc_addr = \\"http://juno-2-genesis.$NAMESPACE.svc.cluster.local:26657\\"[39m
[31m+ grpc_addr = \\"http://juno-2-genesis.$NAMESPACE.svc.cluster.local:9090\\"[39m
[31m+ event_source = { mode = 'push', url = \\"ws://juno-2-genesis.$NAMESPACE.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[2m  trusted_node = false[22m
[2m  account_prefix = \\"juno\\"[22m
[2m  default_gas = 500000000[22m
[33m@@ -153,96 +104,48 @@[39m
[2m  trusting_period = \\"75s\\"[22m
[2m  trust_threshold = { numerator = \\"2\\", denominator = \\"3\\" }[22m
[2m  address_type = { derivation = 'cosmos' }[22m
[32m- gas_price = { price = 0.25, denom = \\"ujuno\\" }",[39m
[31m+ gas_price = { price = 1.25, denom = \\"ujuno\\" }",[39m
[2m      "config.toml": "# The global section has parameters that apply globally to the relayer operation.[22m
[2m  [global][22m
[32m- # Specify the verbosity for the relayer logging output. Default: 'info'[39m
[32m- # Valid options are 'error', 'warn', 'info', 'debug', 'trace'.[39m
[32m- log_level = 'info'[39m
[32m- # Specify the mode to be used by the relayer. [Required][39m
[31m+ log_level = \\"info\\"[39m
[31m+[39m
[2m  [mode][22m
[32m- # Specify the client mode.[39m
[2m  [mode.clients][22m
[32m- # Whether or not to enable the client workers. [Required][39m
[2m  enabled = true[22m
[32m- # Whether or not to enable periodic refresh of clients. [Default: true][39m
[32m- # This feature only applies to clients that underlie an open channel.[39m
[32m- # For Tendermint clients, the frequency at which Hermes refreshes them is 2/3 of their[39m
[32m- # trusting period (e.g., refresh every ~9 days if the trusting period is 14 days).[39m
[32m- # Note: Even if this is disabled, clients will be refreshed automatically if[39m
[32m- #      there is activity on a connection or channel they are involved with.[39m
[2m  refresh = true[22m
[32m- # Whether or not to enable misbehaviour detection for clients. [Default: false][39m
[2m  misbehaviour = true[22m
[32m- # Specify the connections mode.[39m
[31m+[39m
[2m  [mode.connections][22m
[32m- # Whether or not to enable the connection workers for handshake completion. [Required][39m
[2m  enabled = true[22m
[32m- # Specify the channels mode.[39m
[31m+[39m
[2m  [mode.channels][22m
[32m- # Whether or not to enable the channel workers for handshake completion. [Required][39m
[2m  enabled = true[22m
[32m- # Specify the packets mode.[39m
[31m+[39m
[2m  [mode.packets][22m
[32m- # Whether or not to enable the packet workers. [Required][39m
[2m  enabled = true[22m
[32m- # Parametrize the periodic packet clearing feature.[39m
[32m- # Interval (in number of blocks) at which pending packets[39m
[32m- # should be periodically cleared. A value of '0' will disable[39m
[32m- # periodic packet clearing. [Default: 100][39m
[2m  clear_interval = 100[22m
[32m- # Whether or not to clear packets on start. [Default: false][39m
[2m  clear_on_start = true[22m
[32m- # Toggle the transaction confirmation mechanism.[39m
[32m- # The tx confirmation mechanism periodically queries the \`/tx_search\` RPC[39m
[32m- # endpoint to check that previously-submitted transactions[39m
[32m- # (to any chain in this config file) have been successfully delivered.[39m
[32m- # If they have not been, and \`clear_interval = 0\`, then those packets are[39m
[32m- # queued up for re-submission.[39m
[32m- # Experimental feature. Affects telemetry if set to false.[39m
[32m- # [Default: true][39m
[2m  tx_confirmation = true[22m
[32m- # Auto register the counterparty payee on a destination chain to[39m
[32m- # the relayer's address on the source chain. This can be used[39m
[32m- # for simple configuration of the relayer to receive fees for[39m
[32m- # relaying RecvPacket on fee-enabled channels.[39m
[32m- # For more complex configuration, turn this off and use the CLI[39m
[32m- # to manually register the payee addresses.[39m
[32m- # [Default: false][39m
[32m- auto_register_counterparty_payee = false[39m
[32m- # The REST section defines parameters for Hermes' built-in RESTful API.[39m
[32m- # https://hermes.informal.systems/rest.html[39m
[31m+[39m
[2m  [rest][22m
[32m- # Whether or not to enable the REST service. Default: false[39m
[2m  enabled = true[22m
[32m- # Specify the IPv4/6 host over which the built-in HTTP server will serve the RESTful[39m
[32m- # API requests. Default: 127.0.0.1[39m
[32m- host =  '0.0.0.0'[39m
[32m- # Specify the port over which the built-in HTTP server will serve the restful API[39m
[32m- # requests. Default: 3000[39m
[31m+ host = \\"0.0.0.0\\"[39m
[2m  port = 3000[22m
[32m- # The telemetry section defines parameters for Hermes' built-in telemetry capabilities.[39m
[32m- # https://hermes.informal.systems/telemetry.html[39m
[31m+[39m
[2m  [telemetry][22m
[32m- # Whether or not to enable the telemetry service. Default: false[39m
[2m  enabled = true[22m
[32m- # Specify the IPv4/6 host over which the built-in HTTP server will serve the metrics[39m
[32m- # gathered by the telemetry service. Default: 127.0.0.1[39m
[32m- host = '0.0.0.0'[39m
[32m- # Specify the port over which the built-in HTTP server will serve the metrics gathered[39m
[32m- # by the telemetry service. Default: 3001[39m
[31m+ host = \\"0.0.0.0\\"[39m
[2m  port = 3001[22m


[32m-[39m
[2m  [[chains]][22m
[2m  id = \\"osmosis-1\\"[22m
[2m  type = \\"CosmosSdk\\"[22m
[2m  key_name = \\"osmosis-1\\"[22m
[32m- rpc_addr = \\"http://osmosis-1-genesis.default.svc.cluster.local:26657\\"[39m
[32m- grpc_addr = \\"http://osmosis-1-genesis.default.svc.cluster.local:9090\\"[39m
[32m- event_source = { mode = 'push', url = \\"ws://osmosis-1-genesis.default.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[32m- # Experimental: Whether or not the full node is trusted.[39m
[31m+[39m
[31m+ rpc_addr = \\"http://osmosis-1-genesis.$NAMESPACE.svc.cluster.local:26657\\"[39m
[31m+ grpc_addr = \\"http://osmosis-1-genesis.$NAMESPACE.svc.cluster.local:9090\\"[39m
[31m+ event_source = { mode = 'push', url = \\"ws://osmosis-1-genesis.$NAMESPACE.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[2m  trusted_node = false[22m
[2m  account_prefix = \\"osmo\\"[22m
[2m  default_gas = 500000000[22m
[33m@@ -258,17 +161,15 @@[39m
[2m  trust_threshold = { numerator = \\"2\\", denominator = \\"3\\" }[22m
[2m  address_type = { derivation = 'cosmos' }[22m
[2m  gas_price = { price = 1.25, denom = \\"uosmo\\" }[22m
[32m-[39m

[32m-[39m
[2m  [[chains]][22m
[2m  id = \\"cosmoshub-4\\"[22m
[2m  type = \\"CosmosSdk\\"[22m
[2m  key_name = \\"cosmoshub-4\\"[22m
[32m- rpc_addr = \\"http://cosmoshub-4-genesis.default.svc.cluster.local:26657\\"[39m
[32m- grpc_addr = \\"http://cosmoshub-4-genesis.default.svc.cluster.local:9090\\"[39m
[32m- event_source = { mode = 'push', url = \\"ws://cosmoshub-4-genesis.default.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[32m- # Experimental: Whether or not the full node is trusted.[39m
[31m+[39m
[31m+ rpc_addr = \\"http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:26657\\"[39m
[31m+ grpc_addr = \\"http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:9090\\"[39m
[31m+ event_source = { mode = 'push', url = \\"ws://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[2m  trusted_node = false[22m
[2m  account_prefix = \\"cosmos\\"[22m
[2m  default_gas = 500000000[22m
[33m@@ -284,17 +185,15 @@[39m
[2m  trust_threshold = { numerator = \\"2\\", denominator = \\"3\\" }[22m
[2m  address_type = { derivation = 'cosmos' }[22m
[2m  gas_price = { price = 1.25, denom = \\"uatom\\" }[22m
[32m-[39m
[32m-[39m

[2m  [[chains]][22m
[2m  id = \\"juno-2\\"[22m
[2m  type = \\"CosmosSdk\\"[22m
[2m  key_name = \\"juno-2\\"[22m
[32m- rpc_addr = \\"http://juno-2-genesis.default.svc.cluster.local:26657\\"[39m
[32m- grpc_addr = \\"http://juno-2-genesis.default.svc.cluster.local:9090\\"[39m
[32m- event_source = { mode = 'push', url = \\"ws://juno-2-genesis.default.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[32m- # Experimental: Whether or not the full node is trusted.[39m
[31m+[39m
[31m+ rpc_addr = \\"http://juno-2-genesis.$NAMESPACE.svc.cluster.local:26657\\"[39m
[31m+ grpc_addr = \\"http://juno-2-genesis.$NAMESPACE.svc.cluster.local:9090\\"[39m
[31m+ event_source = { mode = 'push', url = \\"ws://juno-2-genesis.$NAMESPACE.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[2m  trusted_node = false[22m
[2m  account_prefix = \\"juno\\"[22m
[2m  default_gas = 500000000[22m
[33m@@ -313,6 +212,15 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "relayer",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "hermes-relayer",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/role": "hermes",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "hermes-relayer",[22m
[2m    },[22m
[2m  }[22m

--- StatefulSet/hermes-relayer ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,15 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "relayer",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "hermes-relayer",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/role": "hermes",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "hermes-relayer",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -29,16 +38,18 @@[39m
[2m            "app.kubernetes.io/name": "hermes-relayer",[22m
[2m            "app.kubernetes.io/rawname": "relayer",[22m
[2m            "app.kubernetes.io/type": "hermes",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[2m          "containers": Array [[22m
[2m            Object {[22m
[31m+             "args": Array [[39m
[31m+               "/exposer/exposer",[39m
[31m+             ],[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "/exposer/exposer",[39m
[2m              ],[22m
[2m              "env": Array [[22m
[2m                Object {[22m
[33m@@ -55,11 +66,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -83,14 +94,24 @@[39m
[2m              ],[22m
[2m            },[22m
[2m            Object {[22m
[31m+             "args": Array [[39m
[31m+               "RLY_INDEX=\${HOSTNAME##*-}[39m
[31m+ echo \\"Relayer Index: $RLY_INDEX\\"[39m
[31m+ hermes start",[39m
[31m+             ],[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "RLY_INDEX=\${HOSTNAME##*-}[39m
[32m- echo \\"Relayer Index: $RLY_INDEX\\"[39m
[32m- hermes start",[39m
[2m              ],[22m
[2m              "env": Array [[22m
[31m+               Object {[39m
[31m+                 "name": "NAMESPACE",[39m
[31m+                 "valueFrom": Object {[39m
[31m+                   "fieldRef": Object {[39m
[31m+                     "fieldPath": "metadata.namespace",[39m
[31m+                   },[39m
[31m+                 },[39m
[31m+               },[39m
[2m                Object {[22m
[2m                  "name": "RELAYER_DIR",[22m
[2m                  "value": "/root/.hermes",[22m
[33m@@ -101,12 +122,12 @@[39m
[2m              "name": "relayer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[2m              },[22m
[2m              "securityContext": Object {[22m
[33m@@ -127,24 +148,26 @@[39m
[2m          ],[22m
[2m          "initContainers": Array [[22m
[2m            Object {[22m
[32m-             "command": Array [[39m
[32m-               "bash",[39m
[32m-               "-c",[39m
[31m+             "args": Array [[39m
[2m                "# Install exposer binary from the image[22m
[2m  cp /bin/exposer /exposer/exposer[22m
[2m  chmod +x /exposer/exposer",[22m
[31m+             ],[39m
[31m+             "command": Array [[39m
[31m+               "bash",[39m
[31m+               "-c",[39m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/exposer:20250205-544757d",[22m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "init-exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "100M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "100M",[39m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[33m@@ -155,9 +178,7 @@[39m
[2m              ],[22m
[2m            },[22m
[2m            Object {[22m
[32m-             "command": Array [[39m
[32m-               "bash",[39m
[32m-               "-c",[39m
[31m+             "args": Array [[39m
[2m                "set -ux[22m

[2m  RLY_INDEX=\${HOSTNAME##*-}[22m
[33m@@ -166,18 +187,16 @@[39m
[2m  mkdir -p $RELAYER_DIR[22m
[2m  cp /configs/config.toml $RELAYER_DIR/config.toml[22m
[2m  cp /configs/config-cli.toml $RELAYER_DIR/config-cli.toml[22m
[32m- cat $RELAYER_DIR/config.toml[39m

[32m- MNEMONIC=$(jq -r \\".relayers[$RELAYER_INDEX].mnemonic\\" $KEYS_CONFIG)[39m
[31m+ # Replace namespace placeholder with actual namespace environment variable[39m
[31m+ sed -i \\"s|\\\\$NAMESPACE|$NAMESPACE|g\\" $RELAYER_DIR/config.toml[39m
[31m+ sed -i \\"s|\\\\$NAMESPACE|$NAMESPACE|g\\" $RELAYER_DIR/config-cli.toml[39m
[31m+[39m
[31m+ MNEMONIC=$(jq -r \\".relayers[$RLY_INDEX].mnemonic\\" $KEYS_CONFIG)[39m
[2m  echo $MNEMONIC > $RELAYER_DIR/mnemonic.txt[22m
[32m- MNEMONIC_CLI=$(jq -r \\".relayers_cli[$RELAYER_INDEX].mnemonic\\" $KEYS_CONFIG)[39m
[31m+ MNEMONIC_CLI=$(jq -r \\".relayers_cli[$RLY_INDEX].mnemonic\\" $KEYS_CONFIG)[39m
[2m  echo $MNEMONIC_CLI > $RELAYER_DIR/mnemonic-cli.txt[22m

[32m- echo \\"Debug output for relayer...\\"[39m
[32m- cat << EOF[39m
[32m-               map[string]interface {}[39m
[32m-               {\\"chains\\":[\\"osmosis-1\\",\\"cosmoshub-4\\",\\"juno-2\\"],\\"channels\\":[{\\"a-chain\\":\\"osmosis-1\\",\\"a-port\\":\\"transfer\\",\\"b-chain\\":\\"cosmoshub-4\\",\\"b-port\\":\\"transfer\\",\\"new-connection\\":true},{\\"a-chain\\":\\"osmosis-1\\",\\"a-port\\":\\"transfer\\",\\"b-chain\\":\\"juno-2\\",\\"b-port\\":\\"transfer\\",\\"new-connection\\":true},{\\"a-chain\\":\\"juno-2\\",\\"a-port\\":\\"transfer\\",\\"b-chain\\":\\"cosmoshub-4\\",\\"b-port\\":\\"transfer\\",\\"new-connection\\":true}],\\"config\\":{\\"event_source\\":{\\"mode\\":\\"push\\"},\\"global\\":{\\"log_level\\":\\"info\\"},\\"mode\\":{\\"channels\\":{\\"enabled\\":true},\\"clients\\":{\\"enabled\\":true,\\"misbehaviour\\":true,\\"refresh\\":true},\\"connections\\":{\\"enabled\\":true},\\"packets\\":{\\"clear_interval\\":100,\\"clear_on_start\\":true,\\"enabled\\":true,\\"tx_confirmation\\":true}},\\"rest\\":{\\"enabled\\":true,\\"host\\":\\"0.0.0.0\\",\\"port\\":3000},\\"telemetry\\":{\\"enabled\\":true,\\"host\\":\\"0.0.0.0\\",\\"port\\":3001}},\\"fullname\\":\\"hermes-relayer\\",\\"ics\\":{\\"enabled\\":false},\\"image\\":\\"ghcr.io/cosmology-tech/starship/hermes:1.10.0\\",\\"name\\":\\"relayer\\",\\"replicas\\":1,\\"type\\":\\"hermes\\"}[39m
[32m- EOF[39m

[2m  echo \\"Creating key for osmosis-1...\\"[22m
[2m  hermes keys add \\\\[22m
[33m@@ -271,24 +290,31 @@[39m
[2m    $DENOM \\\\[22m
[2m    http://juno-2-genesis.$NAMESPACE.svc.cluster.local:8000/credit \\\\[22m
[2m    \\"false\\" || true[22m
[31m+[39m
[2m  hermes create channel \\\\[22m
[2m    --new-client-connection --yes \\\\[22m
[2m    --b-chain cosmoshub-4 \\\\[22m
[2m    --a-chain osmosis-1 \\\\[22m
[2m    --a-port transfer \\\\[22m
[2m    --b-port transfer[22m
[31m+[39m
[2m  hermes create channel \\\\[22m
[2m    --new-client-connection --yes \\\\[22m
[2m    --b-chain juno-2 \\\\[22m
[2m    --a-chain osmosis-1 \\\\[22m
[2m    --a-port transfer \\\\[22m
[2m    --b-port transfer[22m
[31m+[39m
[2m  hermes create channel \\\\[22m
[2m    --new-client-connection --yes \\\\[22m
[2m    --b-chain cosmoshub-4 \\\\[22m
[2m    --a-chain juno-2 \\\\[22m
[2m    --a-port transfer \\\\[22m
[2m    --b-port transfer",[22m
[31m+             ],[39m
[31m+             "command": Array [[39m
[31m+               "bash",[39m
[31m+               "-c",[39m
[2m              ],[22m
[2m              "env": Array [[22m
[2m                Object {[22m
[33m@@ -309,7 +335,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "RELAYER_INDEX",[22m
[32m-                 "value": "0",[39m
[31m+                 "value": "\${HOSTNAME##*-}",[39m
[2m                },[22m
[2m              ],[22m
[2m              "image": "ghcr.io/cosmology-tech/starship/hermes:1.10.0",[22m
[33m@@ -317,12 +343,12 @@[39m
[2m              "name": "init-relayer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[33m@@ -353,11 +379,13 @@[39m
[2m    echo \\"Checking: http://osmosis-1-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id\\"[22m
[2m    sleep 10;[22m
[2m  done[22m
[31m+[39m
[2m  while [ $(curl -sw '%{http_code}' http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id -o /dev/null) -ne 200 ]; do[22m
[2m    echo \\"Genesis validator does not seem to be ready for: cosmoshub-4. Waiting for it to start...\\"[22m
[2m    echo \\"Checking: http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id\\"[22m
[2m    sleep 10;[22m
[2m  done[22m
[31m+[39m
[2m  while [ $(curl -sw '%{http_code}' http://juno-2-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id -o /dev/null) -ne 200 ]; do[22m
[2m    echo \\"Genesis validator does not seem to be ready for: juno-2. Waiting for it to start...\\"[22m
[2m    echo \\"Checking: http://juno-2-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id\\"[22m
[33m@@ -380,16 +408,16 @@[39m
[2m                  },[22m
[2m                },[22m
[2m              ],[22m
[32m-             "image": "curlimages/curl",[39m
[31m+             "image": "curlimages/curl:latest",[39m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "wait-for-chains",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m"
`;

exports[`Manifest Comparison Tests Individual Config Comparisons should generate manifests for two-chain that match the snapshot 1`] = `
"ðŸ”„ MODIFIED_RESOURCES:

--- ConfigMap/keys ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -98,6 +98,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "configmap",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "keys",[39m
[31m+       "app.kubernetes.io/part-of": "global",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "keys",[22m
[2m    },[22m
[2m  }[22m

--- ConfigMap/setup-scripts ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -208,6 +208,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "configmap",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts",[39m
[31m+       "app.kubernetes.io/part-of": "global",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts",[22m
[2m    },[22m
[2m  }[22m

--- StatefulSet/cosmoshub-4-genesis ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,18 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/id": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "cosmoshub-4-genesis",[39m
[31m+       "app.kubernetes.io/part-of": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/role": "genesis",[39m
[31m+       "app.kubernetes.io/type": "cosmoshub-4-statefulset",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-name": "cosmoshub",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "cosmoshub-4-genesis",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +21,7 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "cosmoshub",[39m
[31m+         "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m          "app.kubernetes.io/name": "cosmoshub-4-genesis",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -23,11 +35,12 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "cosmoshub",[39m
[31m+           "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m            "app.kubernetes.io/name": "cosmoshub-4-genesis",[22m
[2m            "app.kubernetes.io/rawname": "cosmoshub-4",[22m
[31m+           "app.kubernetes.io/role": "genesis",[39m
[2m            "app.kubernetes.io/type": "cosmoshub-4",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[33m@@ -91,11 +104,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -114,7 +127,12 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "START_ARGS=\\"\\"[39m
[31m+               "#!/bin/bash[39m
[31m+ set -euo pipefail[39m
[31m+[39m
[31m+ START_ARGS=\\"\\"[39m
[31m+[39m
[31m+[39m
[2m  $CHAIN_BIN start $START_ARGS",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -177,11 +195,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -210,6 +228,7 @@[39m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m

[2m  echo \\"Running setup config script...\\"[22m
[31m+[39m
[2m  bash -e /scripts/update-config.sh",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -251,7 +270,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "TIME_IOTA_MS",[22m
[33m@@ -291,11 +310,11 @@[39m
[2m              "name": "init-config",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -428,11 +447,11 @@[39m
[2m              "name": "init-genesis",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m

--- ConfigMap/setup-scripts-cosmoshub-4 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -608,6 +608,17 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts-cosmoshub-4",[39m
[31m+       "app.kubernetes.io/part-of": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/role": "setup-scripts",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-id": "cosmoshub-4",[39m
[31m+       "starship.io/chain-name": "cosmoshub",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts-cosmoshub-4",[22m
[2m    },[22m
[2m  }[22m

--- Service/cosmoshub-4-validator ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -23,6 +23,12 @@[39m
[2m          "targetPort": 8081,[22m
[2m        },[22m
[2m        Object {[22m
[31m+         "name": "faucet",[39m
[31m+         "port": 8000,[39m
[31m+         "protocol": "TCP",[39m
[31m+         "targetPort": 8000,[39m
[31m+       },[39m
[31m+       Object {[39m
[2m          "name": "grpc",[22m
[2m          "port": 9090,[22m
[2m          "protocol": "TCP",[22m

--- StatefulSet/cosmoshub-4-validator ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,18 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/id": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "cosmoshub-4-validator",[39m
[31m+       "app.kubernetes.io/part-of": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/role": "validator",[39m
[31m+       "app.kubernetes.io/type": "cosmoshub-4-statefulset",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-name": "cosmoshub",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "cosmoshub-4-validator",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -10,7 +22,7 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "cosmoshub",[39m
[31m+         "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m          "app.kubernetes.io/name": "cosmoshub-4-validator",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -24,10 +36,11 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "cosmoshub",[39m
[31m+           "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m            "app.kubernetes.io/name": "cosmoshub-4-validator",[22m
[31m+           "app.kubernetes.io/role": "validator",[39m
[2m            "app.kubernetes.io/type": "cosmoshub-4",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[33m@@ -119,11 +132,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -144,8 +157,10 @@[39m
[2m                "-c",[22m
[2m                "set -eux[22m
[2m  START_ARGS=\\"\\"[22m
[31m+[39m

[2m  # Starting the chain[22m
[31m+[39m
[2m  $CHAIN_BIN start $START_ARGS",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -255,11 +270,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -287,6 +302,7 @@[39m
[2m                "VAL_INDEX=\${HOSTNAME##*-}[22m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m

[31m+[39m
[2m  echo \\"Running setup config script...\\"[22m
[2m  bash -e /scripts/update-config.sh[22m

[33m@@ -351,7 +367,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "NAMESPACE",[22m
[33m@@ -399,11 +415,11 @@[39m
[2m              "name": "init-config",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -428,6 +444,7 @@[39m
[2m                "-c",[22m
[2m                "VAL_INDEX=\${HOSTNAME##*-}[22m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m
[31m+[39m

[2m  if [ -f $CHAIN_DIR/config/genesis.json ]; then[22m
[2m    echo \\"Genesis file exists, exiting early\\"[22m
[33m@@ -500,7 +517,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "NAMESPACE",[22m
[33m@@ -548,11 +565,11 @@[39m
[2m              "name": "init-validator",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -597,16 +614,16 @@[39m
[2m                  },[22m
[2m                },[22m
[2m              ],[22m
[32m-             "image": "curlimages/curl",[39m
[31m+             "image": "curlimages/curl:latest",[39m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "wait-for-chains",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m

--- ConfigMap/explorer ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -6,12 +6,11 @@[39m
[2m    \\"coingecko\\": \\"cosmoshub\\",[22m
[2m    \\"api\\": \\"http://localhost:1317\\",[22m
[2m    \\"rpc\\": [[22m
[32m-     \\"http://localhost:26657\\",[39m
[2m      \\"http://localhost:26657\\"[22m
[2m    ],[22m
[2m    \\"snapshot_provider\\": \\"\\",[22m
[2m    \\"sdk_version\\": \\"0.45.6\\",[22m
[32m-   \\"coin_type\\": \\"118\\",[39m
[31m+   \\"coin_type\\": 118,[39m
[2m    \\"min_tx_fee\\": \\"3000\\",[22m
[2m    \\"addr_prefix\\": \\"cosmos\\",[22m
[2m    \\"logo\\": \\"\\",[22m
[33m@@ -30,12 +29,11 @@[39m
[2m    \\"coingecko\\": \\"osmosis\\",[22m
[2m    \\"api\\": \\"http://localhost:1313\\",[22m
[2m    \\"rpc\\": [[22m
[32m-     \\"http://localhost:26653\\",[39m
[2m      \\"http://localhost:26653\\"[22m
[2m    ],[22m
[2m    \\"snapshot_provider\\": \\"\\",[22m
[2m    \\"sdk_version\\": \\"0.45.6\\",[22m
[32m-   \\"coin_type\\": \\"118\\",[39m
[31m+   \\"coin_type\\": 118,[39m
[2m    \\"min_tx_fee\\": \\"3000\\",[22m
[2m    \\"addr_prefix\\": \\"osmo\\",[22m
[2m    \\"logo\\": \\"\\",[22m
[33m@@ -52,6 +50,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "explorer",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "explorer",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "explorer",[22m
[2m    },[22m
[2m  }[22m

--- Deployment/explorer ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,14 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "Deployment",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "explorer",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "explorer",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "explorer",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -26,34 +34,28 @@[39m
[2m            "app.kubernetes.io/name": "explorer",[22m
[2m            "app.kubernetes.io/rawname": "explorer",[22m
[2m            "app.kubernetes.io/type": "ping-pub",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[2m          "containers": Array [[22m
[2m            Object {[22m
[32m-             "command": Array [[39m
[32m-               "bash",[39m
[32m-               "-c",[39m
[32m-               "yarn serve --host 0.0.0.0 --port 8080",[39m
[31m+             "env": Array [[39m
[31m+               Object {[39m
[31m+                 "name": "CHAINS_CONFIG_PATH",[39m
[31m+                 "value": "/explorer",[39m
[31m+               },[39m
[2m              ],[22m
[2m              "image": "ghcr.io/cosmology-tech/starship/ping-pub:6b7b0d096946b6bcd75d15350c7345da0d4576db",[22m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[32m-             "livenessProbe": Object {[39m
[32m-               "initialDelaySeconds": 60,[39m
[32m-               "periodSeconds": 30,[39m
[32m-               "tcpSocket": Object {[39m
[32m-                 "port": 8080,[39m
[32m-               },[39m
[32m-             },[39m
[2m              "name": "explorer",[22m
[32m-             "readinessProbe": Object {[39m
[32m-               "initialDelaySeconds": 60,[39m
[32m-               "periodSeconds": 30,[39m
[32m-               "tcpSocket": Object {[39m
[32m-                 "port": 8080,[39m
[32m-               },[39m
[31m+             "ports": Array [[39m
[31m+               Object {[39m
[31m+                 "containerPort": 8080,[39m
[31m+                 "name": "http",[39m
[31m+                 "protocol": "TCP",[39m
[2m                },[22m
[31m+             ],[39m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[2m                  "cpu": 1,[22m
[33m@@ -66,8 +68,8 @@[39m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[2m                Object {[22m
[32m-                 "mountPath": "/home/explorer/chains/mainnet",[39m
[32m-                 "name": "explorer-configs",[39m
[31m+                 "mountPath": "/explorer",[39m
[31m+                 "name": "explorer-config",[39m
[2m                },[22m
[2m              ],[22m
[2m            },[22m
[33m@@ -77,7 +79,7 @@[39m
[2m              "configMap": Object {[22m
[2m                "name": "explorer",[22m
[2m              },[22m
[32m-             "name": "explorer-configs",[39m
[31m+             "name": "explorer-config",[39m
[2m            },[22m
[2m          ],[22m
[2m        },[22m

--- StatefulSet/osmosis-1-genesis ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,18 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/id": "osmosis-1",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "osmosis-1-genesis",[39m
[31m+       "app.kubernetes.io/part-of": "osmosis-1",[39m
[31m+       "app.kubernetes.io/role": "genesis",[39m
[31m+       "app.kubernetes.io/type": "osmosis-1-statefulset",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-name": "osmosis",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "osmosis-1-genesis",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +21,7 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "osmosis",[39m
[31m+         "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m          "app.kubernetes.io/name": "osmosis-1-genesis",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -23,11 +35,12 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "osmosis",[39m
[31m+           "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m            "app.kubernetes.io/name": "osmosis-1-genesis",[22m
[2m            "app.kubernetes.io/rawname": "osmosis-1",[22m
[31m+           "app.kubernetes.io/role": "genesis",[39m
[2m            "app.kubernetes.io/type": "osmosis-1",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[33m@@ -91,11 +104,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -184,12 +197,12 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[32m-                 "memory": "200M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "128M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[32m-                 "memory": "200M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "128M",[39m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[33m@@ -211,7 +224,12 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "START_ARGS=\\"\\"[39m
[31m+               "#!/bin/bash[39m
[31m+ set -euo pipefail[39m
[31m+[39m
[31m+ START_ARGS=\\"\\"[39m
[31m+[39m
[31m+[39m
[2m  $CHAIN_BIN start $START_ARGS",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -274,11 +292,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -307,6 +325,7 @@[39m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m

[2m  echo \\"Running setup config script...\\"[22m
[31m+[39m
[2m  bash -e /scripts/update-config.sh",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -348,7 +367,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "TIME_IOTA_MS",[22m
[33m@@ -388,11 +407,11 @@[39m
[2m              "name": "init-config",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -415,20 +434,18 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "# Install faucet binary from the image[39m
[32m- cp /bin/faucet /faucet/faucet[39m
[32m- chmod +x /faucet/faucet",[39m
[31m+               "cp /bin/faucet /faucet/faucet && chmod +x /faucet/faucet",[39m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/faucet:20250325-2207109",[22m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "init-faucet",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -553,11 +570,11 @@[39m
[2m              "name": "init-genesis",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m

--- ConfigMap/setup-scripts-osmosis-1 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -608,6 +608,17 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts-osmosis-1",[39m
[31m+       "app.kubernetes.io/part-of": "osmosis-1",[39m
[31m+       "app.kubernetes.io/role": "setup-scripts",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-id": "osmosis-1",[39m
[31m+       "starship.io/chain-name": "osmosis",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts-osmosis-1",[22m
[2m    },[22m
[2m  }[22m

--- Service/osmosis-1-validator ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -23,6 +23,12 @@[39m
[2m          "targetPort": 8081,[22m
[2m        },[22m
[2m        Object {[22m
[31m+         "name": "faucet",[39m
[31m+         "port": 8000,[39m
[31m+         "protocol": "TCP",[39m
[31m+         "targetPort": 8000,[39m
[31m+       },[39m
[31m+       Object {[39m
[2m          "name": "grpc",[22m
[2m          "port": 9090,[22m
[2m          "protocol": "TCP",[22m

--- StatefulSet/osmosis-1-validator ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,18 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/id": "osmosis-1",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "osmosis-1-validator",[39m
[31m+       "app.kubernetes.io/part-of": "osmosis-1",[39m
[31m+       "app.kubernetes.io/role": "validator",[39m
[31m+       "app.kubernetes.io/type": "osmosis-1-statefulset",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-name": "osmosis",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "osmosis-1-validator",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -10,7 +22,7 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "osmosis",[39m
[31m+         "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m          "app.kubernetes.io/name": "osmosis-1-validator",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -24,10 +36,11 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "osmosis",[39m
[31m+           "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m            "app.kubernetes.io/name": "osmosis-1-validator",[22m
[31m+           "app.kubernetes.io/role": "validator",[39m
[2m            "app.kubernetes.io/type": "osmosis-1",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[33m@@ -119,11 +132,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -145,7 +158,9 @@[39m
[2m                "set -eux[22m
[2m  START_ARGS=\\"\\"[22m

[31m+[39m
[2m  # Starting the chain[22m
[31m+[39m
[2m  $CHAIN_BIN start $START_ARGS",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -255,11 +270,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -286,6 +301,7 @@[39m
[2m                "-c",[22m
[2m                "VAL_INDEX=\${HOSTNAME##*-}[22m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m
[31m+[39m

[2m  echo \\"Running setup config script...\\"[22m
[2m  bash -e /scripts/update-config.sh[22m
[33m@@ -351,7 +367,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "NAMESPACE",[22m
[33m@@ -399,11 +415,11 @@[39m
[2m              "name": "init-config",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -428,6 +444,7 @@[39m
[2m                "-c",[22m
[2m                "VAL_INDEX=\${HOSTNAME##*-}[22m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m
[31m+[39m

[2m  if [ -f $CHAIN_DIR/config/genesis.json ]; then[22m
[2m    echo \\"Genesis file exists, exiting early\\"[22m
[33m@@ -500,7 +517,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "NAMESPACE",[22m
[33m@@ -548,11 +565,11 @@[39m
[2m              "name": "init-validator",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -597,16 +614,16 @@[39m
[2m                  },[22m
[2m                },[22m
[2m              ],[22m
[32m-             "image": "curlimages/curl",[39m
[31m+             "image": "curlimages/curl:latest",[39m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "wait-for-chains",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -618,6 +635,10 @@[39m
[2m                "name": "keys",[22m
[2m              },[22m
[2m              "name": "addresses",[22m
[31m+           },[39m
[31m+           Object {[39m
[31m+             "emptyDir": Object {},[39m
[31m+             "name": "faucet",[39m
[2m            },[22m
[2m            Object {[22m
[2m              "emptyDir": Object {},[22m

--- ConfigMap/registry-cosmoshub-4 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -7,7 +7,14 @@[39m
[2m    \\"assets\\": [[22m
[2m      {[22m
[2m        \\"base\\": \\"uatom\\",[22m
[32m-       \\"coingecko_id\\": \\"atom\\",[39m
[31m+       \\"description\\": \\"The native staking and governance token of the Cosmos Hub.\\",[39m
[31m+       \\"name\\": \\"Cosmos Hub Atom\\",[39m
[31m+       \\"display\\": \\"atom\\",[39m
[31m+       \\"symbol\\": \\"ATOM\\",[39m
[31m+       \\"logo_URIs\\": {[39m
[31m+         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/cosmoshub/images/atom.png\\",[39m
[31m+         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/cosmoshub/images/atom.svg\\"[39m
[31m+       },[39m
[2m        \\"denom_units\\": [[22m
[2m          {[22m
[2m            \\"denom\\": \\"uatom\\",[22m
[33m@@ -18,14 +25,7 @@[39m
[2m            \\"exponent\\": 6[22m
[2m          }[22m
[2m        ],[22m
[32m-       \\"description\\": \\"The native staking and governance token of the Cosmos Hub.\\",[39m
[32m-       \\"display\\": \\"atom\\",[39m
[32m-       \\"logo_URIs\\": {[39m
[32m-         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/cosmoshub/images/atom.png\\",[39m
[32m-         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/cosmoshub/images/atom.svg\\"[39m
[32m-       },[39m
[32m-       \\"name\\": \\"Cosmos Hub Atom\\",[39m
[32m-       \\"symbol\\": \\"ATOM\\"[39m
[31m+       \\"coingecko_id\\": \\"atom\\"[39m
[2m      }[22m
[2m    ][22m
[2m  }",[22m
[33m@@ -73,21 +73,29 @@[39m
[2m      \\"consensus\\": {[22m
[2m        \\"type\\": \\"tendermint\\"[22m
[2m      }[22m
[31m+   },[39m
[31m+   \\"peers\\": {[39m
[31m+     \\"seeds\\": [],[39m
[31m+     \\"persistent_peers\\": [][39m
[2m    },[22m
[2m    \\"explorers\\": [[22m
[2m      {[22m
[2m        \\"kind\\": \\"ping-pub\\",[22m
[2m        \\"url\\": \\"http://localhost:8080\\"[22m
[2m      }[22m
[32m-   ],[39m
[32m-   \\"peers\\": {[39m
[32m-     \\"seeds\\": [],[39m
[32m-     \\"persistent_peers\\": [][39m
[32m-   }[39m
[31m+   ][39m
[2m  }",[22m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "registry",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "registry-cosmoshub-4",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "registry-cosmoshub-4",[22m
[2m    },[22m
[2m  }[22m

--- Deployment/registry ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,14 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "Deployment",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "registry",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "registry",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "registry",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +17,6 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "registry",[39m
[2m          "app.kubernetes.io/name": "registry",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -22,19 +29,17 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "registry",[39m
[31m+           "app.kubernetes.io/component": "registry",[39m
[31m+           "app.kubernetes.io/managed-by": "starship",[39m
[2m            "app.kubernetes.io/name": "registry",[22m
[32m-           "app.kubernetes.io/rawname": "registry",[39m
[32m-           "app.kubernetes.io/type": "registry",[39m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/part-of": "starship",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+           "starship.io/name": "starship-e2e-tests",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[2m          "containers": Array [[22m
[2m            Object {[22m
[32m-             "command": Array [[39m
[32m-               "registry",[39m
[32m-             ],[39m
[2m              "env": Array [[22m
[2m                Object {[22m
[2m                  "name": "NAMESPACE",[22m
[33m@@ -74,21 +79,20 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "REGISTRY_CHAIN_REGISTRY",[22m
[32m-                 "value": "/configs",[39m
[31m+                 "value": "/chains",[39m
[2m                },[22m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/registry:20250205-544757d",[22m
[32m-             "imagePullPolicy": "IfNotPresent",[39m
[2m              "livenessProbe": Object {[22m
[32m-               "initialDelaySeconds": 20,[39m
[32m-               "periodSeconds": 10,[39m
[31m+               "initialDelaySeconds": 15,[39m
[31m+               "periodSeconds": 20,[39m
[2m                "tcpSocket": Object {[22m
[2m                  "port": 8080,[22m
[2m                },[22m
[2m              },[22m
[2m              "name": "registry",[22m
[2m              "readinessProbe": Object {[22m
[32m-               "initialDelaySeconds": 20,[39m
[31m+               "initialDelaySeconds": 5,[39m
[2m                "periodSeconds": 10,[22m
[2m                "tcpSocket": Object {[22m
[2m                  "port": 8080,[22m
[33m@@ -96,22 +100,22 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[2m                Object {[22m
[32m-                 "mountPath": "/configs/cosmoshub-4",[39m
[32m-                 "name": "registry-configs-cosmoshub-4",[39m
[31m+                 "mountPath": "/chains/cosmoshub-4",[39m
[31m+                 "name": "registry-cosmoshub-4",[39m
[2m                },[22m
[2m                Object {[22m
[32m-                 "mountPath": "/configs/osmosis-1",[39m
[32m-                 "name": "registry-configs-osmosis-1",[39m
[31m+                 "mountPath": "/chains/osmosis-1",[39m
[31m+                 "name": "registry-osmosis-1",[39m
[2m                },[22m
[2m              ],[22m
[2m            },[22m
[33m@@ -126,6 +130,7 @@[39m
[2m    echo \\"Checking: http://osmosis-1-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id\\"[22m
[2m    sleep 10;[22m
[2m  done[22m
[31m+[39m
[2m  while [ $(curl -sw '%{http_code}' http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id -o /dev/null) -ne 200 ]; do[22m
[2m    echo \\"Genesis validator does not seem to be ready for: cosmoshub-4. Waiting for it to start...\\"[22m
[2m    echo \\"Checking: http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id\\"[22m
[33m@@ -148,16 +153,16 @@[39m
[2m                  },[22m
[2m                },[22m
[2m              ],[22m
[32m-             "image": "curlimages/curl",[39m
[31m+             "image": "curlimages/curl:latest",[39m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "wait-for-chains",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -168,13 +173,13 @@[39m
[2m              "configMap": Object {[22m
[2m                "name": "registry-cosmoshub-4",[22m
[2m              },[22m
[32m-             "name": "registry-configs-cosmoshub-4",[39m
[31m+             "name": "registry-cosmoshub-4",[39m
[2m            },[22m
[2m            Object {[22m
[2m              "configMap": Object {[22m
[2m                "name": "registry-osmosis-1",[22m
[2m              },[22m
[32m-             "name": "registry-configs-osmosis-1",[39m
[31m+             "name": "registry-osmosis-1",[39m
[2m            },[22m
[2m          ],[22m
[2m        },[22m

--- ConfigMap/registry-osmosis-1 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -7,7 +7,14 @@[39m
[2m    \\"assets\\": [[22m
[2m      {[22m
[2m        \\"base\\": \\"uosmo\\",[22m
[32m-       \\"coingecko_id\\": \\"osmosis\\",[39m
[31m+       \\"description\\": \\"The native token of Osmosis\\",[39m
[31m+       \\"name\\": \\"Osmosis\\",[39m
[31m+       \\"display\\": \\"osmo\\",[39m
[31m+       \\"symbol\\": \\"OSMO\\",[39m
[31m+       \\"logo_URIs\\": {[39m
[31m+         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/osmo.png\\",[39m
[31m+         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/osmo.svg\\"[39m
[31m+       },[39m
[2m        \\"denom_units\\": [[22m
[2m          {[22m
[2m            \\"denom\\": \\"uosmo\\",[22m
[33m@@ -18,22 +25,21 @@[39m
[2m            \\"exponent\\": 6[22m
[2m          }[22m
[2m        ],[22m
[32m-       \\"description\\": \\"The native token of Osmosis\\",[39m
[32m-       \\"display\\": \\"osmo\\",[39m
[31m+       \\"coingecko_id\\": \\"osmosis\\",[39m
[2m        \\"keywords\\": [[22m
[2m          \\"staking\\",[22m
[2m          \\"dex\\"[22m
[32m-       ],[39m
[32m-       \\"logo_URIs\\": {[39m
[32m-         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/osmo.png\\",[39m
[32m-         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/osmo.svg\\"[39m
[32m-       },[39m
[32m-       \\"name\\": \\"Osmosis\\",[39m
[32m-       \\"symbol\\": \\"OSMO\\"[39m
[31m+       ][39m
[2m      },[22m
[2m      {[22m
[2m        \\"base\\": \\"uion\\",[22m
[32m-       \\"coingecko_id\\": \\"ion\\",[39m
[31m+       \\"name\\": \\"Ion\\",[39m
[31m+       \\"display\\": \\"ion\\",[39m
[31m+       \\"symbol\\": \\"ION\\",[39m
[31m+       \\"logo_URIs\\": {[39m
[31m+         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/ion.png\\",[39m
[31m+         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/ion.svg\\"[39m
[31m+       },[39m
[2m        \\"denom_units\\": [[22m
[2m          {[22m
[2m            \\"denom\\": \\"uion\\",[22m
[33m@@ -44,16 +50,10 @@[39m
[2m            \\"exponent\\": 6[22m
[2m          }[22m
[2m        ],[22m
[32m-       \\"display\\": \\"ion\\",[39m
[31m+       \\"coingecko_id\\": \\"ion\\",[39m
[2m        \\"keywords\\": [[22m
[2m          \\"memecoin\\"[22m
[32m-       ],[39m
[32m-       \\"logo_URIs\\": {[39m
[32m-         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/ion.png\\",[39m
[32m-         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/ion.svg\\"[39m
[32m-       },[39m
[32m-       \\"name\\": \\"Ion\\",[39m
[32m-       \\"symbol\\": \\"ION\\"[39m
[31m+       ][39m
[2m      }[22m
[2m    ][22m
[2m  }",[22m
[33m@@ -101,21 +101,29 @@[39m
[2m      \\"consensus\\": {[22m
[2m        \\"type\\": \\"tendermint\\"[22m
[2m      }[22m
[31m+   },[39m
[31m+   \\"peers\\": {[39m
[31m+     \\"seeds\\": [],[39m
[31m+     \\"persistent_peers\\": [][39m
[2m    },[22m
[2m    \\"explorers\\": [[22m
[2m      {[22m
[2m        \\"kind\\": \\"ping-pub\\",[22m
[2m        \\"url\\": \\"http://localhost:8080\\"[22m
[2m      }[22m
[32m-   ],[39m
[32m-   \\"peers\\": {[39m
[32m-     \\"seeds\\": [],[39m
[32m-     \\"persistent_peers\\": [][39m
[32m-   }[39m
[31m+   ][39m
[2m  }",[22m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "registry",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "registry-osmosis-1",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "registry-osmosis-1",[22m
[2m    },[22m
[2m  }[22m

--- ConfigMap/hermes-osmos-cosmos ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -3,92 +3,45 @@[39m
[2m    "data": Object {[22m
[2m      "config-cli.toml": "# The global section has parameters that apply globally to the relayer operation.[22m
[2m  [global][22m
[32m- # Specify the verbosity for the relayer logging output. Default: 'info'[39m
[32m- # Valid options are 'error', 'warn', 'info', 'debug', 'trace'.[39m
[32m- log_level = 'info'[39m
[32m- # Specify the mode to be used by the relayer. [Required][39m
[31m+ log_level = \\"info\\"[39m
[31m+[39m
[2m  [mode][22m
[32m- # Specify the client mode.[39m
[2m  [mode.clients][22m
[32m- # Whether or not to enable the client workers. [Required][39m
[2m  enabled = true[22m
[32m- # Whether or not to enable periodic refresh of clients. [Default: true][39m
[32m- # This feature only applies to clients that underlie an open channel.[39m
[32m- # For Tendermint clients, the frequency at which Hermes refreshes them is 2/3 of their[39m
[32m- # trusting period (e.g., refresh every ~9 days if the trusting period is 14 days).[39m
[32m- # Note: Even if this is disabled, clients will be refreshed automatically if[39m
[32m- #      there is activity on a connection or channel they are involved with.[39m
[2m  refresh = true[22m
[32m- # Whether or not to enable misbehaviour detection for clients. [Default: false][39m
[2m  misbehaviour = true[22m
[32m- # Specify the connections mode.[39m
[31m+[39m
[2m  [mode.connections][22m
[32m- # Whether or not to enable the connection workers for handshake completion. [Required][39m
[2m  enabled = true[22m
[32m- # Specify the channels mode.[39m
[31m+[39m
[2m  [mode.channels][22m
[32m- # Whether or not to enable the channel workers for handshake completion. [Required][39m
[2m  enabled = true[22m
[32m- # Specify the packets mode.[39m
[31m+[39m
[2m  [mode.packets][22m
[32m- # Whether or not to enable the packet workers. [Required][39m
[2m  enabled = true[22m
[32m- # Parametrize the periodic packet clearing feature.[39m
[32m- # Interval (in number of blocks) at which pending packets[39m
[32m- # should be periodically cleared. A value of '0' will disable[39m
[32m- # periodic packet clearing. [Default: 100][39m
[2m  clear_interval = 100[22m
[32m- # Whether or not to clear packets on start. [Default: false][39m
[2m  clear_on_start = true[22m
[32m- # Toggle the transaction confirmation mechanism.[39m
[32m- # The tx confirmation mechanism periodically queries the \`/tx_search\` RPC[39m
[32m- # endpoint to check that previously-submitted transactions[39m
[32m- # (to any chain in this config file) have been successfully delivered.[39m
[32m- # If they have not been, and \`clear_interval = 0\`, then those packets are[39m
[32m- # queued up for re-submission.[39m
[32m- # Experimental feature. Affects telemetry if set to false.[39m
[32m- # [Default: true][39m
[2m  tx_confirmation = true[22m
[32m- # Auto register the counterparty payee on a destination chain to[39m
[32m- # the relayer's address on the source chain. This can be used[39m
[32m- # for simple configuration of the relayer to receive fees for[39m
[32m- # relaying RecvPacket on fee-enabled channels.[39m
[32m- # For more complex configuration, turn this off and use the CLI[39m
[32m- # to manually register the payee addresses.[39m
[32m- # [Default: false][39m
[32m- auto_register_counterparty_payee = false[39m
[32m- # The REST section defines parameters for Hermes' built-in RESTful API.[39m
[32m- # https://hermes.informal.systems/rest.html[39m
[31m+[39m
[2m  [rest][22m
[32m- # Whether or not to enable the REST service. Default: false[39m
[2m  enabled = true[22m
[32m- # Specify the IPv4/6 host over which the built-in HTTP server will serve the RESTful[39m
[32m- # API requests. Default: 127.0.0.1[39m
[32m- host =  '0.0.0.0'[39m
[32m- # Specify the port over which the built-in HTTP server will serve the restful API[39m
[32m- # requests. Default: 3000[39m
[31m+ host = \\"0.0.0.0\\"[39m
[2m  port = 3000[22m
[32m- # The telemetry section defines parameters for Hermes' built-in telemetry capabilities.[39m
[32m- # https://hermes.informal.systems/telemetry.html[39m
[31m+[39m
[2m  [telemetry][22m
[32m- # Whether or not to enable the telemetry service. Default: false[39m
[2m  enabled = false[22m
[32m- # Specify the IPv4/6 host over which the built-in HTTP server will serve the metrics[39m
[32m- # gathered by the telemetry service. Default: 127.0.0.1[39m
[32m- host = '0.0.0.0'[39m
[32m- # Specify the port over which the built-in HTTP server will serve the metrics gathered[39m
[32m- # by the telemetry service. Default: 3001[39m
[31m+ host = \\"0.0.0.0\\"[39m
[2m  port = 3001[22m


[32m-[39m
[2m  [[chains]][22m
[2m  id = \\"osmosis-1\\"[22m
[31m+ type = \\"CosmosSdk\\"[39m
[2m  key_name = \\"osmosis-1-cli\\"[22m
[32m- rpc_addr = \\"http://osmosis-1-genesis.default.svc.cluster.local:26657\\"[39m
[32m- grpc_addr = \\"http://osmosis-1-genesis.default.svc.cluster.local:9090\\"[39m
[31m+[39m
[31m+ rpc_addr = \\"http://osmosis-1-genesis.$NAMESPACE.svc.cluster.local:26657\\"[39m
[31m+ grpc_addr = \\"http://osmosis-1-genesis.$NAMESPACE.svc.cluster.local:9090\\"[39m
[2m  event_source = { mode = 'pull', interval = '500ms' }[22m
[32m- # Experimental: Whether or not the full node is trusted.[39m
[2m  trusted_node = false[22m
[2m  account_prefix = \\"osmo\\"[22m
[2m  default_gas = 500000000[22m
[33m@@ -103,17 +56,16 @@[39m
[2m  trusting_period = \\"75s\\"[22m
[2m  trust_threshold = { numerator = \\"2\\", denominator = \\"3\\" }[22m
[2m  address_type = { derivation = 'cosmos' }[22m
[32m- gas_price = { price = 0.25, denom = \\"uosmo\\" }[39m
[32m-[39m
[31m+ gas_price = { price = 1.25, denom = \\"uosmo\\" }[39m

[32m-[39m
[2m  [[chains]][22m
[2m  id = \\"cosmoshub-4\\"[22m
[31m+ type = \\"CosmosSdk\\"[39m
[2m  key_name = \\"cosmoshub-4-cli\\"[22m
[32m- rpc_addr = \\"http://cosmoshub-4-genesis.default.svc.cluster.local:26657\\"[39m
[32m- grpc_addr = \\"http://cosmoshub-4-genesis.default.svc.cluster.local:9090\\"[39m
[31m+[39m
[31m+ rpc_addr = \\"http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:26657\\"[39m
[31m+ grpc_addr = \\"http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:9090\\"[39m
[2m  event_source = { mode = 'pull', interval = '500ms' }[22m
[32m- # Experimental: Whether or not the full node is trusted.[39m
[2m  trusted_node = false[22m
[2m  account_prefix = \\"cosmos\\"[22m
[2m  default_gas = 500000000[22m
[33m@@ -128,96 +80,48 @@[39m
[2m  trusting_period = \\"75s\\"[22m
[2m  trust_threshold = { numerator = \\"2\\", denominator = \\"3\\" }[22m
[2m  address_type = { derivation = 'cosmos' }[22m
[32m- gas_price = { price = 0.25, denom = \\"uatom\\" }",[39m
[31m+ gas_price = { price = 1.25, denom = \\"uatom\\" }",[39m
[2m      "config.toml": "# The global section has parameters that apply globally to the relayer operation.[22m
[2m  [global][22m
[32m- # Specify the verbosity for the relayer logging output. Default: 'info'[39m
[32m- # Valid options are 'error', 'warn', 'info', 'debug', 'trace'.[39m
[32m- log_level = 'info'[39m
[32m- # Specify the mode to be used by the relayer. [Required][39m
[31m+ log_level = \\"info\\"[39m
[31m+[39m
[2m  [mode][22m
[32m- # Specify the client mode.[39m
[2m  [mode.clients][22m
[32m- # Whether or not to enable the client workers. [Required][39m
[2m  enabled = true[22m
[32m- # Whether or not to enable periodic refresh of clients. [Default: true][39m
[32m- # This feature only applies to clients that underlie an open channel.[39m
[32m- # For Tendermint clients, the frequency at which Hermes refreshes them is 2/3 of their[39m
[32m- # trusting period (e.g., refresh every ~9 days if the trusting period is 14 days).[39m
[32m- # Note: Even if this is disabled, clients will be refreshed automatically if[39m
[32m- #      there is activity on a connection or channel they are involved with.[39m
[2m  refresh = true[22m
[32m- # Whether or not to enable misbehaviour detection for clients. [Default: false][39m
[2m  misbehaviour = true[22m
[32m- # Specify the connections mode.[39m
[31m+[39m
[2m  [mode.connections][22m
[32m- # Whether or not to enable the connection workers for handshake completion. [Required][39m
[2m  enabled = true[22m
[32m- # Specify the channels mode.[39m
[31m+[39m
[2m  [mode.channels][22m
[32m- # Whether or not to enable the channel workers for handshake completion. [Required][39m
[2m  enabled = true[22m
[32m- # Specify the packets mode.[39m
[31m+[39m
[2m  [mode.packets][22m
[32m- # Whether or not to enable the packet workers. [Required][39m
[2m  enabled = true[22m
[32m- # Parametrize the periodic packet clearing feature.[39m
[32m- # Interval (in number of blocks) at which pending packets[39m
[32m- # should be periodically cleared. A value of '0' will disable[39m
[32m- # periodic packet clearing. [Default: 100][39m
[2m  clear_interval = 100[22m
[32m- # Whether or not to clear packets on start. [Default: false][39m
[2m  clear_on_start = true[22m
[32m- # Toggle the transaction confirmation mechanism.[39m
[32m- # The tx confirmation mechanism periodically queries the \`/tx_search\` RPC[39m
[32m- # endpoint to check that previously-submitted transactions[39m
[32m- # (to any chain in this config file) have been successfully delivered.[39m
[32m- # If they have not been, and \`clear_interval = 0\`, then those packets are[39m
[32m- # queued up for re-submission.[39m
[32m- # Experimental feature. Affects telemetry if set to false.[39m
[32m- # [Default: true][39m
[2m  tx_confirmation = true[22m
[32m- # Auto register the counterparty payee on a destination chain to[39m
[32m- # the relayer's address on the source chain. This can be used[39m
[32m- # for simple configuration of the relayer to receive fees for[39m
[32m- # relaying RecvPacket on fee-enabled channels.[39m
[32m- # For more complex configuration, turn this off and use the CLI[39m
[32m- # to manually register the payee addresses.[39m
[32m- # [Default: false][39m
[32m- auto_register_counterparty_payee = false[39m
[32m- # The REST section defines parameters for Hermes' built-in RESTful API.[39m
[32m- # https://hermes.informal.systems/rest.html[39m
[31m+[39m
[2m  [rest][22m
[32m- # Whether or not to enable the REST service. Default: false[39m
[2m  enabled = true[22m
[32m- # Specify the IPv4/6 host over which the built-in HTTP server will serve the RESTful[39m
[32m- # API requests. Default: 127.0.0.1[39m
[32m- host =  '0.0.0.0'[39m
[32m- # Specify the port over which the built-in HTTP server will serve the restful API[39m
[32m- # requests. Default: 3000[39m
[31m+ host = \\"0.0.0.0\\"[39m
[2m  port = 3000[22m
[32m- # The telemetry section defines parameters for Hermes' built-in telemetry capabilities.[39m
[32m- # https://hermes.informal.systems/telemetry.html[39m
[31m+[39m
[2m  [telemetry][22m
[32m- # Whether or not to enable the telemetry service. Default: false[39m
[2m  enabled = false[22m
[32m- # Specify the IPv4/6 host over which the built-in HTTP server will serve the metrics[39m
[32m- # gathered by the telemetry service. Default: 127.0.0.1[39m
[32m- host = '0.0.0.0'[39m
[32m- # Specify the port over which the built-in HTTP server will serve the metrics gathered[39m
[32m- # by the telemetry service. Default: 3001[39m
[31m+ host = \\"0.0.0.0\\"[39m
[2m  port = 3001[22m
[32m-[39m


[2m  [[chains]][22m
[2m  id = \\"osmosis-1\\"[22m
[2m  type = \\"CosmosSdk\\"[22m
[2m  key_name = \\"osmosis-1\\"[22m
[32m- rpc_addr = \\"http://osmosis-1-genesis.default.svc.cluster.local:26657\\"[39m
[32m- grpc_addr = \\"http://osmosis-1-genesis.default.svc.cluster.local:9090\\"[39m
[31m+[39m
[31m+ rpc_addr = \\"http://osmosis-1-genesis.$NAMESPACE.svc.cluster.local:26657\\"[39m
[31m+ grpc_addr = \\"http://osmosis-1-genesis.$NAMESPACE.svc.cluster.local:9090\\"[39m
[2m  event_source = { mode = 'pull', interval = '500ms' }[22m
[32m- # Experimental: Whether or not the full node is trusted.[39m
[2m  trusted_node = false[22m
[2m  account_prefix = \\"osmo\\"[22m
[2m  default_gas = 500000000[22m
[33m@@ -233,17 +137,15 @@[39m
[2m  trust_threshold = { numerator = \\"2\\", denominator = \\"3\\" }[22m
[2m  address_type = { derivation = 'cosmos' }[22m
[2m  gas_price = { price = 1.25, denom = \\"uosmo\\" }[22m
[32m-[39m
[32m-[39m

[2m  [[chains]][22m
[2m  id = \\"cosmoshub-4\\"[22m
[2m  type = \\"CosmosSdk\\"[22m
[2m  key_name = \\"cosmoshub-4\\"[22m
[32m- rpc_addr = \\"http://cosmoshub-4-genesis.default.svc.cluster.local:26657\\"[39m
[32m- grpc_addr = \\"http://cosmoshub-4-genesis.default.svc.cluster.local:9090\\"[39m
[31m+[39m
[31m+ rpc_addr = \\"http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:26657\\"[39m
[31m+ grpc_addr = \\"http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:9090\\"[39m
[2m  event_source = { mode = 'pull', interval = '500ms' }[22m
[32m- # Experimental: Whether or not the full node is trusted.[39m
[2m  trusted_node = false[22m
[2m  account_prefix = \\"cosmos\\"[22m
[2m  default_gas = 500000000[22m
[33m@@ -262,6 +164,15 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "relayer",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "hermes-osmos-cosmos",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/role": "hermes",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "hermes-osmos-cosmos",[22m
[2m    },[22m
[2m  }[22m

--- StatefulSet/hermes-osmos-cosmos ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,15 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "relayer",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "hermes-osmos-cosmos",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/role": "hermes",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "hermes-osmos-cosmos",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -29,16 +38,18 @@[39m
[2m            "app.kubernetes.io/name": "hermes-osmos-cosmos",[22m
[2m            "app.kubernetes.io/rawname": "osmos-cosmos",[22m
[2m            "app.kubernetes.io/type": "hermes",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[2m          "containers": Array [[22m
[2m            Object {[22m
[31m+             "args": Array [[39m
[31m+               "/exposer/exposer",[39m
[31m+             ],[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "/exposer/exposer",[39m
[2m              ],[22m
[2m              "env": Array [[22m
[2m                Object {[22m
[33m@@ -55,11 +66,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -83,14 +94,24 @@[39m
[2m              ],[22m
[2m            },[22m
[2m            Object {[22m
[31m+             "args": Array [[39m
[31m+               "RLY_INDEX=\${HOSTNAME##*-}[39m
[31m+ echo \\"Relayer Index: $RLY_INDEX\\"[39m
[31m+ hermes start",[39m
[31m+             ],[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "RLY_INDEX=\${HOSTNAME##*-}[39m
[32m- echo \\"Relayer Index: $RLY_INDEX\\"[39m
[32m- hermes start",[39m
[2m              ],[22m
[2m              "env": Array [[22m
[31m+               Object {[39m
[31m+                 "name": "NAMESPACE",[39m
[31m+                 "valueFrom": Object {[39m
[31m+                   "fieldRef": Object {[39m
[31m+                     "fieldPath": "metadata.namespace",[39m
[31m+                   },[39m
[31m+                 },[39m
[31m+               },[39m
[2m                Object {[22m
[2m                  "name": "RELAYER_DIR",[22m
[2m                  "value": "/root/.hermes",[22m
[33m@@ -101,12 +122,12 @@[39m
[2m              "name": "relayer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[2m              },[22m
[2m              "securityContext": Object {[22m
[33m@@ -127,24 +148,26 @@[39m
[2m          ],[22m
[2m          "initContainers": Array [[22m
[2m            Object {[22m
[31m+             "args": Array [[39m
[31m+               "# Install exposer binary from the image[39m
[31m+ cp /bin/exposer /exposer/exposer[39m
[31m+ chmod +x /exposer/exposer",[39m
[31m+             ],[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "# Install exposer binary from the image[39m
[32m- cp /bin/exposer /exposer/exposer[39m
[32m- chmod +x /exposer/exposer",[39m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/exposer:20250205-544757d",[22m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "init-exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "100M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "100M",[39m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[33m@@ -155,9 +178,7 @@[39m
[2m              ],[22m
[2m            },[22m
[2m            Object {[22m
[32m-             "command": Array [[39m
[32m-               "bash",[39m
[32m-               "-c",[39m
[31m+             "args": Array [[39m
[2m                "set -ux[22m

[2m  RLY_INDEX=\${HOSTNAME##*-}[22m
[33m@@ -166,18 +187,16 @@[39m
[2m  mkdir -p $RELAYER_DIR[22m
[2m  cp /configs/config.toml $RELAYER_DIR/config.toml[22m
[2m  cp /configs/config-cli.toml $RELAYER_DIR/config-cli.toml[22m
[32m- cat $RELAYER_DIR/config.toml[39m
[31m+[39m
[31m+ # Replace namespace placeholder with actual namespace environment variable[39m
[31m+ sed -i \\"s|\\\\$NAMESPACE|$NAMESPACE|g\\" $RELAYER_DIR/config.toml[39m
[31m+ sed -i \\"s|\\\\$NAMESPACE|$NAMESPACE|g\\" $RELAYER_DIR/config-cli.toml[39m

[32m- MNEMONIC=$(jq -r \\".relayers[$RELAYER_INDEX].mnemonic\\" $KEYS_CONFIG)[39m
[31m+ MNEMONIC=$(jq -r \\".relayers[$RLY_INDEX].mnemonic\\" $KEYS_CONFIG)[39m
[2m  echo $MNEMONIC > $RELAYER_DIR/mnemonic.txt[22m
[32m- MNEMONIC_CLI=$(jq -r \\".relayers_cli[$RELAYER_INDEX].mnemonic\\" $KEYS_CONFIG)[39m
[31m+ MNEMONIC_CLI=$(jq -r \\".relayers_cli[$RLY_INDEX].mnemonic\\" $KEYS_CONFIG)[39m
[2m  echo $MNEMONIC_CLI > $RELAYER_DIR/mnemonic-cli.txt[22m

[32m- echo \\"Debug output for osmos-cosmos...\\"[39m
[32m- cat << EOF[39m
[32m-               map[string]interface {}[39m
[32m-               {\\"chains\\":[\\"osmosis-1\\",\\"cosmoshub-4\\"],\\"channels\\":[{\\"a-chain\\":\\"osmosis-1\\",\\"a-port\\":\\"transfer\\",\\"b-chain\\":\\"cosmoshub-4\\",\\"b-port\\":\\"transfer\\",\\"new-connection\\":true}],\\"config\\":{\\"event_source\\":{\\"mode\\":\\"pull\\"},\\"global\\":{\\"log_level\\":\\"info\\"},\\"mode\\":{\\"channels\\":{\\"enabled\\":true},\\"clients\\":{\\"enabled\\":true,\\"misbehaviour\\":true,\\"refresh\\":true},\\"connections\\":{\\"enabled\\":true},\\"packets\\":{\\"clear_interval\\":100,\\"clear_on_start\\":true,\\"enabled\\":true,\\"tx_confirmation\\":true}},\\"rest\\":{\\"enabled\\":true,\\"host\\":\\"0.0.0.0\\",\\"port\\":3000},\\"telemetry\\":{\\"enabled\\":false,\\"host\\":\\"0.0.0.0\\",\\"port\\":3001}},\\"fullname\\":\\"hermes-osmos-cosmos\\",\\"ics\\":{\\"enabled\\":false},\\"image\\":\\"ghcr.io/hyperweb-io/starship/hermes:1.12.0\\",\\"name\\":\\"osmos-cosmos\\",\\"ports\\":{\\"exposer\\":3002,\\"rest\\":3000},\\"replicas\\":1,\\"type\\":\\"hermes\\"}[39m
[32m- EOF[39m

[2m  echo \\"Creating key for osmosis-1...\\"[22m
[2m  hermes keys add \\\\[22m
[33m@@ -240,12 +259,17 @@[39m
[2m    $DENOM \\\\[22m
[2m    http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:8000/credit \\\\[22m
[2m    \\"false\\" || true[22m
[31m+[39m
[2m  hermes create channel \\\\[22m
[2m    --new-client-connection --yes \\\\[22m
[2m    --b-chain cosmoshub-4 \\\\[22m
[2m    --a-chain osmosis-1 \\\\[22m
[2m    --a-port transfer \\\\[22m
[2m    --b-port transfer",[22m
[31m+             ],[39m
[31m+             "command": Array [[39m
[31m+               "bash",[39m
[31m+               "-c",[39m
[2m              ],[22m
[2m              "env": Array [[22m
[2m                Object {[22m
[33m@@ -266,7 +290,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "RELAYER_INDEX",[22m
[32m-                 "value": "0",[39m
[31m+                 "value": "\${HOSTNAME##*-}",[39m
[2m                },[22m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/hermes:1.12.0",[22m
[33m@@ -274,12 +298,12 @@[39m
[2m              "name": "init-relayer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[33m@@ -310,6 +334,7 @@[39m
[2m    echo \\"Checking: http://osmosis-1-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id\\"[22m
[2m    sleep 10;[22m
[2m  done[22m
[31m+[39m
[2m  while [ $(curl -sw '%{http_code}' http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id -o /dev/null) -ne 200 ]; do[22m
[2m    echo \\"Genesis validator does not seem to be ready for: cosmoshub-4. Waiting for it to start...\\"[22m
[2m    echo \\"Checking: http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id\\"[22m
[33m@@ -332,16 +357,16 @@[39m
[2m                  },[22m
[2m                },[22m
[2m              ],[22m
[32m-             "image": "curlimages/curl",[39m
[31m+             "image": "curlimages/curl:latest",[39m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "wait-for-chains",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m"
`;

exports[`Manifest Comparison Tests Individual Config Comparisons should generate manifests for two-chain-cometmock that match the snapshot 1`] = `
"ðŸ”„ MODIFIED_RESOURCES:

--- ConfigMap/keys ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -98,6 +98,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "configmap",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "keys",[39m
[31m+       "app.kubernetes.io/part-of": "global",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "keys",[22m
[2m    },[22m
[2m  }[22m

--- ConfigMap/setup-scripts ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -208,6 +208,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "configmap",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts",[39m
[31m+       "app.kubernetes.io/part-of": "global",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts",[22m
[2m    },[22m
[2m  }[22m

--- StatefulSet/cosmoshub-4-cometmock ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,18 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/id": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "cosmoshub-4-cometmock",[39m
[31m+       "app.kubernetes.io/part-of": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/role": "cometmock",[39m
[31m+       "app.kubernetes.io/type": "cosmoshub-4-statefulset",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-name": "cosmoshub",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "cosmoshub-4-cometmock",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -27,7 +39,7 @@[39m
[2m            "app.kubernetes.io/name": "cosmoshub-4-cometmock",[22m
[2m            "app.kubernetes.io/rawname": "cosmoshub-4-cometmock",[22m
[2m            "app.kubernetes.io/type": "cometmock",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[33m@@ -38,6 +50,7 @@[39m
[2m                "-c",[22m
[2m                "NODE_LISTEN_ADDR_STR=\\"tcp://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:26658\\"[22m
[2m  NODE_HOME_STR=\\"/chain/genesis\\"[22m
[31m+     [39m
[2m  /chain/cometmock --block-time=800 $NODE_LISTEN_ADDR_STR /chain/genesis/config/genesis.json tcp://0.0.0.0:22331 $NODE_HOME_STR grpc",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -107,11 +120,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -145,7 +158,7 @@[39m
[2m  ## fetch priv_validator and priv_validator_state of all validators[22m
[2m  curl http://$GENESIS_HOST.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/priv_keys -o /chain/genesis/config/priv_validator_key.json[22m
[2m  echo '{\\"height\\":\\"0\\",\\"round\\":0,\\"step\\":0}' > /chain/genesis/data/priv_validator_state.json[22m
[32m-[39m
[31m+     [39m
[2m  echo \\"copy cometmock binary to shared dir\\"[22m
[2m  cp /usr/local/bin/cometmock /chain/cometmock",[22m
[2m              ],[22m
[33m@@ -236,11 +249,11 @@[39m
[2m              "name": "init-comet",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -268,6 +281,7 @@[39m
[2m    echo \\"Checking: http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/priv_keys\\"[22m
[2m    sleep 10;[22m
[2m  done[22m
[31m+     [39m
[2m  echo \\"Ready to start\\"[22m
[2m  exit 0",[22m
[2m              ],[22m
[33m@@ -290,11 +304,11 @@[39m
[2m              "name": "init-wait",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m

--- StatefulSet/cosmoshub-4-genesis ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,18 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/id": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "cosmoshub-4-genesis",[39m
[31m+       "app.kubernetes.io/part-of": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/role": "genesis",[39m
[31m+       "app.kubernetes.io/type": "cosmoshub-4-statefulset",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-name": "cosmoshub",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "cosmoshub-4-genesis",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +21,7 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "cosmoshub",[39m
[31m+         "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m          "app.kubernetes.io/name": "cosmoshub-4-genesis",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -23,11 +35,12 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "cosmoshub",[39m
[31m+           "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m            "app.kubernetes.io/name": "cosmoshub-4-genesis",[22m
[2m            "app.kubernetes.io/rawname": "cosmoshub-4",[22m
[31m+           "app.kubernetes.io/role": "genesis",[39m
[2m            "app.kubernetes.io/type": "cosmoshub-4",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[33m@@ -91,11 +104,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -114,8 +127,12 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "START_ARGS=\\"\\"[39m
[31m+               "#!/bin/bash[39m
[31m+ set -euo pipefail[39m
[31m+[39m
[31m+ START_ARGS=\\"\\"[39m
[2m  START_ARGS=\\"--grpc-web.enable=false --transport=grpc --with-tendermint=false --address tcp://0.0.0.0:26658\\"[22m
[31m+[39m
[2m  $CHAIN_BIN start $START_ARGS",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -165,11 +182,11 @@[39m
[2m              "name": "validator",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -198,6 +215,7 @@[39m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m

[2m  echo \\"Running setup config script...\\"[22m
[31m+[39m
[2m  bash -e /scripts/update-config.sh",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -239,7 +257,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "TIME_IOTA_MS",[22m
[33m@@ -279,11 +297,11 @@[39m
[2m              "name": "init-config",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -416,11 +434,11 @@[39m
[2m              "name": "init-genesis",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m

--- ConfigMap/setup-scripts-cosmoshub-4 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -608,6 +608,17 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts-cosmoshub-4",[39m
[31m+       "app.kubernetes.io/part-of": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/role": "setup-scripts",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-id": "cosmoshub-4",[39m
[31m+       "starship.io/chain-name": "cosmoshub",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts-cosmoshub-4",[22m
[2m    },[22m
[2m  }[22m

--- StatefulSet/osmosis-1-cometmock ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,18 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/id": "osmosis-1",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "osmosis-1-cometmock",[39m
[31m+       "app.kubernetes.io/part-of": "osmosis-1",[39m
[31m+       "app.kubernetes.io/role": "cometmock",[39m
[31m+       "app.kubernetes.io/type": "osmosis-1-statefulset",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-name": "osmosis",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "osmosis-1-cometmock",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -27,7 +39,7 @@[39m
[2m            "app.kubernetes.io/name": "osmosis-1-cometmock",[22m
[2m            "app.kubernetes.io/rawname": "osmosis-1-cometmock",[22m
[2m            "app.kubernetes.io/type": "cometmock",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[33m@@ -38,11 +50,12 @@[39m
[2m                "-c",[22m
[2m                "NODE_LISTEN_ADDR_STR=\\"tcp://osmosis-1-genesis.$NAMESPACE.svc.cluster.local:26658\\"[22m
[2m  NODE_HOME_STR=\\"/chain/genesis\\"[22m
[32m- for i in $(seq 0 0);[39m
[32m- do[39m
[31m+     [39m
[31m+ for i in $(seq 0 0); do[39m
[2m    NODE_LISTEN_ADDR_STR=\\"tcp://osmosis-1-validator-$i.osmosis-1-validator.$NAMESPACE.svc.cluster.local:26658,$NODE_LISTEN_ADDR_STR\\"[22m
[2m    NODE_HOME_STR=\\"/chain/validator-$i,$NODE_HOME_STR\\"[22m
[2m  done[22m
[31m+       [39m
[2m  /chain/cometmock --block-time=800 $NODE_LISTEN_ADDR_STR /chain/genesis/config/genesis.json tcp://0.0.0.0:22331 $NODE_HOME_STR grpc",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -111,8 +124,8 @@[39m
[2m                      "set -eux[22m

[2m  sleep 10[22m
[32m- for i in $(seq 0 0);[39m
[32m- do[39m
[31m+[39m
[31m+ for i in $(seq 0 0); do[39m
[2m    $CHAIN_BIN keys list --keyring-backend test --home /chain/validator-$i --output json | jq[22m
[2m    VAL_KEY_NAME=\\"$(jq -r '.validators[0].name' $KEYS_CONFIG)-$i\\"[22m
[2m    echo \\"Create validator.... $VAL_KEY_NAME\\"[22m
[33m@@ -137,11 +150,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -175,15 +188,15 @@[39m
[2m  ## fetch priv_validator and priv_validator_state of all validators[22m
[2m  curl http://$GENESIS_HOST.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/priv_keys -o /chain/genesis/config/priv_validator_key.json[22m
[2m  echo '{\\"height\\":\\"0\\",\\"round\\":0,\\"step\\":0}' > /chain/genesis/data/priv_validator_state.json[22m
[32m- for i in $(seq 0 0);[39m
[32m- do[39m
[31m+     [39m
[31m+ for i in $(seq 0 0); do[39m
[2m    mkdir -p /chain/validator-$i/config[22m
[2m    mkdir -p /chain/validator-$i/data[22m
[2m    curl http://osmosis-1-validator-$i.osmosis-1-validator.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_key -o /chain/validator-$i/config/node_key.json[22m
[2m    curl http://osmosis-1-validator-$i.osmosis-1-validator.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/priv_keys -o /chain/validator-$i/config/priv_validator_key.json[22m
[2m    echo '{\\"height\\":\\"0\\",\\"round\\":0,\\"step\\":0}' > /chain/validator-$i/data/priv_validator_state.json[22m
[2m  done[22m
[32m-[39m
[31m+       [39m
[2m  echo \\"copy cometmock binary to shared dir\\"[22m
[2m  cp /usr/local/bin/cometmock /chain/cometmock",[22m
[2m              ],[22m
[33m@@ -274,11 +287,11 @@[39m
[2m              "name": "init-comet",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -301,8 +314,7 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "for i in $(seq 0 0);[39m
[32m- do[39m
[31m+               "for i in $(seq 0 0); do[39m
[2m    mkdir -p /chain/validator-$i/config /chain/validator-$i/data[22m
[2m    VAL_KEY_NAME=\\"$(jq -r '.validators[0].name' $KEYS_CONFIG)-$i\\"[22m
[2m    echo \\"Adding validator key.... $VAL_KEY_NAME\\"[22m
[33m@@ -368,11 +380,11 @@[39m
[2m              "name": "init-validator",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -400,14 +412,15 @@[39m
[2m    echo \\"Checking: http://osmosis-1-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/priv_keys\\"[22m
[2m    sleep 10;[22m
[2m  done[22m
[32m- for i in $(seq 0 0);[39m
[32m- do[39m
[31m+     [39m
[31m+ for i in $(seq 0 0); do[39m
[2m    while [ $(curl -sw '%{http_code}' http://osmosis-1-validator-$i.osmosis-1-validator.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/priv_keys -o /dev/null) -ne 200 ]; do[22m
[2m      echo \\"Validator does not seem to be ready for: osmosis-1 validator-$i. Waiting for it to start...\\"[22m
[2m      echo \\"Checking: http://osmosis-1-validator-$i.osmosis-1-validator.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/priv_keys\\"[22m
[2m      sleep 10;[22m
[2m    done[22m
[2m  done[22m
[31m+       [39m
[2m  echo \\"Ready to start\\"[22m
[2m  exit 0",[22m
[2m              ],[22m
[33m@@ -430,11 +443,11 @@[39m
[2m              "name": "init-wait",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m

--- StatefulSet/osmosis-1-genesis ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,18 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/id": "osmosis-1",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "osmosis-1-genesis",[39m
[31m+       "app.kubernetes.io/part-of": "osmosis-1",[39m
[31m+       "app.kubernetes.io/role": "genesis",[39m
[31m+       "app.kubernetes.io/type": "osmosis-1-statefulset",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-name": "osmosis",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "osmosis-1-genesis",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +21,7 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "osmosis",[39m
[31m+         "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m          "app.kubernetes.io/name": "osmosis-1-genesis",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -23,11 +35,12 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "osmosis",[39m
[31m+           "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m            "app.kubernetes.io/name": "osmosis-1-genesis",[22m
[2m            "app.kubernetes.io/rawname": "osmosis-1",[22m
[31m+           "app.kubernetes.io/role": "genesis",[39m
[2m            "app.kubernetes.io/type": "osmosis-1",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[33m@@ -91,11 +104,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -114,8 +127,12 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "START_ARGS=\\"\\"[39m
[31m+               "#!/bin/bash[39m
[31m+ set -euo pipefail[39m
[31m+[39m
[31m+ START_ARGS=\\"\\"[39m
[2m  START_ARGS=\\"--grpc-web.enable=false --transport=grpc --with-tendermint=false --address tcp://0.0.0.0:26658\\"[22m
[31m+[39m
[2m  $CHAIN_BIN start $START_ARGS",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -165,11 +182,11 @@[39m
[2m              "name": "validator",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -198,6 +215,7 @@[39m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m

[2m  echo \\"Running setup config script...\\"[22m
[31m+[39m
[2m  bash -e /scripts/update-config.sh",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -239,7 +257,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "TIME_IOTA_MS",[22m
[33m@@ -279,11 +297,11 @@[39m
[2m              "name": "init-config",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -416,11 +434,11 @@[39m
[2m              "name": "init-genesis",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m

--- ConfigMap/setup-scripts-osmosis-1 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -608,6 +608,17 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts-osmosis-1",[39m
[31m+       "app.kubernetes.io/part-of": "osmosis-1",[39m
[31m+       "app.kubernetes.io/role": "setup-scripts",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-id": "osmosis-1",[39m
[31m+       "starship.io/chain-name": "osmosis",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts-osmosis-1",[22m
[2m    },[22m
[2m  }[22m

--- Service/osmosis-1-validator ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -23,6 +23,12 @@[39m
[2m          "targetPort": 8081,[22m
[2m        },[22m
[2m        Object {[22m
[31m+         "name": "faucet",[39m
[31m+         "port": 8000,[39m
[31m+         "protocol": "TCP",[39m
[31m+         "targetPort": 8000,[39m
[31m+       },[39m
[31m+       Object {[39m
[2m          "name": "grpc",[22m
[2m          "port": 9090,[22m
[2m          "protocol": "TCP",[22m

--- StatefulSet/osmosis-1-validator ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,18 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/id": "osmosis-1",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "osmosis-1-validator",[39m
[31m+       "app.kubernetes.io/part-of": "osmosis-1",[39m
[31m+       "app.kubernetes.io/role": "validator",[39m
[31m+       "app.kubernetes.io/type": "osmosis-1-statefulset",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-name": "osmosis",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "osmosis-1-validator",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -10,7 +22,7 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "osmosis",[39m
[31m+         "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m          "app.kubernetes.io/name": "osmosis-1-validator",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -24,10 +36,11 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "osmosis",[39m
[31m+           "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m            "app.kubernetes.io/name": "osmosis-1-validator",[22m
[31m+           "app.kubernetes.io/role": "validator",[39m
[2m            "app.kubernetes.io/type": "osmosis-1",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[33m@@ -119,11 +132,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -147,6 +160,7 @@[39m
[2m  START_ARGS=\\"--grpc-web.enable=false --transport=grpc --with-tendermint=false --address tcp://0.0.0.0:26658\\"[22m

[2m  # Starting the chain[22m
[31m+[39m
[2m  $CHAIN_BIN start $START_ARGS",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -212,11 +226,11 @@[39m
[2m              "name": "validator",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -244,6 +258,7 @@[39m
[2m                "VAL_INDEX=\${HOSTNAME##*-}[22m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m

[31m+[39m
[2m  echo \\"Running setup config script...\\"[22m
[2m  bash -e /scripts/update-config.sh[22m

[33m@@ -308,7 +323,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "NAMESPACE",[22m
[33m@@ -356,11 +371,11 @@[39m
[2m              "name": "init-config",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -385,6 +400,7 @@[39m
[2m                "-c",[22m
[2m                "VAL_INDEX=\${HOSTNAME##*-}[22m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m
[31m+[39m

[2m  if [ -f $CHAIN_DIR/config/genesis.json ]; then[22m
[2m    echo \\"Genesis file exists, exiting early\\"[22m
[33m@@ -457,7 +473,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "NAMESPACE",[22m
[33m@@ -505,11 +521,11 @@[39m
[2m              "name": "init-validator",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -554,16 +570,16 @@[39m
[2m                  },[22m
[2m                },[22m
[2m              ],[22m
[32m-             "image": "curlimages/curl",[39m
[31m+             "image": "curlimages/curl:latest",[39m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "wait-for-chains",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m"
`;

exports[`Manifest Comparison Tests Individual Config Comparisons should generate manifests for two-chain-cosmos that match the snapshot 1`] = `
"ðŸ”„ MODIFIED_RESOURCES:

--- ConfigMap/keys ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -98,6 +98,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "configmap",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "keys",[39m
[31m+       "app.kubernetes.io/part-of": "global",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "keys",[22m
[2m    },[22m
[2m  }[22m

--- ConfigMap/setup-scripts ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -208,6 +208,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "configmap",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts",[39m
[31m+       "app.kubernetes.io/part-of": "global",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts",[22m
[2m    },[22m
[2m  }[22m

--- StatefulSet/cosmoshub-4-genesis ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,18 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/id": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "cosmoshub-4-genesis",[39m
[31m+       "app.kubernetes.io/part-of": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/role": "genesis",[39m
[31m+       "app.kubernetes.io/type": "cosmoshub-4-statefulset",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-name": "cosmoshub",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "cosmoshub-4-genesis",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +21,7 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "cosmoshub",[39m
[31m+         "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m          "app.kubernetes.io/name": "cosmoshub-4-genesis",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -23,11 +35,12 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "cosmoshub",[39m
[31m+           "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m            "app.kubernetes.io/name": "cosmoshub-4-genesis",[22m
[2m            "app.kubernetes.io/rawname": "cosmoshub-4",[22m
[31m+           "app.kubernetes.io/role": "genesis",[39m
[2m            "app.kubernetes.io/type": "cosmoshub-4",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[33m@@ -91,11 +104,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -184,12 +197,12 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[32m-                 "memory": "200M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "128M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[32m-                 "memory": "200M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "128M",[39m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[33m@@ -211,7 +224,12 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "START_ARGS=\\"\\"[39m
[31m+               "#!/bin/bash[39m
[31m+ set -euo pipefail[39m
[31m+[39m
[31m+ START_ARGS=\\"\\"[39m
[31m+[39m
[31m+[39m
[2m  $CHAIN_BIN start $START_ARGS",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -274,11 +292,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -307,6 +325,7 @@[39m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m

[2m  echo \\"Running setup config script...\\"[22m
[31m+[39m
[2m  bash -e /scripts/update-config.sh",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -348,7 +367,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "TIME_IOTA_MS",[22m
[33m@@ -388,11 +407,11 @@[39m
[2m              "name": "init-config",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -415,20 +434,18 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "# Install faucet binary from the image[39m
[32m- cp /bin/faucet /faucet/faucet[39m
[32m- chmod +x /faucet/faucet",[39m
[31m+               "cp /bin/faucet /faucet/faucet && chmod +x /faucet/faucet",[39m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/faucet:20250325-2207109",[22m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "init-faucet",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -553,11 +570,11 @@[39m
[2m              "name": "init-genesis",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m

--- ConfigMap/setup-scripts-cosmoshub-4 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -608,6 +608,17 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts-cosmoshub-4",[39m
[31m+       "app.kubernetes.io/part-of": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/role": "setup-scripts",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-id": "cosmoshub-4",[39m
[31m+       "starship.io/chain-name": "cosmoshub",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts-cosmoshub-4",[22m
[2m    },[22m
[2m  }[22m

--- Service/cosmoshub-4-validator ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -23,6 +23,12 @@[39m
[2m          "targetPort": 8081,[22m
[2m        },[22m
[2m        Object {[22m
[31m+         "name": "faucet",[39m
[31m+         "port": 8000,[39m
[31m+         "protocol": "TCP",[39m
[31m+         "targetPort": 8000,[39m
[31m+       },[39m
[31m+       Object {[39m
[2m          "name": "grpc",[22m
[2m          "port": 9090,[22m
[2m          "protocol": "TCP",[22m

--- StatefulSet/cosmoshub-4-validator ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,18 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/id": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "cosmoshub-4-validator",[39m
[31m+       "app.kubernetes.io/part-of": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/role": "validator",[39m
[31m+       "app.kubernetes.io/type": "cosmoshub-4-statefulset",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-name": "cosmoshub",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "cosmoshub-4-validator",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -10,7 +22,7 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "cosmoshub",[39m
[31m+         "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m          "app.kubernetes.io/name": "cosmoshub-4-validator",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -24,10 +36,11 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "cosmoshub",[39m
[31m+           "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m            "app.kubernetes.io/name": "cosmoshub-4-validator",[22m
[31m+           "app.kubernetes.io/role": "validator",[39m
[2m            "app.kubernetes.io/type": "cosmoshub-4",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[33m@@ -119,11 +132,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -145,7 +158,9 @@[39m
[2m                "set -eux[22m
[2m  START_ARGS=\\"\\"[22m

[31m+[39m
[2m  # Starting the chain[22m
[31m+[39m
[2m  $CHAIN_BIN start $START_ARGS",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -255,11 +270,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -286,6 +301,7 @@[39m
[2m                "-c",[22m
[2m                "VAL_INDEX=\${HOSTNAME##*-}[22m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m
[31m+[39m

[2m  echo \\"Running setup config script...\\"[22m
[2m  bash -e /scripts/update-config.sh[22m
[33m@@ -351,7 +367,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "NAMESPACE",[22m
[33m@@ -399,11 +415,11 @@[39m
[2m              "name": "init-config",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -428,6 +444,7 @@[39m
[2m                "-c",[22m
[2m                "VAL_INDEX=\${HOSTNAME##*-}[22m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m
[31m+[39m

[2m  if [ -f $CHAIN_DIR/config/genesis.json ]; then[22m
[2m    echo \\"Genesis file exists, exiting early\\"[22m
[33m@@ -500,7 +517,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "NAMESPACE",[22m
[33m@@ -548,11 +565,11 @@[39m
[2m              "name": "init-validator",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -597,16 +614,16 @@[39m
[2m                  },[22m
[2m                },[22m
[2m              ],[22m
[32m-             "image": "curlimages/curl",[39m
[31m+             "image": "curlimages/curl:latest",[39m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "wait-for-chains",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -618,6 +635,10 @@[39m
[2m                "name": "keys",[22m
[2m              },[22m
[2m              "name": "addresses",[22m
[31m+           },[39m
[31m+           Object {[39m
[31m+             "emptyDir": Object {},[39m
[31m+             "name": "faucet",[39m
[2m            },[22m
[2m            Object {[22m
[2m              "emptyDir": Object {},[22m

--- StatefulSet/osmosis-1-genesis ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,18 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/id": "osmosis-1",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "osmosis-1-genesis",[39m
[31m+       "app.kubernetes.io/part-of": "osmosis-1",[39m
[31m+       "app.kubernetes.io/role": "genesis",[39m
[31m+       "app.kubernetes.io/type": "osmosis-1-statefulset",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-name": "osmosis",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "osmosis-1-genesis",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +21,7 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "osmosis",[39m
[31m+         "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m          "app.kubernetes.io/name": "osmosis-1-genesis",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -23,11 +35,12 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "osmosis",[39m
[31m+           "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m            "app.kubernetes.io/name": "osmosis-1-genesis",[22m
[2m            "app.kubernetes.io/rawname": "osmosis-1",[22m
[31m+           "app.kubernetes.io/role": "genesis",[39m
[2m            "app.kubernetes.io/type": "osmosis-1",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[33m@@ -91,11 +104,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -184,12 +197,12 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[32m-                 "memory": "200M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "128M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[32m-                 "memory": "200M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "128M",[39m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[33m@@ -211,7 +224,12 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "START_ARGS=\\"\\"[39m
[31m+               "#!/bin/bash[39m
[31m+ set -euo pipefail[39m
[31m+[39m
[31m+ START_ARGS=\\"\\"[39m
[31m+[39m
[31m+[39m
[2m  $CHAIN_BIN start $START_ARGS",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -274,11 +292,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -307,6 +325,7 @@[39m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m

[2m  echo \\"Running setup config script...\\"[22m
[31m+[39m
[2m  bash -e /scripts/update-config.sh",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -348,7 +367,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "TIME_IOTA_MS",[22m
[33m@@ -388,11 +407,11 @@[39m
[2m              "name": "init-config",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -415,20 +434,18 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "# Install faucet binary from the image[39m
[32m- cp /bin/faucet /faucet/faucet[39m
[32m- chmod +x /faucet/faucet",[39m
[31m+               "cp /bin/faucet /faucet/faucet && chmod +x /faucet/faucet",[39m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/faucet:20250325-2207109",[22m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "init-faucet",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -553,11 +570,11 @@[39m
[2m              "name": "init-genesis",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m

--- ConfigMap/setup-scripts-osmosis-1 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -608,6 +608,17 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts-osmosis-1",[39m
[31m+       "app.kubernetes.io/part-of": "osmosis-1",[39m
[31m+       "app.kubernetes.io/role": "setup-scripts",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-id": "osmosis-1",[39m
[31m+       "starship.io/chain-name": "osmosis",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts-osmosis-1",[22m
[2m    },[22m
[2m  }[22m

--- Service/osmosis-1-validator ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -23,6 +23,12 @@[39m
[2m          "targetPort": 8081,[22m
[2m        },[22m
[2m        Object {[22m
[31m+         "name": "faucet",[39m
[31m+         "port": 8000,[39m
[31m+         "protocol": "TCP",[39m
[31m+         "targetPort": 8000,[39m
[31m+       },[39m
[31m+       Object {[39m
[2m          "name": "grpc",[22m
[2m          "port": 9090,[22m
[2m          "protocol": "TCP",[22m

--- StatefulSet/osmosis-1-validator ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,18 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/id": "osmosis-1",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "osmosis-1-validator",[39m
[31m+       "app.kubernetes.io/part-of": "osmosis-1",[39m
[31m+       "app.kubernetes.io/role": "validator",[39m
[31m+       "app.kubernetes.io/type": "osmosis-1-statefulset",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-name": "osmosis",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "osmosis-1-validator",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -10,7 +22,7 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "osmosis",[39m
[31m+         "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m          "app.kubernetes.io/name": "osmosis-1-validator",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -24,10 +36,11 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "osmosis",[39m
[31m+           "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m            "app.kubernetes.io/name": "osmosis-1-validator",[22m
[31m+           "app.kubernetes.io/role": "validator",[39m
[2m            "app.kubernetes.io/type": "osmosis-1",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[33m@@ -119,11 +132,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -145,7 +158,9 @@[39m
[2m                "set -eux[22m
[2m  START_ARGS=\\"\\"[22m

[31m+[39m
[2m  # Starting the chain[22m
[31m+[39m
[2m  $CHAIN_BIN start $START_ARGS",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -255,11 +270,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -286,6 +301,7 @@[39m
[2m                "-c",[22m
[2m                "VAL_INDEX=\${HOSTNAME##*-}[22m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m
[31m+[39m

[2m  echo \\"Running setup config script...\\"[22m
[2m  bash -e /scripts/update-config.sh[22m
[33m@@ -351,7 +367,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "NAMESPACE",[22m
[33m@@ -399,11 +415,11 @@[39m
[2m              "name": "init-config",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -428,6 +444,7 @@[39m
[2m                "-c",[22m
[2m                "VAL_INDEX=\${HOSTNAME##*-}[22m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m
[31m+[39m

[2m  if [ -f $CHAIN_DIR/config/genesis.json ]; then[22m
[2m    echo \\"Genesis file exists, exiting early\\"[22m
[33m@@ -500,7 +517,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "NAMESPACE",[22m
[33m@@ -548,11 +565,11 @@[39m
[2m              "name": "init-validator",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -597,16 +614,16 @@[39m
[2m                  },[22m
[2m                },[22m
[2m              ],[22m
[32m-             "image": "curlimages/curl",[39m
[31m+             "image": "curlimages/curl:latest",[39m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "wait-for-chains",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -618,6 +635,10 @@[39m
[2m                "name": "keys",[22m
[2m              },[22m
[2m              "name": "addresses",[22m
[31m+           },[39m
[31m+           Object {[39m
[31m+             "emptyDir": Object {},[39m
[31m+             "name": "faucet",[39m
[2m            },[22m
[2m            Object {[22m
[2m              "emptyDir": Object {},[22m

--- ConfigMap/registry-cosmoshub-4 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -7,7 +7,14 @@[39m
[2m    \\"assets\\": [[22m
[2m      {[22m
[2m        \\"base\\": \\"uatom\\",[22m
[32m-       \\"coingecko_id\\": \\"atom\\",[39m
[31m+       \\"description\\": \\"The native staking and governance token of the Cosmos Hub.\\",[39m
[31m+       \\"name\\": \\"Cosmos Hub Atom\\",[39m
[31m+       \\"display\\": \\"atom\\",[39m
[31m+       \\"symbol\\": \\"ATOM\\",[39m
[31m+       \\"logo_URIs\\": {[39m
[31m+         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/cosmoshub/images/atom.png\\",[39m
[31m+         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/cosmoshub/images/atom.svg\\"[39m
[31m+       },[39m
[2m        \\"denom_units\\": [[22m
[2m          {[22m
[2m            \\"denom\\": \\"uatom\\",[22m
[33m@@ -18,14 +25,7 @@[39m
[2m            \\"exponent\\": 6[22m
[2m          }[22m
[2m        ],[22m
[32m-       \\"description\\": \\"The native staking and governance token of the Cosmos Hub.\\",[39m
[32m-       \\"display\\": \\"atom\\",[39m
[32m-       \\"logo_URIs\\": {[39m
[32m-         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/cosmoshub/images/atom.png\\",[39m
[32m-         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/cosmoshub/images/atom.svg\\"[39m
[32m-       },[39m
[32m-       \\"name\\": \\"Cosmos Hub Atom\\",[39m
[32m-       \\"symbol\\": \\"ATOM\\"[39m
[31m+       \\"coingecko_id\\": \\"atom\\"[39m
[2m      }[22m
[2m    ][22m
[2m  }",[22m
[33m@@ -82,6 +82,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "registry",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "registry-cosmoshub-4",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "registry-cosmoshub-4",[22m
[2m    },[22m
[2m  }[22m

--- Deployment/registry ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,14 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "Deployment",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "registry",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "registry",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "registry",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +17,6 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "registry",[39m
[2m          "app.kubernetes.io/name": "registry",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -22,19 +29,17 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "registry",[39m
[31m+           "app.kubernetes.io/component": "registry",[39m
[31m+           "app.kubernetes.io/managed-by": "starship",[39m
[2m            "app.kubernetes.io/name": "registry",[22m
[32m-           "app.kubernetes.io/rawname": "registry",[39m
[32m-           "app.kubernetes.io/type": "registry",[39m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/part-of": "starship",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+           "starship.io/name": "starship-e2e-tests",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[2m          "containers": Array [[22m
[2m            Object {[22m
[32m-             "command": Array [[39m
[32m-               "registry",[39m
[32m-             ],[39m
[2m              "env": Array [[22m
[2m                Object {[22m
[2m                  "name": "NAMESPACE",[22m
[33m@@ -74,21 +79,20 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "REGISTRY_CHAIN_REGISTRY",[22m
[32m-                 "value": "/configs",[39m
[31m+                 "value": "/chains",[39m
[2m                },[22m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/registry:20250205-544757d",[22m
[32m-             "imagePullPolicy": "IfNotPresent",[39m
[2m              "livenessProbe": Object {[22m
[32m-               "initialDelaySeconds": 20,[39m
[32m-               "periodSeconds": 10,[39m
[31m+               "initialDelaySeconds": 15,[39m
[31m+               "periodSeconds": 20,[39m
[2m                "tcpSocket": Object {[22m
[2m                  "port": 8080,[22m
[2m                },[22m
[2m              },[22m
[2m              "name": "registry",[22m
[2m              "readinessProbe": Object {[22m
[32m-               "initialDelaySeconds": 20,[39m
[31m+               "initialDelaySeconds": 5,[39m
[2m                "periodSeconds": 10,[22m
[2m                "tcpSocket": Object {[22m
[2m                  "port": 8080,[22m
[33m@@ -96,22 +100,22 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[2m                Object {[22m
[32m-                 "mountPath": "/configs/cosmoshub-4",[39m
[32m-                 "name": "registry-configs-cosmoshub-4",[39m
[31m+                 "mountPath": "/chains/cosmoshub-4",[39m
[31m+                 "name": "registry-cosmoshub-4",[39m
[2m                },[22m
[2m                Object {[22m
[32m-                 "mountPath": "/configs/osmosis-1",[39m
[32m-                 "name": "registry-configs-osmosis-1",[39m
[31m+                 "mountPath": "/chains/osmosis-1",[39m
[31m+                 "name": "registry-osmosis-1",[39m
[2m                },[22m
[2m              ],[22m
[2m            },[22m
[33m@@ -126,6 +130,7 @@[39m
[2m    echo \\"Checking: http://osmosis-1-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id\\"[22m
[2m    sleep 10;[22m
[2m  done[22m
[31m+[39m
[2m  while [ $(curl -sw '%{http_code}' http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id -o /dev/null) -ne 200 ]; do[22m
[2m    echo \\"Genesis validator does not seem to be ready for: cosmoshub-4. Waiting for it to start...\\"[22m
[2m    echo \\"Checking: http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id\\"[22m
[33m@@ -148,16 +153,16 @@[39m
[2m                  },[22m
[2m                },[22m
[2m              ],[22m
[32m-             "image": "curlimages/curl",[39m
[31m+             "image": "curlimages/curl:latest",[39m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "wait-for-chains",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -168,13 +173,13 @@[39m
[2m              "configMap": Object {[22m
[2m                "name": "registry-cosmoshub-4",[22m
[2m              },[22m
[32m-             "name": "registry-configs-cosmoshub-4",[39m
[31m+             "name": "registry-cosmoshub-4",[39m
[2m            },[22m
[2m            Object {[22m
[2m              "configMap": Object {[22m
[2m                "name": "registry-osmosis-1",[22m
[2m              },[22m
[32m-             "name": "registry-configs-osmosis-1",[39m
[31m+             "name": "registry-osmosis-1",[39m
[2m            },[22m
[2m          ],[22m
[2m        },[22m

--- ConfigMap/registry-osmosis-1 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -7,7 +7,14 @@[39m
[2m    \\"assets\\": [[22m
[2m      {[22m
[2m        \\"base\\": \\"uosmo\\",[22m
[32m-       \\"coingecko_id\\": \\"osmosis\\",[39m
[31m+       \\"description\\": \\"The native token of Osmosis\\",[39m
[31m+       \\"name\\": \\"Osmosis\\",[39m
[31m+       \\"display\\": \\"osmo\\",[39m
[31m+       \\"symbol\\": \\"OSMO\\",[39m
[31m+       \\"logo_URIs\\": {[39m
[31m+         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/osmo.png\\",[39m
[31m+         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/osmo.svg\\"[39m
[31m+       },[39m
[2m        \\"denom_units\\": [[22m
[2m          {[22m
[2m            \\"denom\\": \\"uosmo\\",[22m
[33m@@ -18,22 +25,21 @@[39m
[2m            \\"exponent\\": 6[22m
[2m          }[22m
[2m        ],[22m
[32m-       \\"description\\": \\"The native token of Osmosis\\",[39m
[32m-       \\"display\\": \\"osmo\\",[39m
[31m+       \\"coingecko_id\\": \\"osmosis\\",[39m
[2m        \\"keywords\\": [[22m
[2m          \\"staking\\",[22m
[2m          \\"dex\\"[22m
[32m-       ],[39m
[32m-       \\"logo_URIs\\": {[39m
[32m-         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/osmo.png\\",[39m
[32m-         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/osmo.svg\\"[39m
[32m-       },[39m
[32m-       \\"name\\": \\"Osmosis\\",[39m
[32m-       \\"symbol\\": \\"OSMO\\"[39m
[31m+       ][39m
[2m      },[22m
[2m      {[22m
[2m        \\"base\\": \\"uion\\",[22m
[32m-       \\"coingecko_id\\": \\"ion\\",[39m
[31m+       \\"name\\": \\"Ion\\",[39m
[31m+       \\"display\\": \\"ion\\",[39m
[31m+       \\"symbol\\": \\"ION\\",[39m
[31m+       \\"logo_URIs\\": {[39m
[31m+         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/ion.png\\",[39m
[31m+         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/ion.svg\\"[39m
[31m+       },[39m
[2m        \\"denom_units\\": [[22m
[2m          {[22m
[2m            \\"denom\\": \\"uion\\",[22m
[33m@@ -44,16 +50,10 @@[39m
[2m            \\"exponent\\": 6[22m
[2m          }[22m
[2m        ],[22m
[32m-       \\"display\\": \\"ion\\",[39m
[31m+       \\"coingecko_id\\": \\"ion\\",[39m
[2m        \\"keywords\\": [[22m
[2m          \\"memecoin\\"[22m
[32m-       ],[39m
[32m-       \\"logo_URIs\\": {[39m
[32m-         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/ion.png\\",[39m
[32m-         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/ion.svg\\"[39m
[32m-       },[39m
[32m-       \\"name\\": \\"Ion\\",[39m
[32m-       \\"symbol\\": \\"ION\\"[39m
[31m+       ][39m
[2m      }[22m
[2m    ][22m
[2m  }",[22m
[33m@@ -110,6 +110,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "registry",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "registry-osmosis-1",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "registry-osmosis-1",[22m
[2m    },[22m
[2m  }[22m

--- ConfigMap/hermes-osmos-cosmos ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -3,92 +3,45 @@[39m
[2m    "data": Object {[22m
[2m      "config-cli.toml": "# The global section has parameters that apply globally to the relayer operation.[22m
[2m  [global][22m
[32m- # Specify the verbosity for the relayer logging output. Default: 'info'[39m
[32m- # Valid options are 'error', 'warn', 'info', 'debug', 'trace'.[39m
[32m- log_level = 'error'[39m
[32m- # Specify the mode to be used by the relayer. [Required][39m
[31m+ log_level = \\"error\\"[39m
[31m+[39m
[2m  [mode][22m
[32m- # Specify the client mode.[39m
[2m  [mode.clients][22m
[32m- # Whether or not to enable the client workers. [Required][39m
[2m  enabled = true[22m
[32m- # Whether or not to enable periodic refresh of clients. [Default: true][39m
[32m- # This feature only applies to clients that underlie an open channel.[39m
[32m- # For Tendermint clients, the frequency at which Hermes refreshes them is 2/3 of their[39m
[32m- # trusting period (e.g., refresh every ~9 days if the trusting period is 14 days).[39m
[32m- # Note: Even if this is disabled, clients will be refreshed automatically if[39m
[32m- #      there is activity on a connection or channel they are involved with.[39m
[2m  refresh = true[22m
[32m- # Whether or not to enable misbehaviour detection for clients. [Default: false][39m
[2m  misbehaviour = true[22m
[32m- # Specify the connections mode.[39m
[31m+[39m
[2m  [mode.connections][22m
[32m- # Whether or not to enable the connection workers for handshake completion. [Required][39m
[2m  enabled = true[22m
[32m- # Specify the channels mode.[39m
[31m+[39m
[2m  [mode.channels][22m
[32m- # Whether or not to enable the channel workers for handshake completion. [Required][39m
[2m  enabled = true[22m
[32m- # Specify the packets mode.[39m
[31m+[39m
[2m  [mode.packets][22m
[32m- # Whether or not to enable the packet workers. [Required][39m
[2m  enabled = true[22m
[32m- # Parametrize the periodic packet clearing feature.[39m
[32m- # Interval (in number of blocks) at which pending packets[39m
[32m- # should be periodically cleared. A value of '0' will disable[39m
[32m- # periodic packet clearing. [Default: 100][39m
[2m  clear_interval = 100[22m
[32m- # Whether or not to clear packets on start. [Default: false][39m
[2m  clear_on_start = true[22m
[32m- # Toggle the transaction confirmation mechanism.[39m
[32m- # The tx confirmation mechanism periodically queries the \`/tx_search\` RPC[39m
[32m- # endpoint to check that previously-submitted transactions[39m
[32m- # (to any chain in this config file) have been successfully delivered.[39m
[32m- # If they have not been, and \`clear_interval = 0\`, then those packets are[39m
[32m- # queued up for re-submission.[39m
[32m- # Experimental feature. Affects telemetry if set to false.[39m
[32m- # [Default: true][39m
[2m  tx_confirmation = true[22m
[32m- # Auto register the counterparty payee on a destination chain to[39m
[32m- # the relayer's address on the source chain. This can be used[39m
[32m- # for simple configuration of the relayer to receive fees for[39m
[32m- # relaying RecvPacket on fee-enabled channels.[39m
[32m- # For more complex configuration, turn this off and use the CLI[39m
[32m- # to manually register the payee addresses.[39m
[32m- # [Default: false][39m
[32m- auto_register_counterparty_payee = false[39m
[32m- # The REST section defines parameters for Hermes' built-in RESTful API.[39m
[32m- # https://hermes.informal.systems/rest.html[39m
[31m+[39m
[2m  [rest][22m
[32m- # Whether or not to enable the REST service. Default: false[39m
[2m  enabled = true[22m
[32m- # Specify the IPv4/6 host over which the built-in HTTP server will serve the RESTful[39m
[32m- # API requests. Default: 127.0.0.1[39m
[32m- host =  '0.0.0.0'[39m
[32m- # Specify the port over which the built-in HTTP server will serve the restful API[39m
[32m- # requests. Default: 3000[39m
[31m+ host = \\"0.0.0.0\\"[39m
[2m  port = 3000[22m
[32m- # The telemetry section defines parameters for Hermes' built-in telemetry capabilities.[39m
[32m- # https://hermes.informal.systems/telemetry.html[39m
[31m+[39m
[2m  [telemetry][22m
[32m- # Whether or not to enable the telemetry service. Default: false[39m
[2m  enabled = false[22m
[32m- # Specify the IPv4/6 host over which the built-in HTTP server will serve the metrics[39m
[32m- # gathered by the telemetry service. Default: 127.0.0.1[39m
[32m- host = '0.0.0.0'[39m
[32m- # Specify the port over which the built-in HTTP server will serve the metrics gathered[39m
[32m- # by the telemetry service. Default: 3001[39m
[31m+ host = \\"0.0.0.0\\"[39m
[2m  port = 3001[22m


[32m-[39m
[2m  [[chains]][22m
[2m  id = \\"osmosis-1\\"[22m
[31m+ type = \\"CosmosSdk\\"[39m
[2m  key_name = \\"osmosis-1-cli\\"[22m
[32m- rpc_addr = \\"http://osmosis-1-genesis.default.svc.cluster.local:26657\\"[39m
[32m- grpc_addr = \\"http://osmosis-1-genesis.default.svc.cluster.local:9090\\"[39m
[31m+[39m
[31m+ rpc_addr = \\"http://osmosis-1-genesis.$NAMESPACE.svc.cluster.local:26657\\"[39m
[31m+ grpc_addr = \\"http://osmosis-1-genesis.$NAMESPACE.svc.cluster.local:9090\\"[39m
[2m  event_source = { mode = 'pull', interval = '500ms' }[22m
[32m- # Experimental: Whether or not the full node is trusted.[39m
[2m  trusted_node = false[22m
[2m  account_prefix = \\"osmo\\"[22m
[2m  default_gas = 500000000[22m
[33m@@ -103,17 +56,16 @@[39m
[2m  trusting_period = \\"75s\\"[22m
[2m  trust_threshold = { numerator = \\"2\\", denominator = \\"3\\" }[22m
[2m  address_type = { derivation = 'cosmos' }[22m
[32m- gas_price = { price = 0.25, denom = \\"uosmo\\" }[39m
[32m-[39m
[31m+ gas_price = { price = 1.25, denom = \\"uosmo\\" }[39m

[32m-[39m
[2m  [[chains]][22m
[2m  id = \\"cosmoshub-4\\"[22m
[31m+ type = \\"CosmosSdk\\"[39m
[2m  key_name = \\"cosmoshub-4-cli\\"[22m
[32m- rpc_addr = \\"http://cosmoshub-4-genesis.default.svc.cluster.local:26657\\"[39m
[32m- grpc_addr = \\"http://cosmoshub-4-genesis.default.svc.cluster.local:9090\\"[39m
[31m+[39m
[31m+ rpc_addr = \\"http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:26657\\"[39m
[31m+ grpc_addr = \\"http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:9090\\"[39m
[2m  event_source = { mode = 'pull', interval = '500ms' }[22m
[32m- # Experimental: Whether or not the full node is trusted.[39m
[2m  trusted_node = false[22m
[2m  account_prefix = \\"cosmos\\"[22m
[2m  default_gas = 500000000[22m
[33m@@ -128,96 +80,48 @@[39m
[2m  trusting_period = \\"75s\\"[22m
[2m  trust_threshold = { numerator = \\"2\\", denominator = \\"3\\" }[22m
[2m  address_type = { derivation = 'cosmos' }[22m
[32m- gas_price = { price = 0.25, denom = \\"uatom\\" }",[39m
[31m+ gas_price = { price = 1.25, denom = \\"uatom\\" }",[39m
[2m      "config.toml": "# The global section has parameters that apply globally to the relayer operation.[22m
[2m  [global][22m
[32m- # Specify the verbosity for the relayer logging output. Default: 'info'[39m
[32m- # Valid options are 'error', 'warn', 'info', 'debug', 'trace'.[39m
[32m- log_level = 'error'[39m
[32m- # Specify the mode to be used by the relayer. [Required][39m
[31m+ log_level = \\"error\\"[39m
[31m+[39m
[2m  [mode][22m
[32m- # Specify the client mode.[39m
[2m  [mode.clients][22m
[32m- # Whether or not to enable the client workers. [Required][39m
[2m  enabled = true[22m
[32m- # Whether or not to enable periodic refresh of clients. [Default: true][39m
[32m- # This feature only applies to clients that underlie an open channel.[39m
[32m- # For Tendermint clients, the frequency at which Hermes refreshes them is 2/3 of their[39m
[32m- # trusting period (e.g., refresh every ~9 days if the trusting period is 14 days).[39m
[32m- # Note: Even if this is disabled, clients will be refreshed automatically if[39m
[32m- #      there is activity on a connection or channel they are involved with.[39m
[2m  refresh = true[22m
[32m- # Whether or not to enable misbehaviour detection for clients. [Default: false][39m
[2m  misbehaviour = true[22m
[32m- # Specify the connections mode.[39m
[31m+[39m
[2m  [mode.connections][22m
[32m- # Whether or not to enable the connection workers for handshake completion. [Required][39m
[2m  enabled = true[22m
[32m- # Specify the channels mode.[39m
[31m+[39m
[2m  [mode.channels][22m
[32m- # Whether or not to enable the channel workers for handshake completion. [Required][39m
[2m  enabled = true[22m
[32m- # Specify the packets mode.[39m
[31m+[39m
[2m  [mode.packets][22m
[32m- # Whether or not to enable the packet workers. [Required][39m
[2m  enabled = true[22m
[32m- # Parametrize the periodic packet clearing feature.[39m
[32m- # Interval (in number of blocks) at which pending packets[39m
[32m- # should be periodically cleared. A value of '0' will disable[39m
[32m- # periodic packet clearing. [Default: 100][39m
[2m  clear_interval = 100[22m
[32m- # Whether or not to clear packets on start. [Default: false][39m
[2m  clear_on_start = true[22m
[32m- # Toggle the transaction confirmation mechanism.[39m
[32m- # The tx confirmation mechanism periodically queries the \`/tx_search\` RPC[39m
[32m- # endpoint to check that previously-submitted transactions[39m
[32m- # (to any chain in this config file) have been successfully delivered.[39m
[32m- # If they have not been, and \`clear_interval = 0\`, then those packets are[39m
[32m- # queued up for re-submission.[39m
[32m- # Experimental feature. Affects telemetry if set to false.[39m
[32m- # [Default: true][39m
[2m  tx_confirmation = true[22m
[32m- # Auto register the counterparty payee on a destination chain to[39m
[32m- # the relayer's address on the source chain. This can be used[39m
[32m- # for simple configuration of the relayer to receive fees for[39m
[32m- # relaying RecvPacket on fee-enabled channels.[39m
[32m- # For more complex configuration, turn this off and use the CLI[39m
[32m- # to manually register the payee addresses.[39m
[32m- # [Default: false][39m
[32m- auto_register_counterparty_payee = false[39m
[32m- # The REST section defines parameters for Hermes' built-in RESTful API.[39m
[32m- # https://hermes.informal.systems/rest.html[39m
[31m+[39m
[2m  [rest][22m
[32m- # Whether or not to enable the REST service. Default: false[39m
[2m  enabled = true[22m
[32m- # Specify the IPv4/6 host over which the built-in HTTP server will serve the RESTful[39m
[32m- # API requests. Default: 127.0.0.1[39m
[32m- host =  '0.0.0.0'[39m
[32m- # Specify the port over which the built-in HTTP server will serve the restful API[39m
[32m- # requests. Default: 3000[39m
[31m+ host = \\"0.0.0.0\\"[39m
[2m  port = 3000[22m
[32m- # The telemetry section defines parameters for Hermes' built-in telemetry capabilities.[39m
[32m- # https://hermes.informal.systems/telemetry.html[39m
[31m+[39m
[2m  [telemetry][22m
[32m- # Whether or not to enable the telemetry service. Default: false[39m
[2m  enabled = false[22m
[32m- # Specify the IPv4/6 host over which the built-in HTTP server will serve the metrics[39m
[32m- # gathered by the telemetry service. Default: 127.0.0.1[39m
[32m- host = '0.0.0.0'[39m
[32m- # Specify the port over which the built-in HTTP server will serve the metrics gathered[39m
[32m- # by the telemetry service. Default: 3001[39m
[31m+ host = \\"0.0.0.0\\"[39m
[2m  port = 3001[22m
[32m-[39m


[2m  [[chains]][22m
[2m  id = \\"osmosis-1\\"[22m
[2m  type = \\"CosmosSdk\\"[22m
[2m  key_name = \\"osmosis-1\\"[22m
[32m- rpc_addr = \\"http://osmosis-1-genesis.default.svc.cluster.local:26657\\"[39m
[32m- grpc_addr = \\"http://osmosis-1-genesis.default.svc.cluster.local:9090\\"[39m
[31m+[39m
[31m+ rpc_addr = \\"http://osmosis-1-genesis.$NAMESPACE.svc.cluster.local:26657\\"[39m
[31m+ grpc_addr = \\"http://osmosis-1-genesis.$NAMESPACE.svc.cluster.local:9090\\"[39m
[2m  event_source = { mode = 'pull', interval = '500ms' }[22m
[32m- # Experimental: Whether or not the full node is trusted.[39m
[2m  trusted_node = false[22m
[2m  account_prefix = \\"osmo\\"[22m
[2m  default_gas = 500000000[22m
[33m@@ -233,17 +137,15 @@[39m
[2m  trust_threshold = { numerator = \\"2\\", denominator = \\"3\\" }[22m
[2m  address_type = { derivation = 'cosmos' }[22m
[2m  gas_price = { price = 1.25, denom = \\"uosmo\\" }[22m
[32m-[39m
[32m-[39m

[2m  [[chains]][22m
[2m  id = \\"cosmoshub-4\\"[22m
[2m  type = \\"CosmosSdk\\"[22m
[2m  key_name = \\"cosmoshub-4\\"[22m
[32m- rpc_addr = \\"http://cosmoshub-4-genesis.default.svc.cluster.local:26657\\"[39m
[32m- grpc_addr = \\"http://cosmoshub-4-genesis.default.svc.cluster.local:9090\\"[39m
[31m+[39m
[31m+ rpc_addr = \\"http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:26657\\"[39m
[31m+ grpc_addr = \\"http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:9090\\"[39m
[2m  event_source = { mode = 'pull', interval = '500ms' }[22m
[32m- # Experimental: Whether or not the full node is trusted.[39m
[2m  trusted_node = false[22m
[2m  account_prefix = \\"cosmos\\"[22m
[2m  default_gas = 500000000[22m
[33m@@ -262,6 +164,15 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "relayer",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "hermes-osmos-cosmos",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/role": "hermes",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "hermes-osmos-cosmos",[22m
[2m    },[22m
[2m  }[22m

--- StatefulSet/hermes-osmos-cosmos ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,15 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "relayer",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "hermes-osmos-cosmos",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/role": "hermes",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "hermes-osmos-cosmos",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -29,16 +38,18 @@[39m
[2m            "app.kubernetes.io/name": "hermes-osmos-cosmos",[22m
[2m            "app.kubernetes.io/rawname": "osmos-cosmos",[22m
[2m            "app.kubernetes.io/type": "hermes",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[2m          "containers": Array [[22m
[2m            Object {[22m
[31m+             "args": Array [[39m
[31m+               "/exposer/exposer",[39m
[31m+             ],[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "/exposer/exposer",[39m
[2m              ],[22m
[2m              "env": Array [[22m
[2m                Object {[22m
[33m@@ -55,11 +66,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -83,14 +94,24 @@[39m
[2m              ],[22m
[2m            },[22m
[2m            Object {[22m
[31m+             "args": Array [[39m
[31m+               "RLY_INDEX=\${HOSTNAME##*-}[39m
[31m+ echo \\"Relayer Index: $RLY_INDEX\\"[39m
[31m+ hermes start",[39m
[31m+             ],[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "RLY_INDEX=\${HOSTNAME##*-}[39m
[32m- echo \\"Relayer Index: $RLY_INDEX\\"[39m
[32m- hermes start",[39m
[2m              ],[22m
[2m              "env": Array [[22m
[31m+               Object {[39m
[31m+                 "name": "NAMESPACE",[39m
[31m+                 "valueFrom": Object {[39m
[31m+                   "fieldRef": Object {[39m
[31m+                     "fieldPath": "metadata.namespace",[39m
[31m+                   },[39m
[31m+                 },[39m
[31m+               },[39m
[2m                Object {[22m
[2m                  "name": "RELAYER_DIR",[22m
[2m                  "value": "/root/.hermes",[22m
[33m@@ -101,12 +122,12 @@[39m
[2m              "name": "relayer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[2m              },[22m
[2m              "securityContext": Object {[22m
[33m@@ -127,24 +148,26 @@[39m
[2m          ],[22m
[2m          "initContainers": Array [[22m
[2m            Object {[22m
[31m+             "args": Array [[39m
[31m+               "# Install exposer binary from the image[39m
[31m+ cp /bin/exposer /exposer/exposer[39m
[31m+ chmod +x /exposer/exposer",[39m
[31m+             ],[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "# Install exposer binary from the image[39m
[32m- cp /bin/exposer /exposer/exposer[39m
[32m- chmod +x /exposer/exposer",[39m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/exposer:20250205-544757d",[22m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "init-exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "100M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "100M",[39m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[33m@@ -155,9 +178,7 @@[39m
[2m              ],[22m
[2m            },[22m
[2m            Object {[22m
[32m-             "command": Array [[39m
[32m-               "bash",[39m
[32m-               "-c",[39m
[31m+             "args": Array [[39m
[2m                "set -ux[22m

[2m  RLY_INDEX=\${HOSTNAME##*-}[22m
[33m@@ -166,18 +187,16 @@[39m
[2m  mkdir -p $RELAYER_DIR[22m
[2m  cp /configs/config.toml $RELAYER_DIR/config.toml[22m
[2m  cp /configs/config-cli.toml $RELAYER_DIR/config-cli.toml[22m
[32m- cat $RELAYER_DIR/config.toml[39m
[31m+[39m
[31m+ # Replace namespace placeholder with actual namespace environment variable[39m
[31m+ sed -i \\"s|\\\\$NAMESPACE|$NAMESPACE|g\\" $RELAYER_DIR/config.toml[39m
[31m+ sed -i \\"s|\\\\$NAMESPACE|$NAMESPACE|g\\" $RELAYER_DIR/config-cli.toml[39m

[32m- MNEMONIC=$(jq -r \\".relayers[$RELAYER_INDEX].mnemonic\\" $KEYS_CONFIG)[39m
[31m+ MNEMONIC=$(jq -r \\".relayers[$RLY_INDEX].mnemonic\\" $KEYS_CONFIG)[39m
[2m  echo $MNEMONIC > $RELAYER_DIR/mnemonic.txt[22m
[32m- MNEMONIC_CLI=$(jq -r \\".relayers_cli[$RELAYER_INDEX].mnemonic\\" $KEYS_CONFIG)[39m
[31m+ MNEMONIC_CLI=$(jq -r \\".relayers_cli[$RLY_INDEX].mnemonic\\" $KEYS_CONFIG)[39m
[2m  echo $MNEMONIC_CLI > $RELAYER_DIR/mnemonic-cli.txt[22m

[32m- echo \\"Debug output for osmos-cosmos...\\"[39m
[32m- cat << EOF[39m
[32m-               map[string]interface {}[39m
[32m-               {\\"chains\\":[\\"osmosis-1\\",\\"cosmoshub-4\\"],\\"channels\\":[{\\"a-chain\\":\\"osmosis-1\\",\\"a-port\\":\\"transfer\\",\\"b-chain\\":\\"cosmoshub-4\\",\\"b-port\\":\\"transfer\\",\\"new-connection\\":true}],\\"config\\":{\\"event_source\\":{\\"mode\\":\\"pull\\"},\\"global\\":{\\"log_level\\":\\"error\\"},\\"mode\\":{\\"channels\\":{\\"enabled\\":true},\\"clients\\":{\\"enabled\\":true,\\"misbehaviour\\":true,\\"refresh\\":true},\\"connections\\":{\\"enabled\\":true},\\"packets\\":{\\"clear_interval\\":100,\\"clear_on_start\\":true,\\"enabled\\":true,\\"tx_confirmation\\":true}},\\"rest\\":{\\"enabled\\":true,\\"host\\":\\"0.0.0.0\\",\\"port\\":3000},\\"telemetry\\":{\\"enabled\\":false,\\"host\\":\\"0.0.0.0\\",\\"port\\":3001}},\\"fullname\\":\\"hermes-osmos-cosmos\\",\\"ics\\":{\\"enabled\\":false},\\"image\\":\\"ghcr.io/cosmology-tech/starship/hermes:1.10.0\\",\\"name\\":\\"osmos-cosmos\\",\\"ports\\":{\\"exposer\\":3002,\\"rest\\":3000},\\"replicas\\":1,\\"type\\":\\"hermes\\"}[39m
[32m- EOF[39m

[2m  echo \\"Creating key for osmosis-1...\\"[22m
[2m  hermes keys add \\\\[22m
[33m@@ -240,12 +259,17 @@[39m
[2m    $DENOM \\\\[22m
[2m    http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:8000/credit \\\\[22m
[2m    \\"true\\" || true[22m
[31m+[39m
[2m  hermes create channel \\\\[22m
[2m    --new-client-connection --yes \\\\[22m
[2m    --b-chain cosmoshub-4 \\\\[22m
[2m    --a-chain osmosis-1 \\\\[22m
[2m    --a-port transfer \\\\[22m
[2m    --b-port transfer",[22m
[31m+             ],[39m
[31m+             "command": Array [[39m
[31m+               "bash",[39m
[31m+               "-c",[39m
[2m              ],[22m
[2m              "env": Array [[22m
[2m                Object {[22m
[33m@@ -266,7 +290,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "RELAYER_INDEX",[22m
[32m-                 "value": "0",[39m
[31m+                 "value": "\${HOSTNAME##*-}",[39m
[2m                },[22m
[2m              ],[22m
[2m              "image": "ghcr.io/cosmology-tech/starship/hermes:1.10.0",[22m
[33m@@ -274,12 +298,12 @@[39m
[2m              "name": "init-relayer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[33m@@ -310,6 +334,7 @@[39m
[2m    echo \\"Checking: http://osmosis-1-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id\\"[22m
[2m    sleep 10;[22m
[2m  done[22m
[31m+[39m
[2m  while [ $(curl -sw '%{http_code}' http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id -o /dev/null) -ne 200 ]; do[22m
[2m    echo \\"Genesis validator does not seem to be ready for: cosmoshub-4. Waiting for it to start...\\"[22m
[2m    echo \\"Checking: http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id\\"[22m
[33m@@ -332,16 +357,16 @@[39m
[2m                  },[22m
[2m                },[22m
[2m              ],[22m
[32m-             "image": "curlimages/curl",[39m
[31m+             "image": "curlimages/curl:latest",[39m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "wait-for-chains",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m"
`;

exports[`Manifest Comparison Tests Individual Config Comparisons should generate manifests for two-chain-gorelayer that match the snapshot 1`] = `
"ðŸ”„ MODIFIED_RESOURCES:

--- ConfigMap/keys ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -98,6 +98,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "configmap",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "keys",[39m
[31m+       "app.kubernetes.io/part-of": "global",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "keys",[22m
[2m    },[22m
[2m  }[22m

--- ConfigMap/setup-scripts ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -208,6 +208,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "configmap",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts",[39m
[31m+       "app.kubernetes.io/part-of": "global",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts",[22m
[2m    },[22m
[2m  }[22m

--- StatefulSet/cosmoshub-4-genesis ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,18 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/id": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "cosmoshub-4-genesis",[39m
[31m+       "app.kubernetes.io/part-of": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/role": "genesis",[39m
[31m+       "app.kubernetes.io/type": "cosmoshub-4-statefulset",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-name": "cosmoshub",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "cosmoshub-4-genesis",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +21,7 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "cosmoshub",[39m
[31m+         "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m          "app.kubernetes.io/name": "cosmoshub-4-genesis",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -23,11 +35,12 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "cosmoshub",[39m
[31m+           "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m            "app.kubernetes.io/name": "cosmoshub-4-genesis",[22m
[2m            "app.kubernetes.io/rawname": "cosmoshub-4",[22m
[31m+           "app.kubernetes.io/role": "genesis",[39m
[2m            "app.kubernetes.io/type": "cosmoshub-4",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[33m@@ -91,11 +104,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -184,12 +197,12 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[32m-                 "memory": "200M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "128M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[32m-                 "memory": "200M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "128M",[39m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[33m@@ -211,7 +224,12 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "START_ARGS=\\"\\"[39m
[31m+               "#!/bin/bash[39m
[31m+ set -euo pipefail[39m
[31m+[39m
[31m+ START_ARGS=\\"\\"[39m
[31m+[39m
[31m+[39m
[2m  $CHAIN_BIN start $START_ARGS",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -274,11 +292,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -307,6 +325,7 @@[39m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m

[2m  echo \\"Running setup config script...\\"[22m
[31m+[39m
[2m  bash -e /scripts/update-config.sh",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -348,7 +367,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "TIME_IOTA_MS",[22m
[33m@@ -388,11 +407,11 @@[39m
[2m              "name": "init-config",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -415,20 +434,18 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "# Install faucet binary from the image[39m
[32m- cp /bin/faucet /faucet/faucet[39m
[32m- chmod +x /faucet/faucet",[39m
[31m+               "cp /bin/faucet /faucet/faucet && chmod +x /faucet/faucet",[39m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/faucet:20250325-2207109",[22m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "init-faucet",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -553,11 +570,11 @@[39m
[2m              "name": "init-genesis",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m

--- ConfigMap/setup-scripts-cosmoshub-4 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -608,6 +608,17 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts-cosmoshub-4",[39m
[31m+       "app.kubernetes.io/part-of": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/role": "setup-scripts",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-id": "cosmoshub-4",[39m
[31m+       "starship.io/chain-name": "cosmoshub",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts-cosmoshub-4",[22m
[2m    },[22m
[2m  }[22m

--- Service/cosmoshub-4-validator ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -23,6 +23,12 @@[39m
[2m          "targetPort": 8081,[22m
[2m        },[22m
[2m        Object {[22m
[31m+         "name": "faucet",[39m
[31m+         "port": 8000,[39m
[31m+         "protocol": "TCP",[39m
[31m+         "targetPort": 8000,[39m
[31m+       },[39m
[31m+       Object {[39m
[2m          "name": "grpc",[22m
[2m          "port": 9090,[22m
[2m          "protocol": "TCP",[22m

--- StatefulSet/cosmoshub-4-validator ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,18 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/id": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "cosmoshub-4-validator",[39m
[31m+       "app.kubernetes.io/part-of": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/role": "validator",[39m
[31m+       "app.kubernetes.io/type": "cosmoshub-4-statefulset",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-name": "cosmoshub",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "cosmoshub-4-validator",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -10,7 +22,7 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "cosmoshub",[39m
[31m+         "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m          "app.kubernetes.io/name": "cosmoshub-4-validator",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -24,10 +36,11 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "cosmoshub",[39m
[31m+           "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m            "app.kubernetes.io/name": "cosmoshub-4-validator",[22m
[31m+           "app.kubernetes.io/role": "validator",[39m
[2m            "app.kubernetes.io/type": "cosmoshub-4",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[33m@@ -119,11 +132,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -145,7 +158,9 @@[39m
[2m                "set -eux[22m
[2m  START_ARGS=\\"\\"[22m

[31m+[39m
[2m  # Starting the chain[22m
[31m+[39m
[2m  $CHAIN_BIN start $START_ARGS",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -255,11 +270,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -286,6 +301,7 @@[39m
[2m                "-c",[22m
[2m                "VAL_INDEX=\${HOSTNAME##*-}[22m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m
[31m+[39m

[2m  echo \\"Running setup config script...\\"[22m
[2m  bash -e /scripts/update-config.sh[22m
[33m@@ -351,7 +367,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "NAMESPACE",[22m
[33m@@ -399,11 +415,11 @@[39m
[2m              "name": "init-config",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -428,6 +444,7 @@[39m
[2m                "-c",[22m
[2m                "VAL_INDEX=\${HOSTNAME##*-}[22m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m
[31m+[39m

[2m  if [ -f $CHAIN_DIR/config/genesis.json ]; then[22m
[2m    echo \\"Genesis file exists, exiting early\\"[22m
[33m@@ -500,7 +517,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "NAMESPACE",[22m
[33m@@ -548,11 +565,11 @@[39m
[2m              "name": "init-validator",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -597,16 +614,16 @@[39m
[2m                  },[22m
[2m                },[22m
[2m              ],[22m
[32m-             "image": "curlimages/curl",[39m
[31m+             "image": "curlimages/curl:latest",[39m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "wait-for-chains",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -618,6 +635,10 @@[39m
[2m                "name": "keys",[22m
[2m              },[22m
[2m              "name": "addresses",[22m
[31m+           },[39m
[31m+           Object {[39m
[31m+             "emptyDir": Object {},[39m
[31m+             "name": "faucet",[39m
[2m            },[22m
[2m            Object {[22m
[2m              "emptyDir": Object {},[22m

--- StatefulSet/osmosis-1-genesis ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,18 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/id": "osmosis-1",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "osmosis-1-genesis",[39m
[31m+       "app.kubernetes.io/part-of": "osmosis-1",[39m
[31m+       "app.kubernetes.io/role": "genesis",[39m
[31m+       "app.kubernetes.io/type": "osmosis-1-statefulset",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-name": "osmosis",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "osmosis-1-genesis",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +21,7 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "osmosis",[39m
[31m+         "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m          "app.kubernetes.io/name": "osmosis-1-genesis",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -23,11 +35,12 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "osmosis",[39m
[31m+           "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m            "app.kubernetes.io/name": "osmosis-1-genesis",[22m
[2m            "app.kubernetes.io/rawname": "osmosis-1",[22m
[31m+           "app.kubernetes.io/role": "genesis",[39m
[2m            "app.kubernetes.io/type": "osmosis-1",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[33m@@ -91,11 +104,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -184,12 +197,12 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[32m-                 "memory": "200M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "128M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[32m-                 "memory": "200M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "128M",[39m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[33m@@ -211,7 +224,12 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "START_ARGS=\\"\\"[39m
[31m+               "#!/bin/bash[39m
[31m+ set -euo pipefail[39m
[31m+[39m
[31m+ START_ARGS=\\"\\"[39m
[31m+[39m
[31m+[39m
[2m  $CHAIN_BIN start $START_ARGS",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -274,11 +292,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -307,6 +325,7 @@[39m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m

[2m  echo \\"Running setup config script...\\"[22m
[31m+[39m
[2m  bash -e /scripts/update-config.sh",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -348,7 +367,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "TIME_IOTA_MS",[22m
[33m@@ -388,11 +407,11 @@[39m
[2m              "name": "init-config",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -415,20 +434,18 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "# Install faucet binary from the image[39m
[32m- cp /bin/faucet /faucet/faucet[39m
[32m- chmod +x /faucet/faucet",[39m
[31m+               "cp /bin/faucet /faucet/faucet && chmod +x /faucet/faucet",[39m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/faucet:20250325-2207109",[22m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "init-faucet",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -553,11 +570,11 @@[39m
[2m              "name": "init-genesis",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m

--- ConfigMap/setup-scripts-osmosis-1 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -608,6 +608,17 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts-osmosis-1",[39m
[31m+       "app.kubernetes.io/part-of": "osmosis-1",[39m
[31m+       "app.kubernetes.io/role": "setup-scripts",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-id": "osmosis-1",[39m
[31m+       "starship.io/chain-name": "osmosis",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts-osmosis-1",[22m
[2m    },[22m
[2m  }[22m

--- Service/osmosis-1-validator ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -23,6 +23,12 @@[39m
[2m          "targetPort": 8081,[22m
[2m        },[22m
[2m        Object {[22m
[31m+         "name": "faucet",[39m
[31m+         "port": 8000,[39m
[31m+         "protocol": "TCP",[39m
[31m+         "targetPort": 8000,[39m
[31m+       },[39m
[31m+       Object {[39m
[2m          "name": "grpc",[22m
[2m          "port": 9090,[22m
[2m          "protocol": "TCP",[22m

--- StatefulSet/osmosis-1-validator ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,18 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/id": "osmosis-1",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "osmosis-1-validator",[39m
[31m+       "app.kubernetes.io/part-of": "osmosis-1",[39m
[31m+       "app.kubernetes.io/role": "validator",[39m
[31m+       "app.kubernetes.io/type": "osmosis-1-statefulset",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-name": "osmosis",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "osmosis-1-validator",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -10,7 +22,7 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "osmosis",[39m
[31m+         "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m          "app.kubernetes.io/name": "osmosis-1-validator",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -24,10 +36,11 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "osmosis",[39m
[31m+           "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m            "app.kubernetes.io/name": "osmosis-1-validator",[22m
[31m+           "app.kubernetes.io/role": "validator",[39m
[2m            "app.kubernetes.io/type": "osmosis-1",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[33m@@ -119,11 +132,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -145,7 +158,9 @@[39m
[2m                "set -eux[22m
[2m  START_ARGS=\\"\\"[22m

[31m+[39m
[2m  # Starting the chain[22m
[31m+[39m
[2m  $CHAIN_BIN start $START_ARGS",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -255,11 +270,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -286,6 +301,7 @@[39m
[2m                "-c",[22m
[2m                "VAL_INDEX=\${HOSTNAME##*-}[22m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m
[31m+[39m

[2m  echo \\"Running setup config script...\\"[22m
[2m  bash -e /scripts/update-config.sh[22m
[33m@@ -351,7 +367,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "NAMESPACE",[22m
[33m@@ -399,11 +415,11 @@[39m
[2m              "name": "init-config",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -428,6 +444,7 @@[39m
[2m                "-c",[22m
[2m                "VAL_INDEX=\${HOSTNAME##*-}[22m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m
[31m+[39m

[2m  if [ -f $CHAIN_DIR/config/genesis.json ]; then[22m
[2m    echo \\"Genesis file exists, exiting early\\"[22m
[33m@@ -500,7 +517,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "METRICS",[22m
[32m-                 "value": "",[39m
[31m+                 "value": "false",[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "NAMESPACE",[22m
[33m@@ -548,11 +565,11 @@[39m
[2m              "name": "init-validator",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -597,16 +614,16 @@[39m
[2m                  },[22m
[2m                },[22m
[2m              ],[22m
[32m-             "image": "curlimages/curl",[39m
[31m+             "image": "curlimages/curl:latest",[39m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "wait-for-chains",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -618,6 +635,10 @@[39m
[2m                "name": "keys",[22m
[2m              },[22m
[2m              "name": "addresses",[22m
[31m+           },[39m
[31m+           Object {[39m
[31m+             "emptyDir": Object {},[39m
[31m+             "name": "faucet",[39m
[2m            },[22m
[2m            Object {[22m
[2m              "emptyDir": Object {},[22m

--- ConfigMap/registry-cosmoshub-4 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -7,7 +7,14 @@[39m
[2m    \\"assets\\": [[22m
[2m      {[22m
[2m        \\"base\\": \\"uatom\\",[22m
[32m-       \\"coingecko_id\\": \\"atom\\",[39m
[31m+       \\"description\\": \\"The native staking and governance token of the Cosmos Hub.\\",[39m
[31m+       \\"name\\": \\"Cosmos Hub Atom\\",[39m
[31m+       \\"display\\": \\"atom\\",[39m
[31m+       \\"symbol\\": \\"ATOM\\",[39m
[31m+       \\"logo_URIs\\": {[39m
[31m+         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/cosmoshub/images/atom.png\\",[39m
[31m+         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/cosmoshub/images/atom.svg\\"[39m
[31m+       },[39m
[2m        \\"denom_units\\": [[22m
[2m          {[22m
[2m            \\"denom\\": \\"uatom\\",[22m
[33m@@ -18,14 +25,7 @@[39m
[2m            \\"exponent\\": 6[22m
[2m          }[22m
[2m        ],[22m
[32m-       \\"description\\": \\"The native staking and governance token of the Cosmos Hub.\\",[39m
[32m-       \\"display\\": \\"atom\\",[39m
[32m-       \\"logo_URIs\\": {[39m
[32m-         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/cosmoshub/images/atom.png\\",[39m
[32m-         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/cosmoshub/images/atom.svg\\"[39m
[32m-       },[39m
[32m-       \\"name\\": \\"Cosmos Hub Atom\\",[39m
[32m-       \\"symbol\\": \\"ATOM\\"[39m
[31m+       \\"coingecko_id\\": \\"atom\\"[39m
[2m      }[22m
[2m    ][22m
[2m  }",[22m
[33m@@ -82,6 +82,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "registry",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "registry-cosmoshub-4",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "registry-cosmoshub-4",[22m
[2m    },[22m
[2m  }[22m

--- Deployment/registry ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,14 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "Deployment",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "registry",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "registry",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "registry",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +17,6 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "registry",[39m
[2m          "app.kubernetes.io/name": "registry",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -22,19 +29,17 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "registry",[39m
[31m+           "app.kubernetes.io/component": "registry",[39m
[31m+           "app.kubernetes.io/managed-by": "starship",[39m
[2m            "app.kubernetes.io/name": "registry",[22m
[32m-           "app.kubernetes.io/rawname": "registry",[39m
[32m-           "app.kubernetes.io/type": "registry",[39m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/part-of": "starship",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+           "starship.io/name": "starship-e2e-tests",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[2m          "containers": Array [[22m
[2m            Object {[22m
[32m-             "command": Array [[39m
[32m-               "registry",[39m
[32m-             ],[39m
[2m              "env": Array [[22m
[2m                Object {[22m
[2m                  "name": "NAMESPACE",[22m
[33m@@ -74,21 +79,20 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "REGISTRY_CHAIN_REGISTRY",[22m
[32m-                 "value": "/configs",[39m
[31m+                 "value": "/chains",[39m
[2m                },[22m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/registry:20250205-544757d",[22m
[32m-             "imagePullPolicy": "IfNotPresent",[39m
[2m              "livenessProbe": Object {[22m
[32m-               "initialDelaySeconds": 20,[39m
[32m-               "periodSeconds": 10,[39m
[31m+               "initialDelaySeconds": 15,[39m
[31m+               "periodSeconds": 20,[39m
[2m                "tcpSocket": Object {[22m
[2m                  "port": 8080,[22m
[2m                },[22m
[2m              },[22m
[2m              "name": "registry",[22m
[2m              "readinessProbe": Object {[22m
[32m-               "initialDelaySeconds": 20,[39m
[31m+               "initialDelaySeconds": 5,[39m
[2m                "periodSeconds": 10,[22m
[2m                "tcpSocket": Object {[22m
[2m                  "port": 8080,[22m
[33m@@ -96,22 +100,22 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[2m                Object {[22m
[32m-                 "mountPath": "/configs/cosmoshub-4",[39m
[32m-                 "name": "registry-configs-cosmoshub-4",[39m
[31m+                 "mountPath": "/chains/cosmoshub-4",[39m
[31m+                 "name": "registry-cosmoshub-4",[39m
[2m                },[22m
[2m                Object {[22m
[32m-                 "mountPath": "/configs/osmosis-1",[39m
[32m-                 "name": "registry-configs-osmosis-1",[39m
[31m+                 "mountPath": "/chains/osmosis-1",[39m
[31m+                 "name": "registry-osmosis-1",[39m
[2m                },[22m
[2m              ],[22m
[2m            },[22m
[33m@@ -126,6 +130,7 @@[39m
[2m    echo \\"Checking: http://osmosis-1-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id\\"[22m
[2m    sleep 10;[22m
[2m  done[22m
[31m+[39m
[2m  while [ $(curl -sw '%{http_code}' http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id -o /dev/null) -ne 200 ]; do[22m
[2m    echo \\"Genesis validator does not seem to be ready for: cosmoshub-4. Waiting for it to start...\\"[22m
[2m    echo \\"Checking: http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id\\"[22m
[33m@@ -148,16 +153,16 @@[39m
[2m                  },[22m
[2m                },[22m
[2m              ],[22m
[32m-             "image": "curlimages/curl",[39m
[31m+             "image": "curlimages/curl:latest",[39m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "wait-for-chains",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -168,13 +173,13 @@[39m
[2m              "configMap": Object {[22m
[2m                "name": "registry-cosmoshub-4",[22m
[2m              },[22m
[32m-             "name": "registry-configs-cosmoshub-4",[39m
[31m+             "name": "registry-cosmoshub-4",[39m
[2m            },[22m
[2m            Object {[22m
[2m              "configMap": Object {[22m
[2m                "name": "registry-osmosis-1",[22m
[2m              },[22m
[32m-             "name": "registry-configs-osmosis-1",[39m
[31m+             "name": "registry-osmosis-1",[39m
[2m            },[22m
[2m          ],[22m
[2m        },[22m

--- ConfigMap/registry-osmosis-1 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -7,7 +7,14 @@[39m
[2m    \\"assets\\": [[22m
[2m      {[22m
[2m        \\"base\\": \\"uosmo\\",[22m
[32m-       \\"coingecko_id\\": \\"osmosis\\",[39m
[31m+       \\"description\\": \\"The native token of Osmosis\\",[39m
[31m+       \\"name\\": \\"Osmosis\\",[39m
[31m+       \\"display\\": \\"osmo\\",[39m
[31m+       \\"symbol\\": \\"OSMO\\",[39m
[31m+       \\"logo_URIs\\": {[39m
[31m+         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/osmo.png\\",[39m
[31m+         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/osmo.svg\\"[39m
[31m+       },[39m
[2m        \\"denom_units\\": [[22m
[2m          {[22m
[2m            \\"denom\\": \\"uosmo\\",[22m
[33m@@ -18,22 +25,21 @@[39m
[2m            \\"exponent\\": 6[22m
[2m          }[22m
[2m        ],[22m
[32m-       \\"description\\": \\"The native token of Osmosis\\",[39m
[32m-       \\"display\\": \\"osmo\\",[39m
[31m+       \\"coingecko_id\\": \\"osmosis\\",[39m
[2m        \\"keywords\\": [[22m
[2m          \\"staking\\",[22m
[2m          \\"dex\\"[22m
[32m-       ],[39m
[32m-       \\"logo_URIs\\": {[39m
[32m-         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/osmo.png\\",[39m
[32m-         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/osmo.svg\\"[39m
[32m-       },[39m
[32m-       \\"name\\": \\"Osmosis\\",[39m
[32m-       \\"symbol\\": \\"OSMO\\"[39m
[31m+       ][39m
[2m      },[22m
[2m      {[22m
[2m        \\"base\\": \\"uion\\",[22m
[32m-       \\"coingecko_id\\": \\"ion\\",[39m
[31m+       \\"name\\": \\"Ion\\",[39m
[31m+       \\"display\\": \\"ion\\",[39m
[31m+       \\"symbol\\": \\"ION\\",[39m
[31m+       \\"logo_URIs\\": {[39m
[31m+         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/ion.png\\",[39m
[31m+         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/ion.svg\\"[39m
[31m+       },[39m
[2m        \\"denom_units\\": [[22m
[2m          {[22m
[2m            \\"denom\\": \\"uion\\",[22m
[33m@@ -44,16 +50,10 @@[39m
[2m            \\"exponent\\": 6[22m
[2m          }[22m
[2m        ],[22m
[32m-       \\"display\\": \\"ion\\",[39m
[31m+       \\"coingecko_id\\": \\"ion\\",[39m
[2m        \\"keywords\\": [[22m
[2m          \\"memecoin\\"[22m
[32m-       ],[39m
[32m-       \\"logo_URIs\\": {[39m
[32m-         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/ion.png\\",[39m
[32m-         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/ion.svg\\"[39m
[32m-       },[39m
[32m-       \\"name\\": \\"Ion\\",[39m
[32m-       \\"symbol\\": \\"ION\\"[39m
[31m+       ][39m
[2m      }[22m
[2m    ][22m
[2m  }",[22m
[33m@@ -110,6 +110,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "registry",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "registry-osmosis-1",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "registry-osmosis-1",[22m
[2m    },[22m
[2m  }[22m

--- ConfigMap/go-relayer-osmos-cosmos ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -4,52 +4,77 @@[39m
[2m      "cosmoshub-4.json": "{[22m
[2m    \\"type\\": \\"cosmos\\",[22m
[2m    \\"value\\": {[22m
[32m-     \\"key\\": \\"default\\",[39m
[31m+     \\"key\\": \\"cosmoshub-4\\",[39m
[2m      \\"chain-id\\": \\"cosmoshub-4\\",[22m
[32m-     \\"rpc-addr\\": \\"http://cosmoshub-4-genesis.default.svc.cluster.local:26657\\",[39m
[31m+     \\"rpc-addr\\": \\"http://cosmoshub-4-genesis.$(NAMESPACE).svc.cluster.local:26657\\",[39m
[2m      \\"account-prefix\\": \\"cosmos\\",[22m
[2m      \\"keyring-backend\\": \\"test\\",[22m
[32m-     \\"gas-adjustment\\": 1.5,[39m
[32m-     \\"gas-prices\\": \\"0.025uatom\\",[39m
[32m-     \\"min-gas-amount\\": 1,[39m
[32m-     \\"debug\\": true,[39m
[31m+     \\"gas-adjustment\\": 1.2,[39m
[31m+     \\"gas-prices\\": \\"0.01uatom\\",[39m
[31m+     \\"min-gas-amount\\": 0,[39m
[31m+     \\"debug\\": false,[39m
[2m      \\"timeout\\": \\"20s\\",[22m
[31m+     \\"block-timeout\\": \\"\\",[39m
[2m      \\"output-format\\": \\"json\\",[22m
[32m-     \\"sign-mode\\": \\"direct\\"[39m
[31m+     \\"sign-mode\\": \\"direct\\",[39m
[31m+     \\"extra-codecs\\": [][39m
[2m    }[22m
[2m  }",[22m
[2m      "osmosis-1.json": "{[22m
[2m    \\"type\\": \\"cosmos\\",[22m
[2m    \\"value\\": {[22m
[32m-     \\"key\\": \\"default\\",[39m
[31m+     \\"key\\": \\"osmosis-1\\",[39m
[2m      \\"chain-id\\": \\"osmosis-1\\",[22m
[32m-     \\"rpc-addr\\": \\"http://osmosis-1-genesis.default.svc.cluster.local:26657\\",[39m
[31m+     \\"rpc-addr\\": \\"http://osmosis-1-genesis.$(NAMESPACE).svc.cluster.local:26657\\",[39m
[2m      \\"account-prefix\\": \\"osmo\\",[22m
[2m      \\"keyring-backend\\": \\"test\\",[22m
[32m-     \\"gas-adjustment\\": 1.5,[39m
[32m-     \\"gas-prices\\": \\"0.025uosmo\\",[39m
[32m-     \\"min-gas-amount\\": 1,[39m
[32m-     \\"debug\\": true,[39m
[31m+     \\"gas-adjustment\\": 1.2,[39m
[31m+     \\"gas-prices\\": \\"0.01uosmo\\",[39m
[31m+     \\"min-gas-amount\\": 0,[39m
[31m+     \\"debug\\": false,[39m
[2m      \\"timeout\\": \\"20s\\",[22m
[31m+     \\"block-timeout\\": \\"\\",[39m
[2m      \\"output-format\\": \\"json\\",[22m
[32m-     \\"sign-mode\\": \\"direct\\"[39m
[31m+     \\"sign-mode\\": \\"direct\\",[39m
[31m+     \\"extra-codecs\\": [][39m
[2m    }[22m
[2m  }",[22m
[2m      "path.json": "{[22m
[32m-   \\"src\\": {[39m
[32m-     \\"chain-id\\": \\"osmosis-1\\"[39m
[32m-   },[39m
[32m-   \\"dst\\": {[39m
[32m-     \\"chain-id\\": \\"cosmoshub-4\\"[39m
[32m-   },[39m
[32m-   \\"src-channel-filter\\": {[39m
[32m-     \\"rule\\": null,[39m
[32m-     \\"channel-list\\": [][39m
[31m+   \\"paths\\": {[39m
[31m+     \\"path0\\": {[39m
[31m+       \\"src\\": {[39m
[31m+         \\"chain-id\\": \\"osmosis-1\\",[39m
[31m+         \\"client-id\\": \\"\\",[39m
[31m+         \\"connection-id\\": \\"\\",[39m
[31m+         \\"channel-id\\": \\"\\",[39m
[31m+         \\"port-id\\": \\"transfer\\"[39m
[31m+       },[39m
[31m+       \\"dst\\": {[39m
[31m+         \\"chain-id\\": \\"cosmoshub-4\\",[39m
[31m+         \\"client-id\\": \\"\\",[39m
[31m+         \\"connection-id\\": \\"\\",[39m
[31m+         \\"channel-id\\": \\"\\",[39m
[31m+         \\"port-id\\": \\"transfer\\"[39m
[31m+       },[39m
[31m+       \\"src-channel-filter\\": {[39m
[31m+         \\"rule\\": null,[39m
[31m+         \\"channel-list\\": [][39m
[31m+       }[39m
[31m+     }[39m
[2m    }[22m
[2m  }",[22m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "relayer",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "go-relayer-osmos-cosmos",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/role": "go-relayer",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "go-relayer-osmos-cosmos",[22m
[2m    },[22m
[2m  }[22m

--- StatefulSet/go-relayer-osmos-cosmos ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,15 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "relayer",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "go-relayer-osmos-cosmos",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/role": "go-relayer",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "go-relayer-osmos-cosmos",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -29,21 +38,33 @@[39m
[2m            "app.kubernetes.io/name": "go-relayer-osmos-cosmos",[22m
[2m            "app.kubernetes.io/rawname": "osmos-cosmos",[22m
[2m            "app.kubernetes.io/type": "go-relayer",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[2m          "containers": Array [[22m
[2m            Object {[22m
[31m+             "args": Array [[39m
[31m+               "RLY_INDEX=\${HOSTNAME##*-}[39m
[31m+ echo \\"Relayer Index: $RLY_INDEX\\"[39m
[31m+ rly start",[39m
[31m+             ],[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "rly start",[39m
[2m              ],[22m
[2m              "env": Array [[22m
[31m+               Object {[39m
[31m+                 "name": "NAMESPACE",[39m
[31m+                 "valueFrom": Object {[39m
[31m+                   "fieldRef": Object {[39m
[31m+                     "fieldPath": "metadata.namespace",[39m
[31m+                   },[39m
[31m+                 },[39m
[31m+               },[39m
[2m                Object {[22m
[2m                  "name": "RELAYER_DIR",[22m
[32m-                 "value": "/root",[39m
[31m+                 "value": "/root/.relayer",[39m
[2m                },[22m
[2m              ],[22m
[2m              "image": "ghcr.io/cosmology-tech/starship/go-relayer:v2.4.1",[22m
[33m@@ -51,12 +72,12 @@[39m
[2m              "name": "relayer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[2m              },[22m
[2m              "securityContext": Object {[22m
[33m@@ -77,26 +98,27 @@[39m
[2m          ],[22m
[2m          "initContainers": Array [[22m
[2m            Object {[22m
[32m-             "command": Array [[39m
[32m-               "bash",[39m
[32m-               "-c",[39m
[31m+             "args": Array [[39m
[2m                "set -ux[22m

[2m  RLY_INDEX=\${HOSTNAME##*-}[22m
[31m+ echo \\"Relayer Index: $RLY_INDEX\\"[39m
[31m+[39m
[31m+ mkdir -p $RELAYER_DIR/config[39m
[31m+ cp /configs/path.json $RELAYER_DIR/config/[39m
[31m+[39m
[2m  MNEMONIC=$(jq -r \\".relayers[$RLY_INDEX].mnemonic\\" $KEYS_CONFIG)[22m

[32m- rly config init[39m

[32m-[39m
[32m- echo \\"Adding osmosis-1 chain\\"[39m
[32m- rly chains add --file \\"/configs/osmosis-1.json\\" osmosis-1[39m
[31m+ echo \\"Setting up chain osmosis-1...\\"[39m
[31m+ cp /configs/osmosis-1.json $RELAYER_DIR/config/[39m
[31m+ rly chains add --file /configs/osmosis-1.json osmosis-1[39m

[32m- echo \\"Restoring osmosis-1 keys\\"[39m
[32m- rly keys restore osmosis-1 default \\"$MNEMONIC\\"[39m
[31m+ echo \\"Creating key for osmosis-1...\\"[39m
[31m+ echo \\"$MNEMONIC\\" | rly keys restore osmosis-1 osmosis-1 --restore-key-type secp256k1 --coin-type 118[39m

[2m  DENOM=\\"uosmo\\"[22m
[32m- RLY_ADDR=$(rly address \\"osmosis-1\\" | awk 'END{print}')[39m
[32m- echo \\"Relayer address $RLY_ADDR on osmosis-1 chain with denom $DENOM\\"[39m
[31m+ RLY_ADDR=$(rly keys show osmosis-1 osmosis-1)[39m

[2m  echo \\"Transfer tokens to address $RLY_ADDR\\"[22m
[2m  bash -e /scripts/transfer-tokens.sh \\\\[22m
[33m@@ -105,16 +127,15 @@[39m
[2m    http://osmosis-1-genesis.$NAMESPACE.svc.cluster.local:8000/credit \\\\[22m
[2m    \\"true\\" || true[22m

[31m+ echo \\"Setting up chain cosmoshub-4...\\"[39m
[31m+ cp /configs/cosmoshub-4.json $RELAYER_DIR/config/[39m
[31m+ rly chains add --file /configs/cosmoshub-4.json cosmoshub-4[39m

[32m- echo \\"Adding cosmoshub-4 chain\\"[39m
[32m- rly chains add --file \\"/configs/cosmoshub-4.json\\" cosmoshub-4[39m
[32m-[39m
[32m- echo \\"Restoring cosmoshub-4 keys\\"[39m
[32m- rly keys restore cosmoshub-4 default \\"$MNEMONIC\\"[39m
[31m+ echo \\"Creating key for cosmoshub-4...\\"[39m
[31m+ echo \\"$MNEMONIC\\" | rly keys restore cosmoshub-4 cosmoshub-4 --restore-key-type secp256k1 --coin-type 118[39m

[2m  DENOM=\\"uatom\\"[22m
[32m- RLY_ADDR=$(rly address \\"cosmoshub-4\\" | awk 'END{print}')[39m
[32m- echo \\"Relayer address $RLY_ADDR on cosmoshub-4 chain with denom $DENOM\\"[39m
[31m+ RLY_ADDR=$(rly keys show cosmoshub-4 cosmoshub-4)[39m

[2m  echo \\"Transfer tokens to address $RLY_ADDR\\"[22m
[2m  bash -e /scripts/transfer-tokens.sh \\\\[22m
[33m@@ -123,22 +144,16 @@[39m
[2m    http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:8000/credit \\\\[22m
[2m    \\"true\\" || true[22m

[32m- PATHEND=\\"osmosis-1-cosmoshub-4\\"[39m
[32m- echo \\"Creating path $PATHEND\\"[39m
[32m- rly paths add \\\\[39m
[32m-   osmosis-1 \\\\[39m
[32m-   cosmoshub-4 \\\\[39m
[32m-   $PATHEND \\\\[39m
[32m-   --file \\"/configs/path.json\\"[39m
[31m+ echo \\"Adding paths...\\"[39m
[31m+ rly paths add --file /configs/path.json[39m

[32m- echo \\"Creating a channel\\"[39m
[32m- rly transact link $PATHEND --src-port transfer --dst-port transfer -d[39m

[32m- echo \\"Creating a client on $PATHEND\\"[39m
[32m- rly transact clients $PATHEND[39m
[32m-[39m
[32m- echo \\"Creating a connection on $PATHEND\\"[39m
[32m- rly transact connection $PATHEND",[39m
[31m+ echo \\"Creating client, connection and channel for path0...\\"[39m
[31m+ rly tx link path0 --src-port transfer --dst-port transfer",[39m
[31m+             ],[39m
[31m+             "command": Array [[39m
[31m+               "bash",[39m
[31m+               "-c",[39m
[2m              ],[22m
[2m              "env": Array [[22m
[2m                Object {[22m
[33m@@ -155,16 +170,25 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "RELAYER_DIR",[22m
[32m-                 "value": "/root",[39m
[31m+                 "value": "/root/.relayer",[39m
[31m+               },[39m
[31m+               Object {[39m
[31m+                 "name": "RELAYER_INDEX",[39m
[31m+                 "value": "\${HOSTNAME##*-}",[39m
[2m                },[22m
[2m              ],[22m
[2m              "image": "ghcr.io/cosmology-tech/starship/go-relayer:v2.4.1",[22m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "init-relayer",[22m
[32m-             "resources": null,[39m
[32m-             "securityContext": Object {[39m
[32m-               "allowPrivilegeEscalation": false,[39m
[32m-               "runAsUser": 0,[39m
[31m+             "resources": Object {[39m
[31m+               "limits": Object {[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[31m+               },[39m
[31m+               "requests": Object {[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[31m+               },[39m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[2m                Object {[22m
[33m@@ -194,6 +218,7 @@[39m
[2m    echo \\"Checking: http://osmosis-1-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id\\"[22m
[2m    sleep 10;[22m
[2m  done[22m
[31m+[39m
[2m  while [ $(curl -sw '%{http_code}' http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id -o /dev/null) -ne 200 ]; do[22m
[2m    echo \\"Genesis validator does not seem to be ready for: cosmoshub-4. Waiting for it to start...\\"[22m
[2m    echo \\"Checking: http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id\\"[22m
[33m@@ -216,16 +241,16 @@[39m
[2m                  },[22m
[2m                },[22m
[2m              ],[22m
[32m-             "image": "curlimages/curl",[39m
[31m+             "image": "curlimages/curl:latest",[39m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "wait-for-chains",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m"
`;

exports[`Manifest Comparison Tests Individual Config Comparisons should generate manifests for two-chain-monitoring that match the snapshot 1`] = `
"ðŸ”„ MODIFIED_RESOURCES:

--- ConfigMap/keys ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -98,6 +98,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "configmap",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "keys",[39m
[31m+       "app.kubernetes.io/part-of": "global",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "keys",[22m
[2m    },[22m
[2m  }[22m

--- ConfigMap/setup-scripts ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -208,6 +208,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "configmap",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts",[39m
[31m+       "app.kubernetes.io/part-of": "global",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts",[22m
[2m    },[22m
[2m  }[22m

--- StatefulSet/cosmoshub-4-genesis ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,18 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/id": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "cosmoshub-4-genesis",[39m
[31m+       "app.kubernetes.io/part-of": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/role": "genesis",[39m
[31m+       "app.kubernetes.io/type": "cosmoshub-4-statefulset",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-name": "cosmoshub",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "cosmoshub-4-genesis",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +21,7 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "cosmoshub",[39m
[31m+         "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m          "app.kubernetes.io/name": "cosmoshub-4-genesis",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -23,11 +35,12 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "cosmoshub",[39m
[31m+           "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m            "app.kubernetes.io/name": "cosmoshub-4-genesis",[22m
[2m            "app.kubernetes.io/rawname": "cosmoshub-4",[22m
[31m+           "app.kubernetes.io/role": "genesis",[39m
[2m            "app.kubernetes.io/type": "cosmoshub-4",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[33m@@ -91,11 +104,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -114,7 +127,12 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "START_ARGS=\\"\\"[39m
[31m+               "#!/bin/bash[39m
[31m+ set -euo pipefail[39m
[31m+[39m
[31m+ START_ARGS=\\"\\"[39m
[31m+[39m
[31m+[39m
[2m  $CHAIN_BIN start $START_ARGS",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -177,11 +195,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -210,6 +228,7 @@[39m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m

[2m  echo \\"Running setup config script...\\"[22m
[31m+[39m
[2m  bash -e /scripts/update-config.sh",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -291,11 +310,11 @@[39m
[2m              "name": "init-config",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -428,11 +447,11 @@[39m
[2m              "name": "init-genesis",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m

--- ConfigMap/setup-scripts-cosmoshub-4 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -608,6 +608,17 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts-cosmoshub-4",[39m
[31m+       "app.kubernetes.io/part-of": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/role": "setup-scripts",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-id": "cosmoshub-4",[39m
[31m+       "starship.io/chain-name": "cosmoshub",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts-cosmoshub-4",[22m
[2m    },[22m
[2m  }[22m

--- Service/cosmoshub-4-validator ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -23,6 +23,12 @@[39m
[2m          "targetPort": 8081,[22m
[2m        },[22m
[2m        Object {[22m
[31m+         "name": "faucet",[39m
[31m+         "port": 8000,[39m
[31m+         "protocol": "TCP",[39m
[31m+         "targetPort": 8000,[39m
[31m+       },[39m
[31m+       Object {[39m
[2m          "name": "grpc",[22m
[2m          "port": 9090,[22m
[2m          "protocol": "TCP",[22m

--- StatefulSet/cosmoshub-4-validator ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,18 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/id": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "cosmoshub-4-validator",[39m
[31m+       "app.kubernetes.io/part-of": "cosmoshub-4",[39m
[31m+       "app.kubernetes.io/role": "validator",[39m
[31m+       "app.kubernetes.io/type": "cosmoshub-4-statefulset",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-name": "cosmoshub",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "cosmoshub-4-validator",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -10,7 +22,7 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "cosmoshub",[39m
[31m+         "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m          "app.kubernetes.io/name": "cosmoshub-4-validator",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -24,10 +36,11 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "cosmoshub",[39m
[31m+           "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m            "app.kubernetes.io/name": "cosmoshub-4-validator",[22m
[31m+           "app.kubernetes.io/role": "validator",[39m
[2m            "app.kubernetes.io/type": "cosmoshub-4",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[33m@@ -119,11 +132,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -145,7 +158,9 @@[39m
[2m                "set -eux[22m
[2m  START_ARGS=\\"\\"[22m

[31m+[39m
[2m  # Starting the chain[22m
[31m+[39m
[2m  $CHAIN_BIN start $START_ARGS",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -255,11 +270,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -287,6 +302,7 @@[39m
[2m                "VAL_INDEX=\${HOSTNAME##*-}[22m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m

[31m+[39m
[2m  echo \\"Running setup config script...\\"[22m
[2m  bash -e /scripts/update-config.sh[22m

[33m@@ -399,11 +415,11 @@[39m
[2m              "name": "init-config",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -428,6 +444,7 @@[39m
[2m                "-c",[22m
[2m                "VAL_INDEX=\${HOSTNAME##*-}[22m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m
[31m+[39m

[2m  if [ -f $CHAIN_DIR/config/genesis.json ]; then[22m
[2m    echo \\"Genesis file exists, exiting early\\"[22m
[33m@@ -548,11 +565,11 @@[39m
[2m              "name": "init-validator",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -597,16 +614,16 @@[39m
[2m                  },[22m
[2m                },[22m
[2m              ],[22m
[32m-             "image": "curlimages/curl",[39m
[31m+             "image": "curlimages/curl:latest",[39m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "wait-for-chains",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m

--- ConfigMap/grafana-dashboard-providers ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,13 +2,13 @@[39m
[2m    "apiVersion": "v1",[22m
[2m    "data": Object {[22m
[2m      "default.yaml": "{[22m
[32m-   \\"apiVersion\\": 1[39m
[31m+   \\"apiVersion\\": 1,[39m
[2m    \\"providers\\": [[22m
[2m      {[22m
[32m-       \\"name\\": \\"chain-dashboard\\"[39m
[32m-       \\"orgId\\": 1[39m
[32m-       \\"type\\": \\"file\\"[39m
[32m-       \\"allowUiUpdates\\": true[39m
[31m+       \\"name\\": \\"chain-dashboard\\",[39m
[31m+       \\"orgId\\": 1,[39m
[31m+       \\"type\\": \\"file\\",[39m
[31m+       \\"allowUiUpdates\\": true,[39m
[2m        \\"options\\": {[22m
[2m          \\"path\\": \\"/var/lib/grafana/dashboards\\"[22m
[2m        }[22m
[33m@@ -18,6 +18,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "monitoring",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "grafana-dashboard-providers",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "grafana-dashboard-providers",[22m
[2m    },[22m
[2m  }[22m

--- ConfigMap/grafana-dashboards ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2281,6 +2281,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "monitoring",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "grafana-dashboards",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "grafana-dashboards",[22m
[2m    },[22m
[2m  }[22m

--- ConfigMap/grafana-datasources ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -18,6 +18,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "monitoring",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "grafana-datasources",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "grafana-datasources",[22m
[2m    },[22m
[2m  }[22m

--- Deployment/grafana ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,14 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "Deployment",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "monitoring",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "grafana",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "grafana",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -58,11 +66,11 @@[39m
[2m              ],[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "400M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "400M",[22m
[2m                },[22m
[2m              },[22m

--- Service/grafana ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -6,6 +6,14 @@[39m
[2m        "prometheus.io/port": "8080",[22m
[2m        "prometheus.io/scrape": "true",[22m
[2m      },[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "monitoring",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "grafana",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "grafana",[22m
[2m    },[22m
[2m    "spec": Object {[22m

--- ClusterRole/prometheus ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,14 @@[39m
[2m    "apiVersion": "rbac.authorization.k8s.io/v1",[22m
[2m    "kind": "ClusterRole",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "monitoring",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "prometheus",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "prometheus",[22m
[2m    },[22m
[2m  }[22m

--- ClusterRoleBinding/prometheus ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,14 @@[39m
[2m    "apiVersion": "rbac.authorization.k8s.io/v1",[22m
[2m    "kind": "ClusterRoleBinding",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "monitoring",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "prometheus",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "prometheus",[22m
[2m    },[22m
[2m  }[22m

--- ConfigMap/prometheus-config ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -44,7 +44,6 @@[39m
[2m          target_label: __metrics_path__[22m
[2m          replacement: /api/v1/nodes/\${1}/proxy/metrics[22m

[32m-[39m
[2m    - job_name: 'kubernetes-pods'[22m

[2m      kubernetes_sd_configs:[22m
[33m@@ -147,29 +146,28 @@[39m
[2m    [22m
[2m    - job_name: 'osmosis-genesis'[22m
[2m      static_configs:[22m
[32m-       - targets: ['osmosis-1-genesis.default.svc.cluster.local:26660'][39m
[31m+       - targets: ['osmosis-1-genesis.$(NAMESPACE).svc.cluster.local:26660'][39m
[2m          labels:[22m
[2m            instance: genesis[22m
[2m            type: genesis[22m
[2m            network: \\"osmosis\\"[22m
[2m    - job_name: 'osmosis-validator-0'[22m
[2m      static_configs:[22m
[32m-       - targets: ['osmosis-1-validator-0.osmosis-1-validator.default.svc.cluster.local:26660'][39m
[31m+       - targets: ['osmosis-1-validator-0.osmosis-1-validator.$(NAMESPACE).svc.cluster.local:26660'][39m
[2m          labels:[22m
[2m            instance: \\"validator-0\\"[22m
[2m            type: validator[22m
[2m            network: \\"osmosis\\"[22m
[32m-   [39m
[2m    - job_name: 'cosmoshub-genesis'[22m
[2m      static_configs:[22m
[32m-       - targets: ['cosmoshub-4-genesis.default.svc.cluster.local:26660'][39m
[31m+       - targets: ['cosmoshub-4-genesis.$(NAMESPACE).svc.cluster.local:26660'][39m
[2m          labels:[22m
[2m            instance: genesis[22m
[2m            type: genesis[22m
[2m            network: \\"cosmoshub\\"[22m
[2m    - job_name: 'cosmoshub-validator-0'[22m
[2m      static_configs:[22m
[32m-       - targets: ['cosmoshub-4-validator-0.cosmoshub-4-validator.default.svc.cluster.local:26660'][39m
[31m+       - targets: ['cosmoshub-4-validator-0.cosmoshub-4-validator.$(NAMESPACE).svc.cluster.local:26660'][39m
[2m          labels:[22m
[2m            instance: \\"validator-0\\"[22m
[2m            type: validator[22m
[33m@@ -177,6 +175,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "monitoring",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "prometheus-config",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "prometheus-config",[22m
[2m    },[22m
[2m  }[22m

--- Deployment/prometheus ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -43,11 +43,11 @@[39m
[2m              ],[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "400M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "400M",[22m
[2m                },[22m
[2m              },[22m

--- Service/prometheus ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -6,6 +6,14 @@[39m
[2m        "prometheus.io/port": "9090",[22m
[2m        "prometheus.io/scrape": "true",[22m
[2m      },[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "monitoring",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "prometheus",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "prometheus",[22m
[2m    },[22m
[2m    "spec": Object {[22m

--- StatefulSet/osmosis-1-genesis ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,18 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/id": "osmosis-1",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "osmosis-1-genesis",[39m
[31m+       "app.kubernetes.io/part-of": "osmosis-1",[39m
[31m+       "app.kubernetes.io/role": "genesis",[39m
[31m+       "app.kubernetes.io/type": "osmosis-1-statefulset",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-name": "osmosis",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "osmosis-1-genesis",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +21,7 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "osmosis",[39m
[31m+         "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m          "app.kubernetes.io/name": "osmosis-1-genesis",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -23,11 +35,12 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "osmosis",[39m
[31m+           "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m            "app.kubernetes.io/name": "osmosis-1-genesis",[22m
[2m            "app.kubernetes.io/rawname": "osmosis-1",[22m
[31m+           "app.kubernetes.io/role": "genesis",[39m
[2m            "app.kubernetes.io/type": "osmosis-1",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[33m@@ -91,11 +104,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -114,7 +127,12 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "START_ARGS=\\"\\"[39m
[31m+               "#!/bin/bash[39m
[31m+ set -euo pipefail[39m
[31m+[39m
[31m+ START_ARGS=\\"\\"[39m
[31m+[39m
[31m+[39m
[2m  $CHAIN_BIN start $START_ARGS",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -177,11 +195,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -210,6 +228,7 @@[39m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m

[2m  echo \\"Running setup config script...\\"[22m
[31m+[39m
[2m  bash -e /scripts/update-config.sh",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -291,11 +310,11 @@[39m
[2m              "name": "init-config",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -428,11 +447,11 @@[39m
[2m              "name": "init-genesis",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m

--- ConfigMap/setup-scripts-osmosis-1 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -608,6 +608,17 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts-osmosis-1",[39m
[31m+       "app.kubernetes.io/part-of": "osmosis-1",[39m
[31m+       "app.kubernetes.io/role": "setup-scripts",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-id": "osmosis-1",[39m
[31m+       "starship.io/chain-name": "osmosis",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "setup-scripts-osmosis-1",[22m
[2m    },[22m
[2m  }[22m

--- Service/osmosis-1-validator ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -23,6 +23,12 @@[39m
[2m          "targetPort": 8081,[22m
[2m        },[22m
[2m        Object {[22m
[31m+         "name": "faucet",[39m
[31m+         "port": 8000,[39m
[31m+         "protocol": "TCP",[39m
[31m+         "targetPort": 8000,[39m
[31m+       },[39m
[31m+       Object {[39m
[2m          "name": "grpc",[22m
[2m          "port": 9090,[22m
[2m          "protocol": "TCP",[22m

--- StatefulSet/osmosis-1-validator ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,18 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/id": "osmosis-1",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "osmosis-1-validator",[39m
[31m+       "app.kubernetes.io/part-of": "osmosis-1",[39m
[31m+       "app.kubernetes.io/role": "validator",[39m
[31m+       "app.kubernetes.io/type": "osmosis-1-statefulset",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-name": "osmosis",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "osmosis-1-validator",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -10,7 +22,7 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "osmosis",[39m
[31m+         "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m          "app.kubernetes.io/name": "osmosis-1-validator",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -24,10 +36,11 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "osmosis",[39m
[31m+           "app.kubernetes.io/instance": "starship-e2e-tests",[39m
[2m            "app.kubernetes.io/name": "osmosis-1-validator",[22m
[31m+           "app.kubernetes.io/role": "validator",[39m
[2m            "app.kubernetes.io/type": "osmosis-1",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[33m@@ -119,11 +132,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -145,7 +158,9 @@[39m
[2m                "set -eux[22m
[2m  START_ARGS=\\"\\"[22m

[31m+[39m
[2m  # Starting the chain[22m
[31m+[39m
[2m  $CHAIN_BIN start $START_ARGS",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -255,11 +270,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -287,6 +302,7 @@[39m
[2m                "VAL_INDEX=\${HOSTNAME##*-}[22m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m

[31m+[39m
[2m  echo \\"Running setup config script...\\"[22m
[2m  bash -e /scripts/update-config.sh[22m

[33m@@ -399,11 +415,11 @@[39m
[2m              "name": "init-config",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -428,6 +444,7 @@[39m
[2m                "-c",[22m
[2m                "VAL_INDEX=\${HOSTNAME##*-}[22m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m
[31m+[39m

[2m  if [ -f $CHAIN_DIR/config/genesis.json ]; then[22m
[2m    echo \\"Genesis file exists, exiting early\\"[22m
[33m@@ -548,11 +565,11 @@[39m
[2m              "name": "init-validator",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -597,16 +614,16 @@[39m
[2m                  },[22m
[2m                },[22m
[2m              ],[22m
[32m-             "image": "curlimages/curl",[39m
[31m+             "image": "curlimages/curl:latest",[39m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "wait-for-chains",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m

--- ConfigMap/registry-cosmoshub-4 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -7,7 +7,14 @@[39m
[2m    \\"assets\\": [[22m
[2m      {[22m
[2m        \\"base\\": \\"uatom\\",[22m
[32m-       \\"coingecko_id\\": \\"atom\\",[39m
[31m+       \\"description\\": \\"The native staking and governance token of the Cosmos Hub.\\",[39m
[31m+       \\"name\\": \\"Cosmos Hub Atom\\",[39m
[31m+       \\"display\\": \\"atom\\",[39m
[31m+       \\"symbol\\": \\"ATOM\\",[39m
[31m+       \\"logo_URIs\\": {[39m
[31m+         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/cosmoshub/images/atom.png\\",[39m
[31m+         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/cosmoshub/images/atom.svg\\"[39m
[31m+       },[39m
[2m        \\"denom_units\\": [[22m
[2m          {[22m
[2m            \\"denom\\": \\"uatom\\",[22m
[33m@@ -18,14 +25,7 @@[39m
[2m            \\"exponent\\": 6[22m
[2m          }[22m
[2m        ],[22m
[32m-       \\"description\\": \\"The native staking and governance token of the Cosmos Hub.\\",[39m
[32m-       \\"display\\": \\"atom\\",[39m
[32m-       \\"logo_URIs\\": {[39m
[32m-         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/cosmoshub/images/atom.png\\",[39m
[32m-         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/cosmoshub/images/atom.svg\\"[39m
[32m-       },[39m
[32m-       \\"name\\": \\"Cosmos Hub Atom\\",[39m
[32m-       \\"symbol\\": \\"ATOM\\"[39m
[31m+       \\"coingecko_id\\": \\"atom\\"[39m
[2m      }[22m
[2m    ][22m
[2m  }",[22m
[33m@@ -82,6 +82,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "registry",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "registry-cosmoshub-4",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "registry-cosmoshub-4",[22m
[2m    },[22m
[2m  }[22m

--- Deployment/registry ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,14 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "Deployment",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "registry",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "registry",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "registry",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +17,6 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "registry",[39m
[2m          "app.kubernetes.io/name": "registry",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -22,19 +29,17 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "registry",[39m
[31m+           "app.kubernetes.io/component": "registry",[39m
[31m+           "app.kubernetes.io/managed-by": "starship",[39m
[2m            "app.kubernetes.io/name": "registry",[22m
[32m-           "app.kubernetes.io/rawname": "registry",[39m
[32m-           "app.kubernetes.io/type": "registry",[39m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/part-of": "starship",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+           "starship.io/name": "starship-e2e-tests",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[2m          "containers": Array [[22m
[2m            Object {[22m
[32m-             "command": Array [[39m
[32m-               "registry",[39m
[32m-             ],[39m
[2m              "env": Array [[22m
[2m                Object {[22m
[2m                  "name": "NAMESPACE",[22m
[33m@@ -74,21 +79,20 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "REGISTRY_CHAIN_REGISTRY",[22m
[32m-                 "value": "/configs",[39m
[31m+                 "value": "/chains",[39m
[2m                },[22m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/registry:20250205-544757d",[22m
[32m-             "imagePullPolicy": "IfNotPresent",[39m
[2m              "livenessProbe": Object {[22m
[32m-               "initialDelaySeconds": 20,[39m
[32m-               "periodSeconds": 10,[39m
[31m+               "initialDelaySeconds": 15,[39m
[31m+               "periodSeconds": 20,[39m
[2m                "tcpSocket": Object {[22m
[2m                  "port": 8080,[22m
[2m                },[22m
[2m              },[22m
[2m              "name": "registry",[22m
[2m              "readinessProbe": Object {[22m
[32m-               "initialDelaySeconds": 20,[39m
[31m+               "initialDelaySeconds": 5,[39m
[2m                "periodSeconds": 10,[22m
[2m                "tcpSocket": Object {[22m
[2m                  "port": 8080,[22m
[33m@@ -96,22 +100,22 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[2m                Object {[22m
[32m-                 "mountPath": "/configs/cosmoshub-4",[39m
[32m-                 "name": "registry-configs-cosmoshub-4",[39m
[31m+                 "mountPath": "/chains/cosmoshub-4",[39m
[31m+                 "name": "registry-cosmoshub-4",[39m
[2m                },[22m
[2m                Object {[22m
[32m-                 "mountPath": "/configs/osmosis-1",[39m
[32m-                 "name": "registry-configs-osmosis-1",[39m
[31m+                 "mountPath": "/chains/osmosis-1",[39m
[31m+                 "name": "registry-osmosis-1",[39m
[2m                },[22m
[2m              ],[22m
[2m            },[22m
[33m@@ -126,6 +130,7 @@[39m
[2m    echo \\"Checking: http://osmosis-1-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id\\"[22m
[2m    sleep 10;[22m
[2m  done[22m
[31m+[39m
[2m  while [ $(curl -sw '%{http_code}' http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id -o /dev/null) -ne 200 ]; do[22m
[2m    echo \\"Genesis validator does not seem to be ready for: cosmoshub-4. Waiting for it to start...\\"[22m
[2m    echo \\"Checking: http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id\\"[22m
[33m@@ -148,16 +153,16 @@[39m
[2m                  },[22m
[2m                },[22m
[2m              ],[22m
[32m-             "image": "curlimages/curl",[39m
[31m+             "image": "curlimages/curl:latest",[39m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "wait-for-chains",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -168,13 +173,13 @@[39m
[2m              "configMap": Object {[22m
[2m                "name": "registry-cosmoshub-4",[22m
[2m              },[22m
[32m-             "name": "registry-configs-cosmoshub-4",[39m
[31m+             "name": "registry-cosmoshub-4",[39m
[2m            },[22m
[2m            Object {[22m
[2m              "configMap": Object {[22m
[2m                "name": "registry-osmosis-1",[22m
[2m              },[22m
[32m-             "name": "registry-configs-osmosis-1",[39m
[31m+             "name": "registry-osmosis-1",[39m
[2m            },[22m
[2m          ],[22m
[2m        },[22m

--- ConfigMap/registry-osmosis-1 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -7,7 +7,14 @@[39m
[2m    \\"assets\\": [[22m
[2m      {[22m
[2m        \\"base\\": \\"uosmo\\",[22m
[32m-       \\"coingecko_id\\": \\"osmosis\\",[39m
[31m+       \\"description\\": \\"The native token of Osmosis\\",[39m
[31m+       \\"name\\": \\"Osmosis\\",[39m
[31m+       \\"display\\": \\"osmo\\",[39m
[31m+       \\"symbol\\": \\"OSMO\\",[39m
[31m+       \\"logo_URIs\\": {[39m
[31m+         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/osmo.png\\",[39m
[31m+         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/osmo.svg\\"[39m
[31m+       },[39m
[2m        \\"denom_units\\": [[22m
[2m          {[22m
[2m            \\"denom\\": \\"uosmo\\",[22m
[33m@@ -18,22 +25,21 @@[39m
[2m            \\"exponent\\": 6[22m
[2m          }[22m
[2m        ],[22m
[32m-       \\"description\\": \\"The native token of Osmosis\\",[39m
[32m-       \\"display\\": \\"osmo\\",[39m
[31m+       \\"coingecko_id\\": \\"osmosis\\",[39m
[2m        \\"keywords\\": [[22m
[2m          \\"staking\\",[22m
[2m          \\"dex\\"[22m
[32m-       ],[39m
[32m-       \\"logo_URIs\\": {[39m
[32m-         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/osmo.png\\",[39m
[32m-         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/osmo.svg\\"[39m
[32m-       },[39m
[32m-       \\"name\\": \\"Osmosis\\",[39m
[32m-       \\"symbol\\": \\"OSMO\\"[39m
[31m+       ][39m
[2m      },[22m
[2m      {[22m
[2m        \\"base\\": \\"uion\\",[22m
[32m-       \\"coingecko_id\\": \\"ion\\",[39m
[31m+       \\"name\\": \\"Ion\\",[39m
[31m+       \\"display\\": \\"ion\\",[39m
[31m+       \\"symbol\\": \\"ION\\",[39m
[31m+       \\"logo_URIs\\": {[39m
[31m+         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/ion.png\\",[39m
[31m+         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/ion.svg\\"[39m
[31m+       },[39m
[2m        \\"denom_units\\": [[22m
[2m          {[22m
[2m            \\"denom\\": \\"uion\\",[22m
[33m@@ -44,16 +50,10 @@[39m
[2m            \\"exponent\\": 6[22m
[2m          }[22m
[2m        ],[22m
[32m-       \\"display\\": \\"ion\\",[39m
[31m+       \\"coingecko_id\\": \\"ion\\",[39m
[2m        \\"keywords\\": [[22m
[2m          \\"memecoin\\"[22m
[32m-       ],[39m
[32m-       \\"logo_URIs\\": {[39m
[32m-         \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/ion.png\\",[39m
[32m-         \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/osmosis/images/ion.svg\\"[39m
[32m-       },[39m
[32m-       \\"name\\": \\"Ion\\",[39m
[32m-       \\"symbol\\": \\"ION\\"[39m
[31m+       ][39m
[2m      }[22m
[2m    ][22m
[2m  }",[22m
[33m@@ -110,6 +110,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "registry",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "registry-osmosis-1",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "registry-osmosis-1",[22m
[2m    },[22m
[2m  }[22m

--- ConfigMap/hermes-osmos-cosmos ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -3,92 +3,45 @@[39m
[2m    "data": Object {[22m
[2m      "config-cli.toml": "# The global section has parameters that apply globally to the relayer operation.[22m
[2m  [global][22m
[32m- # Specify the verbosity for the relayer logging output. Default: 'info'[39m
[32m- # Valid options are 'error', 'warn', 'info', 'debug', 'trace'.[39m
[32m- log_level = 'info'[39m
[32m- # Specify the mode to be used by the relayer. [Required][39m
[31m+ log_level = \\"info\\"[39m
[31m+[39m
[2m  [mode][22m
[32m- # Specify the client mode.[39m
[2m  [mode.clients][22m
[32m- # Whether or not to enable the client workers. [Required][39m
[2m  enabled = true[22m
[32m- # Whether or not to enable periodic refresh of clients. [Default: true][39m
[32m- # This feature only applies to clients that underlie an open channel.[39m
[32m- # For Tendermint clients, the frequency at which Hermes refreshes them is 2/3 of their[39m
[32m- # trusting period (e.g., refresh every ~9 days if the trusting period is 14 days).[39m
[32m- # Note: Even if this is disabled, clients will be refreshed automatically if[39m
[32m- #      there is activity on a connection or channel they are involved with.[39m
[2m  refresh = true[22m
[32m- # Whether or not to enable misbehaviour detection for clients. [Default: false][39m
[2m  misbehaviour = true[22m
[32m- # Specify the connections mode.[39m
[31m+[39m
[2m  [mode.connections][22m
[32m- # Whether or not to enable the connection workers for handshake completion. [Required][39m
[2m  enabled = true[22m
[32m- # Specify the channels mode.[39m
[31m+[39m
[2m  [mode.channels][22m
[32m- # Whether or not to enable the channel workers for handshake completion. [Required][39m
[2m  enabled = true[22m
[32m- # Specify the packets mode.[39m
[31m+[39m
[2m  [mode.packets][22m
[32m- # Whether or not to enable the packet workers. [Required][39m
[2m  enabled = true[22m
[32m- # Parametrize the periodic packet clearing feature.[39m
[32m- # Interval (in number of blocks) at which pending packets[39m
[32m- # should be periodically cleared. A value of '0' will disable[39m
[32m- # periodic packet clearing. [Default: 100][39m
[2m  clear_interval = 100[22m
[32m- # Whether or not to clear packets on start. [Default: false][39m
[2m  clear_on_start = true[22m
[32m- # Toggle the transaction confirmation mechanism.[39m
[32m- # The tx confirmation mechanism periodically queries the \`/tx_search\` RPC[39m
[32m- # endpoint to check that previously-submitted transactions[39m
[32m- # (to any chain in this config file) have been successfully delivered.[39m
[32m- # If they have not been, and \`clear_interval = 0\`, then those packets are[39m
[32m- # queued up for re-submission.[39m
[32m- # Experimental feature. Affects telemetry if set to false.[39m
[32m- # [Default: true][39m
[2m  tx_confirmation = true[22m
[32m- # Auto register the counterparty payee on a destination chain to[39m
[32m- # the relayer's address on the source chain. This can be used[39m
[32m- # for simple configuration of the relayer to receive fees for[39m
[32m- # relaying RecvPacket on fee-enabled channels.[39m
[32m- # For more complex configuration, turn this off and use the CLI[39m
[32m- # to manually register the payee addresses.[39m
[32m- # [Default: false][39m
[32m- auto_register_counterparty_payee = false[39m
[32m- # The REST section defines parameters for Hermes' built-in RESTful API.[39m
[32m- # https://hermes.informal.systems/rest.html[39m
[31m+[39m
[2m  [rest][22m
[32m- # Whether or not to enable the REST service. Default: false[39m
[2m  enabled = true[22m
[32m- # Specify the IPv4/6 host over which the built-in HTTP server will serve the RESTful[39m
[32m- # API requests. Default: 127.0.0.1[39m
[32m- host =  '0.0.0.0'[39m
[32m- # Specify the port over which the built-in HTTP server will serve the restful API[39m
[32m- # requests. Default: 3000[39m
[31m+ host = \\"0.0.0.0\\"[39m
[2m  port = 3000[22m
[32m- # The telemetry section defines parameters for Hermes' built-in telemetry capabilities.[39m
[32m- # https://hermes.informal.systems/telemetry.html[39m
[31m+[39m
[2m  [telemetry][22m
[32m- # Whether or not to enable the telemetry service. Default: false[39m
[2m  enabled = true[22m
[32m- # Specify the IPv4/6 host over which the built-in HTTP server will serve the metrics[39m
[32m- # gathered by the telemetry service. Default: 127.0.0.1[39m
[32m- host = '0.0.0.0'[39m
[32m- # Specify the port over which the built-in HTTP server will serve the metrics gathered[39m
[32m- # by the telemetry service. Default: 3001[39m
[31m+ host = \\"0.0.0.0\\"[39m
[2m  port = 3001[22m
[32m-[39m


[2m  [[chains]][22m
[2m  id = \\"osmosis-1\\"[22m
[31m+ type = \\"CosmosSdk\\"[39m
[2m  key_name = \\"osmosis-1-cli\\"[22m
[32m- rpc_addr = \\"http://osmosis-1-genesis.default.svc.cluster.local:26657\\"[39m
[32m- grpc_addr = \\"http://osmosis-1-genesis.default.svc.cluster.local:9090\\"[39m
[32m- event_source = { mode = 'push', url = \\"ws://osmosis-1-genesis.default.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[32m- # Experimental: Whether or not the full node is trusted.[39m
[31m+[39m
[31m+ rpc_addr = \\"http://osmosis-1-genesis.$NAMESPACE.svc.cluster.local:26657\\"[39m
[31m+ grpc_addr = \\"http://osmosis-1-genesis.$NAMESPACE.svc.cluster.local:9090\\"[39m
[31m+ event_source = { mode = 'push', url = \\"ws://osmosis-1-genesis.$NAMESPACE.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[2m  trusted_node = false[22m
[2m  account_prefix = \\"osmo\\"[22m
[2m  default_gas = 500000000[22m
[33m@@ -103,17 +56,16 @@[39m
[2m  trusting_period = \\"75s\\"[22m
[2m  trust_threshold = { numerator = \\"2\\", denominator = \\"3\\" }[22m
[2m  address_type = { derivation = 'cosmos' }[22m
[32m- gas_price = { price = 0.25, denom = \\"uosmo\\" }[39m
[32m-[39m
[32m-[39m
[31m+ gas_price = { price = 1.25, denom = \\"uosmo\\" }[39m

[2m  [[chains]][22m
[2m  id = \\"cosmoshub-4\\"[22m
[31m+ type = \\"CosmosSdk\\"[39m
[2m  key_name = \\"cosmoshub-4-cli\\"[22m
[32m- rpc_addr = \\"http://cosmoshub-4-genesis.default.svc.cluster.local:26657\\"[39m
[32m- grpc_addr = \\"http://cosmoshub-4-genesis.default.svc.cluster.local:9090\\"[39m
[32m- event_source = { mode = 'push', url = \\"ws://cosmoshub-4-genesis.default.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[32m- # Experimental: Whether or not the full node is trusted.[39m
[31m+[39m
[31m+ rpc_addr = \\"http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:26657\\"[39m
[31m+ grpc_addr = \\"http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:9090\\"[39m
[31m+ event_source = { mode = 'push', url = \\"ws://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[2m  trusted_node = false[22m
[2m  account_prefix = \\"cosmos\\"[22m
[2m  default_gas = 500000000[22m
[33m@@ -128,96 +80,48 @@[39m
[2m  trusting_period = \\"75s\\"[22m
[2m  trust_threshold = { numerator = \\"2\\", denominator = \\"3\\" }[22m
[2m  address_type = { derivation = 'cosmos' }[22m
[32m- gas_price = { price = 0.25, denom = \\"uatom\\" }",[39m
[31m+ gas_price = { price = 1.25, denom = \\"uatom\\" }",[39m
[2m      "config.toml": "# The global section has parameters that apply globally to the relayer operation.[22m
[2m  [global][22m
[32m- # Specify the verbosity for the relayer logging output. Default: 'info'[39m
[32m- # Valid options are 'error', 'warn', 'info', 'debug', 'trace'.[39m
[32m- log_level = 'info'[39m
[32m- # Specify the mode to be used by the relayer. [Required][39m
[31m+ log_level = \\"info\\"[39m
[31m+[39m
[2m  [mode][22m
[32m- # Specify the client mode.[39m
[2m  [mode.clients][22m
[32m- # Whether or not to enable the client workers. [Required][39m
[2m  enabled = true[22m
[32m- # Whether or not to enable periodic refresh of clients. [Default: true][39m
[32m- # This feature only applies to clients that underlie an open channel.[39m
[32m- # For Tendermint clients, the frequency at which Hermes refreshes them is 2/3 of their[39m
[32m- # trusting period (e.g., refresh every ~9 days if the trusting period is 14 days).[39m
[32m- # Note: Even if this is disabled, clients will be refreshed automatically if[39m
[32m- #      there is activity on a connection or channel they are involved with.[39m
[2m  refresh = true[22m
[32m- # Whether or not to enable misbehaviour detection for clients. [Default: false][39m
[2m  misbehaviour = true[22m
[32m- # Specify the connections mode.[39m
[31m+[39m
[2m  [mode.connections][22m
[32m- # Whether or not to enable the connection workers for handshake completion. [Required][39m
[2m  enabled = true[22m
[32m- # Specify the channels mode.[39m
[31m+[39m
[2m  [mode.channels][22m
[32m- # Whether or not to enable the channel workers for handshake completion. [Required][39m
[2m  enabled = true[22m
[32m- # Specify the packets mode.[39m
[31m+[39m
[2m  [mode.packets][22m
[32m- # Whether or not to enable the packet workers. [Required][39m
[2m  enabled = true[22m
[32m- # Parametrize the periodic packet clearing feature.[39m
[32m- # Interval (in number of blocks) at which pending packets[39m
[32m- # should be periodically cleared. A value of '0' will disable[39m
[32m- # periodic packet clearing. [Default: 100][39m
[2m  clear_interval = 100[22m
[32m- # Whether or not to clear packets on start. [Default: false][39m
[2m  clear_on_start = true[22m
[32m- # Toggle the transaction confirmation mechanism.[39m
[32m- # The tx confirmation mechanism periodically queries the \`/tx_search\` RPC[39m
[32m- # endpoint to check that previously-submitted transactions[39m
[32m- # (to any chain in this config file) have been successfully delivered.[39m
[32m- # If they have not been, and \`clear_interval = 0\`, then those packets are[39m
[32m- # queued up for re-submission.[39m
[32m- # Experimental feature. Affects telemetry if set to false.[39m
[32m- # [Default: true][39m
[2m  tx_confirmation = true[22m
[32m- # Auto register the counterparty payee on a destination chain to[39m
[32m- # the relayer's address on the source chain. This can be used[39m
[32m- # for simple configuration of the relayer to receive fees for[39m
[32m- # relaying RecvPacket on fee-enabled channels.[39m
[32m- # For more complex configuration, turn this off and use the CLI[39m
[32m- # to manually register the payee addresses.[39m
[32m- # [Default: false][39m
[32m- auto_register_counterparty_payee = false[39m
[32m- # The REST section defines parameters for Hermes' built-in RESTful API.[39m
[32m- # https://hermes.informal.systems/rest.html[39m
[31m+[39m
[2m  [rest][22m
[32m- # Whether or not to enable the REST service. Default: false[39m
[2m  enabled = true[22m
[32m- # Specify the IPv4/6 host over which the built-in HTTP server will serve the RESTful[39m
[32m- # API requests. Default: 127.0.0.1[39m
[32m- host =  '0.0.0.0'[39m
[32m- # Specify the port over which the built-in HTTP server will serve the restful API[39m
[32m- # requests. Default: 3000[39m
[31m+ host = \\"0.0.0.0\\"[39m
[2m  port = 3000[22m
[32m- # The telemetry section defines parameters for Hermes' built-in telemetry capabilities.[39m
[32m- # https://hermes.informal.systems/telemetry.html[39m
[31m+[39m
[2m  [telemetry][22m
[32m- # Whether or not to enable the telemetry service. Default: false[39m
[2m  enabled = true[22m
[32m- # Specify the IPv4/6 host over which the built-in HTTP server will serve the metrics[39m
[32m- # gathered by the telemetry service. Default: 127.0.0.1[39m
[32m- host = '0.0.0.0'[39m
[32m- # Specify the port over which the built-in HTTP server will serve the metrics gathered[39m
[32m- # by the telemetry service. Default: 3001[39m
[31m+ host = \\"0.0.0.0\\"[39m
[2m  port = 3001[22m
[32m-[39m


[2m  [[chains]][22m
[2m  id = \\"osmosis-1\\"[22m
[2m  type = \\"CosmosSdk\\"[22m
[2m  key_name = \\"osmosis-1\\"[22m
[32m- rpc_addr = \\"http://osmosis-1-genesis.default.svc.cluster.local:26657\\"[39m
[32m- grpc_addr = \\"http://osmosis-1-genesis.default.svc.cluster.local:9090\\"[39m
[32m- event_source = { mode = 'push', url = \\"ws://osmosis-1-genesis.default.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[32m- # Experimental: Whether or not the full node is trusted.[39m
[31m+[39m
[31m+ rpc_addr = \\"http://osmosis-1-genesis.$NAMESPACE.svc.cluster.local:26657\\"[39m
[31m+ grpc_addr = \\"http://osmosis-1-genesis.$NAMESPACE.svc.cluster.local:9090\\"[39m
[31m+ event_source = { mode = 'push', url = \\"ws://osmosis-1-genesis.$NAMESPACE.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[2m  trusted_node = false[22m
[2m  account_prefix = \\"osmo\\"[22m
[2m  default_gas = 500000000[22m
[33m@@ -233,17 +137,15 @@[39m
[2m  trust_threshold = { numerator = \\"2\\", denominator = \\"3\\" }[22m
[2m  address_type = { derivation = 'cosmos' }[22m
[2m  gas_price = { price = 1.25, denom = \\"uosmo\\" }[22m
[32m-[39m
[32m-[39m

[2m  [[chains]][22m
[2m  id = \\"cosmoshub-4\\"[22m
[2m  type = \\"CosmosSdk\\"[22m
[2m  key_name = \\"cosmoshub-4\\"[22m
[32m- rpc_addr = \\"http://cosmoshub-4-genesis.default.svc.cluster.local:26657\\"[39m
[32m- grpc_addr = \\"http://cosmoshub-4-genesis.default.svc.cluster.local:9090\\"[39m
[32m- event_source = { mode = 'push', url = \\"ws://cosmoshub-4-genesis.default.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[32m- # Experimental: Whether or not the full node is trusted.[39m
[31m+[39m
[31m+ rpc_addr = \\"http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:26657\\"[39m
[31m+ grpc_addr = \\"http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:9090\\"[39m
[31m+ event_source = { mode = 'push', url = \\"ws://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:26657/websocket\\", batch_delay = '500ms' }[39m
[2m  trusted_node = false[22m
[2m  account_prefix = \\"cosmos\\"[22m
[2m  default_gas = 500000000[22m
[33m@@ -262,6 +164,15 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "relayer",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "hermes-osmos-cosmos",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/role": "hermes",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "hermes-osmos-cosmos",[22m
[2m    },[22m
[2m  }[22m

--- StatefulSet/hermes-osmos-cosmos ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,15 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "relayer",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "hermes-osmos-cosmos",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/role": "hermes",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "starship-e2e-tests",[39m
[31m+     },[39m
[2m      "name": "hermes-osmos-cosmos",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -29,16 +38,18 @@[39m
[2m            "app.kubernetes.io/name": "hermes-osmos-cosmos",[22m
[2m            "app.kubernetes.io/rawname": "osmos-cosmos",[22m
[2m            "app.kubernetes.io/type": "hermes",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[2m          "containers": Array [[22m
[2m            Object {[22m
[31m+             "args": Array [[39m
[31m+               "/exposer/exposer",[39m
[31m+             ],[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "/exposer/exposer",[39m
[2m              ],[22m
[2m              "env": Array [[22m
[2m                Object {[22m
[33m@@ -55,11 +66,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -83,14 +94,24 @@[39m
[2m              ],[22m
[2m            },[22m
[2m            Object {[22m
[31m+             "args": Array [[39m
[31m+               "RLY_INDEX=\${HOSTNAME##*-}[39m
[31m+ echo \\"Relayer Index: $RLY_INDEX\\"[39m
[31m+ hermes start",[39m
[31m+             ],[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "RLY_INDEX=\${HOSTNAME##*-}[39m
[32m- echo \\"Relayer Index: $RLY_INDEX\\"[39m
[32m- hermes start",[39m
[2m              ],[22m
[2m              "env": Array [[22m
[31m+               Object {[39m
[31m+                 "name": "NAMESPACE",[39m
[31m+                 "valueFrom": Object {[39m
[31m+                   "fieldRef": Object {[39m
[31m+                     "fieldPath": "metadata.namespace",[39m
[31m+                   },[39m
[31m+                 },[39m
[31m+               },[39m
[2m                Object {[22m
[2m                  "name": "RELAYER_DIR",[22m
[2m                  "value": "/root/.hermes",[22m
[33m@@ -101,12 +122,12 @@[39m
[2m              "name": "relayer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[2m              },[22m
[2m              "securityContext": Object {[22m
[33m@@ -127,24 +148,26 @@[39m
[2m          ],[22m
[2m          "initContainers": Array [[22m
[2m            Object {[22m
[31m+             "args": Array [[39m
[31m+               "# Install exposer binary from the image[39m
[31m+ cp /bin/exposer /exposer/exposer[39m
[31m+ chmod +x /exposer/exposer",[39m
[31m+             ],[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "# Install exposer binary from the image[39m
[32m- cp /bin/exposer /exposer/exposer[39m
[32m- chmod +x /exposer/exposer",[39m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/exposer:20250205-544757d",[22m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "init-exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "100M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "100M",[39m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[33m@@ -155,9 +178,7 @@[39m
[2m              ],[22m
[2m            },[22m
[2m            Object {[22m
[32m-             "command": Array [[39m
[32m-               "bash",[39m
[32m-               "-c",[39m
[31m+             "args": Array [[39m
[2m                "set -ux[22m

[2m  RLY_INDEX=\${HOSTNAME##*-}[22m
[33m@@ -166,18 +187,16 @@[39m
[2m  mkdir -p $RELAYER_DIR[22m
[2m  cp /configs/config.toml $RELAYER_DIR/config.toml[22m
[2m  cp /configs/config-cli.toml $RELAYER_DIR/config-cli.toml[22m
[32m- cat $RELAYER_DIR/config.toml[39m
[31m+[39m
[31m+ # Replace namespace placeholder with actual namespace environment variable[39m
[31m+ sed -i \\"s|\\\\$NAMESPACE|$NAMESPACE|g\\" $RELAYER_DIR/config.toml[39m
[31m+ sed -i \\"s|\\\\$NAMESPACE|$NAMESPACE|g\\" $RELAYER_DIR/config-cli.toml[39m

[32m- MNEMONIC=$(jq -r \\".relayers[$RELAYER_INDEX].mnemonic\\" $KEYS_CONFIG)[39m
[31m+ MNEMONIC=$(jq -r \\".relayers[$RLY_INDEX].mnemonic\\" $KEYS_CONFIG)[39m
[2m  echo $MNEMONIC > $RELAYER_DIR/mnemonic.txt[22m
[32m- MNEMONIC_CLI=$(jq -r \\".relayers_cli[$RELAYER_INDEX].mnemonic\\" $KEYS_CONFIG)[39m
[31m+ MNEMONIC_CLI=$(jq -r \\".relayers_cli[$RLY_INDEX].mnemonic\\" $KEYS_CONFIG)[39m
[2m  echo $MNEMONIC_CLI > $RELAYER_DIR/mnemonic-cli.txt[22m

[32m- echo \\"Debug output for osmos-cosmos...\\"[39m
[32m- cat << EOF[39m
[32m-               map[string]interface {}[39m
[32m-               {\\"chains\\":[\\"osmosis-1\\",\\"cosmoshub-4\\"],\\"channels\\":[{\\"a-chain\\":\\"osmosis-1\\",\\"a-port\\":\\"transfer\\",\\"b-chain\\":\\"cosmoshub-4\\",\\"b-port\\":\\"transfer\\",\\"new-connection\\":true}],\\"config\\":{\\"event_source\\":{\\"mode\\":\\"push\\"},\\"global\\":{\\"log_level\\":\\"info\\"},\\"mode\\":{\\"channels\\":{\\"enabled\\":true},\\"clients\\":{\\"enabled\\":true,\\"misbehaviour\\":true,\\"refresh\\":true},\\"connections\\":{\\"enabled\\":true},\\"packets\\":{\\"clear_interval\\":100,\\"clear_on_start\\":true,\\"enabled\\":true,\\"tx_confirmation\\":true}},\\"rest\\":{\\"enabled\\":true,\\"host\\":\\"0.0.0.0\\",\\"port\\":3000},\\"telemetry\\":{\\"enabled\\":true,\\"host\\":\\"0.0.0.0\\",\\"port\\":3001}},\\"fullname\\":\\"hermes-osmos-cosmos\\",\\"ics\\":{\\"enabled\\":false},\\"image\\":\\"ghcr.io/cosmology-tech/starship/hermes:1.10.0\\",\\"name\\":\\"osmos-cosmos\\",\\"replicas\\":1,\\"type\\":\\"hermes\\"}[39m
[32m- EOF[39m

[2m  echo \\"Creating key for osmosis-1...\\"[22m
[2m  hermes keys add \\\\[22m
[33m@@ -240,12 +259,17 @@[39m
[2m    $DENOM \\\\[22m
[2m    http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:8000/credit \\\\[22m
[2m    \\"false\\" || true[22m
[31m+[39m
[2m  hermes create channel \\\\[22m
[2m    --new-client-connection --yes \\\\[22m
[2m    --b-chain cosmoshub-4 \\\\[22m
[2m    --a-chain osmosis-1 \\\\[22m
[2m    --a-port transfer \\\\[22m
[2m    --b-port transfer",[22m
[31m+             ],[39m
[31m+             "command": Array [[39m
[31m+               "bash",[39m
[31m+               "-c",[39m
[2m              ],[22m
[2m              "env": Array [[22m
[2m                Object {[22m
[33m@@ -266,7 +290,7 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "RELAYER_INDEX",[22m
[32m-                 "value": "0",[39m
[31m+                 "value": "\${HOSTNAME##*-}",[39m
[2m                },[22m
[2m              ],[22m
[2m              "image": "ghcr.io/cosmology-tech/starship/hermes:1.10.0",[22m
[33m@@ -274,12 +298,12 @@[39m
[2m              "name": "init-relayer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[32m-                 "memory": "500M",[39m
[31m+                 "cpu": "0.2",[39m
[31m+                 "memory": "200M",[39m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[33m@@ -310,6 +334,7 @@[39m
[2m    echo \\"Checking: http://osmosis-1-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id\\"[22m
[2m    sleep 10;[22m
[2m  done[22m
[31m+[39m
[2m  while [ $(curl -sw '%{http_code}' http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id -o /dev/null) -ne 200 ]; do[22m
[2m    echo \\"Genesis validator does not seem to be ready for: cosmoshub-4. Waiting for it to start...\\"[22m
[2m    echo \\"Checking: http://cosmoshub-4-genesis.$NAMESPACE.svc.cluster.local:$GENESIS_PORT/node_id\\"[22m
[33m@@ -332,16 +357,16 @@[39m
[2m                  },[22m
[2m                },[22m
[2m              ],[22m
[32m-             "image": "curlimages/curl",[39m
[31m+             "image": "curlimages/curl:latest",[39m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "wait-for-chains",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m"
`;

exports[`Manifest Comparison Tests Individual Config Comparisons should generate manifests for xpla that match the snapshot 1`] = `
"ðŸ”„ MODIFIED_RESOURCES:

--- ConfigMap/keys ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -98,6 +98,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "configmap",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "keys",[39m
[31m+       "app.kubernetes.io/part-of": "global",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "xpla",[39m
[31m+     },[39m
[2m      "name": "keys",[22m
[2m    },[22m
[2m  }[22m

--- ConfigMap/setup-scripts ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -208,6 +208,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "configmap",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts",[39m
[31m+       "app.kubernetes.io/part-of": "global",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "xpla",[39m
[31m+     },[39m
[2m      "name": "setup-scripts",[22m
[2m    },[22m
[2m  }[22m

--- Deployment/registry ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,14 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "Deployment",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "registry",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "registry",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "xpla",[39m
[31m+     },[39m
[2m      "name": "registry",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -9,7 +17,6 @@[39m
[2m      "revisionHistoryLimit": 3,[22m
[2m      "selector": Object {[22m
[2m        "matchLabels": Object {[22m
[32m-         "app.kubernetes.io/instance": "registry",[39m
[2m          "app.kubernetes.io/name": "registry",[22m
[2m        },[22m
[2m      },[22m
[33m@@ -22,19 +29,17 @@[39m
[2m            "tier": "gateway",[22m
[2m          },[22m
[2m          "labels": Object {[22m
[32m-           "app.kubernetes.io/instance": "registry",[39m
[31m+           "app.kubernetes.io/component": "registry",[39m
[31m+           "app.kubernetes.io/managed-by": "starship",[39m
[2m            "app.kubernetes.io/name": "registry",[22m
[32m-           "app.kubernetes.io/rawname": "registry",[39m
[32m-           "app.kubernetes.io/type": "registry",[39m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/part-of": "starship",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+           "starship.io/name": "xpla",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[2m          "containers": Array [[22m
[2m            Object {[22m
[32m-             "command": Array [[39m
[32m-               "registry",[39m
[32m-             ],[39m
[2m              "env": Array [[22m
[2m                Object {[22m
[2m                  "name": "NAMESPACE",[22m
[33m@@ -74,21 +79,20 @@[39m
[2m                },[22m
[2m                Object {[22m
[2m                  "name": "REGISTRY_CHAIN_REGISTRY",[22m
[32m-                 "value": "/configs",[39m
[31m+                 "value": "/chains",[39m
[2m                },[22m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/registry:20250205-544757d",[22m
[32m-             "imagePullPolicy": "IfNotPresent",[39m
[2m              "livenessProbe": Object {[22m
[32m-               "initialDelaySeconds": 20,[39m
[32m-               "periodSeconds": 10,[39m
[31m+               "initialDelaySeconds": 15,[39m
[31m+               "periodSeconds": 20,[39m
[2m                "tcpSocket": Object {[22m
[2m                  "port": 8080,[22m
[2m                },[22m
[2m              },[22m
[2m              "name": "registry",[22m
[2m              "readinessProbe": Object {[22m
[32m-               "initialDelaySeconds": 20,[39m
[31m+               "initialDelaySeconds": 5,[39m
[2m                "periodSeconds": 10,[22m
[2m                "tcpSocket": Object {[22m
[2m                  "port": 8080,[22m
[33m@@ -96,18 +100,18 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[2m                Object {[22m
[32m-                 "mountPath": "/configs/xpla_1-1",[39m
[32m-                 "name": "registry-configs-xpla-1-1",[39m
[31m+                 "mountPath": "/chains/xpla_1-1",[39m
[31m+                 "name": "registry-xpla-1-1",[39m
[2m                },[22m
[2m              ],[22m
[2m            },[22m
[33m@@ -139,16 +143,16 @@[39m
[2m                  },[22m
[2m                },[22m
[2m              ],[22m
[32m-             "image": "curlimages/curl",[39m
[31m+             "image": "curlimages/curl:latest",[39m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "wait-for-chains",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.1,[39m
[31m+                 "cpu": "0.1",[39m
[2m                  "memory": "100M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -159,7 +163,7 @@[39m
[2m              "configMap": Object {[22m
[2m                "name": "registry-xpla-1-1",[22m
[2m              },[22m
[32m-             "name": "registry-configs-xpla-1-1",[39m
[31m+             "name": "registry-xpla-1-1",[39m
[2m            },[22m
[2m          ],[22m
[2m        },[22m

--- ConfigMap/registry-xpla-1-1 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -7,21 +7,21 @@[39m
[2m    \\"assets\\": [[22m
[2m      {[22m
[2m        \\"base\\": \\"axpla\\",[22m
[32m-       \\"coingecko_id\\": \\"xpla\\",[39m
[31m+       \\"description\\": \\"The XPLA token is the native governance token for the XPLA chain.\\",[39m
[2m        \\"denom_units\\": [[22m
[2m          {[22m
[2m            \\"denom\\": \\"axpla\\",[22m
[2m            \\"exponent\\": 0[22m
[2m          }[22m
[2m        ],[22m
[32m-       \\"description\\": \\"The XPLA token is the native governance token for the XPLA chain.\\",[39m
[31m+       \\"name\\": \\"XPLA\\",[39m
[2m        \\"display\\": \\"XPLA\\",[22m
[31m+       \\"symbol\\": \\"XPLA\\",[39m
[2m        \\"logo_URIs\\": {[22m
[2m          \\"png\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/xpla/images/xpla.png\\",[22m
[2m          \\"svg\\": \\"https://raw.githubusercontent.com/cosmos/chain-registry/master/xpla/images/xpla.svg\\"[22m
[2m        },[22m
[32m-       \\"name\\": \\"XPLA\\",[39m
[32m-       \\"symbol\\": \\"XPLA\\"[39m
[31m+       \\"coingecko_id\\": \\"xpla\\"[39m
[2m      }[22m
[2m    ][22m
[2m  }",[22m
[33m@@ -78,6 +78,14 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "registry",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "registry-xpla-1-1",[39m
[31m+       "app.kubernetes.io/part-of": "starship",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/name": "xpla",[39m
[31m+     },[39m
[2m      "name": "registry-xpla-1-1",[22m
[2m    },[22m
[2m  }[22m

--- ConfigMap/patch-xpla-1-1 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -13,6 +13,17 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "xpla",[39m
[31m+       "app.kubernetes.io/part-of": "xpla_1-1",[39m
[31m+       "app.kubernetes.io/role": "genesis-patch",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-id": "xpla_1-1",[39m
[31m+       "starship.io/chain-name": "xpla",[39m
[31m+       "starship.io/name": "xpla",[39m
[31m+     },[39m
[2m      "name": "patch-xpla-1-1",[22m
[2m    },[22m
[2m  }[22m

--- StatefulSet/xpla-1-1-genesis ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -2,6 +2,18 @@[39m
[2m    "apiVersion": "apps/v1",[22m
[2m    "kind": "StatefulSet",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/id": "xpla_1-1",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "xpla_1-1-genesis",[39m
[31m+       "app.kubernetes.io/part-of": "xpla_1-1",[39m
[31m+       "app.kubernetes.io/role": "genesis",[39m
[31m+       "app.kubernetes.io/type": "xpla_1-1-statefulset",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-name": "xpla",[39m
[31m+       "starship.io/name": "xpla",[39m
[31m+     },[39m
[2m      "name": "xpla-1-1-genesis",[22m
[2m    },[22m
[2m    "spec": Object {[22m
[33m@@ -26,8 +38,9 @@[39m
[2m            "app.kubernetes.io/instance": "xpla",[22m
[2m            "app.kubernetes.io/name": "xpla_1-1-genesis",[22m
[2m            "app.kubernetes.io/rawname": "xpla_1-1",[22m
[31m+           "app.kubernetes.io/role": "genesis",[39m
[2m            "app.kubernetes.io/type": "xpla_1-1",[22m
[32m-           "app.kubernetes.io/version": "0.1.1",[39m
[31m+           "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[2m          },[22m
[2m        },[22m
[2m        "spec": Object {[22m
[33m@@ -91,11 +104,11 @@[39m
[2m              "name": "exposer",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[31m+                 "cpu": "0.2",[39m
[2m                  "memory": "200M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -184,12 +197,12 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.2,[39m
[32m-                 "memory": "200M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "128M",[39m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.2,[39m
[32m-                 "memory": "200M",[39m
[31m+                 "cpu": "0.1",[39m
[31m+                 "memory": "128M",[39m
[2m                },[22m
[2m              },[22m
[2m              "volumeMounts": Array [[22m
[33m@@ -211,7 +224,12 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "START_ARGS=\\"\\"[39m
[31m+               "#!/bin/bash[39m
[31m+ set -euo pipefail[39m
[31m+[39m
[31m+ START_ARGS=\\"\\"[39m
[31m+[39m
[31m+[39m
[2m  $CHAIN_BIN start $START_ARGS",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -274,11 +292,11 @@[39m
[2m              },[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -307,7 +325,9 @@[39m
[2m  echo \\"Validator Index: $VAL_INDEX\\"[22m

[2m  echo \\"Running setup config script...\\"[22m
[31m+[39m
[2m  jq -s '.[0] * .[1]' $CHAIN_DIR/config/genesis.json /patch/genesis.json > $CHAIN_DIR/config/genesis.json.tmp && mv $CHAIN_DIR/config/genesis.json.tmp $CHAIN_DIR/config/genesis.json[22m
[31m+[39m
[2m  bash -e /scripts/update-config.sh",[22m
[2m              ],[22m
[2m              "env": Array [[22m
[33m@@ -389,11 +409,11 @@[39m
[2m              "name": "init-config",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -420,20 +440,18 @@[39m
[2m              "command": Array [[22m
[2m                "bash",[22m
[2m                "-c",[22m
[32m-               "# Install faucet binary from the image[39m
[32m- cp /bin/faucet /faucet/faucet[39m
[32m- chmod +x /faucet/faucet",[39m
[31m+               "cp /bin/faucet /faucet/faucet && chmod +x /faucet/faucet",[39m
[2m              ],[22m
[2m              "image": "ghcr.io/hyperweb-io/starship/faucet:20250325-2207109",[22m
[2m              "imagePullPolicy": "IfNotPresent",[22m
[2m              "name": "init-faucet",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m
[33m@@ -470,6 +488,7 @@[39m

[2m  echo \\"Add custom accounts and balances\\"[22m
[2m  CHAIN_GENESIS_CMD=$($CHAIN_BIN 2>&1 | grep -q \\"genesis-related subcommands\\" && echo \\"genesis\\" || echo \\"\\")[22m
[31m+[39m
[2m  echo \\"Adding balance to xpla1cmywl3ff3vfsdp2s87v25v75qjxs4up35tk45g\\"[22m
[2m  $CHAIN_BIN $CHAIN_GENESIS_CMD add-genesis-account xpla1cmywl3ff3vfsdp2s87v25v75qjxs4up35tk45g 100000000000000000000000axpla --keyring-backend=\\"test\\"",[22m
[2m              ],[22m
[33m@@ -560,11 +579,11 @@[39m
[2m              "name": "init-genesis",[22m
[2m              "resources": Object {[22m
[2m                "limits": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m                "requests": Object {[22m
[32m-                 "cpu": 0.5,[39m
[31m+                 "cpu": "0.5",[39m
[2m                  "memory": "500M",[22m
[2m                },[22m
[2m              },[22m

--- ConfigMap/setup-scripts-xpla-1-1 ---
[32m- Expected (reference)[39m
[31m+ Generated (actual)[39m

[33m@@ -551,7 +551,7 @@[39m
[2m  sed -i -e \\"s#timeout_precommit = \\\\\\".*\\\\\\"#timeout_precommit = \\\\\\"$TIMEOUT_PRECOMMIT\\\\\\"#g\\" $CHAIN_DIR/config/config.toml[22m
[2m  sed -i -e \\"s#timeout_precommit_delta = \\\\\\".*\\\\\\"#timeout_precommit_delta = \\\\\\"$TIMEOUT_PRECOMMIT_DELTA\\\\\\"#g\\" $CHAIN_DIR/config/config.toml[22m
[2m  sed -i -e \\"s#timeout_commit = \\\\\\".*\\\\\\"#timeout_commit = \\\\\\"$TIMEOUT_COMMIT\\\\\\"#g\\" $CHAIN_DIR/config/config.toml",[22m
[32m-     "update-genesis.sh": "#!/bin/bash[39m
[31m+     "updateGenesis.sh": "#!/bin/bash[39m

[2m  DENOM=\\"\${DENOM:=axpla}\\"[22m
[2m  CHAIN_BIN=\\"\${CHAIN_BIN:=xplad}\\"[22m
[33m@@ -587,6 +587,17 @@[39m
[2m    },[22m
[2m    "kind": "ConfigMap",[22m
[2m    "metadata": Object {[22m
[31m+     "labels": Object {[39m
[31m+       "app.kubernetes.io/component": "chain",[39m
[31m+       "app.kubernetes.io/managed-by": "starship",[39m
[31m+       "app.kubernetes.io/name": "setup-scripts-xpla-1-1",[39m
[31m+       "app.kubernetes.io/part-of": "xpla_1-1",[39m
[31m+       "app.kubernetes.io/role": "setup-scripts",[39m
[31m+       "app.kubernetes.io/version": "4.0.0-alpha.0",[39m
[31m+       "starship.io/chain-id": "xpla_1-1",[39m
[31m+       "starship.io/chain-name": "xpla",[39m
[31m+       "starship.io/name": "xpla",[39m
[31m+     },[39m
[2m      "name": "setup-scripts-xpla-1-1",[22m
[2m    },[22m
[2m  }[22m"
`;
